<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd"
[
  <!ENTITY rfc1034 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.1034.xml'>
  <!ENTITY rfc1035 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.1035.xml'>
  <!ENTITY rfc2119 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml'>
  <!ENTITY rfc2781 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2781.xml'>
  <!ENTITY rfc3629 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3629.xml'>
  <!ENTITY rfc3688 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3688.xml'>
  <!ENTITY rfc5730 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5730.xml'>
  <!ENTITY rfc5731 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5731.xml'>
  <!ENTITY rfc3757 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3757.xml'>
  <!ENTITY rfc4033 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4033.xml'>
  <!ENTITY rfc4034 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4034.xml'>
  <!ENTITY rfc4035 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4035.xml'>
  <!ENTITY rfc4310 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.4310.xml'>   
  <!ENTITY W3C.xml PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml4/reference.W3C.REC-xml-20001006.xml'>
  <!ENTITY W3C.xmlschema-1 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml4/reference.W3C.REC-xmlschema-1-20010502.xml'>
  <!ENTITY W3C.xmlschema-2 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml4/reference.W3C.REC-xmlschema-2-20010502.xml'>
]>

<?xml-stylesheet type="text/xsl" href="rfc2629.xslt"?>

<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc rfcedstyle="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc iprnotified="no"?>

<!-- <?rfc strict="yes"?> -->

<rfc category="std" ipr="pre5378Trust200902" number="5910" obsoletes="4310">
  <front>
    <title abbrev="EPP DNS Security Extensions Mapping">
      Domain Name System (DNS) Security Extensions Mapping
      for&nbsp;the&nbsp;Extensible&nbsp;Provisioning Protocol (EPP)</title>
    <author initials="J." surname="Gould" fullname="James Gould">
      <organization>VeriSign, Inc.</organization>
      <address>
        <postal>
          <street>21345 Ridgetop Circle</street>
          <city>Dulles</city>
          <region>VA</region>
          <code>20166-6503</code>
          <country>US</country>
        </postal>
        <email>jgould@verisign.com</email>
      </address>
    </author>
    <author initials="S." surname="Hollenbeck" fullname="Scott Hollenbeck">
      <organization>VeriSign, Inc.</organization>
      <address>
        <postal>
          <street>21345 Ridgetop Circle</street>
          <city>Dulles</city>
          <region>VA</region>
          <code>20166-6503</code>
          <country>US</country>
        </postal>
        <email>shollenbeck@verisign.com</email>
      </address>
    </author>

    <date year="2010" month="May" day="4"/>
    <area>General</area>
    <keyword>EPP</keyword>
    <keyword>Extensible Provisioning Protocol</keyword>
    <keyword>XML</keyword>
    <keyword>DNS</keyword>
    <keyword>Security</keyword>
    <keyword>DNSSEC</keyword>
    <keyword>Delegation Signer</keyword>
    <keyword>DS</keyword>

    <abstract>
      <t>This document describes an Extensible Provisioning Protocol (EPP)
      extension mapping for the provisioning and management of Domain
      Name System security (DNSSEC) extensions for domain names stored in
      a shared central repository.  Specified in XML, this mapping
      extends the EPP domain name mapping to provide additional features
      required for the provisioning of DNS security extensions. This document obsoletes RFC 4310.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction" anchor="intro">
      <t>This document describes an extension mapping for version 1.0 of the
      Extensible Provisioning Protocol (EPP) described in RFC 5730
      <xref target="RFC5730"/>.  This mapping, an extension of the domain name
      mapping described in RFC 5731 <xref target="RFC5731"/>, is specified using
      the Extensible Markup Language (XML) 1.0 <xref target="W3C.REC-xml-20001006"/>
      and XML Schema notation (<xref target="W3C.REC-xmlschema-1-20010502"/>
      <xref target="W3C.REC-xmlschema-2-20010502"/>).</t>

      <t>The EPP core protocol specification <xref target="RFC5730"/>
      provides a complete description of EPP command and response structures.
      A thorough understanding of the base protocol specification is necessary
      to understand the mapping described in this document.  Familiarity with
      the Domain Name System (DNS) described in RFC 1034 <xref target="RFC1034"/>
      and RFC&nbsp;1035 <xref target="RFC1035"/> and with DNS security extensions described
      in RFC&nbsp;4033 <xref target="RFC4033"/>, RFC 4034 <xref target="RFC4034"/>,
      and RFC 4035 <xref target="RFC4035"/> is required to understand
      the DNS security concepts described in this document.</t>

      <t>The EPP mapping described in this document specifies a mechanism
      for the provisioning and management of DNS security extensions in a
      shared central repository.  Information exchanged via this mapping
      can be extracted from the repository and used to publish DNSSEC
      Delegation Signer (DS) resource records (RRs) as described in RFC&nbsp;4034
      <xref target="RFC4034"/>.</t>

      <t>This document obsoletes RFC 4310 <xref target="RFC4310"/>; thus, secDNS-1.1 as defined in this document deprecates secDNS-1.0 <xref target="RFC4310"/>.
      The motivation behind obsoleting RFC 4310 <xref target="RFC4310"/>
includes:

<vspace blankLines="0"/>
      <list style="hanging">
      <t hangText="-">Addressing the issue with removing DS data based on the
non-unique &lt;secDNS:keyTag&gt; element.  The client should explicitly specify
the DS data to be removed, by using all four &lt;secDNS:dsData&gt; elements that are guaranteed to be unique.</t>
      <t hangText="-">Adding the ability to add and remove &lt;secDNS:dsData&gt; elements in a single command.  This makes it consistent with RFC 5731 <xref target="RFC5731"/>.</t>
      <t hangText="-">Clarifying and correcting the usage of the
&lt;secDNS:chg&gt; element.  RFC 4310 <xref target="RFC4310"/> defined the
&lt;secDNS:chg&gt; element as a replacement for the DS data.  This is inconsistent with RFC 5731 <xref target="RFC5731"/>, where a &lt;domain:chg&gt; element is used to change the values of the domain attributes.</t>   
      <t hangText="-">Adding support for the Key Data Interface described in <xref target="keyDataInterface"/> for "thick" DNSSEC servers that accept only key data and generate the associated DS data.</t>    
      </list></t>

      <section title="Conventions Used in This Document" anchor="conventions">
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in BCP 14, RFC 2119
        <xref target="RFC2119"/>.</t>

        <t>In examples, "C:" represents lines sent by a protocol client, and "S:"
        represents lines returned by a protocol server.  "////" is used to note
        element values that have been shortened to better fit page boundaries.
        Indentation and white space in examples is provided only to illustrate
        element relationships and is not a mandatory feature of this protocol.</t>

        <t>XML is case sensitive.  Unless stated otherwise, XML specifications
        and examples provided in this document MUST be interpreted in the
        character case presented in order to develop a conforming implementation.</t>
        
        <t>secDNS-1.0 is used as an abbreviation for urn:ietf:params:xml:ns:secDNS-1.0, and 
        secDNS-1.1 is used as an abbreviation for urn:ietf:params:xml:ns:secDNS-1.1.</t>
        
      </section>
    </section>

	<section title="Migrating from RFC 4310" anchor="migratingFrom4310">
		<t>This section includes implementation recommendations for clients and servers to use in migrating from 
		secDNS-1.0 <xref target="RFC4310"/> to secDNS-1.1.</t>
		
		<t>As this document deprecates RFC 4310 <xref target="RFC4310"/>, if a server announces support for both secDNS-1.0 <xref target="RFC4310"/>  
		and secDNS-1.1 in the EPP greeting, clients supporting both versions SHOULD prefer secDNS-1.1.</t>
		
		<t>A server SHOULD do the following to help clients migrate from secDNS-1.0 <xref target="RFC4310"/> to secDNS-1.1 as defined in this document.<vspace blankLines="0"/></t>  
        <t><list style="numbers">
        <t>A server migrating from secDNS-1.0 <xref target="RFC4310"/> to secDNS-1.1 SHOULD support both versions (i.e., secDNS-1.0 and secDNS-1.1) for a reasonable migration period.<vspace blankLines="0"/></t>
        <t>The version of the &lt;secDNS:infData&gt; element to be returned by the server in the response to a &lt;domain:info&gt; response SHOULD depend   
        on the &lt;extURI&gt; elements (indicating the secDNS extension) the client included in the EPP &lt;login&gt; command using the following mapping:<vspace blankLines="0"/>
        <list style="hanging">
        	<t hangText="-">Return version secDNS-1.1 of the &lt;secDNS:infData&gt; element if urn:ietf:params:xml:ns:secDNS-1.1 was included as an &lt;extURI&gt; element in the EPP &lt;login&gt; command, independent of whether urn:ietf:params:xml:ns:secDNS-1.0 is also included as an &lt;extURI&gt; element in the EPP &lt;login&gt; command.<vspace blankLines="0"/></t>
        	<t hangText="-">Return version secDNS-1.0 of the &lt;secDNS:infData&gt; element if urn:ietf:params:xml:ns:secDNS-1.0 but not urn:ietf:params:xml:ns:secDNS-1.1 was included as an &lt;extURI&gt; element in the EPP &lt;login&gt; command.<vspace blankLines="0"/></t>
        	<t hangText="-">Don't return the &lt;secDNS:infData&gt; element if neither urn:ietf:params:xml:ns:secDNS-1.0 nor urn:ietf:params:xml:ns:secDNS-1.1 was included as an &lt;extURI&gt; element in the EPP &lt;login&gt; command.</t>
        </list></t>   
        </list></t>
 	</section> 

    <section title="Object Attributes" anchor="attrs">
      <t>This extension adds additional elements to the EPP domain name
      mapping <xref target="RFC5731"/>.  Only those new elements are
      described here.</t>


      <section title="Delegation Signer Information" anchor="dsInfo">
        <t>Delegation Signer (DS) information is published by a DNS server
        to indicate that a child zone is digitally signed and that
        the parent zone recognizes the indicated key as a valid zone
        key for the child zone.  A DS resource record (RR) contains four fields: a key
        tag field, a key algorithm number octet, an octet identifying
        a digest algorithm, and a digest field.  See RFC 4034
        <xref target="RFC4034"/> for specific field formats.</t>

        <section title="Public Key Information" anchor="pki">
          <t>Public key information provided by a client maps to the DNSKEY
          RR presentation field formats described in Section 2.2 of RFC 4034
          <xref target="RFC4034"/>.  A DNSKEY RR contains four fields: flags,
          a protocol octet, an algorithm number octet, and a public key.</t>
        </section>
      </section>

      <section title="Booleans" anchor="booleans">
        <t>Boolean values MUST be represented in the XML Schema
        format described in Part 2 of the W3C XML Schema recommendation
        <xref target="W3C.REC-xmlschema-2-20010502"/>.</t>
      </section>

      <section title="Maximum Signature Lifetime" anchor="maxSigLife">
        <t>Maximum signature lifetime (maxSigLife) is an OPTIONAL child preference for the 
        number of seconds after signature generation when the parent's signature on
        the DS information provided by the child will expire.  The maxSigLife 
        value applies to the RRSIG resource record (RR) over the DS RRset.  See 
        Section 3 of RFC 4034 <xref target="RFC4034"/> for information on the RRSIG 
        resource record (RR).<vspace blankLines="0"/></t>
        <t>The maximum signature lifetime is represented using the 
        &lt;secDNS:maxSigLife&gt; element.    
        The maxSigLife value MUST be represented in seconds, using an
        extended XML Schema "int" format.  The base "int" format, which allows
        negative numbers, is described in Part 2 of the W3C XML Schema recommendation
        <xref target="W3C.REC-xmlschema-2-20010502"/>.  This format is further
        restricted to enforce a minimum value of 1.<vspace blankLines="0"/></t>
        <t>If maxSigLife is not provided by the client, or if the server does 
        not support the client-specified maxSigLife value, the default signature expiration policy of
        the server operator (as determined using an out-of-band
        mechanism) applies.</t>
      </section>
    </section>
     
    <section title="DS Data Interface and Key Data Interface" anchor="dsDataKeyDatainterfaces">
       
      <t>This document describes operational scenarios in which a client can
      create, add, and remove Delegation
      Signer (DS) information or key data information for a domain name.  There are two different forms of interfaces that a server can support.  The first is called the "DS Data Interface", where the client is responsible for the creation of the DS information and is required to pass DS information when performing adds and removes.  The server is required to pass DS information for &lt;domain:info&gt; responses.  The second is the "Key Data Interface," where the client is responsible for passing the key data information when performing adds and removes.  
      The server is responsible for passing key data information for &lt;domain:info&gt; responses.</t>
      <t>The server MUST support one form of interface within a single command or response, where &lt;secDNS:dsData&gt; and &lt;secDNS:keyData&gt; 
      MUST NOT be mixed, except for when &lt;secDNS:keyData&gt; is a child element of &lt;secDNS:dsData&gt; for server validation.  
      The server MUST support the use of only one form of interface across all &lt;secDNS:create&gt;, &lt;secDNS:update&gt;, and &lt;secDNS:infData&gt; elements, except during a transition period, during which the server MAY support both.  
      For instance, during a transition period, the server MAY support either the DS Data Interface or the Key Data Interface on a per&nbhy;domain basis and allow the client to migrate to the target interface.  
      The client can replace the interface used by utilizing the
&lt;secDNS:rem&gt;&lt;secDNS:all&gt;true&lt;/secDNS:all&gt;&lt;/secDNS:rem&gt;
element to remove all data of the old interface, and by utilizing the &lt;secDNS:add&gt; to add data using the new interface (&lt;secDNS:dsData&gt; for the DS Data Interface and &lt;secDNS:keyData&gt; for the Key Data Interface).  
      The server MUST return an EPP error result code of 2306 if the server receives a command using an unsupported interface.<vspace blankLines="0"/></t>
       
      <section title="DS Data Interface" anchor="dsDataInterface">
     <t>The DS Data Interface relies on the use of the &lt;secDNS:dsData&gt;
element for creates, adds, removes, and &lt;domain:info&gt; responses.  The key
data associated with the DS information MAY be provided by the client, but the
server is not obligated to use the key data.  The server operator MAY also
issue out-of-band DNS queries to retrieve the key data from the registered
domain's apex in order to evaluate the received DS information. It is
RECOMMENDED that the child zone operator have this key data online in the DNS
tree to allow the parent zone administrator to validate the data as necessary.
The key data SHOULD have the Secure Entry Point (SEP) bit set as described in
RFC 3757 <xref target="RFC3757"/> and RFC 4034 <xref target="RFC4034"/>.</t>  
<t>The &lt;secDNS:dsData&gt; element contains the following child elements:<vspace blankLines="0"/></t>
              <t><list style="hanging">
              <t hangText="-">A &lt;secDNS:keyTag&gt; element that contains a key tag value as
              described in Section 5.1.1 of RFC 4034 <xref target="RFC4034"/>.  The &lt;secDNS:keyTag&gt; element is represented as an unsignedShort <xref target="W3C.REC-xmlschema-2-20010502"/>.<vspace blankLines="0"/></t>

              <t hangText="-">A &lt;secDNS:alg&gt; element that contains an algorithm value as
              described in Section 5.1.2 of RFC 4034 <xref target="RFC4034"/>.
              <vspace blankLines="0"/></t>

              <t hangText="-">A &lt;secDNS:digestType&gt; element that contains a digest type
              value as described in Section 5.1.3 of RFC 4034 <xref target="RFC4034"/>.
              <vspace blankLines="0"/></t>

              <t hangText="-">A &lt;secDNS:digest&gt; element that contains a digest value as
              described in Section 5.1.4 of RFC 4034 <xref target="RFC4034"/>.
              The &lt;secDNS:digest&gt; element is represented as a hexBinary <xref target="W3C.REC-xmlschema-2-20010502"/>.<vspace blankLines="0"/></t>
              
              <t hangText="-">An OPTIONAL &lt;secDNS:keyData&gt; element that describes the key
              data used as input in the DS hash calculation for use in server validation.  The &lt;secDNS:keyData&gt;
              element contains the child elements defined in <xref target="keyDataInterface"/>.</t>
              </list></t>
      </section>
      
     
      <section title="Key Data Interface" anchor="keyDataInterface">
       <t>The Key Data Interface relies on the use of the
&lt;secDNS:keyData&gt; element for creates, adds, removes, and
&lt;domain:info&gt; responses.  The DS information is not provided by the
client but is generated by the server.  The attributes used for DS generation are based on server policy, where only key data is passed between the client and the server.</t>  
       <t>The &lt;secDNS:keyData&gt; element contains the following child elements:<vspace blankLines="0"/></t>
              <t><list style="hanging">
                <t hangText="-">A &lt;secDNS:flags&gt; element that contains a flags field value as
                described in Section 2.1.1 of RFC 4034 <xref target="RFC4034"/>.
                <vspace blankLines="0"/></t>

                <t hangText="-">A &lt;secDNS:protocol&gt; element that contains a protocol field
                value as described in Section 2.1.2 of RFC 4034 <xref target="RFC4034"/>.
                <vspace blankLines="0"/></t>

                <t hangText="-">A &lt;secDNS:alg&gt; element that contains an algorithm number
                field value as described in Section 2.1.3 of RFC 4034 <xref target="RFC4034"/>.
                <vspace blankLines="0"/></t>

                <t hangText="-">A &lt;secDNS:pubKey&gt; element that contains an encoded
                public key field value as described in Section 2.1.4 of RFC 4034
                <xref target="RFC4034"/>.  The &lt;secDNS:pubKey&gt; element is represented as a base64Binary <xref target="W3C.REC-xmlschema-2-20010502"/> with a minimum length of 1.<vspace blankLines="0"/></t>               
 
              </list></t>
      </section>
      
      <section title="Example DS Data Interface and Key Data Interface" anchor="exampleDsDataKeyDataInterface">
        
      <t>Example use of the secDNS-1.1 DS Data Interface for a create:<vspace blankLines="0"/></t>
<!--      <t> -->
<figure><artwork>
&lt;secDNS:dsData&gt;
  &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
  &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
  &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;    
  &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
&lt;/secDNS:dsData&gt;
      </artwork></figure>
<!-- </t> -->
      <t>Example use of secDNS-1.1 DS Data Interface with option key data for a
create:<vspace blankLines="0"/></t>

<!--      <t> -->
<figure><artwork>
&lt;secDNS:dsData&gt;
  &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
  &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
  &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
  &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
  &lt;secDNS:keyData&gt;
    &lt;secDNS:flags&gt;257&lt;/secDNS:flags&gt;
    &lt;secDNS:protocol&gt;3&lt;/secDNS:protocol&gt;
    &lt;secDNS:alg&gt;1&lt;/secDNS:alg&gt;
    &lt;secDNS:pubKey&gt;AQPJ////4Q==&lt;/secDNS:pubKey&gt;
  &lt;/secDNS:keyData&gt;      
 &lt;/secDNS:dsData&gt;
      </artwork></figure>
<!-- </t> -->
      <t>Example use of the secDNS-1.1 Key Data Interface for a create:<vspace blankLines="0"/></t>

<!--      <t> -->
<figure><artwork>
 &lt;secDNS:keyData&gt;
   &lt;secDNS:flags&gt;257&lt;/secDNS:flags&gt;
   &lt;secDNS:protocol&gt;3&lt;/secDNS:protocol&gt;
   &lt;secDNS:alg&gt;1&lt;/secDNS:alg&gt;
   &lt;secDNS:pubKey&gt;AQPJ////4Q==&lt;/secDNS:pubKey&gt;
 &lt;/secDNS:keyData&gt;      
      </artwork></figure>
<!-- </t> -->
   
      </section>
    </section>
 
    <section title="EPP Command Mapping" anchor="commands">
      <t>A detailed description of the EPP syntax and semantics can be found in
      the EPP core protocol specification <xref target="RFC5730"/>.
      The command mappings described here are specifically for use in
      provisioning and managing DNS security extensions via EPP.</t>

      <section title="EPP Query Commands" anchor="queries">
        <t>EPP provides three commands to retrieve object information:
        &lt;check&gt; to determine if an object is known to the server,
        &lt;info&gt; to retrieve detailed information associated with an
        object, and &lt;transfer&gt; to retrieve object transfer status
        information.</t>

        <section title="EPP &lt;check&gt; Command" anchor="check">
          <t>This extension does not add any elements to the EPP &lt;check&gt;
          command or &lt;check&gt; response described in the EPP domain mapping
          <xref target="RFC5731"/>.</t>
        </section>

        <section title="EPP &lt;info&gt; Command" anchor="info">
          <t>This extension does not add any elements to the EPP &lt;info&gt;
          command described in the EPP domain mapping <xref target="RFC5731"/>.
          However, additional elements are defined for the &lt;info&gt; response.</t>

          <t>When an &lt;info&gt; command has been processed successfully, the
          EPP &lt;resData&gt; element MUST contain child elements as described
          in the EPP domain mapping <xref target="RFC5731"/>.
          In addition, the EPP &lt;extension&gt; element SHOULD contain a child
          &lt;secDNS:infData&gt; element that identifies the extension namespace if the domain object has data associated with this extension and based on server policy.  The &lt;secDNS:infData&gt;
          element contains the following child elements:<vspace blankLines="0"/></t>

            <t><list style="hanging">
            <t hangText="-">An OPTIONAL &lt;secDNS:maxSigLife&gt; element that
              indicates a child's preference for the number of seconds
              after signature generation when the parent's signature
              on the DS information provided by the child will expire.  
maxSigLife is described in 
              <xref target="maxSigLife"/>.<vspace blankLines="0"/></t>
              
            <t hangText="-">One or more &lt;secDNS:dsData&gt; elements or &lt;secDNS:keyData&gt; elements, but not both, as defined in <xref target="dsDataKeyDatainterfaces"/>.  
            The &lt;secDNS:dsData&gt; elements describe the Delegation Signer (DS) data provided by the client for the domain.  
            The &lt;secDNS:keyData&gt; elements describe the key data provided by the client for the domain.  
            Child elements of the &lt;secDNS:dsData&gt; element are 
            described in <xref target="dsDataInterface"/>.  Child elements of
the &lt;secDNS:keyData&gt; element are 
            described in <xref target="keyDataInterface"/>.</t> 
            </list></t>
 
          <t>
          <figure>
              <artwork>Example &lt;info&gt; Response for a Secure Delegation
              Using the DS Data Interface:

S:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
S:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
S:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
S:  &lt;response&gt;
S:    &lt;result code="1000"&gt;
S:      &lt;msg&gt;Command completed successfully&lt;/msg&gt;
S:    &lt;/result&gt;
S:    &lt;resData&gt;
S:      &lt;domain:infData
S:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
S:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
S:        &lt;domain:roid&gt;EXAMPLE1-REP&lt;/domain:roid&gt;
S:        &lt;domain:status s="ok"/&gt;
S:        &lt;domain:registrant&gt;jd1234&lt;/domain:registrant&gt;
S:        &lt;domain:contact type="admin"&gt;sh8013&lt;/domain:contact&gt;
S:        &lt;domain:contact type="tech"&gt;sh8013&lt;/domain:contact&gt;
S:        &lt;domain:ns&gt;
S:          &lt;domain:hostObj&gt;ns1.example.com&lt;/domain:hostObj&gt;
S:          &lt;domain:hostObj&gt;ns2.example.com&lt;/domain:hostObj&gt;
S:        &lt;/domain:ns&gt;
S:        &lt;domain:host&gt;ns1.example.com&lt;/domain:host&gt;
S:        &lt;domain:host&gt;ns2.example.com&lt;/domain:host&gt;
S:        &lt;domain:clID&gt;ClientX&lt;/domain:clID&gt;
S:        &lt;domain:crID&gt;ClientY&lt;/domain:crID&gt;
S:        &lt;domain:crDate&gt;1999-04-03T22:00:00.0Z&lt;/domain:crDate&gt;
S:        &lt;domain:upID&gt;ClientX&lt;/domain:upID&gt;
S:        &lt;domain:upDate&gt;1999-12-03T09:00:00.0Z&lt;/domain:upDate&gt;
S:        &lt;domain:exDate&gt;2005-04-03T22:00:00.0Z&lt;/domain:exDate&gt;
S:        &lt;domain:trDate&gt;2000-04-08T09:00:00.0Z&lt;/domain:trDate&gt;
S:        &lt;domain:authInfo&gt;
S:          &lt;domain:pw&gt;2fooBAR&lt;/domain:pw&gt;
S:        &lt;/domain:authInfo&gt;
S:      &lt;/domain:infData&gt;
S:    &lt;/resData&gt;
S:    &lt;extension&gt;
S:      &lt;secDNS:infData
S:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1"&gt;
S:        &lt;secDNS:dsData&gt;
S:          &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
S:          &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
S:          &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
S:          &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
S:        &lt;/secDNS:dsData&gt;
S:      &lt;/secDNS:infData&gt;
S:    &lt;/extension&gt;
S:    &lt;trID&gt;
S:      &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
S:      &lt;svTRID&gt;54322-XYZ&lt;/svTRID&gt;
S:    &lt;/trID&gt;
S:  &lt;/response&gt;
S:&lt;/epp&gt;</artwork>
          </figure>
          </t>

          <t>
            <figure>
              <artwork>Example &lt;info&gt; Response for a Secure Delegation
              Using the DS Data Interface with OPTIONAL Key Data:

S:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
S:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
S:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
S:  &lt;response&gt;
S:    &lt;result code="1000"&gt;
S:      &lt;msg&gt;Command completed successfully&lt;/msg&gt;
S:    &lt;/result&gt;
S:    &lt;resData&gt;
S:      &lt;domain:infData
S:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
S:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
S:        &lt;domain:roid&gt;EXAMPLE1-REP&lt;/domain:roid&gt;
S:        &lt;domain:status s="ok"/&gt;
S:        &lt;domain:registrant&gt;jd1234&lt;/domain:registrant&gt;
S:        &lt;domain:contact type="admin"&gt;sh8013&lt;/domain:contact&gt;
S:        &lt;domain:contact type="tech"&gt;sh8013&lt;/domain:contact&gt;
S:        &lt;domain:ns&gt;
S:          &lt;domain:hostObj&gt;ns1.example.com&lt;/domain:hostObj&gt;
S:          &lt;domain:hostObj&gt;ns2.example.com&lt;/domain:hostObj&gt;
S:        &lt;/domain:ns&gt;
S:        &lt;domain:host&gt;ns1.example.com&lt;/domain:host&gt;
S:        &lt;domain:host&gt;ns2.example.com&lt;/domain:host&gt;
S:        &lt;domain:clID&gt;ClientX&lt;/domain:clID&gt;
S:        &lt;domain:crID&gt;ClientY&lt;/domain:crID&gt;
S:        &lt;domain:crDate&gt;1999-04-03T22:00:00.0Z&lt;/domain:crDate&gt;
S:        &lt;domain:upID&gt;ClientX&lt;/domain:upID&gt;
S:        &lt;domain:upDate&gt;1999-12-03T09:00:00.0Z&lt;/domain:upDate&gt;
S:        &lt;domain:exDate&gt;2005-04-03T22:00:00.0Z&lt;/domain:exDate&gt;
S:        &lt;domain:trDate&gt;2000-04-08T09:00:00.0Z&lt;/domain:trDate&gt;
S:        &lt;domain:authInfo&gt;
S:          &lt;domain:pw&gt;2fooBAR&lt;/domain:pw&gt;
S:        &lt;/domain:authInfo&gt;
S:      &lt;/domain:infData&gt;
S:    &lt;/resData&gt;
S:    &lt;extension&gt;
S:      &lt;secDNS:infData
S:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1"&gt;
S:        &lt;secDNS:maxSigLife&gt;604800&lt;/secDNS:maxSigLife&gt;
S:        &lt;secDNS:dsData&gt;
S:          &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
S:          &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
S:          &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
S:          &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
S:          &lt;secDNS:keyData&gt;
S:            &lt;secDNS:flags&gt;257&lt;/secDNS:flags&gt;
S:            &lt;secDNS:protocol&gt;3&lt;/secDNS:protocol&gt;
S:            &lt;secDNS:alg&gt;1&lt;/secDNS:alg&gt;
S:            &lt;secDNS:pubKey&gt;AQPJ////4Q==&lt;/secDNS:pubKey&gt;
S:          &lt;/secDNS:keyData&gt;
S:        &lt;/secDNS:dsData&gt;
S:      &lt;/secDNS:infData&gt;
S:    &lt;/extension&gt;
S:    &lt;trID&gt;
S:      &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
S:      &lt;svTRID&gt;54322-XYZ&lt;/svTRID&gt;
S:    &lt;/trID&gt;
S:  &lt;/response&gt;
S:&lt;/epp&gt;</artwork>
            </figure>
          </t>

          <t>
            <figure>
              <artwork>Example &lt;info&gt; Response for a Secure Delegation
              Using the Key Data Interface:

S:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
S:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
S:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
S:  &lt;response&gt;
S:    &lt;result code="1000"&gt;
S:      &lt;msg&gt;Command completed successfully&lt;/msg&gt;
S:    &lt;/result&gt;
S:    &lt;resData&gt;
S:      &lt;domain:infData
S:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
S:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
S:        &lt;domain:roid&gt;EXAMPLE1-REP&lt;/domain:roid&gt;
S:        &lt;domain:status s="ok"/&gt;
S:        &lt;domain:registrant&gt;jd1234&lt;/domain:registrant&gt;
S:        &lt;domain:contact type="admin"&gt;sh8013&lt;/domain:contact&gt;
S:        &lt;domain:contact type="tech"&gt;sh8013&lt;/domain:contact&gt;
S:        &lt;domain:ns&gt;
S:          &lt;domain:hostObj&gt;ns1.example.com&lt;/domain:hostObj&gt;
S:          &lt;domain:hostObj&gt;ns2.example.com&lt;/domain:hostObj&gt;
S:        &lt;/domain:ns&gt;
S:        &lt;domain:host&gt;ns1.example.com&lt;/domain:host&gt;
S:        &lt;domain:host&gt;ns2.example.com&lt;/domain:host&gt;
S:        &lt;domain:clID&gt;ClientX&lt;/domain:clID&gt;
S:        &lt;domain:crID&gt;ClientY&lt;/domain:crID&gt;
S:        &lt;domain:crDate&gt;1999-04-03T22:00:00.0Z&lt;/domain:crDate&gt;
S:        &lt;domain:upID&gt;ClientX&lt;/domain:upID&gt;
S:        &lt;domain:upDate&gt;1999-12-03T09:00:00.0Z&lt;/domain:upDate&gt;
S:        &lt;domain:exDate&gt;2005-04-03T22:00:00.0Z&lt;/domain:exDate&gt;
S:        &lt;domain:trDate&gt;2000-04-08T09:00:00.0Z&lt;/domain:trDate&gt;
S:        &lt;domain:authInfo&gt;
S:          &lt;domain:pw&gt;2fooBAR&lt;/domain:pw&gt;
S:        &lt;/domain:authInfo&gt;
S:      &lt;/domain:infData&gt;
S:    &lt;/resData&gt;
S:    &lt;extension&gt;
S:      &lt;secDNS:infData
S:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1"&gt;
S:        &lt;secDNS:keyData&gt;
S:          &lt;secDNS:flags&gt;257&lt;/secDNS:flags&gt;
S:          &lt;secDNS:protocol&gt;3&lt;/secDNS:protocol&gt;
S:          &lt;secDNS:alg&gt;1&lt;/secDNS:alg&gt;
S:          &lt;secDNS:pubKey&gt;AQPJ////4Q==&lt;/secDNS:pubKey&gt;
S:        &lt;/secDNS:keyData&gt;
S:      &lt;/secDNS:infData&gt;
S:    &lt;/extension&gt;
S:    &lt;trID&gt;
S:      &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
S:      &lt;svTRID&gt;54322-XYZ&lt;/svTRID&gt;
S:    &lt;/trID&gt;
S:  &lt;/response&gt;
S:&lt;/epp&gt;</artwork>
            </figure>
          </t>


          <t>An EPP error response MUST be returned if an &lt;info&gt; command
          cannot be processed for any reason.</t>
        </section>

        <section title="EPP &lt;transfer&gt; Command" anchor="transferQ">
          <t>This extension does not add any elements to the EPP &lt;transfer&gt;
          command or &lt;transfer&gt; response described in the EPP domain mapping
          <xref target="RFC5731"/>.</t>
        </section>
      </section>

      <section title="EPP Transform Commands" anchor="transforms">
        <t>EPP provides five commands to transform objects: &lt;create&gt; to create
        an instance of an object, &lt;delete&gt; to delete an instance of an object,
        &lt;renew&gt; to extend the validity period of an object, &lt;transfer&gt; to
        manage object sponsorship changes, and &lt;update&gt; to change information
        associated with an object.</t>

        <section title="EPP &lt;create&gt; Command" anchor="create">
          <t>This extension defines additional elements for the EPP &lt;create&gt;
          command described in the EPP domain mapping <xref target="RFC5731"/>.
          No additional elements are defined for the EPP &lt;create&gt; response.</t>

          <t>The EPP &lt;create&gt; command provides a transform operation that allows
          a client to create a domain object.  In addition to the EPP
          command elements described in the EPP domain mapping <xref target="RFC5731"/>,
          the command MUST contain an &lt;extension&gt; element, and the &lt;extension&gt; element
          MUST contain a child &lt;secDNS:create&gt; element that identifies
          the extension namespace if the client wants to associate data defined in this extension to the domain object.  
          The &lt;secDNS:create&gt;
          element contains the following child elements:<vspace blankLines="0"/></t>
          
          <t><list style="hanging">
            <t hangText="-">An OPTIONAL &lt;secDNS:maxSigLife&gt; element that
              indicates a child's preference for the number of seconds
              after signature generation when the parent's signature
              on the DS information provided by the child will expire.  maxSigLife is described in 
              <xref target="maxSigLife"/>.  If the server does not support the &lt;secDNS:maxSigLife&gt; element, a 2102 error MUST be returned.
            <vspace blankLines="0"/></t>
          <t hangText="-">Zero or more &lt;secDNS:dsData&gt; elements or &lt;secDNS:keyData&gt; elements, but not both, as defined in <xref target="dsDataKeyDatainterfaces"/>.  
          Child elements of the &lt;secDNS:dsData&gt; element are described in <xref target="dsDataInterface"/>.  
          Child elements of the &lt;secDNS:keyData&gt; element are described in <xref target="keyDataInterface"/>.
          </t>
          </list></t>
           <t>
            <figure>
              <artwork>Example &lt;create&gt; Command for a Secure Delegation
              Using the DS Data Interface:

C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
C:  &lt;command&gt;
C:    &lt;create&gt;
C:      &lt;domain:create
C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
C:        &lt;domain:period unit="y"&gt;2&lt;/domain:period&gt;
C:        &lt;domain:ns&gt;
C:          &lt;domain:hostObj&gt;ns1.example.com&lt;/domain:hostObj&gt;
C:          &lt;domain:hostObj&gt;ns2.example.com&lt;/domain:hostObj&gt;
C:        &lt;/domain:ns&gt;
C:        &lt;domain:registrant&gt;jd1234&lt;/domain:registrant&gt;
C:        &lt;domain:contact type="admin"&gt;sh8013&lt;/domain:contact&gt;
C:        &lt;domain:contact type="tech"&gt;sh8013&lt;/domain:contact&gt;
C:        &lt;domain:authInfo&gt;
C:          &lt;domain:pw&gt;2fooBAR&lt;/domain:pw&gt;
C:        &lt;/domain:authInfo&gt;
C:      &lt;/domain:create&gt;
C:    &lt;/create&gt;
C:    &lt;extension&gt;
C:      &lt;secDNS:create
C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1"&gt;
C:        &lt;secDNS:maxSigLife&gt;604800&lt;/secDNS:maxSigLife&gt;
C:        &lt;secDNS:dsData&gt;
C:          &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
C:          &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
C:          &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
C:          &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
C:        &lt;/secDNS:dsData&gt;
C:      &lt;/secDNS:create&gt;
C:    &lt;/extension&gt;
C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
C:  &lt;/command&gt;
C:&lt;/epp&gt;</artwork>
            </figure>
          </t>

          <t>
            <figure>
              <artwork>Example &lt;create&gt; Command for a Secure Delegation
              Using the DS Data Interface with OPTIONAL Key Data:

C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
C:  &lt;command&gt;
C:    &lt;create&gt;
C:      &lt;domain:create
C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
C:        &lt;domain:period unit="y"&gt;2&lt;/domain:period&gt;
C:        &lt;domain:ns&gt;
C:          &lt;domain:hostObj&gt;ns1.example.com&lt;/domain:hostObj&gt;
C:          &lt;domain:hostObj&gt;ns2.example.com&lt;/domain:hostObj&gt;
C:        &lt;/domain:ns&gt;
C:        &lt;domain:registrant&gt;jd1234&lt;/domain:registrant&gt;
C:        &lt;domain:contact type="admin"&gt;sh8013&lt;/domain:contact&gt;
C:        &lt;domain:contact type="tech"&gt;sh8013&lt;/domain:contact&gt;
C:        &lt;domain:authInfo&gt;
C:          &lt;domain:pw&gt;2fooBAR&lt;/domain:pw&gt;
C:        &lt;/domain:authInfo&gt;
C:      &lt;/domain:create&gt;
C:    &lt;/create&gt;
C:    &lt;extension&gt;
C:      &lt;secDNS:create
C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1"&gt;
C:        &lt;secDNS:maxSigLife&gt;604800&lt;/secDNS:maxSigLife&gt;
C:        &lt;secDNS:dsData&gt;
C:          &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
C:          &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
C:          &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
C:          &lt;secDNS:digest&gt;49FD46E6C4B45C55D4AC&lt;/secDNS:digest&gt;
C:          &lt;secDNS:keyData&gt;
C:            &lt;secDNS:flags&gt;257&lt;/secDNS:flags&gt;
C:            &lt;secDNS:protocol&gt;3&lt;/secDNS:protocol&gt;
C:            &lt;secDNS:alg&gt;1&lt;/secDNS:alg&gt;
C:            &lt;secDNS:pubKey&gt;AQPJ////4Q==&lt;/secDNS:pubKey&gt;
C:          &lt;/secDNS:keyData&gt;
C:        &lt;/secDNS:dsData&gt;
C:      &lt;/secDNS:create&gt;
C:    &lt;/extension&gt;
C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
C:  &lt;/command&gt;
C:&lt;/epp&gt;</artwork>
            </figure>
          </t>

          <t>
            <figure>
              <artwork>Example &lt;create&gt; Command for a Secure Delegation
              Using the Key Data Interface:

C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
C:  &lt;command&gt;
C:    &lt;create&gt;
C:      &lt;domain:create
C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
C:        &lt;domain:period unit="y"&gt;2&lt;/domain:period&gt;
C:        &lt;domain:ns&gt;
C:          &lt;domain:hostObj&gt;ns1.example.com&lt;/domain:hostObj&gt;
C:          &lt;domain:hostObj&gt;ns2.example.com&lt;/domain:hostObj&gt;
C:        &lt;/domain:ns&gt;
C:        &lt;domain:registrant&gt;jd1234&lt;/domain:registrant&gt;
C:        &lt;domain:contact type="admin"&gt;sh8013&lt;/domain:contact&gt;
C:        &lt;domain:contact type="tech"&gt;sh8013&lt;/domain:contact&gt;
C:        &lt;domain:authInfo&gt;
C:          &lt;domain:pw&gt;2fooBAR&lt;/domain:pw&gt;
C:        &lt;/domain:authInfo&gt;
C:      &lt;/domain:create&gt;
C:    &lt;/create&gt;
C:    &lt;extension&gt;
C:      &lt;secDNS:create
C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1"&gt;
C:        &lt;secDNS:keyData&gt;
C:          &lt;secDNS:flags&gt;257&lt;/secDNS:flags&gt;
C:          &lt;secDNS:protocol&gt;3&lt;/secDNS:protocol&gt;
C:          &lt;secDNS:alg&gt;1&lt;/secDNS:alg&gt;
C:          &lt;secDNS:pubKey&gt;AQPJ////4Q==&lt;/secDNS:pubKey&gt;
C:        &lt;/secDNS:keyData&gt;
C:      &lt;/secDNS:create&gt;
C:    &lt;/extension&gt;
C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
C:  &lt;/command&gt;
C:&lt;/epp&gt;</artwork>
            </figure>
          </t>

          <t>When a &lt;create&gt; command has been processed successfully, the EPP
          response is as described in the EPP domain mapping <xref target="RFC5731"/>.</t>
        </section>

        <section title="EPP &lt;delete&gt; Command" anchor="delete">
          <t>This extension does not add any elements to the EPP &lt;delete&gt;
          command or &lt;delete&gt; response described in the EPP domain mapping
          <xref target="RFC5731"/>.</t>
        </section>

        <section title="EPP &lt;renew&gt; Command" anchor="renew">
          <t>This extension does not add any elements to the EPP &lt;renew&gt;
          command or &lt;renew&gt; response described in the EPP domain mapping
          <xref target="RFC5731"/>.</t>
        </section>

        <section title="EPP &lt;transfer&gt; Command" anchor="transferT">
          <t>This extension does not add any elements to the EPP &lt;transfer&gt;
          command or &lt;transfer&gt; response described in the EPP domain mapping
          <xref target="RFC5731"/>.</t>
        </section>

        <section title="EPP &lt;update&gt; Command" anchor="update">
          <t>This extension defines additional elements for the EPP &lt;update&gt;
          command described in the EPP domain mapping <xref target="RFC5731"/>.
          No additional elements are defined for the EPP &lt;update&gt; response.</t>

          <t>The EPP &lt;update&gt; command provides a transform operation that
          allows a client to modify the attributes of a domain object.  In
          addition to the EPP command elements described in the EPP domain
          mapping, the command MUST contain an &lt;extension&gt; element, and the &lt;extension&gt; element
          MUST contain a child &lt;secDNS:update&gt; element that identifies
          the extension namespace if the client wants to update the domain object with data defined in this extension.  
          The &lt;secDNS:update&gt; element contains a
          &lt;secDNS:add&gt; element to add security information to a delegation,
          a &lt;secDNS:rem&gt; element to remove security information from a
          delegation, or a &lt;secDNS:chg&gt; element to change existing security
          information.  
          At least one &lt;secDNS:add&gt;, &lt;secDNS:rem&gt;, or &lt;secDNS:chg&gt; element
          MUST be provided.  The order of the &lt;secDNS:rem&gt; and &lt;secDNS:add&gt; elements
          is significant, where the server MUST first remove the existing elements prior to 
          adding the new elements.</t>  

          <t>The &lt;secDNS:update&gt; element also contains an OPTIONAL
          "urgent" attribute that a client can use to ask the server
          operator to complete and implement the update request with high priority.
          This attribute accepts boolean values as described in <xref target="booleans"/>;
          the default value is boolean false.  "High priority" is relative to
          standard server operator policies that are determined using an
          out-of-band mechanism.  A server MUST return an EPP error result code of 2102 
          if the "urgent" attribute is specified with a value of boolean true and the server does not support it.  A 
          server MUST return an EPP error result code of 2306 if the server supports the 
          "urgent" attribute and an urgent update 
          (noted with an "urgent" attribute value of boolean true) cannot be completed 
          with high priority.</t>  
 
           
          <t>The &lt;secDNS:update&gt;
          element contains the following child elements:<vspace blankLines="0"/></t>
          <t><list style="hanging">
         <t hangText="-">An OPTIONAL &lt;secDNS:rem&gt; element that contains a &lt;secDNS:all&gt; element, or one or more &lt;secDNS:dsData&gt; or &lt;secDNS:keyData&gt; 
          elements that are used to remove security data from a delegation.<vspace blankLines="0"/></t>
          <t>The &lt;secDNS:all&gt; element is used to remove all DS and key data with a value of boolean true. A value of boolean false will do nothing.  
          Removing all DS information can remove the ability of the parent to secure the delegation to the child zone.<vspace blankLines="0"/></t>          

          <t>The &lt;secDNS:dsData&gt; element is part of the DS Data Interface
and is used to uniquely define the DS record to be removed, by using all 
          four elements -- &lt;secDNS:keyTag&gt;, &lt;secDNS:alg&gt;,
&lt;secDNS:digestType&gt;, and &lt;secDNS:digest&gt; -- that are 
          guaranteed to be unique.<vspace blankLines="0"/></t>
          <t>The &lt;secDNS:keyData&gt; element is part of the Key Data
Interface and is used to uniquely define the key data to be removed, by using 
          all four elements -- &lt;secDNS:flags&gt;, &lt;secDNS:protocol&gt;,
&lt;secDNS:alg&gt;, and &lt;secDNS:pubKey&gt; -- that are 
          guaranteed to be unique.  There can be more than one DS record created for each key, so removing a key could 
          remove more than one DS record.<vspace blankLines="0"/></t>
          
           <t hangText="-">An OPTIONAL &lt;secDNS:add&gt; element that is used to add security information
          to an existing set.  The &lt;secDNS:add&gt; element MUST contain
          one or more &lt;secDNS:dsData&gt; or &lt;secDNS:keyData&gt; elements.
Child elements of the &lt;secDNS:dsData&gt; element are described in <xref
target="dsDataInterface"/>.  Child elements of the &lt;secDNS:keyData&gt;
element are described in <xref target="keyDataInterface"/>.<vspace blankLines="0"/></t>

          <t hangText ="-">An OPTIONAL &lt;secDNS:chg&gt; element that contains security information to be changed.  A &lt;secDNS:chg&gt; element contains the following child elements:<vspace blankLines="0"/></t>
<list style="hanging">
            <t hangText="-">An OPTIONAL &lt;secDNS:maxSigLife&gt; element that
              indicates a child's preference for the number of seconds
              after signature generation when the parent's signature
              on the DS information provided by the child will expire.  maxSigLife is described in 
              <xref target="maxSigLife"/>.  If the server does not support the &lt;secDNS:maxSigLife&gt; element, a 2102 error MUST be returned.
            <vspace blankLines="0"/></t>
        	</list>
<!-- </t> -->
          </list></t>
          <t>
            <figure>
              <artwork>Example &lt;update&gt; Command, Adding and Removing DS
              Data Using the DS Data Interface:

C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
C:  &lt;command&gt;
C:    &lt;update&gt;
C:      &lt;domain:update
C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
C:      &lt;/domain:update&gt;
C:    &lt;/update&gt;
C:    &lt;extension&gt;
C:      &lt;secDNS:update
C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1"&gt;
C:        &lt;secDNS:rem&gt;
C:          &lt;secDNS:dsData&gt;
C:            &lt;secDNS:keyTag&gt;12345&lt;/secDNS:keyTag&gt;
C:            &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
C:            &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
C:            &lt;secDNS:digest&gt;38EC35D5B3A34B33C99B&lt;/secDNS:digest&gt;
C:          &lt;/secDNS:dsData&gt;
C:        &lt;/secDNS:rem&gt;
C:        &lt;secDNS:add&gt;
C:          &lt;secDNS:dsData&gt;
C:            &lt;secDNS:keyTag&gt;12346&lt;/secDNS:keyTag&gt;
C:            &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
C:            &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
C:            &lt;secDNS:digest&gt;38EC35D5B3A34B44C39B&lt;/secDNS:digest&gt;
C:          &lt;/secDNS:dsData&gt;
C:        &lt;/secDNS:add&gt;
C:      &lt;/secDNS:update&gt;
C:    &lt;/extension&gt;
C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
C:  &lt;/command&gt;
C:&lt;/epp&gt;</artwork>
            </figure>
          </t>

          <t>
            <figure>
              <artwork>Example &lt;update&gt; Command, 
              Updating the maxSigLife:

C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
C:  &lt;command&gt;
C:    &lt;update&gt;
C:      &lt;domain:update
C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
C:      &lt;/domain:update&gt;
C:    &lt;/update&gt;
C:    &lt;extension&gt;
C:      &lt;secDNS:update
C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1"&gt;
C:        &lt;secDNS:chg&gt;
C:          &lt;secDNS:maxSigLife&gt;605900&lt;/secDNS:maxSigLife&gt;
C:        &lt;/secDNS:chg&gt;
C:      &lt;/secDNS:update&gt;
C:    &lt;/extension&gt;
C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
C:  &lt;/command&gt;
C:&lt;/epp&gt;</artwork>
            </figure>
          </t>

          <t>
            <figure>
              <artwork>Example &lt;update&gt; Command, Adding and 
              Removing Key Data Using the Key Data Interface, and 
              Setting maxSigLife:

C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
C:  &lt;command&gt;
C:    &lt;update&gt;
C:      &lt;domain:update
C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
C:      &lt;/domain:update&gt;
C:    &lt;/update&gt;
C:    &lt;extension&gt;
C:      &lt;secDNS:update
C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1"&gt;
C:        &lt;secDNS:rem&gt;
C:          &lt;secDNS:keyData&gt;
C:            &lt;secDNS:flags&gt;257&lt;/secDNS:flags&gt;
C:            &lt;secDNS:protocol&gt;3&lt;/secDNS:protocol&gt;
C:            &lt;secDNS:alg&gt;1&lt;/secDNS:alg&gt;
C:            &lt;secDNS:pubKey&gt;AQPJ////4QQQ&lt;/secDNS:pubKey&gt;
C:          &lt;/secDNS:keyData&gt;
C:        &lt;/secDNS:rem&gt;
C:        &lt;secDNS:add&gt;
C:          &lt;secDNS:keyData&gt;
C:            &lt;secDNS:flags&gt;257&lt;/secDNS:flags&gt;
C:            &lt;secDNS:protocol&gt;3&lt;/secDNS:protocol&gt;
C:            &lt;secDNS:alg&gt;1&lt;/secDNS:alg&gt;
C:            &lt;secDNS:pubKey&gt;AQPJ////4Q==&lt;/secDNS:pubKey&gt;
C:          &lt;/secDNS:keyData&gt;
C:        &lt;/secDNS:add&gt;
C:        &lt;secDNS:chg&gt;
C:          &lt;secDNS:maxSigLife&gt;605900&lt;/secDNS:maxSigLife&gt;
C:        &lt;/secDNS:chg&gt;
C:      &lt;/secDNS:update&gt;
C:    &lt;/extension&gt;
C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
C:  &lt;/command&gt;
C:&lt;/epp&gt;</artwork>
            </figure>
          </t>

          <t>
            <figure>
              <artwork>Example &lt;update&gt; Command, Removing DS Data with
               &lt;secDNS:dsData&gt; Using the DS Data Interface:

C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
C:  &lt;command&gt;
C:    &lt;update&gt;
C:      &lt;domain:update
C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
C:      &lt;/domain:update&gt;
C:    &lt;/update&gt;
C:    &lt;extension&gt;
C:      &lt;secDNS:update
C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1"&gt;
C:        &lt;secDNS:rem&gt;
C:          &lt;secDNS:dsData&gt;
C:            &lt;secDNS:keyTag&gt;12346&lt;/secDNS:keyTag&gt;
C:            &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
C:            &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
C:            &lt;secDNS:digest&gt;38EC35D5B3A34B44C39B&lt;/secDNS:digest&gt;
C:          &lt;/secDNS:dsData&gt;
C:        &lt;/secDNS:rem&gt;
C:      &lt;/secDNS:update&gt;
C:    &lt;/extension&gt;
C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
C:  &lt;/command&gt;
C:&lt;/epp&gt;</artwork>
            </figure>
          </t>

 
          <t>
            <figure>
              <artwork>Example &lt;update&gt; Command, 
              Removing all DS and Key Data Using &lt;secDNS:rem&gt;
              with &lt;secDNS:all&gt;:

C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
C:  &lt;command&gt;
C:    &lt;update&gt;
C:      &lt;domain:update
C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
C:      &lt;/domain:update&gt;
C:    &lt;/update&gt;
C:    &lt;extension&gt;
C:      &lt;secDNS:update urgent="true"
C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.0"&gt;
C:        &lt;secDNS:rem&gt;
C:          &lt;secDNS:all&gt;true&lt;/secDNS:all&gt;  
C:        &lt;/secDNS:rem&gt;
C:      &lt;/secDNS:update&gt;
C:    &lt;/extension&gt;
C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
C:  &lt;/command&gt;
C:&lt;/epp&gt;</artwork>
            </figure>
          </t>


          <t>
            <figure>
              <artwork>Example Urgent &lt;update&gt; Command, 
              Replacing all DS Data Using the DS Data Interface:

C:&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;
C:&lt;epp xmlns="urn:ietf:params:xml:ns:epp-1.0"
C:     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
C:  &lt;command&gt;
C:    &lt;update&gt;
C:      &lt;domain:update
C:       xmlns:domain="urn:ietf:params:xml:ns:domain-1.0"&gt;
C:        &lt;domain:name&gt;example.com&lt;/domain:name&gt;
C:      &lt;/domain:update&gt;
C:    &lt;/update&gt;
C:    &lt;extension&gt;
C:      &lt;secDNS:update urgent="true"
C:       xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1"&gt;
C:        &lt;secDNS:rem&gt;
C:          &lt;secDNS:all&gt;true&lt;/secDNS:all&gt;  
C:        &lt;/secDNS:rem&gt;
C:        &lt;secDNS:add&gt;
C:          &lt;secDNS:dsData&gt;
C:            &lt;secDNS:keyTag&gt;12346&lt;/secDNS:keyTag&gt;
C:            &lt;secDNS:alg&gt;3&lt;/secDNS:alg&gt;
C:            &lt;secDNS:digestType&gt;1&lt;/secDNS:digestType&gt;
C:            &lt;secDNS:digest&gt;38EC35D5B3A34B44C39B&lt;/secDNS:digest&gt;
C:          &lt;/secDNS:dsData&gt;
C:        &lt;/secDNS:add&gt;
C:      &lt;/secDNS:update&gt;
C:    &lt;/extension&gt;
C:    &lt;clTRID&gt;ABC-12345&lt;/clTRID&gt;
C:  &lt;/command&gt;
C:&lt;/epp&gt;</artwork>
            </figure>
          </t>


          <t>When an extended &lt;update&gt; command has been processed
          successfully, the EPP response is as described in the EPP domain
          mapping <xref target="RFC5731"/>.</t>
        </section>
      </section>
    </section>

    <section title="Formal Syntax" anchor="syntax">
      <t>An EPP object mapping is specified in XML Schema notation.  The
      formal syntax presented here is a complete schema representation of
      the object mapping suitable for automated validation of EPP XML
      instances.  The BEGIN and END tags are not part of the schema; they
      are used to note the beginning and ending of the schema for URI
      registration purposes.</t>
      
<t>Copyright (c) 2010 IETF Trust and the persons identified as
authors of the code. All rights reserved.</t>

<t>Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are
met:

<list style="hanging">
<t hangText="-">Redistributions of source code must retain the above copyright
notice, this list of conditions and the following disclaimer.</t>

<t hangText="-">Redistributions in binary form must reproduce the above copyright
notice, this list of conditions and the following disclaimer in the 
documentation and/or other materials provided with the distribution.</t>

<t hangText="-">Neither the name of Internet Society, IETF or IETF Trust, nor the
names of specific contributors, may be used to endorse or promote
products derived from this software without specific prior written 
permission.</t>
</list></t>

<t>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</t>

<!--       <t> -->
        <figure>
          <artwork>
BEGIN
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;schema 
  targetNamespace="urn:ietf:params:xml:ns:secDNS-1.1" 
  xmlns:secDNS="urn:ietf:params:xml:ns:secDNS-1.1" 
  xmlns="http://www.w3.org/2001/XMLSchema" 
  elementFormDefault="qualified"&gt;
  
  &lt;annotation&gt;
    &lt;documentation&gt; 
      Extensible Provisioning Protocol v1.0 
      domain name extension schema 
      for provisioning DNS security (DNSSEC) extensions.
    &lt;/documentation&gt;
  &lt;/annotation&gt;
  
  &lt;!-- 
  Child elements found in EPP commands.  
  --&gt;
  &lt;element name="create" type="secDNS:dsOrKeyType"/&gt;
  &lt;element name="update" type="secDNS:updateType"/&gt;
  
  &lt;!-- 
  Child elements supporting either the 
  dsData or the keyData interface.  
  --&gt;
  &lt;complexType name="dsOrKeyType"&gt;
    &lt;sequence&gt;
      &lt;element name="maxSigLife" type="secDNS:maxSigLifeType" 
      minOccurs="0"/&gt;
      &lt;choice&gt;
        &lt;element name="dsData" type="secDNS:dsDataType" 
        maxOccurs="unbounded"/&gt;
        &lt;element name="keyData" type="secDNS:keyDataType" 
        maxOccurs="unbounded"/&gt;
      &lt;/choice&gt;
        &lt;/sequence&gt;
  &lt;/complexType&gt;
  
  &lt;!-- 
  Definition for the maximum signature lifetime (maxSigLife) 
  --&gt;
  &lt;simpleType name="maxSigLifeType"&gt;
    &lt;restriction base="int"&gt;
      &lt;minInclusive value="1"/&gt;
    &lt;/restriction&gt;
  &lt;/simpleType&gt;

  &lt;!-- 
  Child elements of dsData used for dsData interface 
  --&gt;
  &lt;complexType name="dsDataType"&gt;
    &lt;sequence&gt;
      &lt;element name="keyTag" type="unsignedShort"/&gt;
      &lt;element name="alg" type="unsignedByte"/&gt;
      &lt;element name="digestType" type="unsignedByte"/&gt;
      &lt;element name="digest" type="hexBinary"/&gt;
      &lt;element name="keyData" type="secDNS:keyDataType" 
      minOccurs="0"/&gt;
    &lt;/sequence&gt;
  &lt;/complexType&gt;
  
  &lt;!-- 
  Child elements of keyData used for keyData interface 
  and optionally with dsData interface 
  --&gt;
  &lt;complexType name="keyDataType"&gt;
    &lt;sequence&gt;
      &lt;element name="flags" type="unsignedShort"/&gt;
      &lt;element name="protocol" type="unsignedByte"/&gt;
      &lt;element name="alg" type="unsignedByte"/&gt;
      &lt;element name="pubKey" type="secDNS:keyType"/&gt;
    &lt;/sequence&gt;
  &lt;/complexType&gt;
  
  &lt;!-- 
  Definition for the public key   
  --&gt;
  &lt;simpleType name="keyType"&gt;
    &lt;restriction base="base64Binary"&gt;
      &lt;minLength value="1"/&gt;
    &lt;/restriction&gt;
  &lt;/simpleType&gt;
  
  &lt;!-- 
  Child elements of the &lt;update&gt; element.  
  --&gt;
  &lt;complexType name="updateType"&gt;
    &lt;sequence&gt;
          &lt;element name="rem" type="secDNS:remType" 
          minOccurs="0"/&gt;
          &lt;element name="add" type="secDNS:dsOrKeyType" 
          minOccurs="0"/&gt;
          &lt;element name="chg" type="secDNS:chgType" 
          minOccurs="0"/&gt;
        &lt;/sequence&gt;
    &lt;attribute name="urgent" type="boolean" default="false"/&gt;
  &lt;/complexType&gt;
  
  &lt;!-- 
  Child elements of the &lt;rem&gt; command.  
  --&gt;
  &lt;complexType name="remType"&gt;
        &lt;choice&gt;
          &lt;element name="all" type="boolean"/&gt;
          &lt;element name="dsData" type="secDNS:dsDataType" 
          maxOccurs="unbounded"/&gt;
          &lt;element name="keyData" type="secDNS:keyDataType" 
          maxOccurs="unbounded"/&gt;
        &lt;/choice&gt;
  &lt;/complexType&gt;
  
  &lt;!-- 
  Child elements supporting the &lt;chg&gt; element.  
  --&gt;
  &lt;complexType name="chgType"&gt;
    &lt;sequence&gt;
      &lt;element name="maxSigLife" type="secDNS:maxSigLifeType" 
      minOccurs="0"/&gt;
    &lt;/sequence&gt;
  &lt;/complexType&gt;
  
  &lt;!-- 
  Child response elements.  
  --&gt;
  &lt;element name="infData" type="secDNS:dsOrKeyType"/&gt;

&lt;/schema&gt;
END</artwork>
        </figure>
<!-- 		</t> -->
    </section>

    <section title="Internationalization Considerations" anchor="i18n">
      <t>EPP is represented in XML, which provides native support for encoding
      information using the Unicode character set and its more compact
      representations including UTF-8 <xref target="RFC3629"/>.  Conformant XML
      processors recognize both UTF-8 and UTF-16 <xref target="RFC2781"/>.  Though
      XML includes provisions to identify and use other character encodings
      through use of an "encoding" attribute in an &lt;?xml?&gt; declaration,
      use of UTF-8 is RECOMMENDED in environments where parser encoding support
      incompatibility exists.</t>

      <t>As an extension of the EPP domain mapping <xref target="RFC5731"/>, 
      the internationalization requirements in the EPP domain mapping <xref target="RFC5731"/> are followed 
      by this extension. This extension does not override any of the EPP domain mapping <xref target="RFC5731"/> 
      internationalization features.</t>  
    </section>

    <section title="IANA Considerations" anchor="iana">
      <t>This document uses URNs to describe XML namespaces and XML schemas
      conforming to a registry mechanism described in RFC 3688 <xref target="RFC3688"/>.
      Two URI assignments have been completed by the IANA.</t>

      <t>Registration request for the extension namespace:</t>

      <t>URI: urn:ietf:params:xml:ns:secDNS-1.1</t>

      <t>Registrant Contact: IESG</t>

      <t>XML: None.  Namespace URIs do not represent an XML specification.</t>

      <t>Registration request for the extension XML schema:</t>

      <t>URI: urn:ietf:params:xml:schema:secDNS-1.1</t>

      <t>Registrant Contact: IESG</t>

      <t>XML: See the "Formal Syntax" section of this document.</t>
    </section>

    <section title="Security Considerations" anchor="security">
      <t>The mapping extensions described in this document do not provide any
      security services beyond those described by EPP <xref target="RFC5730"/>,
      the EPP domain name mapping <xref target="RFC5731"/>,
      and protocol layers used by EPP.  The security considerations described in
      these other specifications apply to this specification as well.</t>

      <t>As with other domain object transforms, the EPP transform operations
      described in this document MUST be restricted to the sponsoring client
      as authenticated using the mechanisms described in Sections&nbsp;2.9.1.1 and
      7 of RFC 5730 <xref target="RFC5730"/>.  Any attempt to perform a
      transform operation on a domain object by any client other than the
      sponsoring client MUST be rejected with an appropriate EPP authorization
      error.</t>

      <t>The provisioning service described in this document involves the
      exchange of information that can have an operational impact on the
      DNS.  A trust relationship MUST exist between the EPP client and server,
      and provisioning of public key information MUST only be done after the
      identities of both parties have been confirmed using a strong
      authentication mechanism.</t>

      <t>An EPP client might be acting as an agent for a zone administrator who
      wants to send delegation information to be signed and published by the server
      operator.  Man-in-the-middle attacks are thus possible as a result of
      direct client activity or inadvertent client data manipulation.</t>

      <t>Acceptance of a false key by a server operator can produce significant
      operational consequences.  The child and parent zones MUST be consistent
      to secure the delegation properly.  In the absence of consistent
      signatures, the delegation will not appear in the secure namespace,
      yielding untrustworthy query responses.  If a key is compromised, a client
      can either remove the compromised information or update the delegation
      information via EPP commands using the "urgent" attribute.</t>

      <t>Operational scenarios requiring quick removal of a secure domain
      delegation can be implemented using a two-step process.  First,
      security credentials can be removed using an "urgent" update as just
      described.  The domain can then be removed from the parent zone
      by changing the status of the domain to either of the EPP "clientHold"
      or "serverHold" domain status values.  The domain can also be removed
      from the zone using the EPP &lt;delete&gt; command, but this is a more
      drastic step that needs to be considered carefully before use.</t>

      <t>Data validity checking and Delegation Signer record creation at the server require computational resources.  A
      purposeful or inadvertent denial-of-service attack is possible if a
      client requests some number of update operations that exceed a server's
      processing capabilities.  Server operators SHOULD take steps to manage
      command load and command processing requirements to minimize the risk
      of a denial-of-service attack.</t>

      <t>The signature lifetime values provided by clients are requests that can
      be rejected.  Blind acceptance by a server operator can have an adverse impact
      on a server's processing capabilities.  Server operators SHOULD seriously
      consider adopting implementation rules to limit the range of acceptable
      signature lifetime values to counter potential adverse situations.</t>
    </section>

    <section title="Acknowledgements" anchor="acks">    
      <t>The authors would like to thank the following people who have provided
      significant contributions to the development of this document:</t>

      <t>David Blacka, Howard Eland, Patrik Faltstrom, Olafur Gudmundsson,
Bernie Hoeneisen, Ed Lewis, Klaus Malorny, Alexander Mayrhofer, Patrick Mevzek,
David Smith, Andrew Sullivan, and Srikanth&nbsp;Veeramachaneni.</t>

      <t>This document replaces RFC 4310 <xref target="RFC4310"/>. Please see the Acknowledgements section in that RFC for additional acknowledgements.</t>

      <t>This document incorporates feedback from early implementers on the
PROVREG mailing list and users.</t>
      
    </section>
  </middle>

  <back>

<?rfc rfcedstyle="no"?>
    <references title="Normative References">
      &rfc2119;
      &rfc3688;
      &rfc5730;
      &rfc5731;
      &rfc3757;
      &rfc4034;
      &rfc4035;
      &W3C.xml;
      &W3C.xmlschema-1;
      &W3C.xmlschema-2;
    </references>

    <references title="Informative References">
      &rfc1034;
      &rfc1035;
      &rfc2781;
      &rfc3629;
      &rfc4033;
      &rfc4310;
    </references>
<?rfc rfcedstyle="yes"?>

    <section title="Changes from RFC 4310" anchor="changes-from-rfc4310">
      <t><list style="numbers">
      	<t>Added the motivation in obsoleting RFC 4310 <xref target="RFC4310"/> to <xref target="intro"/>.</t>
      	<t>Updated <xref target="intro"/> to add an explicit statement about deprecation of RFC 4310.</t> 
      	<t>Added secDNS-1.0 and secDNS-1.1 abbreviation definitions in <xref target="conventions"/>.</t>
      	<t>Updated "Data validity checking at the server..." to "Data validity checking and Delegation Signer record creation at the server..." in <xref target="security"/>.</t> 
      	<t>Added <xref target="migratingFrom4310"/>.</t>
      	<t>Updated the second paragraph of <xref target="i18n"/> to clarify that the internationalization features of <xref target="RFC5731"/> are followed.</t>

   		<t>Moved &lt;secDNS:rem&gt; prior to &lt;secDNS:add&gt; to
conform to the EPP order semantics for supporting &lt;secDNS:all&gt; with
&lt;secDNS:rem&gt; to remove all data, and for supporting the replace semantics previously supported by &lt;secDNS:chg&gt;.</t>
   		<t>Added support for the use of the &lt;secDNS:all&gt; boolean element under &lt;secDNS:rem&gt; to remove all DS or key data in place of using &lt;secDNS:chg/&gt;.</t>
   		<t>Updated &lt;secDNS:add&gt;, &lt;secDNS:rem&gt;, and &lt;secDNS:chg&gt; to function in a consistent way to the other EPP RFCs.</t>
   		<t>Removed support for &lt;secDNS:rem&gt; using just &lt;secDNS:keyTag&gt;.</t>  
   	    <t>Moved the &lt;secDNS:maxSigLife&gt; element out of the &lt;secDNS:dsData&gt; and &lt;secDNS:keyData&gt; elements and directly under the &lt;secDNS:create&gt; element, under the &lt;secDNS:chg&gt; element of the &lt;secDNS:update&gt; element, and under the &lt;secDNS:infData&gt; element.  <xref target="maxSigLife"/> element was updated to better describe the &lt;secDNS:maxSigLife&gt; element, and references to the &lt;secDNS:maxSigLife&gt; element were updated throughout the document.</t>  

   		<t>Replaced references to urn:ietf:params:xml:schema:secDNS-1.0 with urn:ietf:params:xml:schema:secDNS-1.1, and replaced "Two URI assignments have been completed by the IANA" with "Two URI assignments have been completed by the IANA" in <xref target="iana"/>.</t>

   		<t>Added "The &lt;secDNS:keyTag&gt; element is represented as an unsignedShort <xref target="W3C.REC-xmlschema-2-20010502"/>" in <xref target="dsDataInterface"/>.</t>
 		<t>Added "The &lt;secDNS:digest&gt; element is represented as a hexBinary <xref target="W3C.REC-xmlschema-2-20010502"/>" in <xref target="dsDataInterface"/>.</t>
 		<t>Added "The &lt;secDNS:pubKey&gt; element is represented as a base64Binary <xref target="W3C.REC-xmlschema-2-20010502"/> with a minimum length of 1" in <xref target="keyDataInterface"/>.</t>
 		<t>Combined "the command MUST contain an &lt;extension&gt; element" with the following sentence in <xref target="create"/> and <xref target="update"/>.</t>

 		<t>Added sentence "If the server does not support the
&lt;secDNS:maxSigLife&gt; element, a 2102 error MUST be returned" to <xref target="create"/> and <xref target="update"/>.</t>
 		<t>Added sentence "This document replaces RFC 4310. Please see the Acknowledgements section in that RFC for additional acknowledgements" in <xref target="acks"/>.</t> 
        <t>Added "This document incorporates feedback from implementers on the PROVREG mail list and users" as well as "This document obsoletes RFC 4310" in the Abstract.</t>
        <t>Removed all references to xsi:schemaLocation to be consistent with the other EPP RFCs.</t>
        <t>Added the "DS Data Interface and Key Data Interface" section.</t>
        <t>Moved the "create, add, remove, and replace Delegation Signer (DS) information" paragraph from the "Object Attributes" section to the "DS Data Interface" section.</t> 
        <t>Replaced the element descriptions in the "EPP &lt;info&gt; Command" section with a reference to the &lt;secDNS:dsData&gt; and &lt;secDNS:keyData&gt; elements described in the "DS Data Interface" and "Key Data Interface" sections, respectively.</t>
        <t>Updated the "EPP &lt;info&gt; Command" section examples to include both the DS Data Interface and the Key Data Interface.</t>
        <t>Updated the "EPP &lt;create&gt; Command" section to refer to both the use of &lt;secDNS:dsData&gt; and &lt;secDNS:keyData&gt; described in the "DS Data Interface" and "Key Data Interface" sections, respectively.</t>
        <t>Updated the "EPP &lt;create&gt; Command" section examples to include both the DS Data Interface and the Key Data Interface.</t>
        <t>Updated the "EPP &lt;update&gt; Command" section to describe the use of &lt;secDNS:add&gt;, &lt;secDNS:rem&gt;, and &lt;secDNS:chg&gt; together.</t>
        <t>Updated the "EPP &lt;update&gt; Command" section examples to include both the DS Data Interface and the Key Data Interface.  Also included additional examples of adding and removing DS data or key data.</t>
        <t>Updated the "Formal Syntax" section with the updated XML schema.</t>
        <t>Updated the Acknowledgements section with a new list of contributors.</t>
        <t>Replaced references to RFC 3730 with references to RFC 5730.</t>
        <t>Replaced references to RFC 3731 with references to RFC 5731.</t>

        <t>Added clarification on when the extension MUST be included for each of the commands and responses (&lt;secDNS:create&gt;, &lt;secDNS:update&gt;, &lt;secDNS:infData&gt;).</t>
        <t>Changed "In addition, the EPP &lt;extension&gt; element MUST contain a child &lt;secDNS:infData&gt; element" to "In addition, the EPP &lt;extension&gt; element SHOULD contain a child &lt;secDNS:infData&gt; element" and added "and based on server policy".</t>
      </list></t>
    </section>
    
  </back>
</rfc>

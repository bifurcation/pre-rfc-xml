<?xml version="1.0" encoding="US-ASCII"?>
<?rfc rfcedstyle="yes"?>
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="2"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<rfc category="historic" consensus="yes" ipr="pre5378Trust200902"
     number="6348" submissionType="IETF">
  <front>
    <title abbrev="Reqs for P2MP Extensions to LDP">Requirements for
    Point-to-Multipoint Extensions
    to&nbsp;the&nbsp;Label&nbsp;Distribution&nbsp;Protocol</title>

    <author fullname="Jean-Louis Le Roux" initials="J.-L." role="editor"
            surname="Le Roux">
      <organization>France Telecom - Orange</organization>

      <address>
        <email>jeanlouis.leroux@orange-ftgroup.com</email>
      </address>
    </author>

    <author fullname="Thomas Morin" initials="T." role="editor"
            surname="Morin">
      <organization>France Telecom - Orange</organization>

      <address>
        <email>thomas.morin@orange-ftgroup.com</email>
      </address>
    </author>

    <date month="September" year="2011" />

    <area>Routing Area</area>

    <workgroup>MPLS</workgroup>

    <keyword>MPLS</keyword>

    <keyword>LDP</keyword>

    <keyword>multipoint</keyword>

    <keyword>P2MP</keyword>

    <keyword>multicast</keyword>

    <abstract>
      <t>This document lists a set of functional requirements that served as
      input to the design of Label Distribution Protocol (LDP) extensions for
      setting up point-to-multipoint (P2MP) Label Switched Paths (LSP), in
      order to deliver point-to-multipoint applications over a Multiprotocol
      Label Switching (MPLS) infrastructure.</t>

      <t>This work was overtaken by the protocol solution developed by the
      MPLS working group, but that solution did not closely follow the
      requirements documented here. This document is published as a historic
      record of the ideas and requirements that shaped the protocol work.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>This document lists a set of functional requirements that served as
      input to the design of Label Distribution Protocol (LDP) extensions for
      setting up point-to-multipoint (P2MP) Label Switched Paths (LSP) <xref
      target="MLDP" />, in order to deliver point-to-multipoint applications
      over a Multiprotocol Label Switching (MPLS) infrastructure. </t>

      <t>This work was overtaken by the protocol solution developed by the
      MPLS working group and documented in <xref target="MLDP" />. That
      solution did not closely follow the requirements documented here, and it
      was recognized that this document had served its purpose in driving
      discussions of how the solution should be designed. At this point, no
      further action is planned to update this document in line with the
      protocol solution, and this document is published simply as a historic
      record of the ideas and requirements that shaped the protocol work.</t>

      <t>The document is structured as follows:<list style="symbols">
          <t><xref target="reqoverview" /> is an overview of the
          requirements.</t>

          <t><xref target="appscenario" /> illustrates an application
          scenario.</t>

          <t><xref target="detailedreqs" /> addresses detailed requirements
          for P2MP LSPs.</t>

          <t><xref target="sharedtrees" /> discusses requirements for shared
          trees and multipoint-to-multipoint (MP2MP) LSPs.</t>

          <t><xref target="evalcriteria" /> presents criteria against which a
          solution can be evaluated.</t>
        </list></t>

      <section title="Requirements Language">
        <t>This document is a historic requirements document. To clarify
        statement of requirements, key words are used as follows. The key
        words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
        "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document
        are to be interpreted as described in <xref target="RFC2119" />.</t>
      </section>

      <section title="Definitions">
        <section title="Acronyms">
          <t>
            <list style="hanging">
              <t hangText="P2P:">Point-to-Point</t>

              <t hangText="MP2P:">Multipoint-to-Point</t>

              <t hangText="P2MP:">Point-to-Multipoint</t>

              <t hangText="MP2MP:">Multipoint-to-Multipoint</t>

              <t hangText="LSP:">Label Switched Path</t>

              <t hangText="LSR:">Label Switching Router</t>

              <t hangText="PE:">Provider Edge</t>

              <t hangText="P:">Provider</t>

              <t hangText="IGP:">Interior Gateway Protocol</t>

              <t hangText="AS:">Autonomous System</t>
            </list>
          </t>
        </section>

        <section title="Terminology">
          <t>The reader is assumed to be familiar with the terminology in
          <xref target="RFC3031" />, <xref target="RFC5036" />, and <xref
          target="RFC4026" />.</t>

          <t>
            <list style="hanging">
              <t hangText="Ingress LSR:"><vspace blankLines="0" />Router
              acting as a sender of an LSP</t>

              <t hangText="Egress LSR:"><vspace blankLines="0" />Router acting
              as a receiver of an LSP</t>

              <t hangText="P2P LSP:"><vspace blankLines="0" />An LSP that has
              one unique Ingress LSR and one unique Egress LSR</t>

              <t hangText="MP2P LSP:"><vspace blankLines="0" />An LSP that has
              one or more Ingress LSRs and one unique Egress LSR</t>

              <t hangText="P2MP LSP:"><vspace blankLines="0" />An LSP that has
              one unique Ingress LSR and one or more Egress LSRs</t>

              <t hangText="MP2MP LSP:"><vspace blankLines="0" />An LSP that
              has one or more Leaf LSRs acting indifferently as Ingress or
              Egress LSR</t>

              <t hangText="Leaf LSR:"><vspace blankLines="0" />An Egress LSR
              of a P2MP LSP or an Ingress/Egress LSR of an MP2MP LSP</t>

              <t hangText="Transit LSR:"><vspace blankLines="0" />An LSR of a
              P2MP or MP2MP LSP that has one or more downstream LSRs</t>

              <t hangText="Branch LSR:"><vspace blankLines="0" />An LSR of a
              P2MP or MP2MP LSP that has more than one downstream LSR</t>

              <t hangText="Bud LSR:"><vspace blankLines="0" />An LSR of a P2MP
              or MP2MP LSP that is an Egress but also has one or more directly
              connected downstream LSR(s)</t>

              <t hangText="P2MP tree:"><vspace blankLines="0" />The ordered
              set of LSRs and links that comprise the path of a P2MP LSP from
              its Ingress LSR to all of its Egress LSRs.</t>
            </list>
          </t>
        </section>
      </section>

      <section title="Context and Motivations">
        <t>LDP <xref target="RFC5036" /> has been deployed for setting up
        point-to-point (P2P) and multipoint-to-point (MP2P) LSPs, in order to
        offer point-to-point services in MPLS backbones.</t>

        <t>There are emerging requirements for supporting delivery of
        point-to-multipoint applications in MPLS backbones, such as those
        defined in <xref target="RFC4834" /> and <xref
        target="RFC5501" />.</t>

        <t>For various reasons, including consistency with P2P applications,
        and taking full advantages of MPLS network infrastructure, it would be
        highly desirable to use MPLS LSPs for the delivery of multicast
        traffic. This could be implemented by setting up a group of P2P or
        MP2P LSPs, but such an approach may be inefficient since it would
        result in data replication at the Ingress LSR and duplicate data
        traffic within the network.</t>

        <t>Hence, new mechanisms are required that would allow traffic from an
        Ingress LSR to be efficiently delivered to a number of Egress LSRs in
        an MPLS backbone on a point-to-multipoint LSP (P2MP LSP), avoiding
        duplicate copies of a packet on a given link and relying on MPLS
        traffic replication at some Branch LSRs.</t>

        <t>Resource Reservation Protocol - Traffic Engineering (RSVP-TE)
        extensions for setting up point-to-multipoint Traffic Engineered LSPs
        (P2MP TE LSPs) have been defined in <xref target="RFC4875" />. They
        meet requirements expressed in <xref target="RFC4461" />. This
        approach is useful in network environments where P2MP Traffic
        Engineering capabilities are needed (optimization, QoS, fast
        recovery).</t>

        <t>However, for operators who want to support point-to-multipoint
        traffic delivery on an MPLS backbone, without Traffic Engineering
        needs, and who have already deployed LDP for P2P traffic, an
        interesting and useful approach would be to rely on LDP extensions in
        order to set up point-to-multipoint (P2MP) LSPs. This would bring
        consistency with P2P MPLS applications and would ease the delivery of
        point-to-multipoint services in an MPLS backbone.</t>
      </section>

      <section title="Document Scope">
        <t>This document focuses on the LDP approach for setting up P2MP LSPs.
        It lists a detailed set of requirements for P2MP extensions to LDP, so
        as to deliver P2MP traffic over an LDP-enabled MPLS infrastructure.
        The original intent was that these requirements should be used as
        guidelines when specifying LDP extensions.</t>

        <t>Note that generic requirements for P2MP extensions to MPLS are out
        of the scope of this document. Rather, this document describes
        solution-specific requirements related to LDP extensions in order to
        set up P2MP LSPs.</t>

        <t>Note also that other mechanisms could be used for setting up P2MP
        LSPs (for instance, PIM extensions), but these are out of the scope of
        this document. The objective is not to compare these mechanisms but
        rather to focus on the requirements for an LDP extension approach.</t>
      </section>
    </section>

    <section anchor="reqoverview" title="Requirements Overview">
      <t>The P2MP LDP mechanism MUST support setting up P2MP LSPs, i.e., LSPs
      with one Ingress LSR and one or more Egress LSRs, with traffic
      replication at some Branch LSRs.</t>

      <t>The P2MP LDP mechanism MUST allow the addition or removal of leaves
      associated with a P2MP LSP.</t>

      <t>The P2MP LDP mechanism MUST coexist with current LDP mechanisms and
      inherit its capability sets from <xref target="RFC5036" />. It is of
      paramount importance that the P2MP LDP mechanism MUST NOT impede the
      operation of existing P2P/MP2P LDP LSPs. Also, the P2MP LDP mechanism
      MUST coexist with P2P and P2MP RSVP-TE mechanisms <xref
      target="RFC3209" /> <xref target="RFC4875" />. It is of paramount
      importance that the P2MP LDP mechanism MUST NOT impede the operation of
      existing P2P and P2MP RSVP-TE LSPs.</t>

      <t>The P2MP LDP mechanism MAY also allow setting up
      multipoint-to-multipoint (MP2MP) LSPs connecting a group of Leaf LSRs
      acting indifferently as Ingress LSR or Egress LSR. This may allow a
      reduction in the amount of LDP state that needs to be maintained by an
      LSR.</t>
    </section>

    <section anchor="appscenario" title="Application Scenario">
      <t><xref target="fig1" /> below illustrates an LDP-enabled MPLS provider
      network, used to carry both unicast and multicast traffic of VPN
      customers following, for instance, the architecture defined in <xref
      target="MVPN" /> for BGP/MPLS VPNs or the one defined in <xref
      target="VPLS-MCAST" />.</t>

      <t>In this example, a set of MP2P LDP LSPs is set up between Provider
      Edge (PE) routers to carry unicast VPN traffic within the MPLS backbone
      (not represented in <xref target="fig1" />).</t>

      <t>In this example, a set of P2MP LDP LSPs is set up between PE routers
      acting as Ingress LSRs and PE routers acting as Egress LSRs, so as to
      support multicast VPN traffic delivery within the MPLS backbone.</t>

      <t>For instance, a P2MP LDP LSP is set up between Ingress LSR PE1 and
      Egress LSRs PE2, PE3, and PE4. It is used to transport multicast traffic
      from PE1 to PE2, PE3, and PE4. P1 is a Branch LSR; it replicates MPLS
      traffic sent by PE1 to P2, P3, and PE2. P2 and P3 are non-Branch Transit
      LSRs; they forward MPLS traffic sent by P1 to PE3 and PE4,
      respectively.</t>

      <figure align="center" anchor="fig1"
              title="P2MP LSP from PE1 to PE2, PE3, PE4">
        <artwork align="center"><![CDATA[
          PE1
          *|                *** P2MP LDP LSP
          *|*****
          P1-----PE2
         */ \*
        */   \*
   *****/     \******
PE3----P2      P3----PE4
       |       |
       |       |
       |       |
      PE5     PE6
]]></artwork>
      </figure>

      <t>If later there are new receivers attached to PE5 and PE6, then PE5
      and PE6 join the P2MP LDP LSP. P2 and P3 become Branch LSRs and
      replicate traffic received from P1 to PE3 and PE5 and to PE4 and PE6,
      respectively (see <xref target="fig2" /> below).</t>

      <figure align="center" anchor="fig2" title="Attachment of PE5 and PE6">
        <artwork align="center"><![CDATA[
          PE1
          *|               *** P2MP LDP LSP
          *|*****
          P1-----PE2
         */ \*
        */   \*
   *****/     \******
PE3----P2      P3----PE4
      *|       |*
      *|       |*
      *|       |*
      PE5     PE6
]]></artwork>
      </figure>

      <t>The above example is provided for the sake of illustration. Note that
      P2MP LSPs Ingress and Egress LSRs may not necessarily be PE routers.
      Also, Branch LSRs may not necessarily be P routers.</t>
    </section>

    <section anchor="detailedreqs" title="Detailed Requirements">
      <section title="P2MP LSPs">
        <t>The P2MP LDP mechanism MUST support setting up P2MP LSPs. Data
        plane aspects related to P2MP LSPs are those already defined in <xref
        target="RFC4461" />. That is, a P2MP LSP has one Ingress LSR and one
        or more Egress LSRs. Traffic sent by the Ingress LSR is received by
        all Egress LSRs. The specific aspect related to P2MP LSPs is the
        action required at a Branch LSR, where data replication occurs.
        Incoming labeled data is appropriately replicated to several outgoing
        interfaces, which may use different labels.</t>

        <t>An LSR SHOULD NOT send more than one copy of a packet on any given
        link of a P2MP LSP. Exceptions to this are mentioned in Sections <xref
        format="counter" target="multiaccess" /> and <xref format="counter"
        target="backward" />.</t>

        <t>A P2MP LSP MUST be identified by a constant and unique identifier
        within the whole LDP domain, whatever the number of leaves, which may
        vary dynamically. This identifier will be used so as to add/remove
        leaves to/from the P2MP tree.</t>
      </section>

      <section title="P2MP LSP FEC">
        <t>As with P2P MPLS technology <xref target="RFC5036" />, traffic MUST
        be classified into a Forwarding Equivalence Class (FEC) in this P2MP
        extension. All packets that belong to a particular P2MP FEC and that
        travel from a particular node MUST use the same P2MP LSP.</t>

        <t>If existing FECs cannot be used for this purpose, a new LDP FEC
        that is suitable for P2MP forwarding MUST be specified.</t>
      </section>

      <section title="P2MP LDP Routing">
        <t>As with P2P and MP2P LDP LSPs, the P2MP LDP mechanism MUST support
        hop-by-hop LSP routing. P2MP LDP-based routing SHOULD rely upon the
        information maintained in LSR Routing Information Bases (RIBs).</t>

        <t>It is RECOMMENDED that the P2MP LSP routing rely upon the unicast
        route to the Ingress LSR to build a reverse path tree.</t>
      </section>

      <section title="Setting Up, Tearing Down, and Modifying P2MP LSPs">
        <t>The P2MP LDP mechanism MUST support the establishment, maintenance,
        and teardown of P2MP LSPs in a scalable manner. This MUST include both
        the existence of a large number of P2MP LSPs within a single network
        and a large number of Leaf LSRs for a single P2MP LSP (see also <xref
        target="scalability" /> for scalability considerations and
        figures).</t>

        <t>In order to scale well with a large number of leaves, it is
        RECOMMENDED to follow a leaf-initiated P2MP LSP setup approach. For
        that purpose, leaves will have to be aware of the P2MP LSP identifier.
        The ways a Leaf LSR discovers P2MP LSP identifiers rely on the
        applications that will use P2MP LSPs and are out of the scope of this
        document.</t>

        <t>The P2MP LDP mechanism MUST allow the dynamic addition and removal
        of leaves to and from a P2MP LSP, without any restriction (provided
        there is network connectivity). It is RECOMMENDED that these
        operations be leaf-initiated. These operations MUST NOT impact the
        data transfer (packet loss, duplication, delay) towards other leaves.
        It is RECOMMENDED that these operations do not cause any additional
        processing except on the path from the added/removed Leaf LSR to the
        Branch LSR.</t>
      </section>

      <section title="Label Advertisement">
        <t>The P2MP LDP mechanism MUST support downstream unsolicited label
        advertisement mode. This is well suited to a leaf-initiated approach
        and is consistent with P2P/MP2P LDP operations.</t>

        <t>Other advertisement modes MAY also be supported.</t>
      </section>

      <section title="Data Duplication">
        <t>Data duplication refers to the receipt of multiple copies of a
        packet by any leaf. Although this may be a marginal situation, it may
        also be detrimental for certain applications. Hence, data duplication
        SHOULD be avoided as much as possible and limited to (hopefully rare)
        transitory conditions.</t>

        <t>Note, in particular, that data duplication might occur if P2MP LSP
        rerouting is being performed (see also <xref
        target="rerouting" />).</t>
      </section>

      <section title="Detecting and Avoiding Loops">
        <t>The P2MP LDP extension MUST have a mechanism to detect routing
        loops. This MAY rely on extensions to the LDP loop detection mechanism
        defined in <xref target="RFC5036" />. A loop detection mechanism MAY
        require recording the set of LSRs traversed on the P2MP tree. The P2MP
        loop avoidance mechanism MUST NOT impact the scalability of the P2MP
        LDP solution.</t>

        <t>The P2MP LDP mechanism SHOULD have a mechanism to avoid routing
        loops in the data plane even during transient events.</t>

        <t>Furthermore, the P2MP LDP mechanism MUST avoid routing loops in the
        data plane, which may trigger unexpected non-localized exponential
        growth of traffic.</t>
      </section>

      <section anchor="rerouting" title="P2MP LSP Rerouting">
        <t>The P2MP LDP mechanism MUST support the rerouting of a P2MP LSP in
        the following cases:<list style="symbols">
            <t>Network failure (link or node);</t>

            <t>A better path exists (e.g., new link or metric change); and</t>

            <t>Planned maintenance.</t>
          </list></t>

        <t>Given that P2MP LDP routing should rely on the RIB, the achievement
        of the following requirements relies on the underlying routing
        protocols (IGP, etc.).</t>

        <section title="Rerouting upon Network Failure">
          <t>The P2MP LDP mechanism MUST allow for rerouting of a P2MP LSP in
          case of link or node failure(s) by relying upon update of the routes
          in the RIB. The rerouting time SHOULD be minimized as much as
          possible so as to reduce traffic disruption.</t>

          <t>A mechanism MUST be defined to prevent constant P2MP LSP teardown
          and rebuild, which may be caused by the instability of a specific
          link/node in the network. This can rely on IGP dampening but may be
          completed by specific dampening at the LDP level.</t>
        </section>

        <section title="Rerouting on a Better Path">
          <t>The P2MP LDP mechanism MUST allow for rerouting of a P2MP LSP in
          case a better path is created in the network, for instance, as a
          result of a metric change, a link repair, or the addition of links
          or nodes. This will rely on update of the routes in the RIB.</t>
        </section>

        <section title="Rerouting upon Planned Maintenance">
          <t>The P2MP LDP mechanism MUST support planned maintenance
          operations. It MUST be possible to reroute a P2MP LSP before a
          link/node is deactivated for maintenance purposes. Traffic
          disruption and data duplication SHOULD be minimized as much as
          possible during such planned maintenance. P2MP LSP rerouting upon
          planned maintenance MAY rely on a make-before-break procedure.</t>
        </section>
      </section>

      <section anchor="multiaccess" title="Support for Multi-Access Networks">
        <t>The P2MP LDP mechanism SHOULD provide a way for a Branch LSR to
        send a single copy of the data onto an interface to a multi-access
        network (e.g., an Ethernet LAN) and reach multiple adjacent downstream
        nodes. This requires that the same label be negotiated with all
        downstream LSRs for the LSP.</t>

        <t>When there are several candidate upstream LSRs on an interface to a
        multi-access LAN, the P2MP LDP mechanism SHOULD provide a way for all
        downstream LSRs of a given P2MP LSP to select the same upstream LSR,
        so as to avoid traffic replication. In addition, the P2MP LDP
        mechanism SHOULD allow for an efficient balancing of a set of P2MP
        LSPs among a set of candidate upstream LSRs on a LAN interface.</t>
      </section>

      <section title="Support for Encapsulation in P2P and P2MP TE Tunnels">
        <t>The P2MP LDP mechanism MUST support nesting P2MP LSPs into P2P and
        P2MP TE tunnels.</t>

        <t>The P2MP LDP mechanism MUST provide a way for a Branch LSR of a
        P2MP LSP, which is also a Head End LSR of a P2MP TE tunnel, to send a
        single copy of the data onto the tunnel and reach all downstream LSRs
        on the P2MP LSP, which are also Egress LSRs of the tunnel. As with LAN
        interfaces, this requires that the same label be negotiated with all
        downstream LSRs of the P2MP LDP LSP.</t>
      </section>

      <section title="Label Spaces">
        <t>Labels for P2MP LSPs and P2P/MP2P LSPs MAY be assigned from shared
        or dedicated label spaces.</t>

        <t>Note that dedicated label spaces will require the establishment of
        separate P2P and P2MP LDP sessions.</t>
      </section>

      <section title="IPv4/IPv6 Support">
        <t>The P2MP LDP mechanism MUST support the establishment of LDP
        sessions over both IPv4 and IPv6 control planes.</t>
      </section>

      <section title="Multi-Area/AS LSPs">
        <t>The P2MP LDP mechanism MUST support the establishment of multi-area
        P2MP LSPs, i.e., LSPs whose leaves do not all reside in the same IGP
        area as the Ingress LSR. This SHOULD be possible without requiring the
        advertisement of Ingress LSRs' addresses across IGP areas.</t>

        <t>The P2MP LDP mechanism MUST also support the establishment of
        inter-AS P2MP LSPs, i.e., LSPs whose leaves do not all reside in the
        same AS as the Ingress LSR. This SHOULD be possible without requiring
        the advertisement of Ingress LSRs' addresses across ASes.</t>
      </section>

      <section title="OAM">
        <t>LDP management tools (<xref target="RFC3815" />, etc.) will have to
        be enhanced to support P2MP LDP extensions. This may yield a new MIB
        module, which may possibly be inherited from the LDP MIB.</t>

        <t>Built-in diagnostic tools MUST be defined to check the
        connectivity, trace the path, and ensure fast detection of data plane
        failures on P2MP LDP LSPs.</t>

        <t>Further and precise requirements and mechanisms for P2MP MPLS
        Operations, Administration, and Maintenance (OAM) purposes are out of
        the scope of this document and are addressed in <xref
        target="RFC4687" />.</t>
      </section>

      <section title="Graceful Restart and Fault Recovery">
        <t>LDP Graceful Restart mechanisms <xref target="RFC3478" /> and Fault
        Recovery mechanisms <xref target="RFC3479" /> SHOULD be enhanced to
        support P2MP LDP LSPs.</t>
      </section>

      <section title="Robustness">
        <t>A solution MUST be designed to re-establish connectivity for P2MP
        and MP2MP LSPs in the event of failures, provided there exists network
        connectivity between ingress and egress nodes (i.e., designed without
        introducing single points of failure).</t>
      </section>

      <section anchor="scalability" title="Scalability">
        <t>Scalability is a key requirement for the P2MP LDP mechanism. It
        MUST be designed to scale well with an increase in the number of any
        of the following: <list style="symbols">
            <t>Number of Leaf LSRs per P2MP LSP;</t>

            <t>Number of downstream LSRs per Branch LSR; and</t>

            <t>Number of P2MP LSPs per LSR.</t>
          </list></t>

        <t>In order to scale well with an increase in the number of leaves, it
        is RECOMMENDED that the size of a P2MP LSP state on an LSR, for one
        particular LSP, depend only on the number of adjacent LSRs on the
        LSP.</t>

        <section title="Orders of Magnitude Expected in Operational Networks">
          <t>Typical orders of magnitude that we expect should be supported
          are: <list style="symbols">
              <t>Tens of thousands of P2MP trees spread out across core
              network routers; and</t>

              <t>Hundreds, or a few thousands, of leaves per tree.</t>
            </list></t>

          <t>See also Section 4.2 of <xref target="RFC4834" />.</t>
        </section>
      </section>

      <section anchor="backward" title="Backward Compatibility">
        <t>In order to allow for a smooth migration, the P2MP LDP mechanism
        SHOULD offer as much backward compatibility as possible. In
        particular, the solution SHOULD allow the setup of a P2MP LSP along
        non-Branch Transit LSRs that do not support P2MP LDP extensions.</t>

        <t>Also, the P2MP LDP solution MUST coexist with current LDP
        mechanisms and inherit its capability sets from <xref
        target="RFC5036" />. The P2MP LDP solution MUST NOT impede the
        operation of P2P/MP2P LSPs. A P2MP LDP solution MUST be designed in
        such a way that it allows P2P/MP2P and P2MP LSPs to be signaled on the
        same interface.</t>
      </section>
    </section>

    <section anchor="sharedtrees" title="Shared Trees">
      <t>For traffic delivery between a group of N LSRs that act as egress
      and/or egress nodes on different P2MP flows, it may be useful to set up
      a shared tree connecting all these LSRs instead of having N P2MP LSPs.
      This would reduce the amount of control and forwarding state that has to
      be maintained on a given LSR.</t>

      <t>There are two main options for supporting such shared trees:<list
          style="symbols">
          <t>Relying on the applications' protocols that use LDP LSPs. A
          shared tree could consist of the combination of an MP2P LDP LSP from
          Leaf LSRs to a given root node with a P2MP LSP from this root to
          Leaf LSRs. For instance, with Multicast L3 VPN applications, it
          would be possible to build a shared tree by combining (see <xref
          target="MVPN" />):<list style="symbols">
              <t>An MP2P unicast LDP LSP, from each PE router of the group to
              a particular root PE router acting as tree root and</t>

              <t>A P2MP LDP LSP from this root PE router to each PE router of
              the group.</t>
            </list></t>

          <t>Relying on a specific LDP mechanism allowing the setup of
          multipoint-to-multipoint MPLS LSPs (MP2MP LSPs).</t>
        </list> The former approach (combination of MP2P and P2MP LSPs at the
      application level) is out of the scope of this document while the latter
      (MP2MP LSPs) is within the scope of this document. Requirements for the
      setup of MP2MP LSPs are listed below.</t>

      <section title="Requirements for MP2MP LSPs">
        <t>A multipoint-to-multipoint (MP2MP) LSP is an LSP connecting a group
        of Leaf LSRs acting as Egress and/or Ingress LSRs. Traffic sent by any
        Leaf LSR is received by all other Leaf LSRs of the group.</t>

        <t>Procedures for setting up MP2MP LSPs with LDP SHOULD be specified.
        An implementation that supports P2MP LDP LSPs MAY also support MP2MP
        LDP LSPs.</t>

        <t>The MP2MP LDP procedures MUST NOT impede the operations of P2MP
        LSP.</t>

        <t>Requirements for P2MP LSPs, set forth in <xref
        target="detailedreqs" />, apply equally to MP2MP LSPs. Particular
        attention should be given to the requirements below:<list
            style="symbols">
            <t>The solution MUST support recovery upon link and transit node
            failure and be designed to re-establish connectivity for MP2MP
            LSPs in the event of failures, provided network connectivity
            exists between ingress and egress nodes (i.e., designed without
            introducing single points of failure).</t>

            <t>The size of MP2MP state on an LSR, for one particular MP2MP
            LSP, SHOULD only depend on the number of adjacent LSRs on the
            LSP.</t>

            <t>Furthermore, the MP2MP LDP mechanism MUST avoid routing loops
            that may trigger exponential growth of traffic. Note that this
            requirement is more challenging with MP2MP LSPs as an LSR may need
            to receive traffic for a given LSP on multiple interfaces.</t>
          </list></t>

        <t>There are additional requirements specific to MP2MP LSPs:<list
            style="symbols">
            <t>It is RECOMMENDED that an MP2MP MPLS LSP is built based on the
            unicast route to a specific LSR called root LSR.</t>

            <t>It is RECOMMENDED to define several root LSRs (e.g., a primary
            and a backup) to ensure redundancy upon root LSR failure.</t>

            <t>The receiver SHOULD NOT receive back a packet it has sent on
            the MP2MP LSP.</t>

            <t>The solution SHOULD avoid that all traffic between any pair of
            leaves is traversing a root LSR (similarly to PIM-Bidir trees) and
            SHOULD provide the operator with means to minimize the delay
            between two leaves.</t>

            <t>It MUST be possible to check connectivity of an MP2MP LSP in
            both directions.</t>
          </list></t>
      </section>
    </section>

    <section anchor="evalcriteria" title="Evaluation Criteria">
      <section title="Performance">
        <t>The solution will be evaluated with respect to the following
        criteria:<list style="format (%d)">
            <t>Efficiency of network resource usage;</t>

            <t>Time to add or remove a Leaf LSR;</t>

            <t>Time to repair a P2MP LSP in case of link or node failure;
            and</t>

            <t>Scalability (state size, number of messages, message size).</t>
          </list></t>

        <t>Particularly, the P2MP LDP mechanism SHOULD be designed with the
        key objective of minimizing the additional amount of state and
        additional processing required in the network.</t>

        <t>Also, the P2MP LDP mechanism SHOULD be designed so that convergence
        times in case of link or node failure are minimized, in order to limit
        traffic disruption.</t>
      </section>

      <section title="Complexity and Risks">
        <t>The proposed solution SHOULD NOT introduce complexity to the
        current LDP operations to such a degree that it would affect the
        stability and diminish the benefits of deploying such solution.</t>
      </section>
    </section>

    <section title="Security Considerations">
      <t>It is expected that addressing the requirements defined in this
      document should not introduce any new security issues beyond those
      inherent to LDP and that a P2MP LDP solution will rely on the security
      mechanisms defined in <xref target="RFC5036" /> (e.g., TCP MD5
      Signature).</t>

      <t>An evaluation of the security features for MPLS networks may be found
      in <xref target="RFC5920" />, and where issues or further work is
      identified by that document, new security features or procedures for the
      MPLS protocols will need to be developed.</t>
    </section>

    <section title="Acknowledgments">
      <t>We would like to thank Christian Jacquenet, Hitoshi Fukuda, Ina
      Minei, Dean Cheng, and Benjamin Niven-Jenkins for their highly useful
      comments and suggestions. We would like to thank Adrian Farrel for
      reviewing this document before publication.</t>

      <t>We would also like to thank the authors of <xref target="RFC4461" />,
      which inspired some of the text in this document.</t>
    </section>
  </middle>

  <back>
    <references title="Normative References">
      <?rfc rfcedstyle="no"?>



      <reference anchor="RFC2119">
        <front>
          <title abbrev="RFC Key Words">Key words for use in RFCs to Indicate
          Requirement Levels</title>

          <author fullname="Scott Bradner" initials="S." surname="Bradner">
            <organization>Harvard University</organization>

            <address>
              <postal>
                <street>1350 Mass. Ave.</street>

                <street>Cambridge</street>

                <street>MA 02138</street>
              </postal>

              <phone>- +1 617 495 3864</phone>

              <email>sob@harvard.edu</email>
            </address>
          </author>

          <date month="March" year="1997" />

          <area>General</area>

          <keyword>keyword</keyword>

          <abstract>
            <t>In many standards track documents several words are used to
            signify the requirements in the specification. These words are
            often capitalized. This document defines these words as they
            should be interpreted in IETF documents. Authors who follow these
            guidelines should incorporate this phrase near the beginning of
            their document: <list>
                <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
                "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
                "OPTIONAL" in this document are to be interpreted as described
                in RFC 2119.</t>
              </list></t>

            <t>Note that the force of these words is modified by the
            requirement level of the document in which they are used.</t>
          </abstract>
        </front>

        <seriesInfo name="BCP" value="14" />

        <seriesInfo name="RFC" value="2119" />

        <format octets="4723"
                target="http://www.rfc-editor.org/rfc/rfc2119.txt" type="TXT" />

        <format octets="17491"
                target="http://xml.resource.org/public/rfc/html/rfc2119.html"
                type="HTML" />

        <format octets="5777"
                target="http://xml.resource.org/public/rfc/xml/rfc2119.xml"
                type="XML" />
      </reference>


      <reference anchor="RFC3031">
        <front>
          <title>Multiprotocol Label Switching Architecture</title>

          <author fullname="E. Rosen" initials="E." surname="Rosen">
            <organization />
          </author>

          <author fullname="A. Viswanathan" initials="A."
                  surname="Viswanathan">
            <organization />
          </author>

          <author fullname="R. Callon" initials="R." surname="Callon">
            <organization />
          </author>

          <date month="January" year="2001" />
        </front>

        <seriesInfo name="RFC" value="3031" />

        <format octets="147175"
                target="http://www.rfc-editor.org/rfc/rfc3031.txt" type="TXT" />
      </reference>



      <reference anchor="RFC5036">
        <front>
          <title>LDP Specification</title>

          <author fullname="L. Andersson" initials="L." surname="Andersson">
            <organization />
          </author>

          <author fullname="I. Minei" initials="I." surname="Minei">
            <organization />
          </author>

          <author fullname="B. Thomas" initials="B." surname="Thomas">
            <organization />
          </author>

          <date month="October" year="2007" />
        </front>

        <seriesInfo name="RFC" value="5036" />

        <format octets="287101"
                target="http://www.rfc-editor.org/rfc/rfc5036.txt" type="TXT" />
      </reference>



      <reference anchor="RFC3815">
        <front>
          <title>Definitions of Managed Objects for the Multiprotocol Label
          Switching (MPLS), Label Distribution Protocol (LDP)</title>

          <author fullname="J. Cucchiara" initials="J." surname="Cucchiara">
            <organization />
          </author>

          <author fullname="H. Sjostrand" initials="H." surname="Sjostrand">
            <organization />
          </author>

          <author fullname="J. Luciani" initials="J." surname="Luciani">
            <organization />
          </author>

          <date month="June" year="2004" />
        </front>

        <seriesInfo name="RFC" value="3815" />

        <format octets="215916"
                target="http://www.rfc-editor.org/rfc/rfc3815.txt" type="TXT" />
      </reference>



      <reference anchor="RFC3478">
        <front>
          <title>Graceful Restart Mechanism for Label Distribution
          Protocol</title>

          <author fullname="M. Leelanivas" initials="M." surname="Leelanivas">
            <organization />
          </author>

          <author fullname="Y. Rekhter" initials="Y." surname="Rekhter">
            <organization />
          </author>

          <author fullname="R. Aggarwal" initials="R." surname="Aggarwal">
            <organization />
          </author>

          <date month="February" year="2003" />
        </front>

        <seriesInfo name="RFC" value="3478" />

        <format octets="29248"
                target="http://www.rfc-editor.org/rfc/rfc3478.txt" type="TXT" />
      </reference>



      <reference anchor="RFC3479">
        <front>
          <title>Fault Tolerance for the Label Distribution Protocol
          (LDP)</title>

          <author fullname="A. Farrel" initials="A." surname="Farrel">
            <organization />
          </author>

          <date month="February" year="2003" />
        </front>

        <seriesInfo name="RFC" value="3479" />

        <format octets="115778"
                target="http://www.rfc-editor.org/rfc/rfc3479.txt" type="TXT" />
      </reference>



      <reference anchor="RFC4461">
        <front>
          <title>Signaling Requirements for Point-to-Multipoint
          Traffic-Engineered MPLS Label Switched Paths (LSPs)</title>

          <author fullname="S. Yasukawa" initials="S." surname="Yasukawa">
            <organization />
          </author>

          <date month="April" year="2006" />

          <abstract>
            <t>This document presents a set of requirements for the
            establishment and maintenance of Point-to-Multipoint (P2MP)
            Traffic-Engineered (TE) Multiprotocol Label Switching (MPLS) Label
            Switched Paths (LSPs).&lt;/t&gt;&lt;t&gt; There is no intent to
            specify solution-specific details or application-specific
            requirements in this document.&lt;/t&gt;&lt;t&gt; The requirements
            presented in this document not only apply to packet-switched
            networks under the control of MPLS protocols, but also encompass
            the requirements of Layer Two Switching (L2SC), Time Division
            Multiplexing (TDM), lambda, and port switching networks managed by
            Generalized MPLS (GMPLS) protocols. Protocol solutions developed
            to meet the requirements set out in this document must attempt to
            be equally applicable to MPLS and GMPLS. This memo provides
            information for the Internet community.</t>
          </abstract>
        </front>

        <seriesInfo name="RFC" value="4461" />

        <format octets="64542"
                target="http://www.rfc-editor.org/rfc/rfc4461.txt" type="TXT" />
      </reference>


    </references>

    <references title="Informative References">


      <reference anchor="RFC4834">
        <front>
          <title abbrev="L3VPN Mcast Reqs">Requirements for Multicast in Layer
          3 Provider-Provisioned Virtual Private Networks (PPVPNs)</title>

          <author fullname="Thomas Morin" initials="T" role="editor"
                  surname="Morin">
            <organization abbrev="France Telecom R&amp;D">France Telecom
            R&amp;D</organization>

            <address>
              <postal>
                <street>2, avenue Pierre Marzin</street>

                <code>22307</code>

                <city>Lannion</city>

                <country>France</country>
              </postal>

              <email>thomas.morin@orange-ftgroup.com</email>
            </address>
          </author>

          <date month="April" year="2007" />

          <workgroup>l3vpn Working Group</workgroup>

          <abstract>
            <t>This document presents a set of functional requirements for
            network solutions that allow the deployment of IP multicast within
            Layer 3 (L3) Provider-Provisioned Virtual Private Networks
            (PPVPNs). It specifies requirements both from the end user and
            service provider standpoints. It is intended that potential
            solutions specifying the support of IP multicast within such VPNs
            will use these requirements as guidelines.</t>
          </abstract>
        </front>

        <seriesInfo name="RFC" value="4834" />

        <format octets="80341"
                target="http://www.rfc-editor.org/rfc/rfc4834.txt" type="TXT" />

        <format octets="135344"
                target="http://xml.resource.org/public/rfc/html/rfc4834.html"
                type="HTML" />

        <format octets="159945"
                target="http://xml.resource.org/public/rfc/xml/rfc4834.xml"
                type="XML" />
      </reference>



      <reference anchor="MLDP">
        <front>
          <title>Label Distribution Protocol Extensions for
          Point-to-Multipoint and Multipoint-to-Multipoint Label Switched
          Paths</title>

          <author fullname="Ina Minei" initials="I" surname="Minei">
            <organization />
          </author>

          <author fullname="IJsbrand Wijnands" initials="I" surname="Wijnands">
            <organization />
          </author>

          <author fullname="Kireeti Kompella" initials="K" surname="Kompella">
            <organization />
          </author>

          <author fullname="Bob Thomas" initials="B" surname="Thomas">
            <organization />
          </author>

          <date month="August" year="2011" />
        </front>

        <seriesInfo name="Work in" value="Progress" />
      </reference>



      <reference anchor="MVPN">
        <front>
          <title>Multicast in MPLS/BGP IP VPNs</title>

          <author fullname="Rahul Aggarwal" initials="R" surname="Aggarwal">
            <organization />
          </author>

          <author fullname="Sarveshwar Bandi" initials="S" surname="Bandi">
            <organization />
          </author>

          <author fullname="Yiqun Cai" initials="Y" surname="Cai">
            <organization />
          </author>

          <author fullname="Thomas Morin" initials="T" surname="Morin">
            <organization />
          </author>

          <author fullname="Yakov Rekhter" initials="Y" surname="Rekhter">
            <organization />
          </author>

          <author fullname="Eric Rosen" initials="E" surname="Rosen">
            <organization />
          </author>

          <author fullname="IJsbrand Wijnands" initials="I" surname="Wijnands">
            <organization />
          </author>

          <author fullname="Seisho Yasukawa" initials="S" surname="Yasukawa">
            <organization />
          </author>

          <date day="28" month="January" year="2010" />
        </front>

        <seriesInfo name="Work in" value="Progress" />
      </reference>



      <reference anchor="VPLS-MCAST">
        <front>
          <title>Multicast in VPLS</title>

          <author fullname="Rahul Aggarwal" initials="R" surname="Aggarwal">
            <organization />
          </author>

          <author fullname="Yuji Kamite" initials="Y" surname="Kamite">
            <organization />
          </author>

          <author fullname="Luyuan Fang" initials="L" surname="Fang">
            <organization />
          </author>

          <author fullname="Yakov Rekhter" initials="Y" surname="Rekhter">
            <organization />
          </author>

          <date month="July" year="2011" />
        </front>

        <seriesInfo name="Work in" value="Progress" />
      </reference>



      <reference anchor="RFC4687">
        <front>
          <title>Operations and Management (OAM) Requirements for
          Point-to-Multipoint MPLS Networks</title>

          <author fullname="S. Yasukawa" initials="S." surname="Yasukawa">
            <organization />
          </author>

          <author fullname="A. Farrel" initials="A." surname="Farrel">
            <organization />
          </author>

          <author fullname="D. King" initials="D." surname="King">
            <organization />
          </author>

          <author fullname="T. Nadeau" initials="T." surname="Nadeau">
            <organization />
          </author>

          <date month="September" year="2006" />

          <abstract>
            <t>Multi-Protocol Label Switching (MPLS) has been extended to
            encompass point-to-multipoint (P2MP) Label Switched Paths (LSPs).
            As with point-to-point MPLS LSPs, the requirement to detect,
            handle, and diagnose control and data plane defects is
            critical.&lt;/t&gt;&lt;t&gt; For operators deploying services
            based on P2MP MPLS LSPs, the detection and specification of how to
            handle those defects are important because such defects not only
            may affect the fundamentals of an MPLS network, but also may
            impact service level specification commitments for customers of
            their network.&lt;/t&gt;&lt;t&gt; This document describes
            requirements for data plane operations and management for P2MP
            MPLS LSPs. These requirements apply to all forms of P2MP MPLS
            LSPs, and include P2MP Traffic Engineered (TE) LSPs and multicast
            LSPs. This memo provides information for the Internet
            community.</t>
          </abstract>
        </front>

        <seriesInfo name="RFC" value="4687" />

        <format octets="30486"
                target="http://www.rfc-editor.org/rfc/rfc4687.txt" type="TXT" />
      </reference>



      <reference anchor="RFC4875">
        <front>
          <title>Extensions to Resource Reservation Protocol - Traffic
          Engineering (RSVP-TE) for Point-to-Multipoint TE Label Switched
          Paths (LSPs)</title>

          <author fullname="R. Aggarwal" initials="R." surname="Aggarwal">
            <organization />
          </author>

          <author fullname="D. Papadimitriou" initials="D."
                  surname="Papadimitriou">
            <organization />
          </author>

          <author fullname="S. Yasukawa" initials="S." surname="Yasukawa">
            <organization />
          </author>

          <date month="May" year="2007" />
        </front>

        <seriesInfo name="RFC" value="4875" />

        <format octets="125394"
                target="http://www.rfc-editor.org/rfc/rfc4875.txt" type="TXT" />
      </reference>



      <reference anchor="RFC4026">
        <front>
          <title>Provider Provisioned Virtual Private Network (VPN)
          Terminology</title>

          <author fullname="L. Andersson" initials="L." surname="Andersson">
            <organization />
          </author>

          <author fullname="T. Madsen" initials="T." surname="Madsen">
            <organization />
          </author>

          <date month="March" year="2005" />

          <abstract>
            <t>The widespread interest in provider-provisioned Virtual Private
            Network (VPN) solutions lead to memos proposing different and
            overlapping solutions. The IETF working groups (first Provider
            Provisioned VPNs and later Layer 2 VPNs and Layer 3 VPNs) have
            discussed these proposals and documented specifications. This has
            lead to the development of a partially new set of concepts used to
            describe the set of VPN services.&lt;/t&gt;&lt;t&gt; To a certain
            extent, more than one term covers the same concept, and sometimes
            the same term covers more than one concept. This document seeks to
            make the terminology in the area clearer and more intuitive. This
            memo provides information for the Internet community.</t>
          </abstract>
        </front>

        <seriesInfo name="RFC" value="4026" />

        <format octets="42124"
                target="http://www.rfc-editor.org/rfc/rfc4026.txt" type="TXT" />
      </reference>



      <reference anchor="RFC3209">
        <front>
          <title>RSVP-TE: Extensions to RSVP for LSP Tunnels</title>

          <author fullname="D. Awduche" initials="D." surname="Awduche">
            <organization />
          </author>

          <author fullname="L. Berger" initials="L." surname="Berger">
            <organization />
          </author>

          <author fullname="D. Gan" initials="D." surname="Gan">
            <organization />
          </author>

          <author fullname="T. Li" initials="T." surname="Li">
            <organization />
          </author>

          <author fullname="V. Srinivasan" initials="V." surname="Srinivasan">
            <organization />
          </author>

          <author fullname="G. Swallow" initials="G." surname="Swallow">
            <organization />
          </author>

          <date month="December" year="2001" />
        </front>

        <seriesInfo name="RFC" value="3209" />

        <format octets="132264"
                target="http://www.rfc-editor.org/rfc/rfc3209.txt" type="TXT" />
      </reference>



      <reference anchor="RFC5920">
        <front>
          <title>Security Framework for MPLS and GMPLS Networks</title>

          <author fullname="L. Fang" initials="L." surname="Fang">
            <organization />
          </author>

          <date month="July" year="2010" />
        </front>

        <seriesInfo name="RFC" value="5920" />

        <format octets="152830"
                target="http://www.rfc-editor.org/rfc/rfc5920.txt" type="TXT" />
      </reference>



      <reference anchor="RFC5501">
        <front>
          <title>Requirements for Multicast Support in Virtual Private LAN
          Services</title>

          <author fullname="Y. Kamite" initials="Y." surname="Kamite">
            <organization />
          </author>

          <author fullname="Y. Wada" initials="Y." surname="Wada">
            <organization />
          </author>

          <author fullname="Y. Serbest" initials="Y." surname="Serbest">
            <organization />
          </author>

          <author fullname="T. Morin" initials="T." surname="Morin">
            <organization />
          </author>

          <author fullname="L. Fang" initials="L." surname="Fang">
            <organization />
          </author>

          <date month="March" year="2009" />
        </front>

        <seriesInfo name="RFC" value="5501" />

        <format octets="71507"
                target="http://www.rfc-editor.org/rfc/rfc5501.txt" type="TXT" />
      </reference>


    </references>

    <?rfc rfcedstyle="yes"?>

    <section anchor="contribauthor" title="Contributing Authors">
      <figure>
        <artwork><![CDATA[
Vincent Parfait
France Telecom - Orange, Orange Business Services

EMail: vincent.parfait@orange-ftgroup.com


Luyuan Fang
Cisco Systems, Inc.

EMail: lufang@cisco.com


Lei Wang
Telenor

EMail: lei.wang@telenor.com


Yuji Kamite
NTT Communications Corporation

EMail: y.kamite@ntt.com


Shane Amante
Level 3 Communications, LLC

EMail: shane@level3.net
]]></artwork>
      </figure>
    </section>
  </back>
</rfc>

<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<rfc number="6545" ipr="trust200902" category="std" obsoletes="6045" submissionType="IETF">
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc toc="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc rfcedstyle="yes"?>

<front>
  <title abbrev="RID">
    Real-time Inter-network Defense (RID)
  </title>
  <author initials="K." surname="Moriarty" fullname="Kathleen M. Moriarty">
    <organization abbrev="EMC">
    EMC Corporation 
    </organization>
    <address>
      <postal>
        <street>176 South Street</street>
        <city>Hopkinton, MA</city>
        <country>United States</country>
      </postal>
      <email>Kathleen.Moriarty@emc.com</email>
    </address>
  </author>
  <date month='April' year='2012' />
  <area>Security</area>
  <workgroup>MILE Working Group</workgroup>

<keyword>incident response, incident coordination, incident handling, incident communication</keyword>

  <abstract>

    <t>Security incidents, such as system compromises, worms, viruses,
    phishing incidents, and denial of service, typically result in the
    loss of service, data, and resources both human and
    system. Service providers and Computer Security Incident Response
    Teams need to be equipped and ready to assist in communicating and
    tracing security incidents with tools and procedures in place
    before the occurrence of an attack.  Real-time Inter-network
    Defense (RID) outlines a proactive inter-network communication
    method to facilitate sharing incident-handling data while
    integrating existing detection, tracing, source identification,
    and mitigation mechanisms for a complete incident-handling
    solution.  Combining these capabilities in a communication system
    provides a way to achieve higher security levels on networks.
    Policy guidelines for handling incidents are recommended and can
    be agreed upon by a consortium using the security recommendations
    and considerations.  This document obsoletes RFC 6045.</t>

  </abstract>
</front>

<middle>

<section title="Introduction" anchor="sec-intro">

<t>Organizations require help from other parties to identify
  incidents, mitigate malicious activity targeting their computing
  resources, and to gain insight into potential threats through the
  sharing of information. This coordination might entail working with
  a service provider (SP) to filter attack traffic, working with an SP
  to resolve a configuration issue that is unintentionally causing
  problems, contacting a remote site to take down a bot network, or
  sharing watch-lists of known malicious IP addresses in a consortium.
  The term "SP" is to be interpreted as any type of service provider or
  Computer Security Incident Response Team (CSIRT) that may be involved in RID communications.</t><t>Incident handling involves the detection, reporting, identification, and mitigation of an incident, whether it be a benign configuration issue, IT incident, an infraction to a service level agreement (SLA), system compromise, socially engineered phishing attack, or a denial-of-service (DoS) attack, etc. When an incident is detected, the response may include simply filing a report, notification to the source of the incident, a request to an SP for resolution/mitigation, or a request to locate the source. One of the more difficult cases is that in which the source of an attack is unknown, requiring the ability to trace the attack traffic iteratively upstream through the network for the possibility of any further actions to take place.  In cases when accurate records of an active session between the target or victim system and the source or attacking system are available, the source is easy to identify.</t><t>Real-time inter-network defense (RID) outlines a proactive inter-network communication method to facilitate sharing incident-handling data while integrating existing detection, tracing, source identification, and mitigation mechanisms for a complete incident handling solution. RID provides a secure method to communicate incident information, enabling the exchange of <xref target="RFC5070">Incident Object Description and Exchange Format (IODEF)</xref> Extensible Markup Language (XML) documents. RID considers security, policy, and privacy issues related to the exchange of potentially sensitive information, enabling SPs or organizations the options to make appropriate decisions according to their policies.  RID includes provisions for confidentiality, integrity, and authentication.</t>
<t>The data in RID messages is represented in an XML <xref target="XML1.0" /> document using the IODEF and RID. By following this model, integration with other aspects for incident handling is simplified. Methods are incorporated into the communication system to indicate what actions need to be taken closest to the source in order to halt or mitigate the effects of the incident or attack at hand. RID is intended to provide a method to communicate the relevant information between CSIRTs while being compatible with a variety of existing and possible future detection-tracing and response approaches.  Incidents may be extended to include Information Technology (IT) incidents, where RID enables the communication between or within providers for non-security IT incidents.</t>
<t>Security and privacy considerations are of high concern since
  potentially sensitive information may be passed through RID
  messages. RID messaging takes advantage of XML security, privacy,
  and policy information set in the RID schema. The RID schema defines
  communication-specific metadata to support the communication of
  IODEF documents for exchanging or tracing information regarding
  incidents. RID messages are encapsulated for transport, which is
  defined in a separate document <xref target="RFC6546" />. The
  authentication, integrity, and authorization features that RID and RID transport offer are used to achieve a necessary level of security.</t><t>Coordinating with other CSIRTs is not strictly a technical problem. There are numerous procedural, trust, and legal considerations that might prevent an organization from sharing information.  RID provides information and options that can be used by organizations who must then apply their own policies for sharing information. Organizations must develop policies and procedures for the use of the RID protocol and IODEF.</t>
<section title="Changes from RFC 6045">
<t>This document contains the following changes with respect to its predecessor <xref target="RFC6045" />:</t>
<list style="symbols"> 
<t>This document is Standards Track, while <xref target="RFC6045" /> was
published as Informational.</t>
<t>This document obsoletes <xref target="RFC6045" /> and moves it to Historic status.</t>
<t>This document refers to the updated RID transport specification <xref target="RFC6546" />, where appropriate.</t>
<t>Edits reflected in this updated version of RID are primarily
  improvements to the informational descriptions.  The descriptions
  have been updated to clarify that IODEF and RID can be used
  for all
  types of incidents and are not limited to network security
  incidents.  The language has been updated to change the focus from
  attacks to incidents, where appropriate.  The term "network provider" has been replaced with the more generic term of "service provider".  Several introductory informational sections have been removed as they are not necessary for the implementation of the protocol.  The sections include:</t> <list>
<t>1.3.  Attack Types and RID Messaging,</t> 
<t>2.  RID Integration with Network Provider Technologies,</t> 
<t>3.1.  Integrating Trace Approaches, and</t>
<t>3.2.  Superset of Packet Information for Traces.</t></list>

<t>An option for a star topology has been included in an informational section to meet current use-case requirements of those who provide reports on incident information.</t>

<t>The schema version was incremented.  The schema has changed to
  include IODEF <xref target="RFC5070" /> enveloped in RID in the
  RIDPolicy class using the new ReportSchema class, to include one
  verified erratum, to include additional enumerations in the Justification attribute, to remove the AcrossNationalBoundaries region enumeration, to add the DataWithHandlingRequirements enumeration in TrafficTypes, and to change the name of the RequestAuthorization MsgType to Acknowledgement.  Additional text has been provided to clarify definitions of enumerated values for some attributes.  The RequestAuthorization name was replaced with Acknowledgement to more accurately represent the function of that message type.  Text was clarified to note the possible use of this message in response to Query and Report messages.  The attributes were fixed in the schema to add 'lang' at the RID class level for language support.</t>  

<t>The TraceRequest and Investigation messages have been collapsed
  into a single message with the requirement to set the MsgType
  according to the functionality required for automation.  The message
  descriptions were identical with the exception of the MsgType, which remains an exception depending on the desired function.  Since both of the enumerations for MsgType are each a Request, 'Investigation' is now 'InvestigationRequest'.  Content may vary within the IODEF document for the type of Request specified.</t>

<t>The IncidentQuery message description name and MsgType enumeration value in the schema have been changed to the more generic name of 'Query'. </t>

<t>Guidance has been improved to ensure consistent implementations and use of XML encryption to provide confidentiality based on data markers, specifically the iodef:restriction attribute in the IODEF and IODEF-RID schemas.  The attribute may also be present in IODEF extension schemas, where the guidance also applies.  Additional guidance and restrictions have been added for XML requirements.</t>

<t>All of the normative text from the Security Considerations section has been moved to a new section, Security Requirements.</t>

<t>The order in which the RID schema is presented in <xref target="sec-IODEF-RID-schema"/> has been changed to match the order in the IODEF-RID schema.</t>

<t>Additional text has been provided to explain the content and interactions between entities in the examples.</t>

<t>Additional references have been provided to improve interoperability with stricter guidance on the use of XML digital signatures and encryption.</t>
</list>
</section>

<section title="Normative and Informative">

<t>Sections 1, 2, 3, and 12 provide helpful background information and considerations.  RID systems participating in a consortium are REQUIRED to fully implement Sections 4, 5, 6, 7, 8, 9, 10, and 11 to prevent interoperability concerns.</t>

</section>

<section title="Terminology" anchor="ext-terminology">

    <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <xref target="RFC2119" />.</t>
</section>
  </section>

<section title="Characteristics of Incidents">
<t>An incident may be defined as a benign configuration issue, IT
  incident, an infraction to a service level agreement (SLA), system
  compromise, a worm or Trojan infection, or a single- or
  multiple-source denial-of-service attack.  The goal of tracing a
  security incident may be to identify the source or to find a point
  on the network as close to the origin of the incident as possible.
  Incident tracing can be used to identify the source(s) of an attack
  in order to halt or mitigate the undesired behavior or to correct an
  identified issue.  RID messages can be communicated between entities
  to report or investigate any type of incident and allow for actions
  to be taken when the source of the incident or a point closer to the
  source is known or has been identified.  Methods to accomplish
  mitigation may include remediation of a configuration issue,
  filtering or rate-limiting the traffic close to the source, or
  taking the host or network offline.  Care must also be taken to
  ensure that the systems involved in the RID communications are not
  abused and to use proper analysis in determining if attack traffic
  is, in fact, attack traffic at each SP involved in the
  investigation.</t><t>Investigating security incidents can be a
  difficult task since attackers go to great lengths to obscure their
  identity.  In the case of a security incident, the true source might
  be identified through an existing established connection to the
  attacker's point of origin.  However, the attacker may not connect
  to the compromised system for a long period of time after the
  initial compromise or may access the system through a series of
  compromised hosts spread across the network.  Other methods of
  obscuring the source may include targeting the host with the same
  attack from multiple sources using both valid and spoofed source
  addresses.  This tactic can be used to compromise a machine and
  leave the difficult task of locating the true origin for the
  administrators.  Attackers use many techniques, which can vary
  between individuals or even organized groups of attackers.  Through
  analysis, the techniques may be grouped into indicators of
  compromise to be shared via IODEF and RID, further assisting with
  the improvement of detection capabilities.  Security incidents,
  including distributed denial-of-service (DDoS) attacks, can be
  difficult or nearly impossible to trace because of the nature of the
  attack.  Some of the difficulties in investigating attacks include
  the following:</t><list style="symbols"><t>the incident or attack
  originates from multiple sources;</t><t>the incident may leverage
  social-engineering techniques or other methods to gain access to
  resources and intellectual property using what appears to be
  legitimate access methods such as outbound web sessions from user
  systems;</t><t>the attack may include various types of traffic meant
  to consume server resources, such as a SYN flood attack without a
  significant increase in bandwidth utilization;</t><t>the type of
  traffic could include valid destination services, which cannot be
  blocked since they are essential services to business, such as DNS
  servers at an SP or HTTP requests sent to an organization connected
  to the Internet;</t><t>the attack may utilize varying types of
  packets including TCP, UDP, ICMP, or other IP protocols;</t><t>the
  attack may be from "zombies" or large botnets, which then require additional searches to locate a controlling server as the true origin of the attack;</t><t>the attack may use a very small number of packets from any particular source, thus making a trace after the fact nearly impossible;</t><t>the indicators of a compromise may be difficult to detect.</t></list><t>If the source(s) of an incident cannot be determined from IP address information, it may be possible to trace the traffic based on characteristics of the incident such as tracing the increased bandwidth utilization or the type of packets seen by the client.  In the case of packets with spoofed source addresses, it is not a trivial task to identify the source of an attack.</t>  <t>IODEF, any extensions to IODEF, and RID can be used to detail an incident, characteristics of the incident (as it evolves), the incident history, and communications of the incident to facilitate the resolution and reporting of the incident.</t>

</section>


<section title="Communication between CSIRTs and Service Providers">

<t>Expediting the communication between CSIRTs and SPs is essential when responding to a security-related incident, which may cross network access points between service providers. As a result of the urgency involved in this inter-service-provider security incident communication, there must be an effective system in place to facilitate the interaction.  This communication policy or method should involve multiple means of communication to avoid a single point of failure. Email is one way to transfer information about the incident, packet traces, etc. However, email may not be received in a timely fashion or be acted upon with the same urgency as a phone call or other communication mechanism like RID.</t>
<t>A technical solution to trace traffic across a single SP may include homegrown or commercial systems for which RID messaging must accommodate the input requirements. The incident-handling system used on the SP's backbone by the CSIRT to coordinate the trace across the single network requires a method to accept, process, and relay RID messages to the system, as well as to wait for responses from the system to continue the RID request process as appropriate. In this scenario, each service provider maintains its own system capable of communicating via RID and integrates with a management station used for monitoring and analysis. An alternative for providers lacking sufficient resources may be to have a neutral third party with access to the provider's network resources who could be used to perform the incident-handling functions. This could be a function of a central organization operating as a CSIRT for countries as a whole or within a consortium that may be able to provide centralized resources.</t>
<t>Consortiums could consist of a federation or a group of service providers or CSIRTs that agrees to participate in the RID communication protocol with an agreed-upon policy and communication protocol facilitating the secure transport of IODEF-RID XML documents. Transport for RID messages is specified in <xref target="RFC6546" />.</t>
<t>One goal of RID is to prevent the need to permit access to other
  networks' equipment. RID provides a standard messaging mechanism to
  enable the communication of incident-handling information to other
  providers in a consortium or in neighboring networks. The third
  party mentioned above may be used in this technical solution to
  assist in facilitating incident handling and possibly traceback
  through smaller providers. The RID messaging mechanism may be a
  logical or physical out-of-band network to ensure that the
  communication is secure and unaffected by the state of the network
  under attack. The two management methods would accommodate the needs
  of larger providers to maintain full management of their network,
  and the third-party option could be available to smaller providers
  who lack the necessary human resources to perform incident-handling
  operations.  The first method enables the individual providers to
  involve (via a notification and alerting system) their network
  operations staff to authorize the continuance of a trace or other
  necessary response to a RID communication request through their network.</t>
<t>The network used for the communication should consist of
  out-of-band or protected channels (direct communication links) or
  encrypted channels dedicated to the transport of RID messages. The
  communication links would be direct connections (virtual or
  physical) between peers who have agreed-upon use and abuse policies
  through a consortium. Consortiums might be linked through policy
  comparisons and additional agreements to form a larger web or
  iterative network of peers that correlates to the traffic paths
  available over the larger web of networks or is based on regions and logical
groups. Contact information, IP addresses of RID systems, and other information
must be coordinated between bilateral peers by a consortium and may use
existing databases, such as the routing arbiter. The security, configuration,
and Confidence rating schemes of the RID messaging peers must be negotiated by
peers and must meet certain overall requirements of the fully connected network
(Internet, government, education, etc.) through the peering and/or a
consortium-based agreement.</t>

<t>RID messaging established with clients of an
provider may be negotiated in a contract as part of a value-added service or
through a service level agreement (SLA). Further discussion is beyond the scope
of this document and may be more appropriately handled in peering or service
level agreements.</t> 
<t>Procedures for incident handling need to be established and well known by anyone that may be involved in incident response. The procedures should also contain contact information for internal escalation procedures, as well as for external assistance groups such as a CSIRT, CERT Coordination Center (CERT/CC), Global Information Assurance Certification (GIAC), and the U.S. Federal Bureau of Investigations (FBI) or other assisting government organization in the country of the investigation.</t>


<section title="Inter-Service-Provider RID Messaging">
<t>RID provides a protocol and format that ensures interoperability
  between vendors for the implementation of an incident messaging
  mechanism. The messages should meet several requirements in order to
  be meaningful as they traverse multiple networks.  RID provides the
  framework necessary for communication between networks involved in
  the incident handling, possible traceback, and mitigation of a
  security incident. Several message types described in
  <xref target="sec-msg-types"/> are necessary to facilitate the
  handling of a security incident. The message types include the
  Report, Query, Request, Acknowledgement, and Result
  message.</t><t>The Report message is used when an incident is to be
  filed on a RID system or associated database, where no further
  action is required. A Query message is used to request information
  on a particular incident. A Request message with options set to
  'TraceRequest' is used when the source of the traffic may have been
  spoofed. In that case, each SP in the upstream path who receives
  this Request will issue a trace across the network to determine the
  upstream source of the traffic. The Acknowledgement and Result
  messages are used to communicate the status and result of a
  Request. The Request message with options set to
  'InvestigationRequest' may be sent to any party assisting in an
  incident investigation. The InvestigationRequest leverages
  the bilateral relationships or a consortium's interconnections to
  mitigate or stop problematic traffic close to the source. Routes
  could determine the fastest path to a known source IP address in the
  case of an InvestigationRequest. A Request message (set to 'TraceRequest' or 'InvestigationRequest') sent between RID systems to stop traffic at the source through a bordering network requires the information enumerated below:</t>
<list style="numbers"><t>Enough information to enable the network
    administrators to make a decision about the importance of
    continuing the trace.</t><t>The incident or IP packet information
    needed to carry out the trace or investigation.</t><t>Contact
    information of the origin of the RID communication.  The contact
    information could be provided through the Autonomous System Number
    (ASN) <xref target="RFC1930" /> or Network Information Center
    (NIC) handle information listed in the Registry for Internet
    Numbers or other Internet databases.</t><t>Network path
    information to help prevent any routing loops through the network
    from perpetuating a trace. If a RID system receives a Request with
    MsgType set to 'TraceRequest' that contains its own information in the path, the trace must cease and the RID system should generate an alert to inform the network operations staff that a tracing loop exists.</t><t>A unique identifier for a single attack. This identifier should be used to correlate traces to multiple sources in a DDoS attack.</t>
</list>
<t>Use of the communication network and the RID protocol must be for pre-approved, authorized purposes only. It is the responsibility of each participating party to adhere to guidelines set forth in both a global use policy established through the peering agreements for each bilateral peer or agreed-upon consortium guidelines. The purpose of such policies is to avoid abuse of the system; the policies shall be developed by a consortium or participating entities. The global policy may be dependent on the domain it operates under; for example, a government network or a commercial network such as the Internet would adhere to different guidelines to address the individual concerns. Privacy issues must be considered in public networks such as the Internet.  Privacy issues are discussed in the Security Requirements section, along with other requirements that must be agreed upon by participating entities.</t><t>RID requests must be legitimate incidents and not used for purposes such as sabotage or censorship. An example of such abuse of the system includes a request to rate-limit legitimate traffic to prevent information from being shared between users on the Internet (restricting access to online versions of papers) or restricting access from a competitor's product in order to sabotage a business.</t>
<t>The RID system should be configurable to either require user input
  or automatically continue traces. This feature enables a network
  manager to assess the available resources before continuing a
  Request message set to 'InvestigationRequest' or 'TraceRequest'. If
  the Confidence rating (provided in IODEF) is low, it may not be in
  the provider's best interest to continue the Request with options 
  set to 'InvestigationRequest' or 'TraceRequest'. The Confidence ratings must adhere to the specifications for selecting the percentage used to avoid abuse of the system. Requests must be issued by authorized individuals from the initiating CSIRT, set forth in policy guidelines established through peering or a SLA.</t>
</section>

<section title="RID Communication Topology">
<t>The most basic topology for communicating RID systems is a
   direct connection or a bilateral relationship as illustrated below.

<figure title="Direct Peer Topology"  anchor="fig-directTopology">
  <artwork><![CDATA[
         ___________                                  __________
         |         |                                  |        |
         |  RID    |__________-------------___________|  RID   |
         |_________|          | SP Border |           |________|
                              -------------
]]></artwork>
</figure>

</t>
<t>Within the consortium model, several topologies might be agreed upon
   and used.  One would leverage bilateral network peering relationships
   of the members of the consortium.  The peers for RID would match that
   of routing peers, and the logical network borders would be used.
   This approach may be necessary for an iterative trace where the
   source is unknown.  The model looks like the above diagram;
   however, there may be an extensive number of interconnections of
   bilateral relationships formed.  Also within a consortium model, it
   may be useful to establish an integrated mesh of networks to pass RID
   messages.  This may be beneficial when the source address is known,
   and an interconnection may provide a faster route to reach the
   closest upstream peer to the source of the attack traffic if direct communication between SPs is not possible.  An
   example is illustrated below.

<figure title="Mesh Peer Topology"  anchor="fig-meshTopology">
  <artwork><![CDATA[
    _______                     _______                     _______
    |     |                     |     |                     |     |
  __| RID |____-------------____| RID |____-------------____| RID |__
    |_____|    | SP Border |    |_____|    | SP Border |    |_____|
       |       -------------               -------------       |
       |_______________________________________________________|

   Direct connection to network that is not an immediate network peer
]]></artwork>
</figure>
</t>
<t>By using a fully meshed model in a consortium, broadcasting RID
   requests would be possible, but not advisable.  By broadcasting a
   request, RID peers that may not have carried the attack traffic on
   their network would be asked to perform a trace for the potential of
   decreasing the time in which the true source was identified.  As a
   result, many networks would have utilized unnecessary resources for a
   Request that may have also been unnecessary.</t>
<t>A star topology may be desirable in instances where a peer may be a provider of incident information.  This requires trust relationships to be established between the provider of information and each of the consumers of that information.  Examples may include country-level CSIRTs or service providers distributing incident information to organizations.</t>
</section>
</section>

<section title="Message Formats">


<section title="RID Data Types">
<t>RID is derived from the IODEF data model and inherits all of the data types defined in the IODEF model. One data type is added by RID: BOOLEAN.</t>


<section title="Boolean">
<t>A boolean value is represented by the BOOLEAN data type.</t><t>The BOOLEAN data type is implemented as "xs:boolean" <xref target="XMLschema" /> in the schema.  Note that there are two lexical representations for boolean in <xref target="XMLschema" />: '1' or 'true' for TRUE and '0' or 'false' or FALSE.</t>
</section>  
</section>


<section title="RID Message Types" anchor="sec-msg-types">
<t>The five RID message types described below MUST be implemented.  RID messages uses both the IODEF <xref target="RFC5070" /> and RID document, which MUST be encapsulated for transport as specified in <xref target="RFC6546" />.  The messages are generated and received on designated systems for RID communications.  Each RID message type, along with an example, is described in the following sections. The IODEF-RID schema is introduced in <xref target="sec-IODEF-RID-schema"/> to support the described RID message types. </t>

<list style="numbers"><t>Request.  This message type is used when a
    request ('InvestigationRequest' or 'TraceRequest') is needed.  The
    purpose of the Request message (set to 'InvestigationRequest') is
    to leverage the existing peer relationships in order to notify the
    SP closest to the source of the valid traffic of a
    security-related incident for any necessary actions to be taken.
    The Request (set to 'TraceRequest') is used when the traffic has to be traced iteratively through networks to find the source by setting the MsgType to 'TraceRequest'.  The 'InvestigationRequest' MsgType is used for all other Request messages.</t><t>Acknowledgement.  This message is sent to the initiating RID system from each of the upstream provider's RID systems to provide information on the status of a Request.  The Acknowledgement is also used to provide a reason why a Request, Report, or Query was not accepted.</t><t>Result.  The Result message is used to provide a final report and the notification of actions taken for a Request.  This message is sent to the initiating CSIRT through the network of RID systems in the path of the trace as notification that the source of the attack was located.</t><t>Report.  This message is used to report a security incident, for which no action is requested.  This may be used for the purpose of correlating attack information by CSIRTs, sharing incident information, statistics and trending information, etc.</t><t>Query.  This message is used to request information about an incident or incident type from a trusted system communicating via RID. The response is provided through the Report message.</t></list><t>When an application receives a RID message, it must be able to determine the type of message and parse it accordingly.  The message type is specified in the RIDPolicy class. The RIDPolicy class may also be used by the transport protocol to facilitate the communication of security incident data to trace, investigate, query, or report information regarding security incidents.</t>
</section>  
</section>

<section title="IODEF-RID Schema" anchor="sec-IODEF-RID-schema">
<t>There are three classes included in the RID extension required to facilitate RID communications.  The RequestStatus class is used to indicate the approval status of a Request message; the IncidentSource class is used to report whether or not a source was found and to identify the source host(s) or network(s); and the RIDPolicy class provides information on the agreed-upon policies and specifies the type of communication message being used.</t><t>The RID schema defines communication-specific metadata to support the exchange of incident information in an IODEF document. The intent in maintaining a separate schema and not using the AdditionalData extension of IODEF is the flexibility of sending messages between RID hosts. Since RID is a separate schema and RID messages include both the RID and IODEF documents, the RID message acts as an envelope in that policy and security defined at the RID message layer are applied to both documents. One reason for maintaining separate schemas is for flexibility, where the RIDPolicy class can be easily extracted for use in the RID message and by the transport protocol.</t>
<t>The security requirements of sending
   incident information between entities include the use of
   encryption.  The RIDPolicy information is not required to be
   encrypted, so separating out this data from the IODEF XML document
   removes the need for decrypting and parsing the IODEF
   document to determine how it should be handled at each RID host.</t>

<t>The purpose of the RIDPolicy class is to specify the message type for
   the receiving host, facilitate the policy needs of RID, and provide
   routing information in the form of an IP address of the destination
   RID system.</t>

<t>The security requirements and policy guidelines are discussed in
   <xref target="sec-reqs"/>.
   The policy is defined between RID peers and within or between
   consortiums.  RIDPolicy is meant to be a tool to facilitate the
   defined policies.  This MUST be used in accordance with policy set
   between clients, peers, consortiums, and/or regions.  Security,
   privacy, and confidentiality MUST be considered as specified in this
   document.</t>

<t>The RID schema is defined as follows:
<figure title="The RID Schema"  anchor="fig-ridschema">
  <artwork><![CDATA[
        +------------------+
        |        RID       |
        +------------------+
        |                  |
        | ENUM lang        |<>---{0..1}----[ RIDPolicy      ]
        |                  |
        |                  |<>---{0..1}----[ RequestStatus  ]
        |                  |
        |                  |<>---{0..1}----[ IncidentSource ]
        +------------------+
]]></artwork>
</figure>
</t>
<t>The aggregate classes that constitute the RID schema in the iodef-rid namespace are as follows:</t><t>RIDPolicy</t><list><t>Zero or One. &nbsp;The RIDPolicy class is used by all message types to facilitate policy agreements between peers, consortiums, or federations, as well as to properly route messages.</t></list><t>RequestStatus</t><list><t>Zero or One. &nbsp;The RequestStatus class is used only in Acknowledgement messages.  The message reports back to the CSIRT or SP in the Acknowledgement message to provide status on a Request or if an error or problem occurs with the receipt or processing of a Report, Query, or Result message.</t></list><t>IncidentSource</t><list><t>Zero or One. &nbsp;The IncidentSource class is used in the Result message only.  The IncidentSource provides the information on the identified source host or network of an attack trace or investigation.</t>
</list><t>Each of the three listed classes may be the only class included in the RID class, hence the option for zero or one.  In some cases, RIDPolicy MAY be the only class in the RID definition when used by the transport protocol <xref target="RFC6546" />, as that information should be as small as possible and may not be encrypted.  The RequestStatus message MUST be able to stand alone without the need for an IODEF document to facilitate the communication, limiting the data transported to the required elements per <xref target="RFC6546" />.</t>

<t>The RID class has one attribute:</t>
<list>
<t>lang</t><list>
      <t>One. &nbsp;REQUIRED.  ENUM.  A valid language code per <xref target="RFC5646" />
      constrained by the definition of "xs:language" inherited from <xref target="XML1.0" />.</t>
</list>
</list>

<section title="RIDPolicy Class">
<t>The RIDPolicy class facilitates the delivery of RID messages and is
  also referenced for transport in the transport document
  <xref target="RFC6546" />.  The RIDPolicy Class includes the
  ability to embed an IODEF document or XML documents that conform to schemas other than IODEF in the ReportSchema element.
<figure title="The RIDPolicy Class"  anchor="fig-ridpolicy">
  <artwork><![CDATA[
       +------------------------+
       | RIDPolicy              |
       +------------------------+
       |                        |
       | ENUM restriction       |<>-------------[ Node         ]
       | ENUM MsgType           |
       | ENUM MsgDestination    |<>---{0..1}----[ IncidentID   ]
       | ENUM ext-MsgType       |
       | ENUM ext-MsgDestination|<>---{1..*}----[ PolicyRegion ]
       |                        |
       |                        |<>---{1..*}----[ TrafficType  ]
       |                        | 
       |                        |<>---{0..1}----[ ReportSchema ]
       +------------------------+
]]></artwork>
</figure>
</t>
<t>The aggregate elements that constitute the RIDPolicy class are as
  follows:</t><t>Node</t><list><t>One. &nbsp;The Node class is used to
    identify a host or network device, in this case to identify the
    system communicating RID messages, and the usage is determined by
    the MsgDestination attribute.  The base definition of this class
    is reused from the IODEF specification <xref target="RFC5070" />,
    Section 3.16.  See <xref target="sec-i18n"/> of this document for Internationalization considerations.</t></list>
<t>IncidentID</t><list><t>Zero or one.  Global reference pointing back to the IncidentID defined in the IODEF data model.  The IncidentID includes the name of the CSIRT, an incident number, and an instance of that incident.  The instance number is appended with a dash separating the values and is used in cases for which it may be desirable to group incidents.  Examples of incidents that may be grouped include botnets, polymorphic attacks, DDoS attacks, multiple hops of compromised systems found during an investigation, etc.</t>
</list>
<t>PolicyRegion</t><list><t>One or many.  REQUIRED.  The values for the attribute "region" are used to determine what policy area may require consideration before a trace can be approved.  The PolicyRegion may include multiple selections from the attribute list in order to fit all possible policy considerations when crossing regions, consortiums, or networks.</t>
</list>
<t>region</t><list><t>One or many.  REQUIRED.  ENUM.  The attribute
    region is used to identify the expected sharing range of the
    incident information.  The region may be within a region or
    defined by existing relationships such as those of a consortium or
    a client to a service provider. </t>
<list style="numbers">
<t>ClientToSP.  A client initiated the request to their service
  provider (SP).  A client may be an individual, enterprise, or other
  type of entity (government, commercial, education, etc.).  An SP may
  be a network, telecommunications, infrastructure, or other type of
  SP where a client-to-vendor relationship has been established.  The
  client-to-vendor relationship will typically have established
  contracts or agreements to define expectations and trust
  relationships.</t><t>SPToClient.  An SP initiated a RID request or
  report to a client.  A client may be an individual, enterprise, or
  other type of entity (government, commercial, education, etc.).  An
  SP may be a network, telecommunications, infrastructure, or other
  type of SP where a client-to-vendor relationship has been
  established.  The client-to-vendor relationship will typically have
  established contracts or agreements to define expectations and trust
  relationships.</t><t>IntraConsortium.  Incident information that
  should have no restrictions within the boundaries of a consortium
  with the agreed-upon use and abuse guidelines.  A consortium is a
  well-defined group with established members and trust relationships
  specific to sharing within that group.  A consortium would typically
  define the types of data that can be shared in advance, define the expectations on protecting that data, as well as have established contractual agreements.  Examples of consortiums may include industry-focused sharing communities (financial, government, research and education, etc.) or cross industry sharing communities (for instance, organizations within local proximity that form a sharing group).</t><t>PeerToPeer.  Incident information that should have no restrictions between two peers but may require further evaluation before continuance beyond that point with the agreed-upon use and abuse guidelines.  PeerToPeer communications may involve any two individuals or entities that decide to share information directly with each other.</t><t>BetweenConsortiums.  Incident information that should have no restrictions between consortiums that have established agreed-upon use and abuse guidelines.  BetweenConsortiums is used when two consortiums (as defined in IntraConsortium above) share data.  The types of data that can be shared BetweenConsortiums should be identified in their agreements and contracts along with expectations on how that data should be handled and protected.</t>

<t>ext-value.  An escape value used to extend this attribute.  See IODEF <xref target="RFC5070" />, Section 5.1.</t>
</list></list>
<t>TrafficType</t><list><t>One or many.  REQUIRED.  The values for the attribute "type" are meant to assist in determining if a trace is appropriate for the SP receiving the request to continue the trace.  Multiple values may be selected for this element; however, where possible, it should be restricted to one value that most accurately describes the traffic type.</t></list>
<t>type</t><list><t>One or many.  REQUIRED.  ENUM.  The attribute type is used to identify the type of information included in the RID message or the type of incident.</t>
<list style="numbers"><t>Attack.  This option SHOULD only be selected
    if the traffic is related to an information security incident or
    attack.  The type of attack MUST also be listed in more detail in
    the IODEF Method and Impact classes for further clarification to
    assist in determining if the trace can be continued
    (<xref target="RFC5070" />, Sections 3.9 and
    3.10.1).</t><t>Network.  This option MUST only be selected when
    the trace is related to network traffic or routing
    issues.</t><t>Content.  This category MUST be used only in the
    case in which the request is related to the content and regional
    restrictions on accessing that type of content exist.  This is not
    malicious traffic but may be used for determining what sources or destinations accessed certain materials available on the Internet, including, but not limited to, news, technology, or inappropriate content.</t>
<t>DataWithHandlingRequirements. This option is used when data shared
  may have additional restrictions for handling, protection, and
  processing based on the type of data and where it resides.
  Regulatory or legal restrictions may be imposed on specific types of
  data that could vary based on the location, region or nation, of the
  data or where it originated.  The IODEF document, as well
  as any extensions, included with the RID message should indicate the specific restrictions to be considered.  The use of this enumeration flag is not legally binding. </t>
<t>AudienceRestriction.  This option is used to indicate that the message contains data that should be viewed by a restricted audience.  This setting should not be used for normal incidents or reporting as it could slow response times. The content may be a business-relevant notification or request.  This option MAY be used by a business partner to report or request assistance if an incident has affected a supply chain.  This option may also be used if the content is relevant to regulatory obligations, legal (eDiscovery), or other use cases that require management attention.</t><t>Other.  If this option is selected, a description of the traffic type MUST be provided so that policy decisions can be made to continue or stop the investigation.  The information should be provided in the IODEF message in the Expectation class or in the History class using a HistoryItem log.  This may also be used for incident types other than information-security-related incidents.</t><t>ext-value.  An escape value used to extend this attribute.  See IODEF <xref target="RFC5070" />, Section 5.1.</t>
</list>
<t>ReportSchema</t><list>
<t>Zero or One. &nbsp;The ReportSchema class is used by the message types that require the full IODEF schema to be included in the RID envelope.  Alternate schemas may be included if approved by the Designated Reviewer and registered by IANA for use with RID.</t></list></list>
<t>The RIDPolicy class has five attributes:</t>
<list><t>restriction</t><list><t>OPTIONAL.  ENUM.  This attribute indicates the disclosure guidelines to which the sender expects the recipient to adhere. This guideline provides no real security since it is the choice of the recipient of the document to honor it.  This attribute follows the same guidelines as "restriction" used in IODEF.</t></list>
<t>MsgType</t>
<list><t>One. &nbsp;REQUIRED.  ENUM.  The type of RID message sent.  The
    five types of messages are described in <xref target="sec-msg-types"/> and can be noted as one of the six selections below, where a Request is set to either 'InvestigationRequest' or 'TraceRequest'.</t>

<list style="numbers"><t>TraceRequest.  This Request message may be
    used to initiate a TraceRequest or to continue a TraceRequest to
    an upstream network closer to the source address of the origin of
    the security incident.</t><t>Acknowledgement.  This message is
    sent to the initiating RID system from each of the upstream RID
    systems to provide information on the request status in the
    current network.</t><t>Result.  This message indicates that the
    source of the attack was located, and the message is sent to the
    initiating RID system through the RID systems in the path of the
    trace.</t><t>InvestigationRequest.  This Request message type is
    used when the source of the traffic is believed to be valid.  The
    purpose of the InvestigationRequest is to leverage the existing
    peer or consortium relationships in order to notify the SP closest
    to the source of the valid traffic that some event occurred, which
    may be a security-related incident.</t><t>Report.  This message is
    used to report a security incident for which no action is
    requested in the IODEF Expectation class.  This may be used for
    the purpose of correlating attack information by CSIRTs, gathering
    statistics and trending information, etc.</t><t>Query.  This message is used to request information from a trusted RID system about an incident or incident type.</t></list></list>
<t>Additionally, there is an extension attribute to add new enumerated values:</t><list><t>ext-value.  An escape value used to extend this attribute.  See IODEF <xref target="RFC5070" />, Section 5.1. </t></list><t>MsgDestination</t><list>
<t>One. &nbsp;REQUIRED.  ENUM.  The destination required at this level may either be the RID messaging system intended to receive the request, or, in the case of a Request with MsgType set to 'InvestigationRequest', the source of the incident.  In the case of an InvestigationRequest, the RID system that can help stop or mitigate the traffic may not be known, and the message may have to traverse RID messaging systems by following the routing path to the RID system closest to the source of the attack traffic.  The Node element lists either the RID system or the IP address of the source, and the meaning of the value in the Node element is determined by the MsgDestination element.</t>
<list style="numbers"><t>RIDSystem.  The IP address of the next
    upstream system accepting RID communications is REQUIRED and is
    listed in the Node element of the RIDPolicy class.  If NodeName
    element of the Node class is used, it contains a DNS domain name.
    The originating RID system is required to check that this domain
    name resolves to the IP address to which the RID message is sent.
    This check may be performed in advance of sending the message and
    the result saved for future use with additional RID
    messages. </t><t>SourceOfIncident.  The Address element of the
    Node element contains the IP address of the incident source, and
    the NodeName element of the Node class is not used.  The IP
    address is REQUIRED when this option is selected.  The IP address
    is used to determine the path of systems accepting RID
    communications that will be used to find the closest RID system to
    the source of an attack in which the IP address used by the source
    is believed to be valid and a Request message with MsgDestination
    set to 'InvestigationRequest' is used.  This is not to be confused
    with the IncidentSource class, as the defined value here is from
    an initial Request ('InvestigationRequest' or 'TraceRequest'), not the source used in a Result message.</t><t>ext-value.  An escape value used to extend this attribute.  All extensions shall specify the contents and meaning of the Node 
element of RIDPolicy.  See IODEF <xref target="RFC5070" />, Section 5.1, on extensibility. If the NodeName element of the Node class is used by an 
     extension, NodeName may contain an Internationalized Domain Name
    (IDN);  see <xref target="sec-i18n"/> for applicable requirements.  All extensions SHOULD use an IP address in the Address element of the Node class as the primary means of Node identification.</t>
</list></list>
<t>MsgType-ext</t><list><t>OPTIONAL.  STRING.  A means by which to extend the MsgType attribute.  See IODEF <xref target="RFC5070" />, Section 5.1.</t></list><t>MsgDestination-ext</t><list><t>OPTIONAL.  STRING.  A means by which to extend the MsgDestination attribute.  See IODEF <xref target="RFC5070" />, Section 5.1</t></list>
</list>
<section title="ReportSchema">
<t>The ReportSchema class is an aggregate class in the RIDPolicy class.  The
IODEF schema is the approved schema for inclusion in RID messages via the
ReportSchema class.
<figure title="The ReportSchema Class"  anchor="fig-reportschema">
  <artwork><![CDATA[
       +-------------------------+
       |      ReportSchema       |
       +-------------------------+
       |                         |
       |  ENUM Version           |
       |  STRING ext-Version     |<>---{1}-------[ XMLDocument   ]
       |  ENUM XMLSchemaID       |
       |  STRING ext-XMLSchemaID |<>---{0..1}----[ URL           ]
       |                         |
       |                         |<>---{0..*}----[ Signature     ]
       |                         |
       +-------------------------+
]]></artwork>
</figure>
</t> 
<t>The elements that constitute the ReportSchema class are as follows:</t><list><t>XMLDocument</t><list><t>One. &nbsp;The XMLDocument is a complete XML document defined by the iodef:ExtensionType class.  This class follows the guidelines in <xref target="RFC5070" />, Section 5, where the data type is set to 'xml' and meaning is set to 'xml' to include an XML document. </t></list><t>URL</t><list><t>Zero or One. &nbsp;URL.  A reference to the XML schema of the XML document included.  The URL data type is defined in <xref target="RFC5070" />, Section 2.15, as "xs:anyURI" in the schema.  The schemaLocation for IODEF is already included in the RID schema, so this is not necessary to include a URL for IODEF documents.  The list of registered schemas for inclusion will be maintained by IANA.</t></list>
<t>Signature</t><list><t>Zero to many.  The Signature uses the
    iodef:ExtensionType class to enable this element to contain a
    detached or enveloped signature.  This class follows the
    guidelines in <xref target="RFC5070" /> Section 5 where the data
    type is set to 'xml' and meaning is set to 'xml' to include an XML
    document.  This element is used to encapsulate the detached
    signature based on the iodef&wj;:RecordItem class within the IODEF
    document to verify the originator of the message or to include the
    enveloped signature.  If other schemas are used instead of IODEF,
    they MUST provide guidance on what class to use if a detached
    signature is provided for this purpose.</t></list><t>The
  ReportSchema class has four
  attributes:</t><t>Version</t><list><t>OPTIONAL. One. &nbsp;The Version
    attribute is the version number of the specified XML schema.  That
    schema must be an approved version of IODEF or a schema registered
    with IANA for use with RID.  The IANA registry for managing
    schemas other than IODEF is specified in <xref target="sec-iana"/>.</t>

<list><t>ext-value.  An escape value used to extend this attribute.  See IODEF <xref target="RFC5070" />, Section 5.1. </t></list></list>
<t>ext-Version</t><list><t>OPTIONAL. One. &nbsp;The ext-Version attribute is the version number of the included XML schema.  This attribute is used if a schema other than IODEF or an IANA-registered schema that has been added to the enumerated list for Version is included.  </t></list>
<t>XMLSchemaID</t><list><t>OPTIONAL. One. &nbsp;The XMLSchemaID attribute
    is the identifier, the defined namespace <xref target="XMLNames"
						  />, of the XML
    schema of the XML document included.  The XMLSchemaID and Version
    specify the format of the XMLDocument element.  The only permitted
    values, include the namespace for IODEF <xref target="RFC5070" />,
    "urn:ietf:params:xml:ns:iodef-1.0", any future IETF-approved
    versions of IODEF, and any namespace included in the IANA-managed
    list of registered schemas for use with RID.  The IANA registry
    for managing schemas other than IODEF is specified in <xref target="sec-iana"/>.</t><list>
<t>ext-value.  An escape value used to extend this attribute.  See IODEF <xref target="RFC5070" />, Section 5.1. </t></list></list>
<t>ext-XMLSchemaID</t><list><t>OPTIONAL. One. &nbsp;The ext-XMLSchemaID attribute is the identifier (defined namespace) of the XML schema of the XML document included.  The ext-XMLSchemaID and ext-Version specify the format of the XMLDocument element and are used if the included schema is not IODEF version 1.0 or an IANA-registered schema that has been added to the enumerated list for XMLSchemaID.</t></list>
</list>

</section>  
</section>

<section title="RequestStatus">
<t>The RequestStatus class is an aggregate class in the RID class.
<figure title="The RequestStatus Class"  anchor="fig-requeststatus">
  <artwork><![CDATA[
                    +--------------------------------+
                    | RequestStatus                  |
                    +--------------------------------+
                    |                                |
                    | ENUM restriction               |
                    | ENUM AuthorizationStatus       |
                    | ENUM Justification             |
                    | STRING ext-AuthorizationStatus |
                    | STRING ext-Justification       |
                    |                                |
                    +--------------------------------+]]></artwork>
</figure>
</t>
<t>The RequestStatus class has five attributes:</t>
<list><t>restriction</t><list><t>OPTIONAL.  ENUM.  This attribute indicates the disclosure guidelines to which the sender expects the recipient to adhere.  This guideline provides no real security since it is the choice of the recipient of the document to honor it.  This attribute follows the same guidelines as "restriction" used in IODEF.</t></list><t>AuthorizationStatus</t><list><t>One. &nbsp;REQUIRED.  ENUM.  The listed values are used to provide a response to the requesting CSIRT of the status of a Request, Report, or Query.</t>
<list style="numbers"><t>Approved.  The trace was approved and will
    begin in the current SP.</t><t>Denied.  The trace was denied in
    the current SP.  The next closest SP can use this message to
    filter traffic from the upstream SP using the example packet to
    help mitigate the effects of the attack as close to the source as
    possible.  The Acknowledgement message must be passed back to the
    originator and a Result message must be used from the closest SP to the
    source in order to indicate actions taken in the IODEF History class.</t><t>Pending.  Awaiting approval; a timeout period has been reached, which resulted in this Pending status and Acknowledgement message being generated.</t><t>ext-value.  An escape value used to extend this attribute.  See IODEF <xref target="RFC5070" />, Section 5.1.</t></list>

<t>Justification</t>
<list><t>OPTIONAL.  ENUM.  Provides a reason for a Denied or Pending message.</t>
<list style="numbers">
<t>SystemResource.  A resource issue exists on the systems that would be involved in the request.</t>
<t>Authentication.  The enveloped digital signature <xref target="RFC3275" /> failed to validate.</t>
<t>AuthenticationOrigin.  The detached digital signature for the original requestor on the RecordItem entry failed to validate.</t>
<t>Encryption.  The recipient was unable to decrypt the request, report, or query.</t>
<t>UnrecognizedFormat.  The format of the provided document was unrecognized.</t>
<t>CannotProcess.  The document could not be processed.  Reasons may include legal or policy decisions.  Resolution may require communication outside of this protocol to resolve legal or policy issues.  No further messages SHOULD be sent until resolved.</t><t>Other.  There were other reasons this request could not be processed.</t><t>ext-value.  An escape value used to extend this attribute.  See IODEF <xref target="RFC5070" />, Section 5.1.</t></list></list>
<t>AuthorizationStatus-ext</t><list><t>OPTIONAL.  STRING.  A means by which to extend the AuthorizationStatus attribute.  See IODEF <xref target="RFC5070" />, Section 5.1.</t></list><t>Justification-ext</t><list><t>OPTIONAL.  STRING.  A means by which to extend the Justification attribute.  See IODEF <xref target="RFC5070" />, Section 5.1.</t></list></list></list>
</section>  

<section title="IncidentSource">
<t>The IncidentSource class is an aggregate class in the RID class.
<figure title="The IncidentSource Class"  anchor="fig-incidentsource">
  <artwork><![CDATA[
       +-------------------+
       | IncidentSource    |
       +-------------------+
       |                   |
       | ENUM restriction  |
       |                   |<>-------------[ SourceFound    ]
       |                   |
       |                   |<>---{0..*}----[ Node           ]
       |                   |
       +-------------------+
]]></artwork>
</figure>
</t>
<t>The elements that constitute the IncidentSource class
  follow:</t><list><t>SourceFound</t><list><t>One. &nbsp;BOOLEAN.  The
      Source class indicates if a source was identified.  If the
      source was identified, it is listed in the Node element of this
      class.</t><t>True.  Source of incident was
      identified.</t><t>False.  Source of incident was not
      identified.</t></list><t>Node</t><list><t>Zero or many.  The
      Node class is used to identify a system identified as part of an
      incident.  If this element is used, the Address element of the
      Node element MUST contain the IP address of the system. If the
      NodeName element of the Node class is used, it contains a DNS
      domain name that has been checked to ensure that it resolved to
      that IP address when the check was performed.  See
  <xref target="sec-i18n"/> of this document for internationalization
  considerations for NodeName.  The base definition of this class from
  the IODEF (<xref target="RFC5070" />, Section 3.16) can be expanded to include other identifiers.</t></list><t>The IncidentSource class has one attribute:</t><t>restriction</t><list><t>OPTIONAL.  ENUM.  This attribute indicates the disclosure guidelines to which the sender expects the recipient to adhere.This guideline provides no real security since it is the choice of the recipient of the document to honor it.  This attribute follows the same guidelines as "restriction" used in IODEF.</t></list></list>
</section>  


<section title="RID Name Spaces">
<t>The RID schema declares a namespace of "urn:ietf:params:xml:ns:iodef-rid-2.0" and registers it per <xref target="RFC3688" />. Each IODEF-RID document MUST use the "iodef-rid-2.0" namespace in the top-level element RID-Document.  It can be referenced as follows:</t>
 <artwork><![CDATA[
<RID-Document version="2.0" lang="en-US" 
   xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-2.0"
   xmlns:xsi="http://www.w3c.org/2001/XMLSchema-instance"
   xsi:schemaLocation="urn:ietf:params:xml:ns:iodef-rid-2.0.xsd">]]></artwork>
</section> 

<section title="Encoding">
<t>RID documents MUST begin with an XML declaration and MUST
   specify the XML version used; also, the use of UTF-8 encoding is
   REQUIRED (<xref target="RFC3470" />, Section 4.4).  RID
   conforms to all XML data encoding conventions and constraints.</t>

   <t>The XML declaration with no character encoding will read as follows:</t>
 <artwork><![CDATA[
   <?xml version="1.0" encoding="UTF-8"?>

The following characters have special meaning in XML and MUST be
escaped with their entity reference equivalent: "&", "<", ">", "\""
(double quotation mark), and "'" (apostrophe).  These entity
references are "&amp;", "&lt;", "&gt;", "&quot;", and "&apos;",
respectively.
]]></artwork>
</section>

<!-- " -->

<section title="Including IODEF or Other XML Documents">
<t>In order to support the changing activity of CSIRTS, the RID schema can include an IODEF or other data
   model.  The IODEF is also extensible, enabling the schemas to evolve along with the needs of CSIRTs.
This section discusses how to include the IODEF XML document or other XML documents to leverage the security and trust relationships established through the use of RID.  These techniques are designed so that adding new data will not require a change to the RID schema.  This approach also supports the exchange of private XML documents relevant only to a closed consortium.  XML documents can be included through the ReportSchema class in the RIDPolicy class.  The XMLDocument attribute is set to 'xml' to allow for the inclusion of full IODEF or other XML documents.  The following guidelines MUST be followed:</t>
<list style="numbers">
<t>The included schema MUST define a separate namespace, such as the declared namespace for IODEF of "urn:ietf:params:xml:ns:iodef-1.0".</t>
<t>When a parser encounters an included XML document it
       does not understand, the included document MUST be ignored (and not
       processed), but the remainder of the document MUST be processed.
       Parsers will be able to identify the XML documents for which they
       have no processing logic through the namespace declaration.
       Parsers that encounter an unrecognized element in a namespace
       that they do support SHOULD reject the document as a syntax
       error.</t>
<t>Implementations SHOULD NOT download schemas at runtime due to the
       security implications, and included documents MUST NOT be required to
       provide a resolvable location of their schema.</t>
</list>
<t>The examples included in <xref target="sec-comm-exchanges" /> demonstrate how an IODEF document is included.  The included schema of IODEF is represented in ReportSchema as follows:</t><list>
<t>Version: "1.0"</t>
<t>XMLSchemaID: "urn:ietf:params:xml:ns:iodef-1.0"</t>
<t>URL: "http://www.iana.org/assignments/xml-registry/schema/iodef-1.0.xsd"</t>
</list>
<t>The URL is optionally included for IODEF since it is already in the RID schema, and the schemaLocation is defined. </t> 

<section title="Including XML Documents in RID" anchor="sec-CVRF">
<t>XML schemas may be registered for inclusion in a RID message.  This
   may include schemas other than IODEF or updated versions of IODEF.
   The registered IANA information for additional schemas MUST include
   the specification name, version, specification Uniform Resource
   Identifier (URI), and namespace.  The following provides an example
   of the necessary information for additional schemas beyond IODEF.
</t>
<t>Example Name (XXXX)</t>

<artwork><![CDATA[
   Schema Name:   XXXX_1.1
   Version:       1.1
   Namespace:     <registered namespace>
   Specification URI:  http://www.example.com/XXXX
]]></artwork>
<t>The version attribute of the ReportSchema class is populated with the
   approved versions of IODEF or any additional schemas registered by
   IANA; see <xref target="sec-iana"/>.</t>
<t>The XMLSchemaID of the ReportSchema class is populated with the
   namespace of the included schema.  The attribute enumeration values
   include the namespace for IODEF and any schema registered by IANA; see <xref target="sec-iana"/>.</t>
<t>The URL element of the ReportSchema class is populated with the
   Specification URI value of the included schema.</t>
</section>
</section>
</section>


<section title="RID Messages">
<t>The IODEF model is followed as specified in <xref target="RFC5070" /> for each of the RID message types. The RID schema is used in combination with IODEF documents to facilitate RID communications. Each message type varies slightly in format and purpose; hence, the requirements vary and are specified for each. All classes, elements, attributes, etc., that are defined in the IODEF-Document are valid in the context of a RID message; however, some listed as optional in IODEF are mandatory for RID as listed for each message type. The IODEF model MUST be fully implemented for RID messages that include IODEF payloads to ensure proper parsing of those messages.</t><t>Note: The implementation of RID may automate the ability to fill in the content required for each message type from packet input, incident data, situational awareness information, or default values such as those used in the EventData class.</t>


<section title="Request">
<t>Description: This message type is used to request assistance in a
  computer security investigation.  The investigation request may be
  directed to another party that can assist with forensics and continue
  the investigation (the incident may have originated on the SP
  network to which the Request was sent), or it may be directed to an
  SP to trace the traffic from an unknown source.   The Request
  message with MsgType set to 'InvestigationRequest' may leverage the
  existing bilateral peer relationships in order to notify the SP
  closest to the source of the valid traffic that some event occurred,
  which may be a security-related incident.  A Request message with
  the MsgType set to 'TraceRequest' may be sent to an upstream peer to
  trace back through the network to locate the source of malicious
  traffic. The following information is REQUIRED for Request messages
  and is provided through the following data structures:</t>

<t>RID Information:</t>
<list><t>RIDPolicy</t>
  <list><t>RID message type, IncidentID, and destination policy
      information</t>
  </list>
</list>
<t>IODEF Information:</t>

<list>
  <t>Timestamps (DetectTime, StartTime, EndTime, ReportTime).</t>
  <t>Incident Identifier (Incident class, IncidentID).</t>
  <t>Confidence rating of security incident (Impact and Confidence
    class).</t>
  <t>System class is used to list both the Source and Destination.</t>
  <t>Expectation class should be used to request any specific actions
    to be taken close to the source.</t>
  <t>Path information of nested RID systems, beginning with the
    request originator used in the trace using IODEF EventData with
    category set to 'infrastructure'.</t>
  <t>Event, Record, and RecordItem classes to include example packets
    and other information related to the incident.  Note: Event
    information included here requires a second instance of EventData
    in addition to that used to convey SP path contact
    information.</t>
</list>

<t>Standards for encryption and digital
  signatures <xref target="RFC3275" /> <xref target="XMLsig" />
  <xref target="XMLencrypt" />:</t>

<list>
  <t>Digital signature from initiating CSIRT or provider system sending the RID message, passed to all systems receiving the Request using a detached XML digital signature on a RecordItem entry, placed in an instance of the Signature element.</t>
  <t>Digital signature of sending CSIRT or SP for authenticity of the RID message, from the CSIRT or provider creating this message using an enveloped XML digital signature on the IODEF document, placed in an instance of the Signature element.</t>
  <t>XML encryption as required by policy, agreements, and data markers.</t>
</list>

<t>Security requirements include the ability to encrypt
  <xref target="XMLencrypt" /> the contents of the Request message
  using the public key of the destination RID system.  The incident
  number increases whether the Request message has the MsgDestination set to
  'InvestigationRequest' or 'TraceRequest' in order to ensure
  uniqueness within the system.  The relaying peers also append their
  Autonomous System (AS) or RID system information using the path
  information as the Request message was relayed through SPs.  This
  enables the response (Result message) to utilize the same path and
  trust relationships for the return message, indicating any actions
  taken.  The request is recorded in the state tables of both the
  initiating and destination SP RID systems.  The destination SP is
  responsible for any actions taken as a result of the request in
  adherence to any service level agreements or policies.  The SP MUST
  confirm that the traffic actually originated from the suspected
  system before taking any action and confirm the reason for the
  request.  The request may be sent directly to a known RID system or
  routed by the source address of the attack using the 
  MsgDestination of RIDPolicy set to 'SourceOfIncident'. Note: Any intermediate parties in a TraceRequest MUST be able to view RIDPolicy information of responding message types in order to properly direct RID messages.</t>

<t>A DDoS attack can have many sources, resulting in multiple traces to locate the sources of the attack.  It may be valid to continue multiple traces for a single attack.  The path information enables the administrators to determine if the exact trace already passed through a single network.  The Incident Identifier must also be used to identify multiple Requests from a single incident.  If a single Request results in divergent paths of Requests, a separate instance number MUST be used under the same IncidentID.  The IncidentID instance number of IODEF can be used to correlate related incident data that is part of a larger incident.</t>
</section> 

<section title="Acknowledgement">
<t>Description: The Acknowledgement is also used to provide a status
  to any message type and to provide a Justification if the message
  could not be processed for any reason.  This message is sent to the
  initiating RID system from the next upstream provider's application
  or system designated for accepting RID communications to provide
  information on the request status in the current SP.  </t><t>The
  following information is REQUIRED for Acknowledgement messages and
  is provided through the following data structures:</t>

<t>RID Information:</t><list><t>RIDPolicy</t><list><t>RID message type, IncidentID, and destination policy information</t></list><t>RequestStatus class:</t>
<list><t>Status of Request</t></list></list><t>Standards for encryption and digital signatures <xref target="RFC3275" />, <xref target="XMLsig" />, <xref target="XMLencrypt" />:</t><list><t>Digital signature of responding CSIRT or provider for authenticity of Trace Status Message, from the CSIRT or provider creating this message using an enveloped XML digital signature.
</t>
<t>XML encryption as required by policy, agreements, and data markers.</t>
</list><t>A message is sent back to the initiating CSIRT or provider's
  system; it accepts RID communications of the trace as status
  notification.  This message verifies that the next RID system in the
  path has received the message from the previous system in the path.
  This message also verifies that the trace is now continuing, has
  stopped, or is pending in the next upstream CSIRT or provider's RID
  system.  The Pending status is automatically generated after a
  2-minute timeout without system-predefined or administrator action
  to approve or disapprove the trace continuance.  If a Request is
  denied, the originator and sending peer (if they are not the same)
  MUST both receive the message.  This provides the sending peer with the option to take action to stop or mitigate the traffic as close to the source as possible.</t>
</section> 

<section title="Result">
<t>Description: This message indicates that the trace or investigation
  has been completed and provides the result.  The Result message
  includes information on whether or not a source was found, and the
  source information is provided through the IncidentSource class. The
  Result information MUST go back to the originating RID system that
  began the investigation or trace. A provider may use any number of
  incident-handling data sources to ascertain the true source of an
  attack. All of the possible information sources may or may not be
  readily tied into the RID communications system.</t><t>The following
  information is REQUIRED for Result messages and will be provided
  through the following data structures:</t>

<list><t>RID Information:</t><list><t>RIDPolicy</t><list><t>RID message type, IncidentID, and destination policy information</t></list><t>Incident Source</t><list><t>The IncidentSource class of the RID schema is used to note if a source was identified and provide the source address(es) or other Node information.</t></list>
</list>
<t>IODEF Information:</t><list>
	<t>Timestamps (DetectTime, StartTime, EndTime,
	ReportTime).</t><t>Incident Identifier (Incident class,
	IncidentID).</t><list><t>Trace number is used for multiple
	traces of a single incident; it MUST be included if the response
	is specific to an instance of an
	incident.</t></list><t>Confidence rating of security incident
	(Impact and Confidence class).</t><t>System class is used to
	list both the Source and Destination Information used in the
	attack and must note if the traffic is spoofed, thus requiring
	in RID an upstream Request set to
	'TraceRequest'.</t><t>History class "atype" attribute is used
	to note any actions taken.</t><t>History class also notes any
	other background information including notes about the
	Confidence level or rating of the result
	information.</t><t>Path information of nested RID systems,
	beginning with the request originator used in the trace using
	IODEF EventData with category set to 'infrastructure'.  The
	last SP listed is the SP that located the source of the
	traffic (the provider sending the Result
	message).</t><t>Event, Record, and RecordItem classes to
	include example packets and other information related to the
	incident (optional). Note: Event information included here requires a second instance of EventData in addition to that used to convey SP path contact information.</t></list><t>Standards for encryption and digital signatures <xref target="RFC3275" />, <xref target="XMLsig" />, <xref target="XMLencrypt" />:</t><list><t>Digital signature of source CSIRT or provider for authenticity of Result message, from the CSIRT or provider creating this message using an enveloped XML digital signature.</t>
<t>XML encryption as required by policy, agreements, and data markers.</t>
</list></list>

<t>
  A message is sent back to the initiating CSIRT or provider's RID
  system to notify the CSIRT that the source has been located.  The
  actual source information may or may not be included, depending on
  the policy of the network in which the client or host is attached.
  Any action taken by the SP to act upon the discovery of the source
  of a trace should be included.  The SP may be able to automate the
  adjustment of filters at their border router to block outbound
  access for the machine(s) discovered as a part of the attack.

 The filters may be comprehensive and block all Internet access until
 the host has taken the appropriate action to resolve any security
 issues.  The SP may be limited in their options for filtering due to
 agreements or other restrictions resulting in less comprehensive
 filters, such as rate-limiting the ingress traffic as close to the
 source as possible.
</t>

<t>Security and privacy requirements
  discussed in <xref target="sec-reqs"/> MUST be taken into account.</t><t>Note: The History class has been expanded in IODEF to accommodate all of the possible actions taken as a result of a RID Request using the "iodef:atype", or action type, attribute.  The History class should be used to note all actions taken close to the source of a trace or incident using the most appropriate option for the type of action along with a description.  The "atype" attribute in the Expectation class can also be used to request an appropriate action when a Request is made.</t>
</section> 


<section title="Report">
<t>Description: This message or document is sent to a RID system to
   provide a report of a security incident.  This message does not
   require any actions to be taken, except to file the report on the
   receiving RID system or associated database.</t>

   <t>The following information is REQUIRED for Report messages and will be
   provided through the following data structures:</t>
<list>
      <t>RID Information:</t>
<list>
         <t>RIDPolicy RID message type, IncidentID, and destination
            policy information</t></list>

   <t>The following data is RECOMMENDED if available and can be provided
   through the following data structures:</t>

      <t>IODEF Information:</t>
<list>
         <t>Timestamps (DetectTime, StartTime, EndTime, ReportTime).</t>

         <t>Incident Identifier (Incident class, IncidentID).
	   <list>
	     <t>
               Trace number is used for multiple traces of a single
               incident; it MUST be included if the Report is specific
               to an instance of an incident.
	     </t>
	   </list>
	 </t>

         <t>Confidence rating of security incident (Impact and Confidence
            class).</t>

         <t>System class is used to list both the Source and Destination
            Information used in the attack.</t>

         <t>Event, Record, and RecordItem classes are used to include example
            packets and other information related to the incident
            (optional).</t>
</list>
      <t>Standards for encryption and digital signatures <xref target="RFC3275" />, <xref target="XMLsig" />, <xref target="XMLencrypt" />:</t>
<list>
         <t>Digital signature from initiating RID system, passed to all
         systems receiving the report using an enveloped XML digital signature, placed in an instance of the Signature element.</t>
<t>XML encryption as required by policy, agreements, and data markers.</t>
</list>
</list>
   <t>Security requirements include the ability to encrypt
   <xref target="XMLencrypt" /> the contents of the Report message using the public key
   of the destination RID system.  Senders of a Report message should
   note that the information may be used to correlate security incident
   information for the purpose of trending, pattern detection, etc., and
   may be shared with other parties unless otherwise agreed upon with
   the receiving RID system.  Therefore, sending parties of a Report
   message may obfuscate or remove destination addresses or other
   sensitive information before sending a Report message.  A Report
   message may be sent either to file an incident report or to respond
   to a Query, and data sensitivity must be considered in both
   cases.  The SP path information is not necessary for this message, as
   it will be communicated directly between two trusted RID systems.</t>
</section> 


<section title="Query">
<t>Description: The Query message is used to request incident
   information from a trusted RID system.  The request can include the
   incident number, if known, or detailed information about the
   incident.  If the incident number is known, the Report message
   containing the incident information can easily be returned to the
   trusted requestor using automated methods.  If an example packet or
   other unique information is included in the Query, the return
   report may be automated; otherwise, analyst intervention may be
   required.</t>

   <t>The following information is REQUIRED for a Query message
   and is provided through the following data structures:</t>

<list>
      <t>RID Information:</t>
<list>
         <t>RIDPolicy</t>
<list>
            <t>RID message type, IncidentID, and destination
            policy information</t></list></list>

      <t>IODEF Information (optional):</t>
<list>
         <t>Timestamps (DetectTime, StartTime, EndTime, ReportTime).</t>

         <t>Incident Identifier (Incident class, IncidentID).</t>
            <list><t>Trace number is used for multiple traces of a single
            incident; it MUST be included if the Query is an instance of an incident.</t></list>

         <t>Confidence rating of security incident (Impact and Confidence
            class).</t>

         <t>System class is used to list both the Source and Destination
            Information used in the attack.</t>

         <t>Event, Record, and RecordItem classes are used to include example
            packets and other information related to the incident
            (optional).</t></list>

      <t>Standards for encryption and digital signatures <xref target="RFC3275" />, <xref target="XMLsig" />, <xref target="XMLencrypt" />:</t>
<list>
         <t>Digital signature from the CSIRT or SP initiating the RID message, passed to all
         systems receiving the Query using an enveloped XML digital
         signature, placed in an instance of the Signature element.</t>
<t>XML encryption as required by policy, agreements, and data markers.</t>
</list>
</list>

   <t>The proper response to the Query message is a Report message.
   Multiple incidents may be returned for a single query if an incident
   type is requested.  In this case, the receiving system sends an
   IODEF document containing multiple incidents or all instances of an
   incident.  The system sending the reply may preset a limit to the
   number of documents returned in one report.  The recommended limit
   is 5, to prevent the documents from becoming too large.  Other
   transfer methods may be better suited than RID for large transfers of
   data.  The Confidence rating may be used in the Query message
   to select only incidents with an equal or higher Confidence rating
   than what is specified.  This may be used for cases when information
   is gathered on a type of incident but not on specifics about a single
   incident.  Source and Destination Information may not be needed if
   the Query is intended to gather data about a specific type of
   incident.</t>
</section> 

</section>


<section title="RID Communication Exchanges" anchor="sec-comm-exchanges">
<t>The following section outlines the communication flows for RID and
   also provides examples of messages. </t>
<t>The possible set of message exchanges include:</t>

<list style="symbols">
<t>Request: Asynchronous Request for assistance and/or action to be taken, MAY involve multiple systems and iterative Requests</t><list style="empty">
<t>MsgType set to 'InvestigationRequest' or 'TraceRequest'</t>
<t>Possible responses:</t>
<list style="symbols">
<t>Acknowledgement (OPTIONAL for InvestigationRequest)</t>
<t>Result (REQUIRED unless Acknowledgement was set to 'no')</t>
<t>Report (OPTIONAL; zero or more; Report can be sent unsolicited)</t>
</list></list>

<t>Query: Synchronous request for information</t><list style="empty">
<t>MsgType set to 'Query'</t>
<t>Possible responses:</t>
<list style="symbols">
<t>Acknowledgement (OPTIONAL if yes; REQUIRED if no Report will be sent)</t>
<t>Report (REQUIRED unless Acknowledgement was set to 'no')</t>
</list></list>

<t>Report: Asynchronous information report; may be pushed to systems
  or may be a response to a Query</t><list style="empty">
<t>MsgType set to 'Report'</t>
<t>Possible responses:</t>
<list style="symbols">
<t>Acknowledgement (OPTIONAL)</t>
</list></list>
</list>

<t>Processing considerations for the IODEF document and any IODEF
  included elements or attributes MUST follow the guidelines specified
  in <xref target="RFC5070" />, Section 4.  <xref target="RFC3023" />
  and <xref target="RFC3470" /> specify requirements and best
  practices for the use of XML in IETF application protocols.  RID and
  IODEF documents MUST be well-formed (see <xref target="RFC3470" />, Section 4.1) and MUST be validated against the appropriate schema.  Internal or external DTD subsets are prohibited in RID; see <xref target="RFC3023" />, Section 3.</t>  

<t>Comments can be ignored by conform ant processors for RID or IODEF
  documents (see <xref target="RFC3470" />, Section 4.6) and are included below for informational purposes only.  The first example demonstrates the use of a detached digital signature.  Subsequent examples do not include the detached signature required for some message types.  The signature is applied after the message is created as demonstrated in the first example.</t>

<t>Note: For each example listed below, <xref target="RFC5735" /> addresses were used.
   Assume that each IP address listed is actually a separate network
   range held by different SPs.  Addresses were used from /27 network
   ranges.</t>

<section title="Upstream Trace Communication Flow">
<t>   The diagram below outlines the RID Request communication flow for a TraceRequest
   between RID systems on different networks tracing an attack.  The
   Request message with MsgDestination set to 'TraceRequest' is represented in
   the diagram by "TraceRequest".  SP-1, SP-2, and SP-3 represent service providers that are involved in the example trace communication flow.

<figure title="TraceRequest Communication Flow"  anchor="fig-tracerequestflow">
  <artwork><![CDATA[
 Attack Dest      SP-1            SP-2        SP-3        Attack Src

 1. Attack    |  Attack
    reported  |  detected

 2.              Initiate trace

 3.              Locate origin
                 through
                 upstream SP

 4.              o---TraceRequest----->

 5.                              Trace
                                 Initiated

 6.              <---Acknowledgement--o

 7.                              Locate origin
                                 through
                                 upstream SP

 8.                              o---TraceRequest--->

 9.                                             Trace Initiated

 10.             <----------Acknowledgement----o
                                  <-Acknowledgement-o

 11.                                            Locate attack
                                                source on network   X

 12.             <------------Result----------------o

 13.             o- - - - -Acknowledgement- - - - - >
]]></artwork>
</figure>
               
</t>
   <t>Before a trace is initiated, the RID system should verify that an
   instance of the trace or a similar request is not active.  The traces
   may be resource intensive; therefore, providers need to be able to
   detect potential abuse of the system or unintentional resource
   drains.  Information such as the Source and Destination Information,
   associated packets, and the incident may be desirable to maintain for
   a period of time determined by administrators.</t>

   <t>The communication flow demonstrates that an Acknowledgement
   message is sent to both the downstream peer and the original
   requestor.  If a Request in a traceback is denied, the downstream peer has the
   option to take an action and respond with a Result message.  The
   originator of the request may follow up with the downstream peer of
   the SP involved using a Request with the MsgType set to 'InvestigationRequest' to ensure that an
   action is taken if no response is received.  Nothing precludes the
   originator of the request from initiating a new Request with the
   MsgType set to 'TraceRequest' thereby
   bypassing the SP that denied the request, if a trace is needed beyond
   that point.  Another option may be for the initiator to send an
   'InvestigationRequest' to an SP upstream of the SP that denied the
   request.  This action assumes enough information was gathered to discern the true source
   of the attack traffic from the incident-handling information.</t>

<t>The proper response to a TraceRequest is an Acknowledgement message.  The	 		
   Acknowledgement message lets the requestor know if the trace  		
   will continue through the next upstream network.  If there is a	 		
   problem with the request, such as a failure to validate the digital	 		
   signature or decrypt the request, an Acknowledgement message MUST	 		
   be sent to the requestor and the downstream peer (if they are not one	 		
   and the same) providing the reason why the message could not be	 		
   processed.  Assuming that the trace continued, additional	 		
   TraceRequests with the response of an Acknowledgement message	 		
   would occur, thereby passing the request upstream in the path to the source of	 		
   the traffic related to the incident.  Once a source is found, a	 		
   Result message is sent to the originator of the trace, as determined	 		
   by the SP path information provided through the document instance of	 		
   EventData, where contact is set to 'infrastructure'.  The SP path	 		
   information is also used when sending the Acknowledgement	 		
   messages to the first entry (the trace originator) and the last	 		
   nested entry (the downstream peer).  The Result message is encrypted	 			
   <xref target="XMLencrypt" /> for the originator providing information about the	 		
   incident source and any actions taken.  If the originator fails to	 		
   decrypt or authenticate the Result message, an Acknowledgement	 		
   message is sent in response; otherwise, no return message is sent.  The final Acknowledgement to the Result message is depicted as optional in the diagram above.  If an Acknowledgement message is sent with the RequestStatus set	 		
   to Denied, a downstream peer receiving this message may choose to	 		
   take action to stop or mitigate the traffic at that point in the	 		
   network, as close to the source as possible.  If the downstream peer	 		
   chooses this option, it would send a Result message to the trace	 		
   originator.</t>

<section title="RID TraceRequest Example">
<t>The example listed is of a Request message with MsgDestination set to 'TraceRequest' based on the incident report
   example from the IODEF document.  The RID classes were
   included as appropriate for a Request message of this type using the
   RIDPolicy class.  The example given is that of a CSIRT reporting a
   DoS attack in progress to the upstream SP.  The request asks the next
   SP to continue the trace and have the traffic mitigated closer to the
   source of the traffic.  The example Request message is the first
   step of a TraceRequest as depicted in the previous diagram, where
   'Attack Dest' is represented by 192.0.2.67 (and SP-1).  The 'Attack
   Src' is later identified in the Result message example as
   192.0.2.37 and initially as tracing closer to 192.0.2.35.  SP-1
   is identified in the Request as CSIRT-FOR-OUR-DOMAIN, and SP-2 is
   identified in the RID document for the Request as the 'RIDSystem'
   in 'MsgDestination' as 192.0.2.3 using the Node class.  SP-3 is
   later used in the Result message and the administrator is
   identified as 'Admin-contact@10.1.1.2' as they searched for
   192.0.2.35; the administrator may be different than the
   constituency contact (an additional Request with MsgDestination set to
   'TraceRequest' occurred between SP-2 to SP-3 that is not included).
   SP-3 is the service provider for 192.0.2.32/27 and was able to take
   the action to rate-limit their traffic. The SP-1, SP-2, and SP-3
   information would be replaced with the appropriate (and valid)
   email and other contact information in real usages.  The Node class
   enables multiple methods to identify a system, such as a fully
   qualified domain name or the IP address to be provided for the SP.  Any
   mapping of existing relationships from the SP Node information to
   the name, contact, digital signature verification information and
   other identifying or trust information is provided at the
   application layer to support end users of the incident management
   system.  A packet is provided in this example to enable any traces
   to be performed by SP-2 and SP-3 to perform traces to the attack
   source before taking the requested action to 'rate-limit' the
   traffic.  The subnet of 192.0.2.0 uses a 27-bit mask in the examples below.</t>

   <t>In the following example, use of <xref target="XMLsig" /> to generate digital
   signatures follows the guidance of <xref target="XMLsig" /> 1.0.  Version 1.1 of <xref target="XMLsig" />
   supports additional digest algorithms.  Reference <xref target="RFC4051" /> for URIs intended for use with XML digital signatures, encryption, and canonicalization.  SHA-1 SHOULD NOT be used; see <xref target="RFC6194" /> for further details.</t>

<t>Note: Due to the limit of 72 characters per line, some line breaks were 
   added in the examples and schemas in this document.</t>

  <artwork><![CDATA[
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<iodef-rid:RID lang="en-US" 
 xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-2.0" 
 xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0" 
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="urn:ietf:params:xml:ns:iodef-rid-2.0">
 <iodef-rid:RIDPolicy MsgDestination="RIDSystem" MsgType="TraceRequest">
   <iodef-rid:PolicyRegion region="IntraConsortium"/>
     <iodef:Node>
      <iodef:Address category="ipv4-addr">192.0.2.3</iodef:Address>
     </iodef:Node>
     <iodef-rid:TrafficType type="Attack"/>
     <iodef:IncidentID name="CERT-FOR-OUR-DOMAIN">
            CERT-FOR-OUR-DOMAIN#207-1
     </iodef:IncidentID>
     <!-- IODEF-Document included in RID -->
     <iodef-rid:ReportSchema Version="1.0">
      <iodef-rid:XMLDocument dtype="xml" meaning="xml">
       <IODEF-Document lang="en">
        <iodef:Incident purpose="traceback" restriction="need-to-know">
          <iodef:IncidentID name="CERT-FOR-OUR-DOMAIN">
                           CERT-FOR-OUR-DOMAIN#207-1
          </iodef:IncidentID>
          <iodef:DetectTime>2004-02-02T22:49:24+00:00</iodef:DetectTime>
          <iodef:StartTime>2004-02-02T22:19:24+00:00</iodef:StartTime>
          <iodef:ReportTime>2004-02-02T23:20:24+00:00</iodef:ReportTime>
          <iodef:Description>
                           Host involved in DoS attack
          </iodef:Description>
          <iodef:Assessment>
            <iodef:Impact completion="failed" severity="low" 
                          type="dos"/>
          </iodef:Assessment>
          <iodef:Contact role="creator" type="organization">
            <iodef:ContactName>Constituency-contact for 192.0.2.35
            </iodef:ContactName>
            <iodef:Email>Constituency-contact@192.0.2.35</iodef:Email>
          </iodef:Contact>
          <iodef:EventData>
            <iodef:Flow>
              <iodef:System category="source">
                <iodef:Node>
                  <iodef:Address category="ipv4-addr">192.0.2.35
                  </iodef:Address>
                </iodef:Node>
                <iodef:Service ip_protocol="6">
                  <iodef:Port>38765</iodef:Port>
                </iodef:Service>
              </iodef:System>
              <iodef:System category="target">
                <iodef:Node>
                  <iodef:Address category="ipv4-addr">192.0.2.67
                  </iodef:Address>
                </iodef:Node>
                <iodef:Service ip_protocol="6">
                  <iodef:Port>80</iodef:Port>
                </iodef:Service>
              </iodef:System>
            </iodef:Flow>
            <iodef:Expectation action="rate-limit-host" severity="high">
              <iodef:Description>
                     Rate-limit traffic close to source
            </iodef:Description>
          </iodef:Expectation>
          <iodef:Record>
            <iodef:RecordData>
              <iodef:Description>
               The IPv4 packet included was used in the described attack
              </iodef:Description>
              <iodef:RecordItem dtype="ipv4-packet">450000522ad9
                0000ff06c41fc0a801020a010102976d0050103e020810d9
                4a1350021000ad6700005468616e6b20796f7520666f7220
                6361726566756c6c792072656164696e6720746869732052
                46432e0a
              </iodef:RecordItem>
             </iodef:RecordData>
            </iodef:Record>
           </iodef:EventData>
           <iodef:History>
             <iodef:HistoryItem action="rate-limit-host">
               <iodef:DateTime>
                      2001-09-14T08:19:01+00:00
               </iodef:DateTime>
               <iodef:IncidentID name="CSIRT-FOR-OUR-DOMAIN">
                      CSIRT-FOR-OUR-DOMAIN#207-1
               </iodef:IncidentID>
               <iodef:Description>
              Notification sent to next upstream SP closer to 192.0.2.35
               </iodef:Description>
              </iodef:HistoryItem>
             </iodef:History>
            </iodef:Incident>
           </IODEF-Document>
         </iodef-rid:XMLDocument>
       <!-- End of IODEF-Document included in RID -->
       <!-- Start of detached XML signature included in RID -->
       <iodef-rid:Signature dtype="xml" meaning="xml">
        <Signature xmlns="http://www.w3.org/2000/09/xmldsig#" 
                   Id="dsig-123456">
        <SignedInfo>
<CanonicalizationMethod 
  Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
<SignatureMethod 
  Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
    <Reference URI="">
    <Transforms>
     <Transform Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
     <Transform Algorithm="http://www.w3.org/2002/06/xmldsig-filter2">
     <XPath xmlns="http://www.w3.org/2002/06/xmldsig-filter2"
       xmlns:dsig="http://www.w3.org/2000/09/xmldsig#"
       xmlns:dsig-trans="http://www.w3.org/2002/06/xmldsig-filter2"
       Filter="intersect">
       //dsig:Signature[@Id = 'dsig-123456']/
       ancestor::iodef-rid:ReportSchema/
       iodef-rid:XMLDocument/IODEF-Document[1]/iodef:Incident[1]/
       iodef:EventData[1]/iodef:Record[1]/iodef:RecordData[1]/
       iodef:RecordItem[1]</XPath></Transform></Transforms>
    <DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
    <DigestValue>
       NQuIhPjdZuZJnPi/hW62dwJT1dR+vqcZV8mpemCVN5g=
    </DigestValue>
   </Reference></SignedInfo>
   <SignatureValue>
lnq/ePQ4AVpxCR0ifCp9sMsW0r/AdT3C2GR/zaN1V+hZ/NApOygUjMzTCQnx+RvGPNkO/RVq
BEIDgZQUEnQZn/uSbmr0tQ6xpBfaxF1DCosLgiZy+2jFzpXrwoN/jHNgtxR/9QLW9mZ+I7V6
LEEJ73Kut+d0naTGHlyi64ab2PqsVuRXQ4pXUKbhMkhzeTIqvFLK93KGfsIMd6Cb+n2u/ABy
Lkc+gflJYUWVP4DxkQ4cyex6hM6RYTRUSr7jVD9K4d8KFP2g85i69YLtSu01W1Np0afpJ4a9
MK0E7ISMNRmC8wIklCAsSXiBRqyaEwaSy/clybI0vCTPqGOYh3/SZg==
   </SignatureValue>
   <KeyInfo>
    <KeyValue>
      <RSAKeyValue>
       <Modulus>
z8adrX9m0S8OxIxN+fui33wiz4ZYgb4xPbR9MS5pOp1A8kVpH5Ew3N6O3/dMs2a4diIxyGLV
h0r86QXWH/W6T2IC2ny+hi+jWRwXrvgTY3ZAFgePvz2OdRhVN/cUbOto4Pa4I2mVZWW+/Q0F
n7YpqPBDDxlGq/xyFPuYq/4y7Y+Ah+vHO2ZSaiQjbj8F38XrGhwlcbFVyK8AmxK3z0zWwX86
uMEqVCjW6s6j2KAWdbAjEpgZHlJY87i/DqnFgxfmdg3oru+YeiEPVRY8hyQpYbtgryveZOHT
gnCHmS/53U9jSS0cyb/ADuj1upfyNoOiMMgQr7Olhc5pTvuWAl4Fnw==</Modulus>
       <Exponent>AQAB</Exponent>
      </RSAKeyValue>
      </KeyValue>
    </KeyInfo>
   </Signature>
  </iodef-rid:Signature>
  <!-- End of detached XML signature included in RID -->
      </iodef-rid:ReportSchema>
   </iodef-rid:RIDPolicy>
</iodef-rid:RID>
]]></artwork>

</section>
<section title="Acknowledgement Message Example">

   <t>The example Acknowledgement message is in response to the
   Request message listed above.  The SP that received the request
   is responding to approve the trace continuance in their network.</t>

<artwork><![CDATA[
<iodef-rid:RID lang="en"
               xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-2.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0">
  <iodef-rid:RIDPolicy MsgType="Acknowledgement"
                       MsgDestination="RIDSystem">
    <iodef-rid:PolicyRegion region="IntraConsortium"/>
    <iodef:Node>
      <iodef:Address category="ipv4-addr">192.0.2.67</iodef:Address>
    </iodef:Node>
    <iodef-rid:TrafficType type="Attack"/>
    <iodef:IncidentID name="CERT-FOR-OUR-DOMAIN">
      CERT-FOR-OUR-DOMAIN#207-1
    </iodef:IncidentID>
  </iodef-rid:RIDPolicy>
  <iodef-rid:RequestStatus AuthorizationStatus="Approved"/>
</iodef-rid:RID>
]]></artwork>

</section> 
<section title="Result Message Example">
<t>
   The example Result message is in response to the Request listed above.
   This message type only comes after an Acknowledgement within the
   Request flow of messages where a TraceRequest is in progress.  It
   may be a direct response to a Request with the MsgType set to
   'InvestigationRequest'.  This message provides information about
   the source of the attack and the actions taken to mitigate the
   traffic.  The Result message is typically the last message in a
   Request flow; however, an Acknowledgement MAY follow if there are
   any issues receiving or processing the Result.
</t>

<artwork><![CDATA[
<iodef-rid:RID lang="en"
               xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-2.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0">
  <iodef-rid:RIDPolicy MsgType="Result"
                       MsgDestination="RIDSystem">
    <iodef-rid:PolicyRegion region="IntraConsortium"/>
    <iodef:Node>
      <iodef:Address category="ipv4-addr">192.0.2.67</iodef:Address>
    </iodef:Node>
    <iodef-rid:TrafficType type="Attack"/>
    <iodef:IncidentID name="CERT-FOR-OUR-DOMAIN">
      CERT-FOR-OUR-DOMAIN#207-1
    </iodef:IncidentID>
<!-- IODEF-Document included in RID -->
    <iodef-rid:ReportSchema Version="1.0">
     <iodef-rid:XMLDocument dtype="xml" meaning="xml">
      <iodef:IODEF-Document lang="en">
      <iodef:Incident restriction="need-to-know" purpose="traceback">
        <iodef:IncidentID name="CERT-FOR-OUR-DOMAIN">
          CERT-FOR-OUR-DOMAIN#207-1
        </iodef:IncidentID>
      <iodef:DetectTime>2004-02-02T22:49:24+00:00</iodef:DetectTime>
      <iodef:StartTime>2004-02-02T22:19:24+00:00</iodef:StartTime>
      <iodef:ReportTime>2004-02-02T23:20:24+00:00</iodef:ReportTime>
      <iodef:Description>Host involved in DoS attack</iodef:Description>
      <iodef:Assessment>
        <iodef:Impact severity="low" completion="failed"
                      type="dos"/>
      </iodef:Assessment>
      <iodef:Contact role="creator" type="organization">
        <iodef:ContactName>Constituency-contact for 192.0.2.35
        </iodef:ContactName>
        <iodef:Email>Constituency-contact@192.0.2.35</iodef:Email>
      </iodef:Contact>
      <iodef:EventData>
        <iodef:Contact role="admin" type="organization">
          <iodef:ContactName>Admin-contact for 192.0.2.35
          </iodef:ContactName>
          <iodef:Email>Admin-contact@10.1.1.2</iodef:Email>
        </iodef:Contact>
        <iodef:Flow>
          <iodef:System category="intermediate">
            <iodef:Node>
              <iodef:Address category="ipv4-addr">192.0.2.35
              </iodef:Address>
            </iodef:Node>
          </iodef:System>
        </iodef:Flow>
        <iodef:EventData>
          <iodef:Contact role="admin" type="organization">
            <iodef:ContactName>Admin-contact for 192.0.2.3
            </iodef:ContactName>
            <iodef:Email>Admin-contact@192.0.2.3</iodef:Email>
          </iodef:Contact>
          <iodef:Flow>
            <iodef:System category="intermediate">
              <iodef:Node>
                <iodef:Address category="ipv4-addr">192.0.2.3
                </iodef:Address>
              </iodef:Node>
            </iodef:System>
          </iodef:Flow>
        </iodef:EventData>
      </iodef:EventData>
      <iodef:EventData>
        <iodef:Flow>
          <iodef:System category="source">
            <iodef:Node>
              <iodef:Address category="ipv4-addr">192.0.2.35
              </iodef:Address>
            </iodef:Node>
            <iodef:Service ip_protocol="6">
              <iodef:Port>38765</iodef:Port>
            </iodef:Service>
          </iodef:System>
          <iodef:System category="target">
            <iodef:Node>
              <iodef:Address category="ipv4-addr">192.0.2.67
              </iodef:Address>
            </iodef:Node>
            <iodef:Service ip_protocol="6">
              <iodef:Port>80</iodef:Port>
            </iodef:Service>
          </iodef:System>
        </iodef:Flow>
        <iodef:Expectation severity="high" action="rate-limit-host">
          <iodef:Description>
            Rate-limit traffic close to source
          </iodef:Description>
        </iodef:Expectation>
        <iodef:Record>
          <iodef:RecordData>
            <iodef:Description>
              The IPv4 packet included was used in the described attack
            </iodef:Description>
            <iodef:RecordItem dtype="ipv4-packet">450000522ad9
            0000ff06c41fc0a801020a010102976d0050103e020810d9
            4a1350021000ad6700005468616e6b20796f7520666f7220
            6361726566756c6c792072656164696e6720746869732052
            46432e0a
            </iodef:RecordItem>
          </iodef:RecordData>
        </iodef:Record>
      </iodef:EventData>
      <iodef:History>
        <iodef:HistoryItem action="rate-limit-host">
          <iodef:DateTime>2004-02-02T22:53:01+00:00</iodef:DateTime>
          <iodef:IncidentID name="CSIRT-FOR-OUR-DOMAIN">
            CSIRT-FOR-OUR-DOMAIN#207-1
          </iodef:IncidentID>
          <iodef:Description>
            Notification sent to next upstream SP closer to 192.0.2.35
          </iodef:Description>
        </iodef:HistoryItem>
        <iodef:HistoryItem action="rate-limit-host">
          <iodef:DateTime>2004-02-02T23:07:21+00:00</iodef:DateTime>
          <iodef:IncidentID name="CSIRT-FOR-SP3">
            CSIRT-FOR-SP3#3291-1
          </iodef:IncidentID>
          <iodef:Description>
            Host rate-limited for 24 hours
            </iodef:Description>
          </iodef:HistoryItem>
        </iodef:History>
      </iodef:Incident>
      </iodef:IODEF-Document>
     </iodef-rid:XMLDocument>
<!-- End of IODEF-Document included in RID -->
   </iodef-rid:ReportSchema>
  </iodef-rid:RIDPolicy>
  <iodef-rid:IncidentSource>
    <iodef-rid:SourceFound>true</iodef-rid:SourceFound>
    <iodef:Node>
      <iodef:Address category="ipv4-addr">192.0.2.37</iodef:Address>
    </iodef:Node>
  </iodef-rid:IncidentSource>
</iodef-rid:RID>

]]></artwork>

</section>
</section>

<section title="Investigation Request Communication Flow">
  <t>The diagram below outlines a RID Request
   communication flow between RID systems on different networks for a
   security incident with a known source address.  Therefore, MsgDestination is set to 'InvestigationRequest' for the Request message and is included in the diagram below as "Investigation".  The proper response
   to a Request with the MsgDestination set to 'InvestigationRequest' is a Result message.  If there is a
   problem with the Request, such as a failure to validate the digital
   signature or decrypt the Request, an Acknowledgement message is
   sent to the requestor.  The Acknowledgement message should
   provide the reason why the message could not be processed.

<figure title="Investigation Request Communication Flow"  anchor="fig-investigationrequestflow">
  <artwork><![CDATA[
    Attack Dest      SP-1              SP-2        Attack Src

    1. Attack    |  Attack
       reported  |  detected

    2.              Determine source
                    of security incident

    3.              o---Investigation---->

    4.                              Research
                                    incident and
                                    determine appropriate
                                    actions to take

    5.              <-------Result-------o
]]></artwork>
</figure>
</t>
<section title="Investigation Request Example">
   <t>The following example only includes the RID-specific details.  The
   IODEF and security measures are similar to the TraceRequest, with the exception that the source is known, the
   receiving RID system is known to be close to the source, and the MsgDestination is set to 'InvestigationRequest'.  The source
   known is indicated in the IODEF document, which allows for incident
   sources to be listed as spoofed, if appropriate.</t>
<t>This flow does not include a Result message because the request is denied as shown in the Acknowledgement response.</t>
<t>SP-1 is represented by CERT-FOR-OUR-DOMAIN and 192.0.2.67.  SP-2 is identified by 192,0.2.98.  In this example, SP-2 is the service provider for systems on the 192.0.2.32/27 subnet.  The contact for the host 192.0.2.35 is known at the start of the request as 'Constituency-contact@10.1.1.2'.</t>

<artwork><![CDATA[
<iodef-rid:RID lang="en"
               xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-2.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0">
  <iodef-rid:RIDPolicy MsgType="InvestigationRequest"
                       MsgDestination="SourceOfIncident">
    <iodef-rid:PolicyRegion region="PeerToPeer"/>
    <iodef:Node>
      <iodef:Address category="ipv4-addr">192.0.2.98</iodef:Address>
    </iodef:Node>
    <iodef-rid:TrafficType type="Attack"/>
    <iodef:IncidentID name="CERT-FOR-OUR-DOMAIN">
      CERT-FOR-OUR-DOMAIN#208-1
    </iodef:IncidentID>
<!-- IODEF-Document included in RID -->
    <iodef-rid:ReportSchema Version="1.0">
     <iodef-rid:XMLDocument dtype="xml" meaning="xml">
  <iodef:IODEF-Document lang="en">
  <iodef:Incident restriction="need-to-know" purpose="other">
    <iodef:IncidentID name="CERT-FOR-OUR-DOMAIN">
      CERT-FOR-OUR-DOMAIN#208-1
    </iodef:IncidentID>
    <iodef:DetectTime>2004-02-05T08:13:33+00:00</iodef:DetectTime>
    <iodef:StartTime>2004-02-05T08:13:31+00:00</iodef:StartTime>
    <iodef:EndTime>2004-02-05T08:13:33+00:00</iodef:EndTime>
    <iodef:ReportTime>2004-02-05T08:13:35+00:00</iodef:ReportTime>
    <iodef:Description>Host involved in DoS attack</iodef:Description>
    <iodef:Assessment>
      <iodef:Impact severity="low" completion="failed" type="recon"/>
    </iodef:Assessment>
    <iodef:Contact role="creator" type="organization">
      <iodef:ContactName>Constituency-contact for 192.0.2.35
      </iodef:ContactName>
      <iodef:Email>Constituency-contact@10.1.1.2</iodef:Email>
    </iodef:Contact>
    <iodef:EventData>
      <iodef:Flow>
        <iodef:System category="source">
          <iodef:Node>
            <iodef:Address category="ipv4-addr">192.0.2.35
            </iodef:Address>
          </iodef:Node>
          <iodef:Service ip_protocol="6">
            <iodef:Port>41421</iodef:Port>
          </iodef:Service>
        </iodef:System>
        <iodef:System category="target">
          <iodef:Node>
            <iodef:Address category="ipv4-addr">192.0.2.67
            </iodef:Address>
          </iodef:Node>
          <iodef:Service ip_protocol="6">
            <iodef:Port>80</iodef:Port>
          </iodef:Service>
        </iodef:System>
      </iodef:Flow>
      <iodef:Expectation severity="high" action="investigate">
        <iodef:Description>
          Investigate whether source has been compromised
        </iodef:Description>
      </iodef:Expectation>
    </iodef:EventData>
    <iodef:History>
      <iodef:HistoryItem action="block-host">
        <iodef:DateTime>2004-02-05T08:19:01+00:00</iodef:DateTime>
        <iodef:IncidentID name="CSIRT-FOR-OUR-DOMAIN">
          CSIRT-FOR-OUR-DOMAIN#208-1
        </iodef:IncidentID>
        <iodef:Description>
          Investigation request sent to SP for 192.0.2.35
        </iodef:Description>
      </iodef:HistoryItem>
    </iodef:History>
  </iodef:Incident>
  </iodef:IODEF-Document>
     </iodef-rid:XMLDocument>
<!-- End of IODEF-Document included in RID -->
    </iodef-rid:ReportSchema>
  </iodef-rid:RIDPolicy>
</iodef-rid:RID>

]]></artwork>
</section>

<section title="Acknowledgement Message Example">
   <t>The example Acknowledgement message is in response to the
   Request listed above.  The SP that received the request
   was unable to validate the digital signature used to authenticate the
   sending RID system.</t>

<artwork><![CDATA[
<iodef-rid:RID lang="en"
               xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-2.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0">
  <iodef-rid:RIDPolicy MsgType="Acknowledgement"
                       MsgDestination="RIDSystem">
    <iodef-rid:PolicyRegion region="IntraConsortium"/>
    <iodef:Node>
      <iodef:Address category="ipv4-addr">192.0.2.67</iodef:Address>
    </iodef:Node>
    <iodef-rid:TrafficType type="Attack"/>
    <iodef:IncidentID name="CERT-FOR-OUR-DOMAIN">
      CERT-FOR-OUR-DOMAIN#208-1
    </iodef:IncidentID>
  </iodef-rid:RIDPolicy>
  <iodef-rid:RequestStatus AuthorizationStatus="Denied"
                           Justification="Authentication"/>
</iodef-rid:RID>
]]></artwork>

</section>

</section>
<section title="Report Communication Flow">
   <t>The diagram below outlines the RID Report communication flow between
   RID systems on different SPs.

<figure title="Report Communication Flow"  anchor="fig-reportflow">
  <artwork><![CDATA[
        SP-1                           SP-2

     1. Generate incident information
        and prepare Report message

     2.              o-------Report------->

     3.                          File report in database

]]></artwork>
</figure>
</t>
   <t>The Report communication flow is used to provide information on
   incidents.  Incident information may
   be shared between CSIRTs or other entities using this
   format.  When a report is received, the RID system must verify that
   the report has not already been filed.  The incident number and
   incident data, such as the hexadecimal packet and incident class
   information, can be used to compare with existing database entries.
   The Report message typically does not have a response.  If there is a
   problem with the Report message, such as a failure to validate the
   digital signature <xref target="RFC3275" /> or decrypt the request, an
   Acknowledgement message is sent to the requestor.  The
   Acknowledgement message should provide the reason why the
   message could not be processed.</t>

<section title="Report Example">
   <t>The following example only includes the RID-specific details.  This
   report is an unsolicited Report message that includes an IPv4 packet.
   The IODEF document and digital signature is similar to the
   Request example with MsgDestination set to 'TraceRequest'.</t>
<t>This example is a message sent from SP-1, CERT-FOR-OUR-DOMAIN at 192.0.2.67, to SP-2 at 192.0.2.130 for informational purposes on an attack that took place.</t>

  <artwork><![CDATA[
<iodef-rid:RID lang="en"
               xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-2.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0">
  <iodef-rid:RIDPolicy MsgType="Report" MsgDestination="RIDSystem">
    <iodef-rid:PolicyRegion region="PeerToPeer"/>
    <iodef:Node>
      <iodef:Address category="ipv4-addr">192.0.2.130</iodef:Address>
    </iodef:Node>
    <iodef-rid:TrafficType type="Attack"/>
    <iodef:IncidentID name="CERT-FOR-OUR-DOMAIN">
      CERT-FOR-OUR-DOMAIN#209-1
    </iodef:IncidentID>
<!-- IODEF-Document included in RID -->
    <iodef-rid:ReportSchema>
     <iodef-rid:XMLDocument dtype="xml" meaning="xml">
  <iodef:IODEF-Document lang="en">
  <iodef:Incident restriction="need-to-know" purpose="reporting">
    <iodef:IncidentID name="CERT-FOR-OUR-DOMAIN">
      CERT-FOR-OUR-DOMAIN#209-1
    </iodef:IncidentID>
    <iodef:DetectTime>2004-02-05T10:21:08+00:00</iodef:DetectTime>
    <iodef:StartTime>2004-02-05T10:21:05+00:00</iodef:StartTime>
    <iodef:EndTime>2004-02-05T10:35:00+00:00</iodef:EndTime>
    <iodef:ReportTime>2004-02-05T10:27:38+00:00</iodef:ReportTime>
    <iodef:Description>Host illicitly accessed admin account
    </iodef:Description>
    <iodef:Assessment>
      <iodef:Impact severity="high" completion="succeeded"
                    type="admin"/>
      <iodef:Confidence rating="high"/>
    </iodef:Assessment>
    <iodef:Contact role="creator" type="organization">
      <iodef:ContactName>Constituency-contact for 192.0.2.35
      </iodef:ContactName>
      <iodef:Email>Constituency-contact@10.1.1.2</iodef:Email>
    </iodef:Contact>
    <iodef:EventData>
      <iodef:Flow>
        <iodef:System category="source">
          <iodef:Node>
            <iodef:Address category="ipv4-addr">192.0.2.35
            </iodef:Address>
          </iodef:Node>
          <iodef:Service ip_protocol="6">
            <iodef:Port>32821</iodef:Port>
          </iodef:Service>
        </iodef:System>
        <iodef:System category="target">
          <iodef:Node>
            <iodef:Address category="ipv4-addr">192.0.2.67
            </iodef:Address>
          </iodef:Node>
          <iodef:Service ip_protocol="6">
            <iodef:Port>22</iodef:Port>
          </iodef:Service>
        </iodef:System>
      </iodef:Flow>
    </iodef:EventData>
    <iodef:History>
      <iodef:HistoryItem action="rate-limit-host">
        <iodef:DateTime>2004-02-05T10:28:00+00:00</iodef:DateTime>
        <iodef:IncidentID name="CSIRT-FOR-OUR-DOMAIN">
          CSIRT-FOR-OUR-DOMAIN#209-1
        </iodef:IncidentID>
        <iodef:Description>
          Incident report sent to SP for 192.0.2.35
        </iodef:Description>
      </iodef:HistoryItem>
    </iodef:History>
  </iodef:Incident>
  </iodef:IODEF-Document>
     </iodef-rid:XMLDocument>
<!-- End of IODEF-Document included in RID -->
  </iodef-rid:ReportSchema>
  </iodef-rid:RIDPolicy>
</iodef-rid:RID>

]]></artwork>
</section>
</section>

<section title="Query Communication Flow">

   <t>The diagram below outlines the RID Query communication flow
   between RID systems on different networks.

<figure title="Query Communication Flow"  anchor="fig-incidentqueryflow">
  <artwork><![CDATA[
        SP-1                           SP-2

     1. Generate a request for
        information on a specific
        incident number or incident type

     2.              o-------Query------->

     3.                              Verify policy information
                                     and determine if matches exist
                                     for requested information

     4.              <-------Report------o

     5.  Associate report to request
         by incident number or type
         and file report(s).
]]></artwork>
</figure>

</t>
   <t>The Query message communication receives a response of a
   Report message.  If the Report message is empty, the responding host
   did not have information available to share with the requestor.  The
   incident number and responding RID system, as well as the transport,
   assist in the association of the request and response since a report
   can be filed and is not always solicited.  If there is a problem with
   the Query message, such as a failure to validate the digital
   signature or decrypt the request, an Acknowledgement message is
   sent to the requestor.  The Acknowledgement message should
   provide the reason why the message could not be processed.</t>

<section title="Query Example">
   <t>The Query request may be received in several formats as a
   result of the type of query being performed.  If the incident number
   is the only information provided, the IODEF document and IP packet
   data may not be needed to complete the request.  However, if a type
   of incident is requested, the incident number remains NULL, and the
   IP packet data will not be included in the IODEF RecordItem class;
   the other incident information is the main source for comparison.  In
   the case in which an incident number may not be the same between
   CSIRTs, the incident number and/or IP packet information can be
   provided and used for comparison on the receiving RID system to
   generate (a) Report message(s).</t>
<t>This query is sent to 192.0.2.3, inquiring about the incident with the identifier CERT-FOR-OUR-DOMAIN#210-1.  The Report will be provided to the requestor identified and verified through the authentication and digital signature information provided in the RID message.  An example Report is provided above.</t>

  <artwork><![CDATA[
<iodef-rid:RID lang="en"
               xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-2.0"
               xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0">
  <iodef-rid:RIDPolicy MsgType="Query"
                       MsgDestination="RIDSystem">
    <iodef-rid:PolicyRegion region="PeerToPeer"/>
    <iodef:Node>
      <iodef:Address category="ipv4-addr">192.0.2.3</iodef:Address>
    </iodef:Node>
    <iodef-rid:TrafficType type="Attack"/>
    <iodef:IncidentID name="CERT-FOR-OUR-DOMAIN">
      CERT-FOR-OUR-DOMAIN#210-1
    </iodef:IncidentID>
  </iodef-rid:RIDPolicy>
</iodef-rid:RID>
]]></artwork>

</section>
</section>
</section> 

<section title="RID Schema Definition" anchor="sec-schema-def">
 <artwork><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
 <xs:schema xmlns:iodef-rid="urn:ietf:params:xml:ns:iodef-rid-2.0"
  xmlns:iodef="urn:ietf:params:xml:ns:iodef-1.0"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
  targetNamespace="urn:ietf:params:xml:ns:iodef-rid-2.0"
  elementFormDefault="qualified" attributeFormDefault="unqualified">
 <xs:import namespace="urn:ietf:params:xml:ns:iodef-1.0"
 schemaLocation="http://www.iana.org/assignments/xml-registry/schema/
 iodef-1.0.xsd"/>
 <xs:import namespace="http://www.w3.org/2000/09/xmldsig#"
 schemaLocation="http://www.w3.org/TR/xmldsig-core/
 xmldsig-core-schema.xsd"/>

 <!-- ****************************************************************
 *********************************************************************
 ***  Real-time Inter-network Defense - RID XML Schema             ***
 ***    Namespace - iodef-rid, April 2012                        ***
 ***    The namespace is defined to support transport of IODEF     ***
 ***     documents for exchanging incident information.            ***
 *********************************************************************
 -->
 <!--RID messages act as an envelope for IODEF and RID documents
     to support the exchange of incident information-->
 <!--
 ====== Real-Time Inter-network Defense - RID ======
 ====  Suggested definition for RID messaging ======
  -->

 <xs:annotation>
   <xs:documentation>XML Schema wrapper for IODEF</xs:documentation>
 </xs:annotation>
 <xs:element name="RID" type="iodef-rid:RIDType"/>
   <xs:complexType name="RIDType">
     <xs:sequence>
       <xs:element ref="iodef-rid:RIDPolicy" minOccurs="0"/>
       <xs:element ref="iodef-rid:RequestStatus" minOccurs="0"/>
       <xs:element ref="iodef-rid:IncidentSource" minOccurs="0"/>
     </xs:sequence>
     <xs:attribute name="lang"
                    type="xs:language" use="required"/>
   </xs:complexType>

 <!--Used in Acknowledgement Message for RID-->

 <xs:element name="RequestStatus" type="iodef-rid:RequestStatusType"/>
   <xs:complexType name="RequestStatusType">
      <xs:attribute name="AuthorizationStatus" use="required">
         <xs:simpleType>
           <xs:restriction base="xs:NMTOKEN">
           <xs:whiteSpace value="collapse"/>
             <xs:enumeration value="Approved"/>
             <xs:enumeration value="Denied"/>
             <xs:enumeration value="Pending"/>
             <xs:enumeration value="ext-value"/>
           </xs:restriction>
         </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="ext-AuthorizationStatus"
                    type="xs:string" use="optional"/>
      <xs:attribute name="Justification">
         <xs:simpleType>
           <xs:restriction base="xs:NMTOKEN">
           <xs:whiteSpace value="collapse"/>
             <xs:enumeration value="SystemResource"/>
             <xs:enumeration value="Authentication"/>
             <xs:enumeration value="AuthenticationOrigin"/>
             <xs:enumeration value="Encryption"/>
             <xs:enumeration value="UnrecognizedFormat"/>
             <xs:enumeration value="CannotProcess"/>
             <xs:enumeration value="Other"/>
             <xs:enumeration value="ext-value"/>
           </xs:restriction>
         </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="ext-Justification"
                    type="xs:string" use="optional"/>
     <xs:attribute name="restriction" type="iodef:restriction-type"/>
   </xs:complexType>

 <!--Incident Source Information for Result Message-->

 <xs:element name="IncidentSource" type="iodef-rid:IncidentSourceType"/>
   <xs:complexType name="IncidentSourceType">
     <xs:sequence>
       <xs:element ref="iodef-rid:SourceFound"/>
       <xs:element ref="iodef:Node" minOccurs="0"
           maxOccurs="unbounded"/>
     </xs:sequence>
     <xs:attribute name="restriction" type="iodef:restriction-type"/>
   </xs:complexType>
   <xs:element name="SourceFound" type="xs:boolean"/>

 <!--
 ====== Real-Time Inter-network Defense Policy - RIDPolicy ======
 ======  Definition for RIDPolicy for messaging
  -->

 <xs:annotation>
  <xs:documentation>RID Policy used for transport of
      messages</xs:documentation>
 </xs:annotation>

 <!-- RIDPolicy information with setting information listed in RID
      documentation -->

 <xs:element name="RIDPolicy" type="iodef-rid:RIDPolicyType"/>
   <xs:complexType name="RIDPolicyType">
     <xs:sequence>
       <xs:element ref="iodef-rid:PolicyRegion" maxOccurs="unbounded"/>
       <xs:element ref="iodef:Node"/>
       <xs:element ref="iodef-rid:TrafficType" maxOccurs="unbounded"/>
       <xs:element ref="iodef:IncidentID" minOccurs="0"/>
       <xs:element ref="iodef-rid:ReportSchema" minOccurs="0"/>
     </xs:sequence>
    <xs:attribute name="MsgType" use="required">
     <xs:simpleType>
       <xs:restriction base="xs:NMTOKEN">
       <xs:whiteSpace value="collapse"/>
         <xs:enumeration value="TraceRequest"/>
         <xs:enumeration value="Acknowledgement"/>
         <xs:enumeration value="Result"/>
         <xs:enumeration value="InvestigationRequest"/>
         <xs:enumeration value="Report"/>
         <xs:enumeration value="Query"/>
         <xs:enumeration value="ext-value"/>
       </xs:restriction>
     </xs:simpleType>
    </xs:attribute>
   <xs:attribute name="ext-MsgType" type="xs:string" use="optional"/>
   <xs:attribute name="MsgDestination" use="required">
     <xs:simpleType>
       <xs:restriction base="xs:NMTOKEN">
       <xs:whiteSpace value="collapse"/>
         <xs:enumeration value="RIDSystem"/>
         <xs:enumeration value="SourceOfIncident"/>
         <xs:enumeration value="ext-value"/>
       </xs:restriction>
     </xs:simpleType>
    </xs:attribute>
   <xs:attribute name="ext-MsgDestination" type="xs:string"
                 use="optional"/>
   <xs:attribute name="restriction" type="iodef:restriction-type"/>
    </xs:complexType>
   <xs:element name="PolicyRegion">
     <xs:complexType>
      <xs:attribute name="region" use="required">
       <xs:simpleType>
        <xs:restriction base="xs:NMTOKEN">
        <xs:whiteSpace value="collapse"/>
          <xs:enumeration value="ClientToSP"/>
          <xs:enumeration value="SPToClient"/>
          <xs:enumeration value="IntraConsortium"/>
          <xs:enumeration value="PeerToPeer"/>
          <xs:enumeration value="BetweenConsortiums"/>
          <xs:enumeration value="ext-value"/>
        </xs:restriction>
       </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="ext-region"
                    type="xs:string" use="optional"/>
     </xs:complexType>
   </xs:element>
   <xs:element name="TrafficType">
     <xs:complexType>
      <xs:attribute name="type" use="required">
       <xs:simpleType>
        <xs:restriction base="xs:NMTOKEN">
        <xs:whiteSpace value="collapse"/>
          <xs:enumeration value="Attack"/>
          <xs:enumeration value="Network"/>
          <xs:enumeration value="Content"/>
          <xs:enumeration value="DataWithHandlingRequirements"/>
          <xs:enumeration value="AudienceRestriction"/>
          <xs:enumeration value="Other"/>
          <xs:enumeration value="ext-value"/>
        </xs:restriction>
       </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="ext-type"
                    type="xs:string" use="optional"/>
     </xs:complexType>
   </xs:element>
 <!--Used to include an enveloped XML document in RID-->
 <xs:element name="ReportSchema" type="iodef-rid:ReportSchemaType"/>
   <xs:complexType name="ReportSchemaType">
     <xs:sequence>
       <xs:element ref="iodef-rid:XMLDocument" minOccurs="1" 
                   maxOccurs="1"/>
       <xs:element ref="iodef-rid:URL" minOccurs="0" 
                   maxOccurs="1"/>
       <xs:element ref="iodef-rid:Signature" minOccurs="0" 
                   maxOccurs="unbounded"/>
     </xs:sequence>
      <xs:attribute name="Version" use="optional">
       <xs:simpleType>
        <xs:restriction base="xs:NMTOKEN">
        <xs:whiteSpace value="collapse"/>
          <xs:enumeration value="1.0"/>
               <xs:enumeration value="ext-value"/>
        </xs:restriction>
       </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="ext-Version"
                    type="xs:string" use="optional"/>
      <xs:attribute name="XMLSchemaID" use="optional">
       <xs:simpleType>
        <xs:restriction base="xs:anyURI">
        <xs:whiteSpace value="collapse"/>
          <xs:enumeration value="urn:ietf:params:xml:ns:iodef-1.0"/> 
               <xs:enumeration value="ext-value"/>
        </xs:restriction>
       </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="ext-XMLSchemaID"
                    type="xs:string" use="optional"/>
     </xs:complexType>
   <xs:element name="XMLDocument"
               type="iodef:ExtensionType"/>
   <xs:element name="URL"
               type="xs:anyURI"/>
   <xs:element name="Signature"
               type="iodef:ExtensionType"/>
 </xs:schema>
]]></artwork>
</section>


<section title="Security Requirements" anchor="sec-reqs">
<section title="XML Digital Signatures and Encryption" anchor="sec-encryption">

<t>RID leverages existing security standards and data markings in RIDPolicy to achieve the required levels of security for the exchange of incident information.  The use of standards includes TLS and the XML
   security features of encryption <xref target="XMLencrypt" /> and digital signatures
   <xref target="RFC3275" /> <xref target="XMLsig" />.  The standards provide clear methods to ensure that
   messages are secure, authenticated, and authorized; meet policy and privacy guidelines; and maintain integrity.  XML Signature Best Practices <xref target="XMLSigBP" /> should be referenced by implementers for information on improving security to mitigate attacks.</t>

   <t>As specified in the relevant sections of this document, the XML
   digital signature <xref target="RFC3275" /> and XML encryption <xref target="XMLencrypt" /> are used
   in the following cases:</t>

   <t>XML Digital Signature</t>

<list style="symbols">

      <t>The originator of a Request MUST
      use a detached signature to sign at least one of the original elements contained in the RecordItem class to provide
      authentication to all upstream participants in the trace or those involved in the investigation.  All instances of RecordItem provided by the originator may be individually signed,
      and additional RecordItem entries by upstream peers in the trace or investigation may be
      signed by the peer adding the data, while maintaining the original RecordItem entry(s) and detached signature(s) from the original requestor.  It is important to note that the data is signed at the RecordItem level.  Since multiple RecordItems may exist within an IODEF document and may originate from different sources, the signature is applied at the RecordItem level to enable the use of an XML detached signature.  Exclusive canonicalization <xref target="XMLCanon" /> is REQUIRED for the detached signature and not the references, as the XML document generated is then included in the RID message within the Signature element of the ReportSchema class.   This
      signature MUST be passed to all recipients of the Request message.</t>  

<t>If a Request does not include a RecordItem entry, a timestamp MUST
  be used to ensure there is data to be signed for the multi-hop
  authentication use case.  The DateTime element of the
  iodef:RecordData class (<xref target="RFC5070" />, Section 3.19.1) is used for this purpose.</t>

      <t>For all message types, the full IODEF-RID document MUST be signed
      using an enveloped signature by the sending peer to provide
      authentication and integrity to the receiving RID system.  The signature is placed in an instance of the Signature element.</t>

<t>XML Signature Best Practices <xref target="XMLSigBP" /> guidance
  SHOULD be followed to prevent or mitigate security risks.  Examples
  include the recommendation to authenticate a signature prior to
  processing (executing potentially dangerous operations) and the
  recommendation to limit the use of URIs since they may enable cross-site scripting attacks or access to local information.</t>

<t>XML Path Language (XPath) 2.0 <xref target="XMLPath" /> MUST be followed to specify the portion of the XML document to be signed.  XPath is used to specify a location within an XML document.  Best practice recommendations for using XPath <xref target="XMLSigBP" /> SHOULD be referenced to reduce the risk of denial-of-service attacks.  The use of XSLT transforms MUST be restricted according to security guidance in <xref target="XMLSigBP" />.</t>
</list>

   <t>XML Encryption</t>

<list style="symbols">
      <t>The IODEF-RID document MAY be encrypted to provide an extra layer
      of security between peers so that not only the message is 
      encrypted for transport.  This behavior would be agreed upon between peers or a consortium, or determined
      on a per-message basis, depending on security requirements.  It
      should be noted that there are cases for transport where the
      RIDPolicy class needs to be presented in clear text, as detailed
      in the transport document <xref target="RFC6546" />.</t>

      <t>A Request, or any other message type that may be
      relayed through RID systems before reaching the intended destination as
      a result of trust relationships, MAY be encrypted specifically for the intended
      recipient.  This may be necessary if the RID network is being used
      for message transfer, the intermediate parties do not need to have
      knowledge of the request contents, and a direct communication path
      does not exist.  In that case, the RIDPolicy class is used by
      intermediate parties and as such, RIDPolicy is maintained in clear text.</t>

      <t>The action taken in the Result message may be encrypted using the
      key of the request originator.  In that case, the intermediate
      parties can view the RIDPolicy information and know the trace has
      been completed and do not need to see the action.  If the use of
      encryption were limited to sections of the message, the History
      class information would be encrypted.  Otherwise, it is
      RECOMMENDED to encrypt the entire IODEF-RID document and use an
      enveloped signature for the originator of the request.  The
      existence of the Result message for an incident would tell any
      intermediate parties used in the path of the incident
      investigation that the incident handling has been completed.</t>

<t>The iodef:restriction attribute sets expectations for the privacy
  of an incident and is defined in Section 3.2 of RFC 5070.  Following the guidance for XML encryption in the Security Requirements section, the iodef:restriction attribute can be set in any of the RID classes to define restrictions and encryption requirements for the exchange of incident information.  The restriction options enable encryption capabilities for the complete exchange of an IODEF document (including any extensions), within specific classes of IODEF, or IODEF extensions, where more limited restrictions are desired.  The restriction attribute is contained in each of the RID classes and MUST be used in accordance with confidentiality expectations for either sections of the IODEF document or the complete IODEF document.  Consortiums and organizations should consider this guidance when creating exchange policies.</t>
<t>Expectations based on how restriction is set:</t>
<list style="symbols">
<t>If restriction is set to 'private', the class or document MUST be
  encrypted for the recipient using XML encryption and the public key
  of the recipient.  See <xref target="sec-pki"/> for a discussion on public key infrastructure (PKI) and other security requirements.</t>
<t>If restriction is set to 'need-to-know', the class or document MUST
  be encrypted to ensure only those with need-to-know access can
  decrypt the data.  The document can either be encrypted for each
  individual for which access is intended or be encrypted with a
  single group key.  The method used SHOULD adhere to any certificate
  policy and practices agreements between entities for the use of RID.
  A group key in this instance refers to a single key (symmetric) that
  is used to encrypt the block of data.  The users with need-to-know
  access privileges may be given access to the shared key via a secure
  distribution method, for example, providing access to the symmetric
  key encrypted with each of the user's public keys.</t>
<t>If restriction is set to 'public', the class or document MUST be sent in clear text.  This setting can be critical if certain sections of a document or an entire document are to be shared without restrictions.  This provides flexibility within an incident to share certain information freely where appropriate.</t>
<t>If restriction is set to 'default', the information can be shared according to an information disclosure policy pre-arranged by the communicating parties.</t>
</list>
<t>Expectations based on placement of the restriction setting:</t>
<list style="symbols">
<t>If restriction is set within one of the RID classes, the restriction applies to the entire IODEF document.</t>
<t>If restriction is set within individual IODEF classes, the restriction applies to the specific IODEF class and the children of that class.</t>
</list>

</list>

   <t>The formation of policies is a very important aspect of using a
   messaging system like RID to exchange potentially sensitive
   information.  Many considerations should be involved for peering
   parties, and some guidelines to protect the data, systems, and
   transport are covered in this section.  Policies established should
   provide guidelines for communication methods, security, and fall-back
   procedures.  See Sections <xref target="sec-consortiums" format="counter"/> and <xref target="sec-privacy" format="counter"/> for additional information on consortiums and PKI considerations.</t>

   <t>The security considerations for the storage and exchange of
   information in RID messaging may include adherence to local,
   regional, or national regulations in addition to the obligations to
   protect client information during an investigation.  RIDPolicy is a
   necessary tool for listing the requirements of messages to provide a
   method to categorize data elements for proper handling.  Controls are
   also provided for the sending entity to protect messages from third
   parties through XML encryption.</t>

   <t>RID provides a method to exchange incident-handling requests and
   Report messages between entities.  Administrators have
   the ability to base decisions on the available resources and other
   factors of their network and maintain control of incident investigations
   within their own network.  Thus, RID provides the ability for
   participating networks to manage their own security controls,
   leveraging the information listed in RIDPolicy.</t>

<t>RID is used to transfer or exchange XML documents in an IODEF format or using another IANA-registered format.  Implementations SHOULD NOT download schemas at runtime due to the
       security implications, and included documents MUST NOT be required to
       provide a resolvable location of their schema.</t>

</section>

<section title="Message Transport">
   <t>A transport specification is defined in a separate document
   <xref target="RFC6546" />.  The specified transport protocols MUST use encryption to
   provide an additional level of security and integrity, while
   supporting mutual authentication through bidirectional certificate
   usage.  Any subsequent transport method defined should take advantage
   of existing standards for ease of implementation and integration of
   RID systems.  Session encryption for the transport of RID messages is
   enforced in the transport specification.  The privacy and security
   considerations are addressed fully in RID to protect sensitive
   portions of documents and to provide a method to authenticate the
   messages.  Therefore, RID messages do not rely on the security
   provided by the transport layer alone.  The encryption requirements
   and considerations for RID messages are discussed in
   <xref target="sec-encryption"/> of this document.</t>

   <t>Consortiums may vary their selected transport
   mechanisms and thus decide upon a mutual protocol to use for
   transport when communicating with peers in a neighboring consortium
   using RID.  RID systems MUST implement and deploy HTTPS as defined in
   the transport document <xref target="RFC6546" /> and optionally MAY
   support other
   protocols such as the Blocks Extensible Exchange Protocol (BEEP) <xref target="RFC3080" />.  Bindings would need to be defined to enable support for other transport protocols.</t>
 
  <t>Systems used to send authenticated RID messages between networks MUST
   use a secured system and interface to connect to a border network's
   RID systems.  Each connection to a RID system MUST meet the security
   requirements agreed upon through the consortium regulations, peering,
   or SLAs.  The RID system MUST listen for and send RID messages
   on only the designated port, which also MUST be over an encrypted tunnel
   meeting the minimum requirement of algorithms and key lengths
   established by the consortium, peering, or SLA.  The selected
   cryptographic algorithms for symmetric encryption, digital
   signatures, and hash functions MUST meet minimum security levels of
   the times.  The encryption strength MUST adhere to import and export
   regulations of the involved countries for data exchange.</t>

   <t>Out-of-band communications dedicated to SP interaction for RID
   messaging would provide additional security as well as guaranteed
   bandwidth during a denial-of-service attack.  For example, an out-of-
   band channel may consist of logical paths defined over the existing
   network.  Out-of-band communications may not be practical or possible between service providers, but provisions should be considered to protect the incident
   management systems used for RID messaging.  Methods to protect the
   data transport may also be provided through session encryption.</t>

</section>

<section title="Public Key Infrastructure" anchor="sec-pki">

   <t>It is RECOMMENDED that RID, the XML security functions, and transport protocols
   properly integrate with a PKI managed by
   the consortium, federate PKIs within a consortium, or use a PKI managed by a trusted third party.  Entities MAY use shared keys as an alternate solution, although this may limit the ability to validate certificates and could introduce risk.  For the Internet,
   a few examples of existing efforts that could be leveraged to provide
   the supporting PKI include the Regional Internet Registry's (RIR's) PKI
   hierarchy, vendor issued certificates, or approved issuers of Extended Validation (EV) Certificates.  Security and privacy considerations related to
   consortiums are discussed in Sections <xref target="sec-consortiums" format="counter"/> and <xref target="sec-privacy" format="counter"/>.</t>

<t>The use of PKI between entities or by a consortium SHOULD adhere to any applicable certificate policy and practices agreements for the use of RID.  <xref target="RFC3647" /> specifies a commonly used format for certificate policy (CP) and certification practices statements (CPS).  Systems with predefined relationships for RID
   include those who peer directly or through a consortium with agreed-upon
   appropriate use agreements.  The agreements to trust other entities
   may be based on assurance levels that could be determined by a
   comparison of the CP, CPS, and/or RID operating procedures.  The
   initial comparison of policies and the ability to audit controls provide a baseline assurance level for entities to form and maintain trust relationships.  Trust relationships may also be defined through a bridged or hierarchical
   PKI in which both peers belong.  If shared keys or keys issued from a common CA are used, the verification of controls to determine the assurance level to trust other entities may be limited to the RID policies and operating procedures.</t>

   <t>XML security
   functions utilized in RID require a trust center such as a PKI for
   the distribution of credentials to provide the necessary level of
   security for this protocol.  Layered transport protocols also utilize
   encryption and rely on a trust center.  Public key certificate pairs
   issued by a trusted Certification Authority (CA) MAY be used to
   provide the necessary level of authentication and encryption for the
   RID protocol.  The CA used for RID messaging must be trusted by all
   involved parties and may take advantage of similar efforts, such as
   the Internet2 federated PKI or the ARIN/RIR effort to provide a PKI
   to service providers.  The PKI used for authentication also
   provides the necessary certificates needed for encryption used for the
   RID transport protocol <xref target="RFC6546" />.</t>


<section title="Authentication">

   <t>Hosts receiving a RID message MUST be able to verify that the sender
   of the request is valid and trusted.  Using digital signatures on a
   hash of the RID message with an X.509 version 3 certificate issued by
   a trusted party MUST be used to authenticate the request.  The X.509
   version 3 specifications as well as the digital signature
   specifications and path validation standards set forth in <xref target="RFC5280" />
   MUST be followed in order to interoperate with a PKI designed for
   similar purposes.  Full path validation verifies
   the chaining relationship to a trusted root and also performs a
   certificate revocation check.  
The use of digital signatures in RID XML messages MUST follow the World
   Wide Web Consortium (W3C) recommendations for signature syntax and
   processing when either the XML encryption <xref target="XMLencrypt" /> or digital
   signature <xref target="XMLsig" /> <xref target="RFC3275" /> is used within a document.  </t>

   <t>It might be helpful to define an extension to the authentication
   scheme that uses attribute certificates <xref target="RFC5755" /> in such a way that
   an application could automatically determine whether human
   intervention is needed to authorize a request; however, the
   specification of such an extension is out of scope for this document.</t>

   <t>The use of pre-shared keys may be considered for authentication at the transport layer.  If
   this option is selected, the specifications set forth in "Pre-Shared
   Key Ciphersuites for Transport Layer Security (TLS)" <xref target="RFC4279" /> MUST
   be followed.  Transport specifications are detailed in a separate document <xref target="RFC6546" />.</t>
</section>
<section title="Multi-Hop Request Authentication">
   <t>The use of multi-hop authentication in a Request is used when a Request is sent to multiple entities or SPs in an iterative manner.  Multi-hop authentication is REQUIRED in Requests that involve multiple SPs where Requests are forwarded iteratively through peers.  Bilateral trust relationships MAY be used between peers; multi-hop authentication MUST be used for cases where the originator of a message is authenticated several hops into the message flow.</t>

<t>For practical
   reasons, SPs may want to prioritize incident-handling events
   based upon the immediate peer for a Request, the originator of a request, and
   the listed Confidence rating for the incident.  In order to provide a
   higher assurance level of the authenticity of a Request, the
   originating RID system is included in the Request along with
   contact information and the information of all RID systems in the
   path the trace has taken.  This information is provided through the
   IODEF EventData class, which nests the list of systems and contacts
   involved in a trace, while setting the category attribute to
   "infrastructure".</t>

   <t>To provide multi-hop authentication, the originating RID system MUST include a
   digital signature in the Request sent to all systems in the
   upstream path.  The digital signature from the RID system is
   performed on the RecordItem class of the IODEF following the XML
   digital signature specifications from W3C <xref target="XMLsig" /> using a detached
   signature.  The signature MUST be passed to all parties that receive
   a Request, and each party MUST be able to perform full path
   validation on the digital signature <xref target="RFC5280" />.  In order to accommodate that
   requirement, the RecordItem data MUST remain
   unchanged as a request is passed along between providers and is the
   only element for which the signature is applied.  If additional
   RecordItems are included in the document at upstream peers, the initial
   RecordItem entry MUST still remain with the detached signature.  The subsequent
   RecordItem elements may be signed by the peer adding the incident information for
   the investigation.  A second benefit to this requirement is that the
   integrity of the filter used is ensured as it is passed to subsequent
   SPs in the upstream trace of the incident.  The trusted PKI also
   provides the keys used to digitally sign the RecordItem class for
   a Request to meet the requirement of authenticating the original
   request.  Any host in the path of the trace should be able to verify
   the digital signature using the trusted PKI.</t>

   <t>In the case in which an enterprise using RID sends a
   Request to its provider, the signature from the enterprise
   MUST be included in the initial request.  The SP may generate
   a new request to send upstream to members of the SP consortium to
   continue the investigation.  If the original request is sent, the originating
   SP, acting on behalf of the enterprise network under attack, MUST
   also digitally sign, with an enveloped signature, the full IODEF
   document to assure the authenticity of the Request.  An SP that
   offers RID as a service may be using its own PKI to secure RID
   communications between its RID system and the attached enterprise
   networks.  SPs participating in the trace MUST be able to determine
   the authenticity of RID requests.</t>
</section>
</section>


<section title="Consortiums and Public Key Infrastructures" anchor="sec-consortiums">
   <t>Consortiums are an ideal way to establish a communication web
   of trust for RID messaging.  It should be noted that direct relationships may be ideal for some communications, such as those between a provider of incident information and a subscriber of the incident reports.  The consortium could provide centralized
   resources, such as a PKI, and established guidelines and control requirements for use of RID.  The consortium may assist in establishing trust
   relationships between the participating SPs to achieve the necessary
   level of cooperation and experience-sharing among the consortium
   entities.  This may be established through PKI certificate policy
   <xref target="RFC3647" /> reviews to determine the appropriate trust levels between
   organizations or entities.  The consortium may also be used for other
   purposes to better facilitate communication among SPs in a common
   area (Internet, region, government, education, private networks,
   etc.).</t>

   <t>Using a PKI to distribute certificates used by RID systems provides
   an already established method to link trust relationships between consortiums that peer with SPs belonging to a separate
   consortium.  In other words, consortiums could peer with other
   consortiums to enable communication of RID messages between the
   participating SPs.  The PKI along with Memorandums of Agreement could
   be used to link border directories to share public key information in
   a bridge, a hierarchy, or a single cross-certification relationship.</t>

   <t>Consortiums also need to establish guidelines for each participating
   SP to adhere to.  The RECOMMENDED guidelines include:</t>

<list style="symbols">
     <t>Physical and logical practices to protect RID systems;</t>

     <t>Network- and application-layer protection for RID systems and
      communications;</t>

     <t>Proper use guidelines for RID systems, messages, and requests; and</t>

     <t>A PKI, certificate policy, and certification practices statement to provide authentication, integrity, and privacy.</t>
</list>

   <t>The functions described for a consortium's role parallel those
   of a PKI federation.  The PKI federations that currently exist are
   responsible for establishing security guidelines and PKI trust
   models.  The trust models are used to support applications to share
   information using trusted methods and protocols.</t>

   <t>A PKI can also provide the same level of security for communication
   between an end entity (enterprise, educational, or government
   customer network) and the SP.</t>
</section>

<section title="Privacy Concerns and System Use Guidelines" anchor="sec-privacy">
   <t>Privacy issues raise many concerns when information-sharing is
   required to achieve the goal of stopping or mitigating the effects of
   a security incident.  The RIDPolicy class is used to automate the
   enforcement of the privacy concerns listed within this document.  The
   privacy and system use concerns for the system communicating RID messages
   and other integrated components include the following:</t>

   <t>Service Provider Concerns:</t>

<list style="symbols">
     <t>Privacy of data monitored and/or stored on Intrusion Detection Systems (IDSs) for attack
      detection.</t>

     <t>Privacy of data monitored and stored on systems used to trace
      traffic across a single network.</t>

     <t>Privacy of incident information stored on incident management systems participating in RID communications.</t>
</list>

   <t>Customer Attached Networks Participating in RID with SP:</t>
<list style="symbols">
     <t>Customer networks may include enterprise, educational,
      government, or other networks attached to an SP participating in
      RID.  Customers should review data handling policies to
      understand how data will be protected by a service provider.
      This information will enable customers to decide what types of
      data at what sensitivity level can be shared with service
      providers.  This information could be used at the application
      layer to establish sharing profiles for entities and groups; see
      <xref target="sec-sharing"/>.</t>

     <t>Customers should request information on the security and privacy considerations in
      place by their SP and the consortium of which the SP is a
      member.  Customers should understand if their data were to be
      forwarded, how it might be sanitized and how it will be
      protected.   In advance of sharing data with their SP, customers
      should also understand if limitations can be placed on how it will be used.</t>

     <t>Customers should be aware that their data can and will be sent to
      other SPs in order to complete a trace unless an agreement stating
      otherwise is made in the service level agreements between the
      customer and SP.  Customers considering privacy options may limit the use of this feature if they do not want the data forwarded.</t>
</list>

   <t>Parties Involved in the Attack:</t>

<list style="symbols">
     <t>Privacy of the identity of a host involved in an attack or any indicators of compromise.</t>

     <t>Privacy of information such as the source and destination used for
      communication purposes over the monitored or RID-connected
      network(s).</t>

     <t>Protection of data from being viewed by intermediate parties in
      the path of an Request request should be considered.</t>
</list>

   <t>Consortium Considerations:</t>
<list style="symbols">
     <t>System use restrictions for security incident handling within the
      local region's definitions of appropriate traffic.  When participating in a consortium, appropriate use guidelines should be agreed upon and entered into contracts.</t>

     <t>System use prohibiting the consortium's participating SPs from
      inappropriately tracing traffic to locate sources or
      mitigate traffic unlawfully within the jurisdiction or region.</t>
</list>

   <t>Inter-Consortium Considerations:</t>
<list style="symbols">
     <t>System use between peering consortiums should consider any
      government communication regulations that apply between those two
      regions, such as encryption export and import restrictions.</t>

     <t>System use between consortiums SHOULD NOT request traffic traces and
      actions beyond the scope intended and permitted by law or
      inter-consortium agreements.</t>

     <t>System use between consortiums should consider national boundary issues
      and request limits in their appropriate system use agreements.  Appropriate use should include restrictions to prevent the use of the protocol for limiting or restricting traffic that is otherwise
      permitted within the country in which the peering consortium
      resides.</t>
</list>

   <t>The security and privacy considerations listed above are for the
   consortiums, SPs, and enterprises to agree upon.  The agreed-upon
   policies may be facilitated through use of the RIDPolicy class and application-layer options.  Some
   privacy considerations are addressed through the RID guidelines for
   encryption and digital signatures as described in
   <xref target="sec-encryption"/>.</t>

   <t>RID is useful in determining the true source of an incident that
   traverses multiple networks or to communicate security incidents and
   automate the response.  The information obtained from the investigation may
   determine the identity of the source host or the SP
   used by the source of the traffic.  It should be noted that the trace
   mechanism used across a single SP may also raise
   privacy concerns for the clients of the network.  Methods that may
   raise concern include those that involve storing packets for some
   length of time in order to trace packets after the fact.  Monitoring
   networks for intrusions and for tracing capabilities also raises
   concerns for potentially sensitive valid traffic that may be
   traversing the monitored network.  IDSs and single-network tracing
   are outside of the scope of this document, but the concern should be
   noted and addressed within the use guidelines of the network.  Some
   IDSs and single-network trace mechanisms attempt to properly address
   these issues.  RID is designed to provide the information needed by
   any single-network trace mechanism.  The provider's choice of a
   single trace mechanism depends on resources, existing solutions, and
   local legislation.  Privacy concerns in regard to the single-network
   trace must be dealt with at the client-to-SP level and are out of
   scope for RID messaging.</t>

   <t>The identity of the true source of an attack being traced
   through RID could be sensitive.  The true identity listed in a Result
   message can be protected through the use of encryption <xref target="XMLencrypt" />
   enveloping the IODEF document and RID Result information, using the
   public encryption key of the originating SP.  Alternatively, the
   action taken may be listed without the identity being revealed to the
   originating SP.  The ultimate goal of the RID communication system is
   to stop or mitigate attack traffic, not to ensure that the identity
   of the attack traffic is known to involved parties.  The SP that
   identifies the source should deal directly with the involved parties
   and proper authorities in order to determine the guidelines for the
   release of such information, if it is regarded as sensitive.  In some
   situations, systems used in attacks are compromised by an unknown
   source and, in turn, are used to attack other systems.  In that
   situation, the reputation of a business or organization may be at
   stake, and the action taken may be the only additional information
   reported in the Result message to the originating system.  If the
   security incident is a minor incident, such as a zombie system used
   in part of a large-scale DDoS attack, ensuring the system is taken
   off the network until it has been fixed may be sufficient.  The
   decision is left to the system users and consortiums to determine
   appropriate data to be shared given that the goal of the
   specification is to provide the appropriate technical options to
   remain compliant.  The textual descriptions should include details of
   the incident in order to protect the reputation of the unknowing
   attacker and prevent the need for additional investigation.  Local,
   state, or national laws may dictate the appropriate reporting action
   for specific security incidents.</t>

   <t>Privacy becomes an issue whenever sensitive data traverses a network.
   For example, if an attack occurred between a specific source and
   destination, then every SP in the path of the trace becomes aware that the cyber attack occurred.  In a targeted
   attack, it may not be desirable that information about two nation
   states that are battling a cyber war would become general knowledge
   to all intermediate parties.  However, it is important to allow the
   traces to take place in order to halt the activity since the health
   of the networks in the path could also be at stake during the attack.
   This provides a second argument for allowing the Result message to
   only include an action taken and not the identity of the offending
   host.  In the case of a Request or Report, where the originating
   SP is aware of the SP that will receive the request for processing,
   the free-form text areas of the document could be encrypted
   <xref target="XMLencrypt" /> using the public key of the destination SP to ensure
   that no other SP in the path can read the contents.  The encryption
   is accomplished through the W3C <xref target="XMLencrypt" /> specification for
   encrypting an element.</t>

   <t>In some situations, all network traffic of a nation may be granted
   through a single SP.  In that situation, options must
   support sending Result messages from a downstream peer of that
   SP.  That option provides an additional level of
   abstraction to hide the identity and the SP of the identified source
   of the traffic.  Legal action may override this technical decision
   after the trace has taken place, but that is out of the technical
   scope of this document.</t>

   <t>Privacy concerns when using an Request message to request
   action close to the source of valid attack traffic need to be
   considered.  Although the intermediate SPs may relay the request if
   there is no direct trust relationship to the closest SP to the
   source, the intermediate SPs do not require the ability to see the
   contents of the packet or the text description field(s) in the
   request.  This message type does not require any action by the
   intermediate RID systems, except to relay the packet to the next SP
   in the path.  Therefore, the contents of the request may be encrypted
   for the destination system.  The intermediate SPs only need to
   know how to direct the request to the manager of the ASN in which the
   source IP address belongs.</t>

   <t>Traces must be legitimate security-related incidents and not used for
   purposes such as sabotage or censorship.  An example of such abuse of
   the system includes a request to block or rate-limit legitimate
   traffic to prevent information from being shared between users on the
   Internet (restricting access to online versions of papers) or
   restricting access from a competitor's product in order to sabotage a
   business.</t>

   <t>Intra-consortium RID communications raise additional issues,
   especially when the peering consortiums reside in different regions
   or nations.  Request messages and requested actions to mitigate or stop traffic
   must adhere to the appropriate use guidelines and yet prevent abuse
   of the system.  First, the peering consortiums must identify the
   types of traffic that can be traced between the borders of the
   participating SPs of each consortium.  The traffic traced should be
   limited to security-incident-related traffic.  Second, the traces
   permitted within one consortium, if passed to a peering consortium, may
   infringe upon the peering consortium's freedom-of-information laws.
   An example would be a consortium in one country permitting a trace of
   traffic containing objectionable material, outlawed within that
   country.  The RID trace may be a valid use of the system within the
   confines of that country's network border; however, it may not be
   permitted to continue across network boundaries where such content is
   permitted under law.  By continuing the trace in another country's
   network, the trace and response could have the effect of improperly
   restricting access to data.  A continued trace into a second country
   may break the laws and regulations of that nation.  Any such traces
   MUST cease at the country's border.</t>

   <t>The privacy concerns listed in this section address issues among the
   trusted parties involved in a trace within an SP, a RID consortium,
   and peering RID consortiums.  Data used for RID communications must
   also be protected from parties that are not trusted.  This protection
   is provided through the authentication and encryption of documents as
   they traverse the path of trusted servers and through the local security controls in place for the incident management systems.  Each RID system MUST
   perform a bidirectional authentication when sending a RID message
   and use the public encryption key of the upstream or downstream peer
   to send a message or document over the network.  This means that the
   document is decrypted and re-encrypted at each RID system via TLS
   over a transport protocol such as <xref target="RFC6546" />.  The RID messages may be
   decrypted at each RID system in order to properly process the request
   or relay the information.  Today's processing power is more than
   sufficient to handle the minimal burden of encrypting and decrypting
   relatively small typical RID messages.</t>
</section>

<section title="Sharing Profiles and Policies" anchor="sec-sharing">
<t>The application layer can be used to establish workflows and rulesets
specific to sharing profiles for entities or consortiums.  The profiles can
leverage sharing agreements to restrict data types or classifications of data
that are shared.  The level of information or classification of data shared
with any entity may be based on protection levels offered by the receiving
entity and periodic validation of those controls.  The profile may also
indicate how far information can be shared according to the entity and data
type. The profile may also indicate whether requests to share data from an
entity must go directly to that entity.
</t> 

<t>In some cases, pre-defined sharing profiles will be possible.
  These include any use case where an agreement is in place in advance
  of sharing.  Examples may be between clients and SPs, entities such
  as partners, or consortiums.  There may be other cases when sharing
  profiles may not be established in advance, such as an organization
  dealing with an incident who requires assistance from an entity that
  it has not worked with before.  An organization may want to establish sharing profiles specific to possible user groups to prepare for possible incident scenarios.  The user groups could include business partners, industry peers, service providers, experts not part of a service provider, law enforcement, or regulatory reporting bodies.</t>
<t>Workflows to approve transactions may be specific to sharing profiles and data types.  Application developers should include capabilities to enable these decision points for users of the system.</t>
<t>Any expectations between entities to preserve the weight and admissibility of evidence should be handled at the policy and agreement level.  A sharing profile may include notes or an indicator for approvers in workflows to reflect if such agreements exist.</t>
</section>
</section>


<section title="Security Considerations">
   <t>RID has many security requirements and considerations built into the design of the protocol,
   several of which are described in the Security Requirements section.  For a
   complete view of security, considerations include the
   availability, confidentiality, and integrity concerns for the
   transport, storage, and exchange of information.</t>

   <t>Protected tunnels
   between systems accepting RID communications are used to provide confidentiality,
   integrity, authenticity, and privacy for the data at the transport layer.  Encryption and digital signatures are also used at the IODEF document level through RID options to provide confidentiality, integrity, authenticity, privacy and traceability of the document contents at the application layer.  Trust
   relationships are based on PKI and the comparison/validation of
   security controls for the incident management systems communicating
   via RID.  Trust levels can be established in cross-certification
   processes where entities compare PKI policies that include the
   specific management and handling of an entity's PKI and
   certificates issued under that policy.  <xref target="RFC3647" />
   defines an Internet X.509 Public Key Infrastructure Certificate
   Policy and Certification Practices Framework that may be used in
   the comparison of policies to establish trust levels and agreements
   between entities, an entity and a consortium, and consortiums.  The
   agreements SHOULD consider key management practices including the
   ability to perform path validation on certificates
   <xref target="RFC5280" />, key distribution techniques
   <xref target="RFC2585" />, and Certificate Authority and Registration Authority management practices.</t>

<t>The agreements between entities SHOULD also include a common understanding of the usage of RID security, policy, and privacy options discussed in both the Security Requirements and Security Considerations sections.  The formality, requirements, and complexity of the agreements for the certificate policy, practices, supporting infrastructure, and the use of RID options SHOULD be decided by the entities or consortiums creating those agreements.</t>
</section>

<section title="Internationalization Issues" anchor="sec-i18n">
<t>The Node class identifies a host or network device.  This document 
  reuses the definition of Node from the IODEF specification 
  <xref target="RFC5070" />, Section 3.16.  However, that document did not clearly 
  specify whether a NodeName could be an Internationalized Domain Name 
  (IDN).  RID systems MUST treat the NodeName class as a domain name 
  slot <xref target="RFC5890" />.  RID systems SHOULD support IDNs in the NodeName 
  class. If they do so, the UTF-8 representation of the domain name MUST 
  be used, i.e., all of the domain name's labels MUST be U-labels 
  expressed in UTF-8 or NR-LDH labels <xref target="RFC5890" />; A-labels 
  MUST NOT be used.  An application communicating via RID can convert between A-labels 
  and U-labels by using the Punycode encoding <xref target="RFC3492" /> for A-labels 
  as described in the protocol specification for Internationalized 
  Domain Names in Applications <xref target="RFC5891" />.</t>
</section>

<section title="IANA Considerations" anchor="sec-iana">
  <t>This document uses URNs to describe XML namespaces and XML schemas
   <xref target="XMLschema" /> conforming to a registry mechanism described in
   <xref target="RFC3688" />.</t>

   <t>Registration request for the iodef-rid namespace:</t>
<list>
   <t>URI: urn:ietf:params:xml:ns:iodef-rid-2.0</t>

   <t>Registrant Contact: IESG.</t>

   <t>XML: None.  Namespace URIs do not represent an XML specification.</t>
</list>

   <t>Registration request for the iodef-rid XML schema:</t>
<list>
   <t>URI: urn:ietf:params:xml:schema:iodef-rid-2.0</t>

   <t>Registrant Contact: IESG.</t>

   <t>XML: See <xref target="sec-schema-def"/>, "RID Schema Definition", of this document.</t>
</list>
<t>The following registry has been created and is now managed by IANA:</t><list>

      <t>Name of the registry: "XML Schemas Exchanged via RID"</t>
<t>Namespace details:  A registry entry for an XML Schema Transferred via RID consists of:</t>
<list>
<t>Schema Name:  A short string that represents the schema referenced.  This value is for reference only in the table.  The version of the schema MUST be included in this string to allow for multiple versions of the same specification to be in the registry.</t>
<t>Version: The version of the registered XML schema.  The version is a string that SHOULD be formatted as numbers separated by a '.' (period) character.</t>
<t>Namespace:  The namespace of the referenced XML schema.  This is represented in the RID ReportSchema class in the XMLSchemaID attribute as an enumerated value is represented by a URN or URI.</t>
<t>Specification URI:  A URI <xref target="RFC3986" /> from which the
registered specification can be obtained.  The specification MUST be publicly
available from this URI.</t>
<t>Reference: The reference to the document that describes the schema.</t>
</list>

<t>Information that must be provided to assign a new value: The above list of information.</t>
<t>Fields to record in the registry: Schema Name, Version, Namespace,
Specification URI, Reference</t>
<t>Initial registry contents: See <xref target="sec-CVRF"/>.</t>
<t> Allocation Policy: Expert Review <xref target="RFC5226" /> and
Specification Required <xref target="RFC5226" />.</t> 

</list>
<t>The Designated Expert is expected to consult with the MILE (Managed
   Incident Lightweight Exchange) working group or its successor if any
   such WG exists (e.g., via email to the working group's mailing list).
   The Designated Expert is expected to retrieve the XML schema specification
   from the provided URI in order to check the public availability of
   the specification and verify the correctness of the URI.  An
   important responsibility of the Designated Expert is to ensure that
   the XML schema is appropriate for use in RID.</t>
<t>The following registry has been created and is now managed by IANA:</t><list>

      <t>Name of the registry: "RID Enumeration List"</t>
<t>The registry is intended to enable enumeration value additions to attributes in the iodef-rid XML schema.</t>
<t>Fields to record in the registry: Attribute Name, Attribute Value,
Description, Reference</t>

<t>Initial registry content: none.</t>
<t> Allocation Policy: Expert Review <xref target="RFC5226" /></t></list>
<t>The Designated Expert is expected to consult with the MILE (Managed
   Incident Lightweight Exchange) working group or its successor if any
   such WG exists (e.g., via email to the working group's mailing list).
   The Designated Expert is expected to review the request and validate the appropriateness of the enumeration for the attribute.  If a specification is associated with the request, it MUST be reviewed by the Designated Expert.</t>
</section>

<section title="Summary">
   <t>Security incidents have always been difficult to trace as a result of
   spoofed sources, resource limitations, and bandwidth utilization
   problems.  Incident response is often slow even when the IP address
   is known to be valid because of the resources required to notify the
   responsible party of the attack and then to stop or mitigate the
   attack traffic.  Methods to identify and trace attacks near real time
   are essential to thwarting attack attempts.  SPs need
   policies and automated methods to combat the hacker's efforts.  SPs
   need automated monitoring and response capabilities to identify and
   trace attacks quickly without resource-intensive side effects.
   Integration with a centralized communication system to coordinate the
   detection, tracing, and identification of attack sources on a single
   network is essential.  RID provides a way to integrate SP resources
   for each aspect of attack detection, tracing, and source
   identification and extends the communication capabilities among
   SPs.  The communication is accomplished through the use
   of flexible IODEF XML-based documents passed between incident-handling systems or RID
   systems.  A Request is communicated to
   an upstream SP and may result in an upstream trace or in an action to
   stop or mitigate the attack traffic.  The messages are communicated
   among peers with security inherent to the RID messaging scheme
   provided through existing standards such as XML encryption and
   digital signatures.  Policy information is carried in the RID message
   itself through the use of the RIDPolicy.  RID provides the timely
   communication among SPs, which is essential for incident handling.</t>

</section>

</middle>

<back>

<references title="Normative References">
  <?rfc include="reference.RFC.2119" ?>
  <?rfc include="reference.RFC.2585" ?>
  <?rfc include="reference.RFC.3023" ?>
  <?rfc include="reference.RFC.3275" ?>
  <?rfc include="reference.RFC.3492" ?>
  <?rfc include="reference.RFC.3470" ?>
  <?rfc include="reference.RFC.3688" ?>
  <?rfc include="reference.RFC.4051" ?>
  <?rfc include="reference.RFC.4279" ?>
  <?rfc include="reference.RFC.5070" ?>
  <?rfc include="reference.RFC.5226" ?>
  <?rfc include="reference.RFC.5280" ?>
  <?rfc include="reference.RFC.5755" ?>
  <?rfc include="reference.RFC.5646" ?>
  <?rfc include="reference.RFC.5890" ?>
  <?rfc include="reference.RFC.5891" ?>

    <reference anchor="RFC6546">
        <front>
            <title>Transport of Real-time Inter-network Defense (RID) Messages
over HTTP/TLS</title>
            <author initials="B." surname="Trammell" fullname="">
                <organization />
            </author>
              <date month="April" year="2012" />
        </front>
<seriesInfo name="RFC" value="6546"/>
    </reference>

    <reference anchor="XML1.0" target="http://www.w3.org/TR/xml/">
        <front>
            <title>Extensible Markup Language (XML) 1.0</title>
            <author initials="T." surname="Bray" fullname="">
                <organization />
            </author>
            <author initials="E." surname="Maler" fullname="">
                <organization />
            </author>
            <author initials="J." surname="Paoli" fullname="">
                <organization />
            </author>
            <author initials="C.M." surname="Sperberg-McQueen" fullname="">
                <organization />
            </author>
            <author initials="F." surname="Yergeau" fullname="">
                <organization />
            </author>
            <date month="November" year="2008" />
        </front>
        <seriesInfo name="W3C Recommendation" value="XML 1.0" />
    </reference>

    <reference anchor="XMLCanon" target="http://www.w3.org/TR/xml-c14n">
        <front>
            <title>Canonical XML 1.0</title>
            <author initials="J." surname="Boyer" fullname="">
                <organization />
            </author>
            <date month="December" year="2001" />
        </front>
        <seriesInfo name="W3C Recommendation" value="1.0" />
    </reference>  

    <reference anchor="XMLencrypt" target="http://www.w3.org/TR/xmlenc-core/">
        <front>
            <title>XML Encryption Syntax and Processing</title>
            <author initials="T." surname="Imaura" fullname="">
                <organization />
            </author>
            <author initials="B." surname="Dillaway" fullname="">
                <organization />
            </author>
            <author initials="E." surname="Simon" fullname="">
                <organization />
            </author>
            <date month="December" year="2002" />
        </front>
        <seriesInfo name="W3C" value="Recommendation" />
    </reference>

    <reference anchor="XMLPath" target="http://www.w3.org/TR/xpath20/">
        <front>
            <title>XML Schema Part 1: Structures</title>
            <author initials="A." surname="Berglund">
                <organization />
            </author>
            <author initials="S." surname="Boag">
                <organization />
            </author>
            <author initials="D." surname="Chamberlin">
                <organization />
            </author>
            <author initials="M." surname="Fernandez">
                <organization />
            </author>
            <author initials="M." surname="Kay">
                <organization />
            </author>
            <author initials="J." surname="Robie">
                <organization />
            </author>
            <author initials="J." surname="Simeon">
                <organization />
            </author>
            <date month="December" year="2010" />
        </front>
        <seriesInfo name="W3C Recommendation" value="Second Edition" />
    </reference>

    <reference anchor="XMLschema" target="http://www.w3.org/TR/xmlschema-1/">
        <front>
            <title>XML Schema Part 1: Structures</title>
            <author initials="H." surname="Thompson">
                <organization />
            </author>
            <author initials="D." surname="Beech">
                <organization />
            </author>
            <author initials="M." surname="Maloney">
                <organization />
            </author>
            <author initials="N." surname="Mendelsohn">
                <organization />
            </author>
            <date month="October" year="2004" />
        </front>
        <seriesInfo name="W3C Recommendation" value="Second Edition" />
    </reference>

    <reference anchor="XMLsig" target="http://www.w3.org/TR/xmldsig-core/">
        <front>
            <title>XML-Signature Syntax and Processing</title>
            <author initials="M." surname="Bartel">
                <organization />
            </author>
            <author initials="J." surname="Boyer">
                <organization />
            </author>
            <author initials="B." surname="Fox">
                <organization />
            </author>
            <author initials="B." surname="LaMaccia">
                <organization />
            </author>
            <author initials="E." surname="Simon">
                <organization />
            </author>
            <date month="June" year="2008" />
        </front>
        <seriesInfo name="W3C Recommendation" value="Second Edition" />
    </reference>

    <reference anchor="XMLSigBP" target="http://www.w3.org/TR/xmldsig-bestpractices/">
        <front>
            <title>XML-Signature Best Practices</title>
            <author initials="F." surname="Hirsch">
                <organization />
            </author>
            <author initials="P." surname="Datta">
                <organization />
            </author>
           <date month="August" year="2011" />
        </front>
        <seriesInfo name="W3C" value="Recommendation" />
    </reference>
</references>

<references title="Informative References">
  <?rfc include="reference.RFC.1930" ?>
  <?rfc include="reference.RFC.3647" ?>
  <?rfc include="reference.RFC.3080" ?>
  <?rfc include="reference.RFC.3986" ?>
  <?rfc include="reference.RFC.5735" ?>
  <?rfc include="reference.RFC.6045" ?>
  <?rfc include="reference.RFC.6194" ?>
    <reference anchor="XMLNames" target="http://www.w3.org/TR/xml-names/">
        <front>
            <title>Namespaces in XML 1.0 (Third Edition)</title>
            <author initials="T." surname="Bray" fullname="">
                <organization />
            </author>
            <author initials="D." surname="Hollander" fullname="">
                <organization />
            </author>
            <author initials="A." surname="Layman" fullname="">
                <organization />
            </author>
            <author initials="R." surname="Tobin" fullname="">
                <organization />
            </author>
            <author initials="H." surname="Thomson" fullname="">
                <organization />
            </author>
            <date month="December" year="2009" />
        </front>
        <seriesInfo name="W3C Recommendation" value="" />
    </reference>  
</references>

<section title="Acknowledgements">
   <t>Many thanks to colleagues and the Internet community for reviewing and
   commenting on the document as well as providing recommendations to improve, 
   simplify, and secure the protocol: 
Steve Bellovin,
David Black, 
Harold Booth, 
Paul Cichonski, 
Robert K. Cunningham, 
Roman Danyliw, 
Yuri Demchenko, 
Sandra G. Dykes, 
Stephen Farrell, 
Katherine Goodier, 
Cynthia D. McLain, 
Thomas Millar, 
Jean-Francois Morfin, 
Stephen Northcutt, 
Damir Rajnovic, 
Tony Rutkowski, 
Peter Saint-Andre, 
Jeffrey Schiller, 
Robert Sparks, 
William Streilein, 
Richard Struse, 
Tony Tauber, 
Brian Trammell, 
Sean Turner,
Iljitsch van Beijnum,  and 
David Waltermire. </t>
</section>
</back>
</rfc>

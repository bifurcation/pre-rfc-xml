<?xml version='1.0' encoding='US-ASCII'?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC2205 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.2205.xml">
<!ENTITY RFC4090 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4090.xml">
<!ENTITY RFC4561 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.4561.xml">
<!ENTITY RFC6780 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6780.xml">
<!ENTITY RFC7551 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.7551.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY RFC8271 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8271.xml">
<!ENTITY RFC3209 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3209.xml">
<!ENTITY RFC3473 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.3473.xml">
<!ENTITY RFC5920 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.5920.xml">
<!ENTITY RFC6370 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6370.xml">
<!ENTITY RFC6373 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.6373.xml">
<!ENTITY RFC8131 SYSTEM "https://xml2rfc.ietf.org/public/rfc/bibxml/reference.RFC.8131.xml">
]>
<rfc number="8537" submissionType="IETF" consensus="yes" category="std" ipr="trust200902" updates="4090, 7551">
	<!-- Generated by id2xml 1.4.4 on 2018-12-21T07:13:18Z -->
	<?rfc compact="yes"?>
	<?rfc text-list-symbols="o*+-"?>
	<?rfc subcompact="no"?>
	<?rfc sortrefs="yes"?>
	<?rfc symrefs="yes"?>
	<?rfc strict="yes"?>
        <?rfc toc="yes"?>
	<front>
	<title abbrev="Associated Bidirectional LSP Fast Reroute">Updates to the Fast Reroute Procedures for Co-routed Associated Bidirectional Label Switched Paths (LSPs)</title>
	<author fullname="Rakesh Gandhi" initials="R." role="editor" surname="Gandhi">
	<organization>Cisco Systems, Inc.</organization>
	<address><postal><street>Canada</street>
	</postal>
	<email>rgandhi@cisco.com</email>
	</address>
	</author>

	<author fullname="Himanshu Shah" initials="H." surname="Shah">
	<organization>Ciena</organization>
	<address><email>hshah@ciena.com</email>
	</address>
	</author>

	<author fullname="Jeremy Whittaker" initials="J." surname="Whittaker">
	<organization>Verizon</organization>
	<address><email>jeremy.whittaker@verizon.com</email>
	</address>
	</author>

	<date month="February" year="2019"/>
	<workgroup>TEAS Working Group</workgroup>


	<abstract><t>
   Resource Reservation Protocol (RSVP) association signaling can be
   used to bind two unidirectional Label Switched Paths (LSPs) into an
   associated bidirectional LSP.  When an associated bidirectional LSP
   is co-routed, the reverse LSP follows the same path as its forward
   LSP.  This document updates the fast reroute procedures defined
   in RFC 4090 to support both single-sided and double-sided provisioned
   associated bidirectional LSPs.  This document also updates the
   procedure for associating two reverse LSPs defined in RFC 7551 to
   support co-routed bidirectional LSPs.  The fast reroute procedures can ensure
   that, for the co-routed LSPs, traffic flows on co-routed paths in the
   forward and reverse directions after a failure event.</t>

	</abstract>
	</front>

	<middle>
	<section title="Introduction" anchor="section-1"><t>
   The Resource Reservation Protocol (RSVP) (Extended) ASSOCIATION
   Object is specified in <xref target="RFC6780"/> and can be used generically to
   associate Multiprotocol Label Switching (MPLS) and Generalized MPLS
   (GMPLS) Traffic Engineering (TE) Label Switched Paths (LSPs).
   <xref target="RFC7551"/> defines mechanisms for binding two point-to-point (P2P)
   unidirectional LSPs <xref target="RFC3209"/> into an associated bidirectional LSP.
   There are two models described in <xref target="RFC7551"/> for provisioning an
   associated bidirectional LSP: single-sided and double-sided.  In both
   models, the reverse LSP of the bidirectional LSP may or may not be
   co-routed and follow the same path as its forward LSP.</t>

	<t>
   In some packet transport networks, there are requirements where the
   reverse LSP of a bidirectional LSP needs to follow the same path as
   its forward LSP <xref target="RFC6373"/>.  The MPLS Transport Profile (MPLS-TP) <xref target="RFC6370"/>
   architecture facilitates the co-routed bidirectional LSP by using 
   GMPLS extensions <xref target="RFC3473"/> to achieve congruent paths.  However,
   RSVP association signaling allows enabling co-routed bidirectional
   LSPs without having to deploy GMPLS extensions in the existing
   networks.  The association signaling also allows taking advantage of
   the existing TE and fast reroute mechanisms in the network.</t>

	<t>
   <xref target="RFC4090"/> defines fast reroute extensions for RSVP-TE LSPs, which are also
   applicable to the associated bidirectional LSPs.  <xref target="RFC8271"/> defines
   fast reroute procedures for GMPLS signaled bidirectional LSPs such as
   coordinating bypass tunnel assignments in the forward and reverse
   directions of the LSP.  The mechanisms defined in <xref target="RFC8271"/> are also
   useful for the fast reroute of associated bidirectional LSPs.</t>

	<t>
   This document updates the fast reroute procedures defined in <xref target="RFC4090"/> to
   support both single-sided and double-sided provisioned associated
   bidirectional LSPs.  This document also updates the procedure for
   associating two reverse LSPs defined in <xref target="RFC7551"/> to support
   co-routed bidirectional LSPs.  The fast reroute procedures can ensure that for
   the co-routed LSPs, traffic flows on co-routed paths in the forward
   and reverse directions after fast reroute.</t>

	<section title="Assumptions and Considerations" anchor="section-1.1"><t>
   The following assumptions and considerations apply to this document:</t>

	<t><list style="symbols"><t>The fast reroute procedure for the unidirectional LSPs is defined in
      <xref target="RFC4090"/> and is not modified by this document.</t>

	<t>The fast reroute procedure when using unidirectional bypass tunnels is
      defined in <xref target="RFC4090"/> and is not modified by this document.</t>

	<t>This document assumes that the fast reroute bypass tunnels used for
      protected associated bidirectional LSPs are also associated
      bidirectional.</t>

	<t>This document assumes that the fast reroute bypass tunnels used for
	protected co-routed associated bidirectional LSPs are also co-routed
	associated bidirectional.</t> 

	<t>The fast reroute procedure to coordinate the bypass tunnel assignment
      defined in this document may be used for protected 
      associated bidirectional LSPs that are not co-routed but requires that the downstream
      Point of Local Repair (PLR) and Merge Point (MP) pair of the
      forward LSP matches the upstream MP and PLR pair of the reverse
      LSP.</t>

	<t>Unless otherwise specified in this document, the fast reroute
      procedures defined in <xref target="RFC4090"/> are used for associated
      bidirectional LSPs.</t>

	</list>
	</t>

	</section>

	</section>

	<section title="Conventions Used in This Document"
		 anchor="section-2"><section title="Key Word Definitions" anchor="section-2.1">
        <t>
    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
    NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
    "MAY", and "OPTIONAL" in this document are to be interpreted as
    described in BCP&nbsp;14 <xref target="RFC2119"/> <xref target="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>

	</section>

	<section title="Terminology" anchor="section-2.2"><t>
   The reader is assumed to be familiar with the terminology defined in
   <xref target="RFC2205"/>, <xref target="RFC3209"/>, <xref target="RFC4090"/>, <xref target="RFC7551"/>, and <xref target="RFC8271"/>.</t>

	<section title="Forward Unidirectional LSPs" anchor="section-2.2.1"><t>
   Two reverse unidirectional P2P LSPs are set up in
   opposite directions between a pair of source and destination nodes to
   form an associated bidirectional LSP.  In the
   case of single-sided provisioned LSP, the originating LSP with a
   REVERSE_LSP Object <xref target="RFC7551"/> is identified as a forward
   unidirectional LSP.  In the case of double-sided provisioned LSP, the
   LSP originating from the higher node address (as source) and
   terminating on the lower node address (as destination) is identified
   as a forward unidirectional LSP.</t>

	</section>

	<section title="Reverse Co-routed Unidirectional LSPs" anchor="section-2.2.2"><t>
   Two reverse unidirectional P2P LSPs are set up in 
   opposite directions between a pair of source and destination nodes to
   form an associated bidirectional LSP.  A
   reverse unidirectional LSP originates on the same node where the
   forward unidirectional LSP terminates, and it terminates on the same
   node where the forward unidirectional LSP originates.  A reverse co-routed
   unidirectional LSP traverses along the same path as the
   forward-direction unidirectional LSP in the opposite direction.</t>

	</section>

	</section>

	</section>

	<section title="Problem Statement" anchor="section-3"><t>
   As specified in <xref target="RFC7551"/>, in the single-sided provisioning case, the
   RSVP-TE tunnel is configured only on one endpoint node of the
   bidirectional LSP.  An LSP for this tunnel is initiated by the
   originating endpoint with the (Extended) ASSOCIATION Object containing
   Association Type set to "Single-Sided Associated Bidirectional LSP"
   and the REVERSE_LSP Object inserted in the RSVP Path message.  The remote
   endpoint then creates the corresponding reverse TE tunnel and signals
   the reverse LSP in response using the information from the
   REVERSE_LSP Object and other objects present in the received RSVP
   Path message.  As specified in <xref target="RFC7551"/>, in the double-sided
   provisioning case, the RSVP-TE tunnel is configured on both endpoint
   nodes of the bidirectional LSP.  Both forward and reverse LSPs are
   initiated independently by the two endpoints with the (Extended)
   ASSOCIATION Object containing Association Type set to
   "Double-Sided Associated Bidirectional LSP".  With both single-sided and
   double-sided provisioned bidirectional LSPs, the reverse LSP may or may not
   be congruent (i.e., co-routed) and follow the same path as its forward
   LSP.</t>

	<t>
   Both single-sided and double-sided associated bidirectional LSPs
   require solutions to the following issues for fast reroute to ensure
   co-routing after a failure event.</t>

	<section title="Fast Reroute Bypass Tunnel Assignment" anchor="section-3.1"><t>
   In order to ensure that the traffic flows on a co-routed path after a
   link or node failure on the protected co-routed LSP path, the midpoint
   PLR nodes need to assign matching
   bidirectional bypass tunnels for fast reroute.  


   Such bypass
   assignment requires coordination between the PLR nodes in both the forward
   and reverse
   directions when more than one bypass tunnel is present on
   a PLR node.</t>

	<figure title="Multiple Bidirectional Bypass Tunnels" anchor="ref-multiple-bidirectional-bypass-tunnels"><artwork><![CDATA[
                   <-- Bypass N -->
               +-----+         +-----+
               |  H  +---------+  I  |
               +--+--+         +--+--+
                  |               |
                  |               |
       LSP1 -->   |   LSP1 -->    |   LSP1 -->       LSP1 -->
+-----+        +--+--+         +--+--+        +-----+        +-----+
|  A  +--------+  B  +----X----+  C  +--------+  D  +--------+  E  |
+-----+        +--+--+         +--+--+        +-----+        +-----+
       <-- LSP2   |    <-- LSP2   |   <-- LSP2       <-- LSP2
                  |               |
                  |               |
               +--+--+         +--+--+
               |  F  +---------+  G  |
               +-----+         +-----+
                   <-- Bypass S -->
]]></artwork>
	</figure>
	<t>
   As shown in <xref target="ref-multiple-bidirectional-bypass-tunnels"/>,
   there are two bypass tunnels available: bypass tunnel N (on path B-H-I-C) and bypass tunnel S (on path B-F-G-C).
   The midpoint PLR nodes B and C need to coordinate bypass tunnel
   assignment to ensure that traffic in both directions flows through
   either bypass tunnel N or bypass tunnel S after the link
   B-C failure.</t>

	</section>

	<section title="Node Protection Bypass Tunnels" anchor="section-3.2"><t>
   When using a node protection bypass tunnel with a protected
   associated bidirectional LSP, after a link failure, the forward and
   reverse LSP traffic can flow on different node protection bypass
   tunnels in the upstream and downstream directions.</t>

	<figure title="Node Protection Bypass Tunnels" anchor="ref-node-protection-bypass-tunnels"><artwork><![CDATA[
           <-- Bypass N -->
+-----+                        +-----+
|  H  +------------------------+  I  |
+--+--+                        +--+--+
   |      <-- Rerouted-LSP2       |
   |                              |
   |                              |
   |   LSP1 -->       LSP1 -->    |   LSP1 -->       LSP1 -->
+--+--+        +-----+         +--+--+        +-----+        +-----+
|  A  +--------+  B  +----X----+  C  +--------+  D  +--------+  E  |
+-----+        +--+--+         +-----+        +--+--+        +-----+
       <-- LSP2   |    <-- LSP2       <-- LSP2   |   <-- LSP2
                  |                              |
                  |                              |
                  |       Rerouted-LSP1 -->      |
               +--+--+                        +--+--+
               |  F  +------------------------+  G  |
               +-----+                        +-----+
                          <-- Bypass S -->
]]></artwork>
	</figure>
	<t>
   As shown in <xref target="ref-node-protection-bypass-tunnels"/>, after the link B-C failure, the downstream PLR
   node B reroutes the protected forward LSP1 traffic over bypass
   tunnel S (on path B-F-G-D) to reach downstream MP node D, whereas the
   upstream PLR node C reroutes the protected reverse LSP2 traffic over bypass
   tunnel N (on path C-I-H-A) to reach the upstream MP node A. As a result, the traffic in the forward and reverse directions
   flows on different bypass tunnels, which can cause the co-routed
   associated bidirectional LSP to be no longer co-routed.  However, unlike
   GMPLS LSPs, the asymmetry of paths in the forward and reverse
   directions does not result in RSVP soft-state timeout with the
   associated bidirectional LSPs.</t>

	</section>

	<section title="Bidirectional LSP Association at Midpoints" anchor="section-3.3"><t>
   In packet transport networks, a restoration LSP is signaled after a
   link failure on the protected LSP path, and the protected LSP may or
   may not be torn down <xref target="RFC8131"/>.  In this case, multiple forward and
   reverse LSPs of a co-routed associated bidirectional LSP may be
   present at midpoint nodes with identical (Extended) ASSOCIATION
   Objects.  This creates an ambiguity at midpoint nodes to identify
   the correct associated LSP pair for fast reroute bypass assignment
   (e.g., during the recovery phase of the RSVP graceful restart procedure).</t>

	<figure title="Restoration LSP Setup after Link Failure" anchor="ref-restoration-lsp-setup-after-link-failure"><artwork><![CDATA[
       LSP3 -->                       LSP3 -->       LSP3 -->
       LSP1 -->       LSP1 -->        LSP1 -->       LSP1 -->
+-----+        +-----+         +-----+        +-----+        +-----+
|  A  +--------+  B  +----X----+  C  +--------+  D  +--------+  E  |
+-----+        +--+--+         +--+--+        +-----+        +-----+
       <-- LSP2   |    <-- LSP2   |   <-- LSP2       <-- LSP2
       <-- LSP4   |               |   <-- LSP4       <-- LSP4
                  |               |
                  |   LSP3 -->    |
               +--+--+         +--+--+
               |  F  +---------+  G  |
               +-----+         +-----+
                   <-- Bypass S -->
                       <-- LSP4
]]></artwork>
	</figure>
	<t>As shown in <xref
	target="ref-restoration-lsp-setup-after-link-failure"/>, the protected
	LSPs (LSP1 and LSP2) are an
	associated LSP pair; similarly, the restoration LSPs (LSP3 and LSP4) are
   an associated LSP pair. Both pairs belong to the same associated
   bidirectional LSP and carry identical (Extended) ASSOCIATION Objects.
    In this example, the midpoint node D may mistakenly associate LSP1 with the reverse LSP4 instead of the reverse LSP2 due to the matching
	(Extended) ASSOCIATION Objects.  This may cause the co-routed
   associated bidirectional LSP to be no longer co-routed after fast
   reroute.  Since the bypass assignment needs to be coordinated between
   the forward and reverse LSPs, this can also lead to undesired bypass
   tunnel assignments.
	</t>



	</section>

	</section>

	<section title="Signaling Procedure" anchor="section-4"><section title="Associated Bidirectional LSP Fast Reroute" anchor="section-4.1"><t>
   For both single-sided and double-sided associated bidirectional LSPs,
   the fast reroute procedure specified in <xref target="RFC4090"/> is used.  In
   addition, the mechanisms defined in <xref target="RFC8271"/> are used as follows:</t>

	<t><list style="symbols"><t>The BYPASS_ASSIGNMENT IPv4 subobject (value 38) and IPv6
      subobject (value 39) defined in <xref target="RFC8271"/> are used to coordinate
      bypass tunnel assignment between the PLR nodes in both the forward and
      reverse directions
      (see <xref target="ref-multiple-bidirectional-bypass-tunnels"/>).  The BYPASS_ASSIGNMENT and Node-ID
      address <xref target="RFC4561"/> subobjects MUST be added by the downstream PLR
      node in the RECORD_ROUTE Object (RRO) of the RSVP Path message of
      the forward LSP to indicate the local bypass tunnel assignment
      using the procedure defined in <xref target="RFC8271"/>.  The upstream node uses
      the bypass assignment information (namely, bypass tunnel source
      address, destination address, and Tunnel ID) in the received RSVP
      Path message of the protected forward LSP to find the associated
      bypass tunnel in the reverse direction.  The upstream PLR node
      MUST NOT add the BYPASS_ASSIGNMENT subobject in the RRO of the
      RSVP Path message of the reverse LSP.</t>

	<t>The downstream PLR node initiates the bypass tunnel assignment for
      the forward LSP.  The upstream PLR (forward-direction LSP MP) node
      reflects the associated bypass tunnel assignment for the
      reverse-direction LSP.  The upstream PLR node MUST NOT initiate the
      bypass
      tunnel assignment.</t>

	<t>If the indicated forward bypass tunnel or the associated reverse
      bypass tunnel is not found, the upstream PLR SHOULD send a Notify
      message <xref target="RFC3473"/> with Error Code "FRR Bypass Assignment Error"
      (value 44) and Sub-code "Bypass Tunnel Not Found" (value 1)
      <xref target="RFC8271"/> to the downstream PLR.</t>

	<t>If the bypass tunnel cannot be used as described in Section 4.5.3
      of <xref target="RFC8271"/>, the upstream PLR SHOULD send a Notify message
      <xref target="RFC3473"/> with Error Code "FRR Bypass Assignment Error" (value
      44) and Sub-code "Bypass Assignment Cannot Be Used" (value 0)
      <xref target="RFC8271"/> to the downstream PLR.</t>

	<t>After a link or node failure, the PLR nodes in both forward and
      reverse directions trigger fast reroute independently using the
      procedures defined in <xref target="RFC4090"/> and send the forward and protected
      reverse LSP modified RSVP Path messages and traffic over the
      bypass tunnel.  The RSVP Resv signaling of the protected forward
      and reverse LSPs follows the same procedure as defined in
      <xref target="RFC4090"/> and is not modified by this document.</t>

	</list>
	</t>

	<section title="Restoring Co-routing with Node Protection Bypass Tunnels" anchor="section-4.1.1"><t>
   After fast reroute, the downstream MP node assumes the role of
   upstream PLR and reroutes the reverse LSP RSVP Path messages and
   traffic over the bypass tunnel on which the forward LSP RSVP Path
   messages and traffic are received.  This procedure is defined as
   "restoring co-routing" in <xref target="RFC8271"/>.  This procedure is used to ensure
   that both forward and reverse LSP signaling and traffic flow on the
   same bidirectional bypass tunnel after fast reroute.</t>

	<t>
   As shown in <xref target="ref-node-protection-bypass-tunnels"/>, when using a node protection bypass tunnel with
   protected co-routed LSPs, asymmetry of paths can occur in the forward
   and reverse directions after a link failure <xref target="RFC8271"/>.  In order to
   restore co-routing, the downstream MP node D (acting as an upstream
   PLR) MUST trigger the procedure to restore co-routing and reroute the
   protected reverse LSP2 RSVP Path messages and traffic over the bypass
   tunnel S (on path D-G-F-B) to the upstream MP node B upon receiving
   the protected forward LSP modified RSVP Path messages and traffic
   over the bypass tunnel S (on path D-G-F-B) from node B.  The upstream
   PLR node C stops receiving the RSVP Path messages and traffic for the
   reverse LSP2 from node D (resulting in RSVP soft-state timeout), and
   it stops sending the RSVP Path messages for the reverse LSP2 over the
   bypass tunnel N (on path C-I-H-A) to node A.</t>

	</section>

	<section title="Unidirectional Link Failures" anchor="section-4.1.2"><t>
   The unidirectional link failures can cause co-routed associated
   bidirectional LSPs to be no longer co-routed after fast reroute with
   both link protection and node protection bypass tunnels.  However,
   the unidirectional link failures in the upstream and/or downstream
   directions do not result in RSVP soft-state timeout with the
   associated bidirectional LSPs as upstream and downstream PLRs trigger
   fast reroute independently.  The asymmetry of forward and reverse LSP
   paths due to the unidirectional link failure in the downstream
   direction can be corrected by using the procedure to restore co-
   routing specified in <xref target="section-4.1.1"/>.</t>

	</section>

	<section title="Revertive Behavior after Fast Reroute" anchor="section-4.1.3"><t>
   When the revertive behavior is desired for a protected LSP after the
   link is restored, the procedure defined in Section 6.5.2 of <xref target="RFC4090"/>
   is followed.</t>

	<t><list style="symbols"><t>The downstream PLR node starts sending
the RSVP Path messages and
      traffic flow of the protected forward LSP over the restored link
      and stops sending them over the bypass tunnel <xref target="RFC4090"/>.</t>

	<t>The upstream PLR node (when the protected LSP is present) also
      starts sending the RSVP Path messages and traffic flow of the
      protected reverse LSPs over the restored link and stops sending
      them over the bypass tunnel <xref target="RFC4090"/>.</t>

	<t>For node protection bypass tunnels (see <xref target="ref-node-protection-bypass-tunnels"/>), after
      restoring co-routing, the upstream PLR node D SHOULD start sending
      RSVP Path messages and traffic for the reverse LSP over the
      original link (C-D) when it receives the unmodified RSVP Path
      messages and traffic for the protected forward LSP over it and
      stops sending them over the bypass tunnel S (on path D-G-F-B).</t>

	</list>
	</t>

	</section>

	<section title="Bypass Tunnel Provisioning" anchor="section-4.1.4"><t>
   Fast reroute bidirectional bypass tunnels can be single-sided or
   double-sided associated tunnels.  For both single-sided and double-
   sided associated bypass tunnels, the fast reroute assignment policies
   need to be configured on the downstream PLR nodes of the protected
   LSPs that initiate the bypass tunnel assignments.  For single-sided
   associated bypass tunnels, these nodes are the originating endpoints
   of their signaling.</t>

	</section>

	<section title="One-to-One Bypass Tunnel" anchor="section-4.1.5"><t>
   The fast reroute signaling procedure defined in this document can be
   used for both facility backup described in Section 3.2 of <xref target="RFC4090"/>
   and one-to-one backup described in Section 3.1 of <xref target="RFC4090"/>.  
As
   described in Section 4.5.2 of <xref target="RFC8271"/>, in the one-to-one backup method,
   if the associated bidirectional bypass tunnel is already in use at
   the upstream PLR, it SHOULD send a Notify message <xref target="RFC3473"/> with
   Error Code "FRR Bypass Assignment Error" (value 44) and Sub-code
   "One-to-One Bypass Already in Use" (value 2) to the downstream PLR.</t>

	</section>

	</section>

	<section title="Bidirectional LSP Association at Midpoints" anchor="section-4.2"><t>
   In order to associate the LSPs unambiguously at a midpoint node (see
   <xref target="ref-restoration-lsp-setup-after-link-failure"/>), the
   endpoint node MUST signal the Extended ASSOCIATION Object
   and add a unique Extended Association ID for each associated forward
   and reverse LSP pair forming the bidirectional LSP.  An endpoint node
   MAY set the Extended Association ID to the value formatted according
   to the structure shown in Appendix A.</t>

	<t><list style="symbols"><t>For single-sided provisioned bidirectional LSPs <xref target="RFC7551"/>, the
      originating endpoint signals the Extended ASSOCIATION Object with
      a unique Extended Association ID.  The remote endpoint copies the
      contents of the received Extended ASSOCIATION Object including the
      Extended Association ID in the RSVP Path message of the reverse
      LSP's Extended ASSOCIATION Object.</t>

	<t>For double-sided provisioned bidirectional LSPs <xref target="RFC7551"/>, both
      endpoints need to ensure that the bidirectional LSP has a unique
      Extended ASSOCIATION Object for each forward and reverse LSP pair
      by selecting appropriate unique Extended Association IDs signaled
      by them.  A controller can be used to provision a unique Extended
      Association ID on both endpoints.  The procedure for selecting
      unique Extended Association IDs is outside the scope of this
      document.</t>

	</list>
	</t>

	</section>

	</section>

	<section title="Compatibility" anchor="section-5"><t>
   This document updates the procedures for fast reroute for associated
   bidirectional LSPs defined in <xref target="RFC4090"/> and the procedures for associating
   bidirectional LSPs defined in <xref target="RFC7551"/>.  The procedures use the
   signaling messages defined in <xref target="RFC8271"/>; no new signaling messages
   are defined in this document.  The procedures ensure that for the co-routed
   LSPs, traffic flows on co-routed paths in the forward and
   reverse directions after fast reroute.  Operators wishing to use this
   function SHOULD ensure that it is supported on all the nodes on the
   LSP path.  The nodes not supporting this function can cause the
   traffic to flow on asymmetric paths in the forward and reverse
   directions of the associated bidirectional LSPs after fast reroute.</t>

	</section>

	<section title="Security Considerations" anchor="section-6"><t>
   This document updates the signaling mechanisms defined in <xref target="RFC4090"/>
   and <xref target="RFC7551"/>. It does not introduce any additional security
   considerations other than those already covered in <xref target="RFC4090"/>,
   <xref target="RFC7551"/>, <xref target="RFC8271"/>, and the MPLS/GMPLS security framework
   <xref target="RFC5920"/>.</t>

	</section>

	<section title="IANA Considerations" anchor="section-7"><t>
   This document has no IANA actions.</t>

	</section>

	</middle>

	<back>
	<references title="Normative References">
	&RFC2119;
	&RFC2205;
	&RFC4090;
	&RFC4561;
	&RFC6780;
	&RFC7551;
	&RFC8174;
	&RFC8271;
	</references>
	<references title="Informative References">
	&RFC3209;
	&RFC3473;
	&RFC5920;
	&RFC6370;
	&RFC6373;
	&RFC8131;
	</references>
	<section title="Extended Association ID" anchor="section-a"><t>
   The Extended Association ID in the Extended ASSOCIATION Object <xref target="RFC6780"/>
   can be set to the value formatted according to the structure shown in
   the following example to uniquely identify associated forward and
   reverse LSP pairs of an associated bidirectional LSP.</t>

	<t>An example of the IPv4 Extended Association ID format is shown below:
	</t>


	<figure title="IPv4 Extended Association ID Format Example" anchor="ref-ipv4-extended-association-id-format-example"><artwork><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                    IPv4 LSP Source Address                    |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |           Reserved            |            LSP ID             |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  :                                                               :
  :                      Variable Length ID                       :
  :                                                               :
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
	</figure>

	<t><list style="hanging" hangIndent="3"><t hangText="IPv4 LSP Source Address">
	<vspace blankLines="1"/>
	IPv4 source address of the forward LSP <xref target="RFC3209"/>.
	</t>

	<t hangText="LSP ID">
	<vspace blankLines="1"/>
	16-bit LSP ID of the forward LSP <xref target="RFC3209"/>.
	</t>

	<t hangText="Variable Length ID">
	<vspace blankLines="1"/>
	Variable length Extended Association ID <xref target="RFC6780"/>
	inserted by the endpoint node
	of the associated bidirectional LSP <xref target="RFC7551"/>.
	</t>
      </list></t>
	<t>An example of the IPv6 Extended Association ID format is shown below:
	</t>




	<figure title="IPv6 Extended Association ID Format Example" anchor="ref-ipv6-extended-association-id-format-example"><artwork><![CDATA[
   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |                                                               |
  +                                                               +
  |                    IPv6 LSP Source Address                    |
  +                                                               +
  |                          (16 bytes)                           |
  +                                                               +
  |                                                               |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  |           Reserved            |            LSP ID             |
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
  :                                                               :
  :                      Variable Length ID                       :
  :                                                               :
  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
	</figure>
	<t><list style="hanging" hangIndent="3"><t hangText="LSP Source Address">
	<vspace blankLines="1"/>
	IPv6 source address of the forward LSP <xref target="RFC3209"/>.
	</t>

	<t hangText="LSP ID">
	<vspace blankLines="1"/>
	16-bit LSP ID of the forward LSP <xref target="RFC3209"/>.
	</t>

	<t hangText="Variable Length ID">
	<vspace blankLines="1"/>
	Variable length Extended Association ID <xref target="RFC6780"/>
	inserted by the endpoint node
	of the associated bidirectional LSP <xref target="RFC7551"/>.
	</t>

	</list>
	</t>

	<t>
   In both IPv4 and IPv6 examples, the Reserved flags MUST be set to 0
   on transmission.</t>

	</section>

	<section title="Acknowledgments" numbered="no" anchor="acknowledgments"><t>
   A special thanks to the authors of <xref target="RFC8271"/>; this document uses the
   signaling mechanisms defined in that document.  The authors would
   also like to thank Vishnu Pavan Beeram, Daniele Ceccarelli, Deborah
   Brungard, Adam Roach, and Benjamin Kaduk for reviewing this document
   and providing valuable comments.</t>

	</section>

	</back>

	</rfc>
	

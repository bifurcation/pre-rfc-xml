<?xml version="1.0" encoding="US-ASCII"?>


<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc sortrefs="yes"?>
<?rfc linkmailto="no"?>
<?rfc symrefs="yes"?>
<?rfc rfcedstyle="yes"?>
<?rfc compact="yes"?>  
<?rfc subcompact="no"?>

<rfc number="7195" ipr="trust200902" category="std" submissionType="IETF" consensus="yes">

  <front>
    <title abbrev="PSTN Circuit-Switched Bearers in SDP">
      Session Description Protocol (SDP) Extension for Setting&nbsp;Audio&nbsp;and&nbsp;Video&nbsp;Media&nbsp;Streams&nbsp;over&nbsp;Circuit&nbhy;Switched&nbsp;Bearers&nbsp;in
      the Public Switched Telephone Network (PSTN)
    </title>
    
    <author initials="M" surname="Garcia-Martin" fullname="Miguel A. Garcia-Martin">
      <organization>Ericsson</organization>
      <address>
	<postal>
	  <street>Calle Via de los Poblados 13</street>
	  <city>Madrid</city> 
	  <region>ES</region> 
	  <code>28033</code>
	  <country>Spain</country>
	</postal>
	<email>miguel.a.garcia@ericsson.com</email>
      </address>
    </author>

    <author initials="S" surname="Veikkolainen" fullname="Simo Veikkolainen">
      <organization>Nokia</organization>
      <address>
	<postal>
	  <street>P.O. Box 226</street>
	  <city>NOKIA GROUP</city> 
	  <region>FI</region> 
	  <code>00045</code>
	  <country>Finland</country>
	</postal>
	<phone>+358 50 486 4463 </phone>
	<email>simo.veikkolainen@nokia.com</email>
      </address>
    </author>

    <date month="April" year="2014" />
    <area>RAI</area>
    <workgroup>MMUSIC WG</workgroup>
    <keyword>PSTN</keyword>


    <abstract>
      <t>
	This memo describes use cases, requirements, and protocol
	extensions for using the Session Description Protocol (SDP)
	offer/answer model for establishing audio and video media
	streams over circuit-switched bearers in the Public Switched 
	Telephone Network (PSTN).
      </t>
    </abstract> 
  </front>
  
  <middle>
    <section anchor="intro" title="Introduction">
      
      <t>
	The <xref target="RFC4566">Session Description Protocol
	(SDP)</xref> is intended for describing multimedia sessions
	for the purposes of session announcement, session invitation,
	and other forms of multimedia session initiation. SDP is most
	commonly used for describing media streams that are
	transported over the <xref target="RFC3550">Real-Time
	Transport Protocol (RTP)</xref>, using the profiles for audio
	and video media defined in <xref target="RFC3551">"RTP Profile for Audio
and Video Conferences with Minimal Control"</xref>.
      </t>
      
      <t>
	However, SDP can be used to describe media transport
	protocols other than RTP. Previous work includes <xref
	target="RFC3108">SDP conventions for describing ATM bearer
	connections</xref> and the <xref target="RFC4975">Message
	Session Relay Protocol</xref>.
      </t>

      <t>
	SDP is commonly carried in <xref target="RFC3261">Session
	Initiation Protocol (SIP)</xref> messages in order to agree on
	a common media description among the endpoints. <xref
	target="RFC3264">"An Offer/Answer Model with the Session
	Description Protocol (SDP)"</xref> defines a framework by which
	two endpoints can exchange SDP media descriptions and come to
	an agreement as to which media streams should be used, along
	with the media-related parameters.
      </t>
      
      <t>
	In some scenarios, it might be desirable to establish the media
	stream over a circuit-switched bearer connection even if the
	signaling for the session is carried over an IP bearer. An
	example of such a scenario is illustrated with two mobile
	devices capable of both circuit-switched and packet-switched
	communication over a low-bandwidth radio bearer. The radio
	bearer may not be suitable for carrying real-time audio or
	video media, and using a circuit-switched bearer would offer
	a better perceived quality of service. So, according
	to this scenario, SDP and its higher-layer session control
	protocol (e.g., the <xref target="RFC3261">Session Initiation
	Protocol (SIP) </xref>) are used over regular IP connectivity,
	while the audio or video is received through the classical
	circuit-switched bearer.
      </t>

      <t>
	This document addresses only the use of circuit-switched
	bearers in the PSTN, not a generic circuit-switched
	network. The mechanisms presented below require a call
	signaling protocol of the PSTN to be used (such as <xref
	target="ITU.Q931.1998">ITU-T Q.931 </xref> or <xref
	target="TS.24.008">3GPP TS 24.008</xref>).
      </t>

      <t>
	Setting up a signaling relationship in the IP domain instead
	of just setting up a circuit-switched call also offers the
	possibility of negotiating, in the same session, other IP-based
	media that is not sensitive to jitter and delay, for
	example, text messaging or presence information.
      </t>

      <t>
	At a later point in time, the mobile device might move to an
	area where a high-bandwidth packet-switched bearer, for
	example, a Wireless Local Area Network (WLAN) connection, is
	available. At this point, the mobile device may perform a
	handover and move the audio or video media streams over to the
	high-speed bearer. This implies a new exchange of SDP
	offer/answer that leads to a renegotiation of the media
	streams.
      </t>

      <t>
	Other use cases exist. For example, an endpoint might have at
	its disposal circuit-switched and packet-switched
	connectivity, but the same audio or video codecs are not
	feasible for both access networks. For example, the
	circuit-switched audio or video stream supports
	narrow-bandwidth codecs, while the packet-switched access
	allows any other audio or video codec implemented in the
	endpoint. In this case, it might be beneficial for the
	endpoint to describe different codecs for each access type and
	get an agreement on the bearer together with the remote
	endpoint.
      </t>

      <t>
	There are additional use cases related to third party call
	control where the session setup time is improved when the
	circuit-switched bearer in the PSTN is described together with
	one or more codecs.
      </t>


      <t>
	The rest of the document is structured as follows: <xref
	target="sec-conventions"/> provides the document conventions,
	<xref target="sec-requirements"/> introduces the requirements,
	<xref target="sec-overview"/> presents an overview of the
	proposed solutions, and <xref
	target="sec-protocol-description"/> contains the protocol
	description.  <xref target="sec-sdp-examples" /> provides 
	examples of circuit-switched audio or
	video streams in SDP. Sections <xref target="sec-security" format="counter"/> and <xref
	target="sec-iana" format="counter"/> contain the Security and IANA 
	considerations, respectively.
      </t>

    </section>

    <section title="Conventions Used in This Document" anchor="sec-conventions">
      
      <t>
	The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
	NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT
	RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
	interpreted as described in BCP 14, <xref target="RFC2119">RFC
	2119</xref> and indicate requirement levels for compliant
	implementations.
      </t>
      
    </section>
    
    <section title="Requirements" anchor="sec-requirements">
      

      <t>
	This section presents the general requirements that are specific for
	the audio or video media streams over circuit-switched bearers.
      </t>
      
      <t><list style='format REQ-%d:'>
	<t>
	  A mechanism for endpoints to negotiate and agree on an audio
	  or video media stream established over a circuit-switched
	  bearer MUST be available.
	</t>
	
	<t>
	  The mechanism MUST allow the endpoints to combine
	  circuit-switched audio or video media streams with other
	  complementary media streams, for example, text messaging.
	</t>

	<t>
	  The mechanism MUST allow the endpoint to negotiate the
	  direction of the circuit-switched bearer, i.e., which
	  endpoint is active when initiating the circuit-switched
	  bearer.
	</t>
	
	<t>
	  The mechanism MUST be independent of the type of the
	  circuit-switched access (e.g., Integrated Services Digital
	  Network (ISDN), Global System for Mobile Communication
	  (GSM), etc.)
	</t>

	<t>
	  There MUST be a mechanism that helps an endpoint to
	  correlate an incoming circuit-switched bearer with the one
	  negotiated in SDP, as opposed to another incoming call that
	  is not related to that. In case correlation by programmatic means
          is not possible, correlation may also be performed by the
          human user.
	</t>

	<t>
	  It MUST be possible for endpoints to advertise different
	  lists of audio or video codecs in the circuit-switched audio
	  or video stream from those used in a packet-switched audio
	  or video stream.
	</t>

	<t>
	  It MUST be possible for endpoints to not advertise the list
	  of available codecs for circuit-switched audio or video
	  streams. 
	</t>


      </list></t>
    </section>

    <section title="Overview of Operation" anchor="sec-overview">


      <t>
	The mechanism defined in this memo extends SDP <xref target="RFC4566"></xref> and allows
	describing an audio or video media stream established over a
	circuit-switched bearer. A new network type ("PSTN") and a new
	protocol type ("PSTN") are defined for the "c="
	and "m=" lines to be able to describe a media
	stream over a circuit-switched bearer. These SDP extensions
	are described in <xref target="sec-sdp-extensions"/>. Since 
	circuit-switched bearers are connection-oriented media
	streams, the mechanism reuses the connection-oriented  
	extensions defined in <xref target="RFC4145">RFC 4145</xref>
	to negotiate the active and passive sides of a connection
	setup. This is further described in <xref
	target="sec-connection-direction"/>.
      </t>

      <section title="Example Call Flow" anchor="sec-example">
	<t>
	  Consider the example presented in <xref
	  target="fig-example-flow"/>.  In this example, Endpoint A is 
	  located in an environment where it has access to both IP
	  and circuit-switched bearers for communicating with other
	  endpoints. Endpoint A decides that the circuit-switched
	  bearer offers a better perceived quality of service for
	  voice and issues an SDP offer containing the description of
	  an audio media stream over a circuit-switched bearer.
	</t>

	<figure anchor="fig-example-flow" title="Example Flow" align="center">
	  <artwork><![CDATA[
 Endpoint A                        Endpoint B
   | (1) SDP offer (PSTN audio)         |
   |----------------------------------->|
   |                                    |
   | (2) SDP answer (PSTN audio)        |
   |<-----------------------------------|
   |                                    |
   |   PSTN call setup                  |
   |<-----------------------------------|
   |                                    |
   |                                    |
   |<===== media over PSTN bearer =====>|
   |                                    |
  ]]></artwork>
	</figure>

	
	<t>
	  Endpoint B receives the SDP offer and determines that it is
	  located in an environment where the IP-based bearer is not
	  suitable for real-time audio media. However, Endpoint B also
	  has a PSTN circuit-switched bearer available for
	  audio. Endpoint B generates an SDP answer containing a
	  description of the audio media stream over a
	  circuit-switched bearer. 
	</t>
		
	<t>
	  During the offer/answer exchange, Endpoints A and B also
	  agree upon the direction in which the circuit-switched bearer
	  should be established. In this example, Endpoint B becomes
	  the active party; in other words, it establishes the
	  circuit-switched call to the other endpoint. The
	  offer/answer exchange contains identifiers or references
	  that can be used on the circuit-switched network for
	  addressing the other endpoint, as well as information that
	  is used to determine that the incoming circuit-switched
	  bearer establishment is related to the ongoing session
	  between the two endpoints.
	</t>
	
	<t>
	  Endpoint B establishes a circuit-switched bearer towards
	  Endpoint A using whatever mechanisms are defined for the
	  network type in question. When receiving the incoming
	  circuit-switched connection attempt, Endpoint A is able to
	  determine that the attempt is related to the session it is
	  just establishing with B.
	</t>
	
	<t>
	  Endpoint A accepts the circuit-switched connection; the
	  circuit-switched bearer setup is completed. The two endpoints
	  can now use the circuit-switched connection for two-way
	  audio media. 
	</t>

	<t>
	  If, for some reason, Endpoint B would like to reject the
	  offered stream, it would set the port number of the specific
	  stream to zero, as specified in <xref
	  target="RFC3264">RFC 3264</xref>. Also, if B does not
	  understand some of the SDP attributes specified in this
	  document, it would ignore them, as specified in
	  <xref target="RFC4566">RFC 4566</xref>.
	</t>

      </section>

    </section>

    <section title="Protocol Description"
	     anchor="sec-protocol-description">

      <section title="Level of Compliance" anchor="sec-compliance">

	<t>
	  Implementations that are compliant with this specification MUST
	  implement the SDP extensions described in
	  <xref target="sec-sdp-extensions"/> and MUST implement the
	  considerations discussed in Sections <xref
	  target="sec-correlation-negotiation" format="counter"/>, <xref
	  target="sec-sdp-considerations" format="counter"/>, and <xref
	  target="sec-offer-answer-ext" format="counter"/>. 


	</t>

      </section>


      <section title="Extensions to SDP" anchor="sec-sdp-extensions">

	<t>
	  This section provides the syntax and semantics of the
	  extensions required for providing a description of audio
	  or video media streams over circuit-switched bearers in SDP.
	</t>

	<section title="Connection Data" anchor="sec-c-line">

	  <t>
	    According to <xref target="RFC4566">SDP</xref>, the
	    connection data line in SDP has the following syntax:
	  </t>
	  <t><list>
	    <t>
	      c=&lt;nettype&gt; &lt;addrtype&gt; &lt;connection-address&gt;
	    </t>
	  </list></t>
	  <t>
	    where &lt;nettype&gt; indicates the network type,
	    &lt;addrtype&gt; indicates the address type, and 
	    &lt;connection-address&gt; is the connection address, which
	    is dependent on the address type. 
	  </t>
	  <t>
	    At the moment, the only network type defined is "IN", which
	    indicates Internet network type. The address types "IP4" and
	    "IP6" indicate the type of IP addresses.
	  </t>

	  <t>
	    This memo defines a new network type for describing a
	    circuit-switched bearer network type in the PSTN. The mnemonic
	    "PSTN" is used for this network type.
	  </t>

	  <t>
	    For the address type, we initially considered the
	    possibility of describing E.164 telephone numbers. We
	    define a new "E164" address type to be used within the
	    context of a "PSTN" network type. The "E164" address type
	    indicates that the connection address contains an
	    E.164 number represented according to the
	    <xref target="ITU.E164.2010">ITU-T E.164 </xref>
	    recommendation. 
	  </t>
	  <t>
	    It is a common convention that an international E.164
	    number contains a leading '+' sign. For consistency's
	    sake, we also require the E.164 telephone is prepended
	    with a '+', even if that is not necessary for routing of
	    the call in the PSTN network. 
	  </t>

	  <t>
	    There are cases, though, when the endpoint is merely aware
	    of a circuit-switched bearer, without having further
	    information about the E.164 number
	    allocated to it. In these cases, a dash ("-") is used to
	    indicate an unknown connection address. 
This makes the connection data line consistent with SDP syntax.
	  </t>


	  <t>
	    Please note that the "E164" address type
	    defined in this memo is exclusively defined to be used in 
	    conjunction with the "PSTN" network type in accordance
	    with regular offer/answer procedures <xref target="RFC4566"/>. 
	  </t>

<t><list>
<t>Note: RFC 3108 <xref target="RFC3108"/> also defines address type "E.164". This
definition is distinct from the one defined by this memo and shall
not be used with &lt;nettype&gt; "PSTN".
</t>
</list>
</t>
	  <t>
	    This memo exclusively uses the international
	    representation of E.164 numbers, i.e., those including a
	    country code and, as described above, prepended 
	    with a '+' sign. Implementations conforming to this
	    specification and using the "E164" address type together
	    with the "PSTN" network type MUST use the
	    'global-number-digits' construction specified in
	    <xref target="RFC3966">RFC 3966 </xref> for representing
	    international E.164 numbers. This
	    representation requires the presence of the '+'
	    sign and additionally allows for the
	    presence of one or more 'visual-separator' constructions
	    for easier human readability (see <xref
	    target="sec-syntax"/>). 
	  </t>

	  <t>
	      Note that &lt;connection-address&gt; MUST NOT be omitted
	      when unknown since this would violate basic syntax of
	      <xref target="RFC4566">SDP</xref>. In such cases, it
	      MUST be set to a "-". 
	  </t>
	  
	  <t>
	    The following are examples of the extension to the
	    connection data line:
	  </t>
	  <t><list>
	    <t>
	      c=PSTN E164 +441134960123
	    </t>
	    <t>
	      c=PSTN E164 -
	    </t>
	  </list></t>

	  <t>
	    When the &lt;addrtype&gt; is E164, the connection address
	    is defined as follows:
	    <list style="symbols">
	      <t>an international E.164 number (prepended with a '+' sign)</t>
	      <t>the value "-", signifying that the address is
	      unknown</t>
	      <t>any other value resulting from the production rule of
	      connection-address in <xref target="RFC4566">RFC 4566</xref>, but in all cases any
	      value encountered will be ignored.</t> 

	    </list>
	  </t>

	</section>


	<section title="Media Descriptions" anchor="sec-m-line">
	  <t>
	    According to <xref target="RFC4566">SDP</xref>, the
	    media description line in SDP has the following syntax:
	  </t>
	  <t><list>
	    <t>
	      m=&lt;media&gt; &lt;port&gt; &lt;proto&gt; &lt;fmt&gt; ...
	    </t>
	  </list>
	  </t>
	  <t>
	    The &lt;media&gt; subfield carries the media type. For
	    establishing an audio bearer, the existing "audio" media
	    type is used. For establishing a video bearer, the
	    existing "video" media type is used.
	  </t>

	  <t> 
	    The &lt;port&gt; subfield is the transport port to which
	    the media stream is sent. Circuit-switched access lacks
	    the concept of a port number; therefore, the
	    &lt;port&gt; subfield does not carry any meaningful
	    value. In order to be compliant with SDP syntax,
	    implementations SHOULD set the &lt;port&gt; subfield to the
	    discard port value "9" and MUST ignore it on reception.
	  </t>

	  <t>
	    According to <xref target="RFC3264">RFC 3264</xref>, a port
	    number of zero in the offer of a unicast stream indicates
	    that the stream is offered but must not be used. If a
	    port number of zero is present in the answer of a unicast
	    stream, it indicates that the stream is rejected. These
	    rules are still valid when the media line in SDP represents
	    a circuit-switched bearer.
	  </t>

	  <t>
	    The &lt;proto&gt; subfield is the transport protocol. The
	    circuit-switched bearer uses whatever transport protocol it
	    has available. This subfield SHOULD be set to the mnemonic
	    "PSTN" to be syntactically correct with <xref
	    target="RFC4566">SDP </xref> and to indicate the usage of
	    circuit-switched protocols in the PSTN.
	  </t>

	  <t>
	    The &lt;fmt&gt; subfield is the media format
	    description. In the classical usage of SDP to describe
	    RTP-based media streams, when the &lt;proto&gt; subfield is
	    set to "RTP/AVP" or "RTP/SAVP", the &lt;fmt&gt; subfield
	    contains the payload types as defined in the <xref
	    target="RFC3551">RTP audio profile</xref>.
	  </t>

	  <t>
	    When "RTP/AVP" is used in the &lt;proto&gt; field, the
	    &lt;fmt&gt; subfield contains the RTP payload type
	    numbers. We use the &lt;fmt&gt; subfield to indicate the
	    list of available codecs over the circuit-switched
	    bearer, by reusing the conventions and payload type
	    numbers defined for RTP / AVP. The RTP audio and video media
	    types, when applied to PSTN circuit-switched
	    bearers, represent merely an audio or video codec. If the
	    endpoint is able to determine the list of available codecs
	    for circuit-switched media streams, it MUST
	    use the corresponding payload type numbers in the
	    &lt;fmt&gt; subfield.
	  </t>

	  <t>
	    In some cases, the endpoint is not able to
	    determine the list of available codecs for circuit-switched
	    media streams. In this case, in order to be syntactically
	    compliant with <xref target="RFC4566">SDP </xref>, the
	    endpoint MUST include a single dash ("-") in the &lt;fmt&gt;
	    subfield.
	  </t>
	  <t>
	    As per <xref target="RFC4566">RFC 4566</xref>, the media
	    format descriptions are listed in priority order.
	  </t>

	  <t>
	    Examples of media descriptions for circuit-switched audio
	    streams are:
	  </t>
	  <t>
	    <list>
	      <t>
		m=audio 9 PSTN 3 0 8 
	      </t>
	      <t>
		m=audio 9 PSTN -
	      </t>
	    </list>
	  </t>

	  <t>
	    Similarly, an example of a media description for
	    circuit-switched video stream is:
	  </t>
	  <t>
	    <list>
	      <t>
		m=video 9 PSTN 34
	      </t>
	      <t>
		m=video 9 PSTN -
	      </t>
	    </list>
	  </t>

	  
	</section>
	
	<section title="Correlating the PSTN Circuit-Switched Bearer with SDP"
		 anchor="sec-correlation">
	  <t>
	    The endpoints should be able to correlate the
	    circuit-switched bearer with the session negotiated with
	    SDP in order to avoid ringing for an incoming
	    circuit-switched bearer that is related to the session
	    controlled with SDP (and SIP).
	  </t>
	  
	  <t>
	    Several alternatives exist for performing this
	    correlation. This memo provides three mutually non-exclusive
	    correlation mechanisms. 
   Additionally, we define a fourth mechanism where correlation may be
   performed by external means, typically by the human user, in case
   using other correlation mechanisms is not possible or does not
   succeed. 
Other correlation mechanisms may
	    exist, and their usage will be specified when need
	    arises. </t>

<t>All mechanisms share the same principle: some
	    unique information is sent in the SDP and in the
	    circuit-switched signaling protocol. If these pieces of
	    information match, then the circuit-switched bearer is
	    part of the session described in the SDP
	    exchange. Otherwise, there is no guarantee that the
	    circuit-switched bearer is related to such session. 
	  </t>

	  <t>
	    The first mechanism is based on the exchange of PSTN
	    Caller ID between the endpoints. The Caller ID is also
	    available as the Calling Party Number in the circuit-switched
	    signaling. 


	  </t>

	  <t>
	    The second mechanism is based on the inclusion in
	    SDP of a value that is also sent in the User-User
	    Information Element that is part of the bearer setup
	    signaling in the PSTN. 
	  </t>

	  <t>
	    The third mechanism is based on sending in SDP a string
	    that represents Dual-Tone Multi-Frequency (DTMF) digits
	    that will be later sent right after the circuit-switched
	    bearer is established. 
          </t>

<t>
   The fourth correlation mechanism declares support for cases where
   correlation is done by external means.  Typically, this means that the
   decision is left to the human user.  This is how some
   current conferencing systems operate: after logging on to the
   conference, the system calls back to the user's phone number to
   establish audio communications, and it is up to the human user to
   accept or reject the incoming call.  By declaring explicit support
   for this mechanism, endpoints can use it only when such a possibility
   exists.
</t>

<t>
            Endpoints may opt to implement any combination
            of the correlation mechanisms specified in Sections <xref
            target="sec-corr-caller-id" format="counter"/>, <xref
            target="sec-corr-uuie" format="counter"/>, <xref
            target="sec-corr-dtmf" format="counter"/>, and <xref
            target="sec-corr-external" format="counter"/>, including the option to
            implement none at all.

	  </t>

	  <section title="The &quot;cs&nbhy;correlation&quot; Attribute"
		   anchor="sec-corr-attr">

	   <t>
	     In order to provide support for the correlation
	     mechanisms, we define a new media-level SDP attribute
	     called "cs&nbhy;correlation". 
There MUST
   be at most one "cs&nbhy;correlation" attribute per media description.
</t>
<t>This "cs&nbhy;correlation" attribute 
	     MAY contain zero or more subfields -- "callerid", "uuie",
"dtmf", or "external" to
	     specify additional information
	     required by the Caller ID, User-User Information Element,
	     DTMF, or external correlation mechanisms, respectively. The list of
	     correlation mechanisms may be extended by other
	     specifications; see <xref target="sec-corr-extensions"/>
	     for more details.
	   </t>

	   <t>
	     The following sections provide more detailed information
	     about these subfields.
	  </t>

	  <t>
            The values "callerid", "uuie", "dtmf", and "external" refer
            to the correlation mechanisms defined in Sections <xref
            target="sec-corr-caller-id" format="counter"/>, <xref
            target="sec-corr-uuie" format="counter"/>, <xref
            target="sec-corr-dtmf" format="counter"/>, and <xref
            target="sec-corr-external" format="counter"/>, respectively.  The formal
            Augmented Backus-Naur Format (ABNF) syntax of the
            "cs-correlation" attribute is presented in <xref
            target="sec-syntax"/>.
	  </t>


	  </section>

	  <section title="Caller ID Correlation Mechanism" anchor="sec-corr-caller-id">

	    <t>
	      The Caller ID correlation mechanism consists of an
	      exchange of the Calling Party Number as an international
	      E.164 number in SDP, followed by the availability of the
	      Calling Party Number Information Element in the call
	      setup signaling of the circuit-switched connection. If
	      both pieces of information match, the circuit-switched
	      bearer is correlated to the session described in SDP.
	    </t>

	    <t>
	      An example of inclusion of an international E.164 number in
	      the "cs&nbhy;correlation" attribute is:
	    </t>
	    <t>
	      <list>
		<t>a=cs&nbhy;correlation:callerid:+441134960123</t>
	      </list>
	    </t>


	    <t>
	      The presence of the "callerid" subfield indicates that
	      the endpoint supports use of the Calling Party Number as
	      a means of correlating a PSTN call with the session
	      being negotiated. The "callerid" subfield MAY be
	      accompanied by the international E.164 number of the
	      party inserting the parameter.

	      <list>
		<t>
		  Note that there are no guarantees that this
		  correlation mechanism works or is even available, due a
		  number of problems:


	      <list style="symbols">
		<t>
		  The endpoint might not be aware of its own E.164
		  number, in which case it cannot populate the SDP
		  appropriately.
		</t>
		
		<t>
		  The Calling Party Number Information Element in the
		  circuit-switched signaling might not be available,
		  e.g., due to policy restrictions of the network
		  operator or caller restriction due to privacy.
		</t>
		
		<t>
		  The Calling Party Number Information Element in the
		  circuit-switched signaling might be available, but
		  the digit representation of the E.164 number might
		  differ from the one expressed in the SDP, due to,
		  e.g., lack of country code. To mitigate this
		  problem, implementations should consider only some of
		  the rightmost digits from the E.164 number for
		  correlation. For example, the numbers
		  +44-113-496-0123 and 0113-496-0123 could be
		  considered as the same number. This is also the
		  behavior of some cellular phones, which correlate
		  the incoming calling party with a number stored in
		  the phone book, for the purpose of displaying the
		  caller's name. Please refer to <xref
		  target="ITU.E164.2010">ITU-T E.164 recommendation
		  </xref> for consideration of the relevant number of
		  digits to consider.
		</t>
	      </list>
</t>
	      </list>
	    </t>

	  </section>	  
	  
	  <section title="User-User Information Element Correlation
			  Mechanism" anchor="sec-corr-uuie"> 

	    <t>
	      A second correlation mechanism is based on including in
	      SDP a string that represents the User-User Information
	      Element that is part of the call setup signaling of the
	      circuit-switched bearer. The User-User Information
	      Element is specified in <xref
	      target="ITU.Q931.1998">ITU-T Q.931 </xref> and <xref
	      target="TS.24.008">3GPP TS 24.008</xref>, among 
	      others. The User-User Information Element has a maximum
	      size of 35 or 131 octets, depending on the actual
	      message of the PSTN protocol where it is included and
	      the network settings.
	    </t>
	    
	    <t>
	      The mechanism works as follows. An endpoint creates a
	      User-User Information Element, according to the
	      requirements of the call setup signaling protocol. The
	      same value is included in the SDP offer or SDP answer,
	      in the "uuie" subfield of the "cs&nbhy;correlation"
	      attribute. When the SDP offer/answer exchange is
	      completed, each endpoint has become aware of the value
	      that will be used in the User-User Information Element
	      of the call setup message of the PSTN protocol. The
	      endpoint that initiates the call setup attempt includes
	      this value in the User-User Information Element. The
	      recipient of the call setup attempt can extract the
	      User-User Information Element and correlate it with the
	      value previously received in the SDP. If both values
	      match, then the call setup attempt corresponds to that
	      indicated in the SDP.
	    </t>

	    <t>
	      According to <xref target="ITU.Q931.1998">ITU-T
	      Q.931</xref>, the User-User Information Element (UUIE)
	      identifier is composed of a first octet identifying this
	      as a User-User Information Element, a second octet
	      containing the length of the user-user contents, a third
	      octet containing a Protocol Discriminator, and a value
	      of up to 32 or 128 octets (depending on network
	      settings) containing the actual User Information (see
	      Figure 4-36 in <xref target="ITU.Q931.1998"/>). The first two octets of the
	      UUIE MUST NOT be used for correlation; only the octets
	      carrying the Protocol Discriminator and the User
	      Information value are input to the creation of the value
	      of the "uuie" subfield in the "cs&nbhy;correlation"
	      attribute. Therefore, the value of the "uuie" subfield
	      in the "cs&nbhy;correlation" attribute MUST start with the
	      Protocol Discriminator octet, followed by the User
	      Information octets. The value of the Protocol
	      Discriminator octet is not specified in this document;
	      it is expected that organizations using this technology
	      will allocate a suitable value for the Protocol
	      Discriminator.
	    </t>



	    <t>
	      Once the binary value of the "uuie" subfield in the
	      "cs&nbhy;correlation" attribute is created, it MUST be base 16
	      (also known as "hex") encoded before it is inserted in
	      SDP. Please refer to <xref target="RFC4648">RFC
	      4648</xref> for a detailed description of base 16
	      encoding. The resulting encoded value needs to have an
	      even number of hexadecimal digits and MUST be
	      considered invalid if it has an odd number.
	    </t>
	      
	    <t>


	      <list>
		<t>
		  Note: The encoding of the "uuie" subfield of the
		  "cs&nbhy;correlation" attribute is largely inspired by
		  the encoding of the same value in the User-to-User
		  header field in SIP, according to <xref
		  target="SIP-UUI"> "A Mechanism for
		  Transporting User to User Call Control Information
		  in SIP"</xref>.  
		</t>
	      </list>
	    </t>

	    <t>
	      As an example, an endpoint willing to send a UUIE
	      containing a Protocol Discriminator with the hexadecimal
	      value of %x56 and an hexadecimal User Information value
	      of %xA390F3D2B7310023 would include an "a=cs&nbhy;correlation" attribute
	      line as follows:
	    </t>
	    <t>
	      <list>
		<t>
		  a=cs&nbhy;correlation:uuie:56A390F3D2B7310023
		</t>
	      </list>
	    </t>

	    <t>
	      Note that the value of the
	      User-User Information Element is considered as an opaque
	      string and only used for correlation purposes. Typically,
	      call signaling protocols impose requirements on the
	      creation of a User-User Information Element for end-user
	      protocol exchange. The details regarding the generation of
	      the User-User Information Element are outside the scope of
	      this specification. 
	    </t>

	    <t>
	      Please note that there are no guarantees that this
	      correlation mechanism works. On one side, policy
	      restrictions might not make the User-User information
	      available end to end in the PSTN. On the other hand, the
	      generation of the User-User Information Element is
	      controlled by the PSTN circuit-switched call protocol, which
	      might not offer enough freedom for generating different
	      values from one endpoint to another one or from one call to
	      another in the same endpoint. This might result in the same
	      value of the User-User Information Element for all calls.
	    </t>
	    
	  </section>
	  
	  <section title="DTMF Correlation Mechanism" anchor="sec-corr-dtmf">

	    <t>
	      We introduce a third mechanism for correlating the
	      circuit-switched bearer with the session described with
	      SDP. 
  This is based on
  agreeing on a sequence of digits that are negotiated in the SDP
  offer/answer exchange and sent as DTMF tones as described in ITU-T 
  Recommendation Q.23 <xref target="ITU.Q23.1988"></xref> over the circuit-switched bearer  
  once this bearer is established.
If the DTMF digit sequence received through
	      the circuit-switched bearer matches the digit string
	      negotiated in the SDP, the circuit-switched bearer is
	      correlated with the session described in the SDP. The
	      mechanism is similar to many voice conferencing systems
	      that require the user to enter a PIN code using DTMF
	      tones in order to be accepted in a voice conference.
	    </t>
	    
	    <t>
	      The mechanism works as follows. An endpoint selects a
	      DTMF digit sequence. The same sequence is included in
	      the SDP offer or SDP answer, in a "dtmf" subfield of the
	      "cs&nbhy;correlation" attribute. When the SDP offer/answer
	      exchange is completed, each endpoint has become aware of
	      the DTMF sequence that will be sent right after the
	      circuit-switched bearer is set up. The endpoint that
	      initiates the call setup attempt sends the DTMF digits
	      according to the procedures defined for the
	      circuit-switched bearer technology used. The recipient
	      (passive side of the bearer setup) of the call setup
	      attempt collects the digits and compares them with the
	      value previously received in the SDP. If the digits
	      match, then the call setup attempt corresponds to that
	      indicated in the SDP.
	    </t>

            <t>
	      <list>
		<t>
		  Note: Implementations are advised to select a number of
		  DTMF digits that provide enough assurance that the
		  call is related but do not
		  prolong the bearer setup time unnecessarily. A
		  number of 5 to 10 digits is a good compromise.
		</t>
	      </list>
	    </t>
	    
	    <t>
	      As an example, an endpoint willing to send DTMF tone
	      sequence "14D*3" would include an "a=cs&nbhy;correlation" attribute
	      line as follows:
	    </t>
	    
	    <t>
	      <list>
		<t>a=cs-correlation:dtmf:14D*3</t>
	      </list>
	    </t>
	    
	    <t>
	      If the endpoints successfully agree on the usage of the
	      DTMF digit correlation mechanism but the passive side
	      does not receive any DTMF digits after successful
	      circuit-switched bearer setup or receives a set of DTMF
	      digits that do not match the value of the "dtmf"
	      attribute (including receiving too many digits), the
	      passive side SHOULD consider that this DTMF 
	      mechanism has failed to correlate the incoming call.
	    </t>
	    

	  </section>


          <section title="External Correlation Mechanism"
                   anchor="sec-corr-external">
            <t>
              The fourth correlation mechanism relies on external means
              for correlating the incoming call to the session. Since
              endpoints can select which correlation mechanisms they
              support, it may happen that no other common correlation
              mechanism is found or that the selected correlation
              mechanism does not succeed due to the required feature
              not being supported by the underlying PSTN network. In
              these cases, the human user can make the decision to
              accept or reject the incoming call, thus
              "correlating" the call with the session. 
   Since not all
   endpoints are operated by a human user and since there may be no
   other external means implemented by the endpoint for the
   correlation function, we explicitly define support for
   such a external correlation mechanism.
            </t>

            <t>
              Endpoints wishing to use this external correlation
              mechanism would use the "external" subfield in the
              "cs&nbhy;correlation" attribute. Unlike the other three 
              correlation mechanisms, the "external" subfield does not
              accept a value. The following is an example of an "a=cs&nbhy;correlation"
              attribute line:
            </t>

            <t>
              <list>
                <t>a=cs-correlation:external</t>
              </list>
            </t>

            <t>
              Endpoints that are willing to only use the three
              explicit correlation mechanisms defined in this document
              ("callerid", "uuie", and/or "dtmf") would not include the
              "external" mechanism in the offer/answer exchange.
            </t>

            <t>
              The external correlation mechanism typically relies on
              the human user to make the decision on whether or not the call is
              related
              to the ongoing session. After the user accepts
              the call, that bearer is considered as related to the
              session. There is a small chance that the user receives
              at the same time another circuit-switched call that is
              not related to the ongoing session. The user may reject
              this call if he is able to determine (e.g., based on the
              calling line identification) that the call is not
              related to the session and continue waiting for another
              call attempt. If the user accepts the incoming
              circuit-switched call, but it turns out to be not
              related to the session, the endpoints need to rely on
              the human user to take appropriate action (typically,
              the user would hang up).
            </t>

          </section>



	  <section title="Extensions to Correlation Mechanisms" anchor="sec-corr-extensions">
	   <t>
	     New values for the "cs&nbhy;correlation" attribute may be
	     specified. The registration policy for new values 
	     is "Specification Required"; see <xref
	     target="sec-iana"/>. Any such specification MUST include
	     a description of how the SDP offer/answer mechanism is used
	     to negotiate the use of the new values, taking into
	     account how endpoints determine which side will become
	     active or passive (see <xref
	     target="sec-correlation-negotiation"/> for more details).  
	   </t>

	  <t>
	    If, during the offer/answer negotiation, either endpoint
	    encounters an unknown value in the "cs&nbhy;correlation"
	    attribute, it MUST consider that mechanism as unsupported
	    and MUST NOT include that value in subsequent offer/answer
	    negotiation. 
	  </t>
	  </section>
	</section>
      </section>

      <section title="Negotiating the Correlation Mechanisms"
	       anchor="sec-correlation-negotiation">
	<t>
	  The four correlation mechanisms presented above (based on
	  Called Party Number, User-User Information Element,
	  DTMF digit sending, and external) are non-exclusive and can be used
	  independently of each other. In order to know how to
	  populate the "cs&nbhy;correlation" attribute, the endpoints
	  need to agree which endpoint will become the active party,
	  i.e., the one that will set up the circuit-switched bearer.
	</t>
	

	<section title="Determining the Direction of the Circuit-Switched Bearer Setup"
		 anchor="sec-connection-direction"> 

	  <t>
	    In order to avoid a situation where both endpoints attempt
	    to initiate a connection simultaneously, the direction in
	    which the circuit-switched bearer is set up MUST be
	    negotiated during the offer/answer exchange.
	  </t>

	  <t>
	    The framework defined in <xref target="RFC4145">RFC
	    4145</xref> allows the endpoints to agree which endpoint
	    acts as the active endpoint when initiating a TCP
	    connection.  While <xref target="RFC4145">RFC 4145</xref>
	    was originally designed for establishing TCP connections,
	    it can be easily extrapolated to the connection
	    establishment of circuit-switched bearers. This
	    specification uses the concepts specified in <xref
	    target="RFC4145">RFC 4145</xref> for agreeing on the
	    direction of establishment of a circuit-switched bearer.
	  </t>

	  <t>
	    <xref target="RFC4145">RFC 4145 </xref> defines two new
	    attributes in SDP: "setup" and "connection". The "setup"
	    attribute indicates which of the endpoints should initiate
	    the connection establishment of the PSTN circuit-switched
	    bearer. Four values are defined in Section 4 of <xref
	    target="RFC4145">RFC 4145 </xref>: "active", "passive",
	    "actpass", and "holdconn". Please refer to  Section 4 of <xref
	    target="RFC4145">RFC 4145 </xref> for a detailed description
	    of this attribute.
	  </t>

	  <t>
	    The "connection" attribute indicates whether a new
	    connection is needed or an existing connection is
	    reused. The attribute can take the values "new" or
	    "existing". Please refer to Section 5 of <xref
	    target="RFC4145">RFC 4145 </xref> for a detailed description
	    of this attribute.
	  </t>
	  
	  <t>
	    Implementations that are compliant with this specification MUST support
	    the "setup" and "connection" attributes specified in <xref
	    target="RFC4145">RFC 4145 </xref>, but applied to
	    circuit-switched bearers in the PSTN.
	  </t>

	  <t>
	    We define the active party as the one that initiates the
	    circuit-switched bearer after the offer/answer exchange. The
	    passive party is the one receiving the circuit-switched
	    bearer. Either party may indicate its desire to become the
	    active or passive party during the offer/answer exchange
	    using the procedures described in <xref
	    target="sec-offer-answer-ext"/>. 
	  </t>
	</section>

	<section title="Populating the &#34;cs-correlation&#34; Attribute"
		 anchor="sec-populating-the-cs-correlation-attribute">
	  

	  <t>
	    By defining values for the subfields in the
	    "cs&nbhy;correlation" attribute, the endpoint indicates that
	    it is willing to become the active party and that it
	    can use those values in the Calling Party
	    Number, in the User-User Information Element, or as DTMF tones
	    during the circuit-switched bearer setup.
	  </t>
	  
	  <t>
	    Thus, the following rules apply:
	    <list style="symbols">
	      <t>
		An endpoint that can only become the active party in
		the circuit-switched bearer setup MUST include all
		correlation mechanisms it supports in the
		"cs&nbhy;correlation" attribute and MUST also specify 
		values for the "callerid", "uuie", and "dtmf" subfields. Notice
that the "external" subfield does not accept a value.
	      </t>
	      
	      <t>
		An endpoint that can only become the passive party in the
		circuit-switched bearer setup MUST include all correlation
		mechanisms it supports in the "cs&nbhy;correlation"
		attribute but MUST NOT specify values for the
		subfields. 
	      </t>
	      
	      <t>
		An endpoint that is willing to become either the active or
		passive party (by including the "a=setup:actpass"
		attribute in the offer) MUST include all correlation
		mechanisms it supports in the "cs&nbhy;correlation"
		attribute and MUST also specify values for the
		"callerid", "uuie", and "dtmf" subfields. Notice that the
      "external" subfield does not accept a value.
	      </t>
	    </list>
	  </t>

	</section>

	<section title="Considerations for Correlations"
		 anchor="sec-neg-endpoint-behaviour"> 


	  <t>
	    Passive endpoints should expect an incoming circuit-switched (CS) call for
	    setting up the audio bearer. Passive endpoints MAY
	    suppress the incoming CS alert during certain time
	    periods. Additional restrictions can be applied, such as
	    the passive endpoint not alerting incoming calls
	    originated from the number that was observed during the
	    offer/answer negotiation.
	  </t>

	  <t>
 	    There may be cases when an endpoint is not willing to
	    include one or more correlation mechanisms in the
	    "a=cs&nbhy;correlation" attribute line even if it supports it. For example, some correlation mechanisms
	    can be omitted if the endpoint is certain that the PSTN
	    network does not support carrying the correlation
	    identifier. Also, since using the DTMF-based correlation
	    mechanism requires the call to be accepted before DTMF
	    tones can be sent, some endpoints may enforce a policy
	    restricting this due to, for example, cost associated with
	    received calls, making the DTMF-based mechanism unusable.
	  </t>

	  <t>
	    Note that it cannot be guaranteed that the
	    correlation mechanisms relying on caller identification, User-User
Information Element, and
   DTMF sending will succeed even if the usage of
	    those was agreed beforehand. This is due to the fact that
	    correlation mechanisms require support from the
	    circuit-switched bearer technology used.
	  </t>
	  
	  <t>
	    Therefore, even a single positive indication
	    using any of these mechanisms SHOULD be interpreted by the
	    passive endpoint so that the circuit-switched bearer
	    establishment is related to the ongoing session, even if
	    the other correlation mechanisms fail.
	  </t>

	  <t>
            If, after successfully negotiating any of the "callerid",
            "uuie", or "dtmf" correlation mechanisms in the SDP
            offer/answer exchange, an endpoint receives an incoming
            establishment of a circuit-switched bearer with no
            correlation information present, the endpoint first checks
            whether or not the offer/answer exchange was also used to successfully
            negotiate the "external" correlation mechanism. If it
            was, the endpoint should let the decision be made by
            external means, typically the human user. If the
            "external" correlation mechanism was not successfully
            negotiated, the endpoint should treat the call as
    unrelated to the ongoing session in the IP domain.
	  </t>

	  
	  </section>

	</section>      

	<section title="Considerations for Usage of Existing SDP"
	       anchor="sec-sdp-considerations">


	  <section title="Originator of the Session" anchor="sec-originator">
	    <t>
	      According to <xref target="RFC4566">SDP</xref>, the
	      origin line in SDP has the following syntax:
	    </t>
	    <t><list>
	      <t>
		o=&lt;username&gt; &lt;sess-id&gt; &lt;sess-version&gt; &lt;nettype&gt; &lt;addrtype&gt; &lt;unicast-address&gt;
	      </t>
	    </list>
	    </t>
	    <t>
	      Of interest here are the &lt;nettype&gt; and
	      &lt;addrtype&gt; fields, which indicate the type of network
	      and type of address, respectively. Typically, this field
	      carries the IP address of the originator of the
	      session. Even if the SDP was used to negotiate an audio or
	      video media stream transported over a circuit-switched
	      bearer, the originator is using SDP over an IP
	      bearer. Therefore, &lt;nettype&gt; and &lt;addrtype&gt;
	      fields in the "o=" line should be populated with the IP
	      address identifying the source of the signaling.
	    </t>
	  </section>
	  
	  
	  <section title="Contact Information" anchor="sec-contact-info">
	    <t>
	      <xref target="RFC4566">SDP</xref> defines the "p=" line,
	      which may include the phone number of the person
	      responsible for the conference. Even though this line can
	      carry a phone number, it is not suited for the purpose of
	      defining a connection address for the media. Therefore, we
	      have selected to define the PSTN-specific connection
	      addresses in the "c=" line.
	    </t>
	  </section>
	  
	</section>
	
	<section title="Considerations for Usage of Third Party Call Control (3PCC)"
	       anchor="sec-3pcc-considerations">

	  <t>
	    <xref target="RFC3725">"Best Current Practices for Third
	    Party Call Control (3PCC) in the Session Initiation
	    Protocol (SIP)"</xref> outlines several flows that are
	    possible in third party call control scenarios and
	    recommends some flows for specific situations.
	  </t>

	  <t>
	    One of the assumptions in <xref target="RFC3725"/> is that an
	    SDP offer may include a "black hole" connection address,
	    which has the property that packets sent to it will never
	    leave the host that sent them. For IPv4, this "black
	    hole" connection address is 0.0.0.0 or a domain name
	    within the .invalid DNS top level domain.  
	  </t>

	  <t>
	    When using an E.164 address scheme in the context of
	    third party call control, when the User Agent needs to
	    indicate an unknown phone number, it MUST populate the
	    &lt;addrtype&gt; of the SDP "c=" line with a "-" string. 
	  </t>

	  <t>
	    <list>
	      <t>
		Note: This may result in the recipient of the
		initial offer rejecting such offer if the recipient of
		the offer was not aware of its own E.164
		number. Consequently, it will not be possible to
		establish a circuit-switched bearer, since neither
		party is aware of its E.164 number.
	      </t>
	    </list>
	  </t>
	</section>
	
      <section title="Offer/Answer Mode Extensions"
	       anchor="sec-offer-answer-ext">

	<t>
	  In this section, we define extensions to the offer/answer
	  model defined in <xref target="RFC3264">"An Offer/Answer Model with
the Session Description Protocol (SDP)"</xref> to allow for PSTN addresses to
	  be used with the offer/answer model.
	</t>

	<section title="Generating the Initial Offer"
		 anchor="sec-generating-the-initial-offer">
	  <t>
	    The offerer, wishing to use PSTN audio or video stream,
	    MUST populate the "c=" and "m=" lines as follows.
	  </t>

	  <t>
	    The endpoint MUST set the &lt;nettype&gt; in the "c=" line
	    to "PSTN" and the &lt;addrtype&gt; to
	    "E164". Furthermore, the endpoint SHOULD set the
	    &lt;connection-address&gt; field to its own international
	    E.164 number (with a leading "+"). If the endpoint is not
	    aware of its own E.164 number, it MUST set the
	    &lt;connection-address&gt; to "-".
	  </t>

	  <t>
	    In the "m=" line, the endpoint MUST set the &lt;media&gt;
	    subfield to "audio" or "video", depending on the media
	    type, and the &lt;proto&gt; subfield to "PSTN". The
	    &lt;port&gt; subfield SHOULD be set to "9" (the discard
	    port). The values "audio" or "video" in the &lt;media&gt;
	    subfield MUST NOT be set by the endpoint unless it has
	    knowledge that these bearer types are available on the
	    circuit-switched network.
	  </t>

	  <t>
	    The &lt;fmt&gt; subfield carries the payload type
	    number(s) the endpoint is wishing to use. Payload type
	    numbers in this case refer to the codecs that the endpoint
	    wishes to use on the PSTN media stream. For example, if the
	    endpoint wishes to use the GSM codec, it would add payload
	    type number 3 in the list of codecs. The list of payload
	    types MUST only contain those codecs the endpoint is
	    able to use on the PSTN bearer. In case the endpoint is
	    not aware of the codecs available for the circuit-switched
	    media streams, it MUST include a dash ("-") in the
	    &lt;fmt&gt; subfield.
	  </t>

	  <t>
	    The mapping table of static payload types numbers to
	    payload types is initially specified in <xref
	    target="RFC3551"/> and maintained by IANA. For 
	    dynamic payload types, the endpoint MUST define the 
	    set of valid encoding names and related parameters using
	    the "a=rtpmap" attribute line. See Section 6 of <xref
	    target="RFC4566">RFC 4566 </xref> for details.

	  </t>

	  <t>
	    When generating the offer, the offerer MUST
	    include an "a=cs&nbhy;correlation" attribute line in the SDP
	    offer. The offerer MUST NOT include more than one
	    "cs&nbhy;correlation" attribute per media description. The
	    "a=cs&nbhy;correlation" line SHOULD contain an enumeration 
	    of all the correlation mechanisms supported by the
	    offerer, in the format of subfields. See <xref
	    target="sec-neg-endpoint-behaviour"/> for more information
	    on usage of the correlation mechanisms.
	  </t>
	  
	  <t>
            The current list of subfields
            include "callerid", "uuie", "dtmf", and "external", and they
            refer to the correlation mechanisms defined in Sections <xref
            target="sec-corr-caller-id" format="counter"/>, <xref
target="sec-corr-uuie" format="counter"/>,
            <xref target="sec-corr-dtmf" format="counter"/>, and <xref
            target="sec-corr-external" format="counter"/>, respectively.
	  </t>
	  	
	  <t>
	    If the offerer supports any of the correlation mechanisms
	    defined in this memo and is willing to become the
	    active party, the offerer MUST add the "callerid",
	    "uuie", "dtmf", and/or "external" subfields and MUST specify 
	    values for them as follows:

	    <list style="symbols">
	      <t>The international E.164 number as the value in the
	      "callerid" subfield.</t>
	      <t>The contents of the User-User Information Element as
	      the value of the "uuie" subfield. </t>
	      <t>The DTMF tone string as the value of the "dtmf"
	      subfield.</t>
             <t>The endpoint MUST NOT specify any
      value for the "external" subfield.</t>
	    </list>
	  </t>

	  <t>
	    If the offerer is only able to become the passive party in
	    the circuit-switched bearer setup, it MUST add at least
	    one of the possible correlation mechanisms but MUST NOT
	    specify values for those subfields.
	  </t>

	  <t>
	    For example, if the offerer is willing to use the
	    User-User Information Element and DTMF digit-sending
	    mechanisms but can only become the passive party, and is also able
to let the human user
   decide whether the correlation should be done or not, it
	    includes the following lines in the SDP:  
	  </t>
	  
	  <t>
	    <list>
	      <t>a=cs-correlation:uuie dtmf external</t>
	      <t>a=setup:passive</t>
	    </list>
	  </t>
	  
	  
	  <t>
	    If, on the other hand, the offerer is willing to use the
	    User-User Information Element and the DTMF correlation
	    mechanisms and is able to become the active or passive
	    side, and is also able to let the
   human user decide whether the correlation should be done or not, it includes the following lines in the SDP:
	  </t>

	  <t>
	    <list>
	      <t>a=cs-correlation:uuie:56A390F3D2B7310023 dtmf:14D*3 external</t>
	      <t>a=setup:actpass</t>
	    </list> 
	  </t>

	  <t>
	    The negotiation of the value of the "setup" attribute
	    takes place as defined in Section 4.1 of <xref
	    target="RFC4145">RFC 4145 </xref>. 
	  </t>

	  <t>
	    The offerer states which role or roles it is willing to
	    perform; the answerer, taking the offerer's
	    willingness into consideration, chooses which roles both
	    endpoints will actually perform during the
	    circuit-switched bearer setup.
	  </t>

	  <t>
	    By "active" endpoint, we refer to an endpoint that will
	    establish the circuit-switched bearer; by
	    "passive" endpoint, we refer to an endpoint that will
	    receive a circuit-switched bearer.
	  </t>

	  <t>
	    If an offerer does not know its international E.164
	    number, it MUST set the "setup" attribute to the value
	    "active". If the offerer knows its international E.164
	    number, it SHOULD set the value to either "actpass" or
	    "passive". 
	  </t>

	  <t>
	    Also "holdconn" is a permissible value in the "setup"
	    attribute. It indicates that the connection should not be
	    established for the time being.
	  </t>

	  <t>
	    The offerer uses the "connection" attribute to decide
	    whether a new circuit-switched bearer is to be established
	    or not. For the initial offer, the offerer MUST use
	    value "new".
	  </t>

	</section>

	<section title="Generating the Answer"
		 anchor="sec-generating-the-answer"> 

	  <t>
	    If the offer contained a circuit-switched audio or video
	    stream, the answerer first determines whether it is able
	    to accept and use such streams on the circuit-switched
	    network. If the answerer does not 
	    support or is not willing to use circuit-switched media
	    for the session, it MUST construct an answer where the
	    port number for such media stream(s) is set to zero,
	    according to Section 6 of <xref target="RFC3264"/>. If the
	    answerer is willing to use 
	    circuit-switched media for the session, it MUST ignore the
	    received port number (unless the port number is set to
	    zero).  
	  </t>
	  

	  <t>
	    If the offer included a "-" as the payload type number, it
	    indicates that the offerer is not willing or able to
	    define any specific payload type. Most often, a "-" is
	    expected to be used instead of the payload type when the 
	    endpoint is not aware of or not willing to define the
	    codecs that will eventually be used on the
	    circuit-switched bearer. The circuit-switched signaling
	    protocols have their own means of negotiating or
	    indicating the codecs; therefore, an answerer SHOULD accept
	    such offers and SHOULD set the payload type to "-"
	    in the answer. 
	  </t>

	  <t>
	    If the answerer explicitly wants to specify a codec for
	    the circuit-switched media, it MAY set the respective
	    payload numbers in the &lt;fmt&gt; subfield in the
	    answer. This behavior, however, is NOT RECOMMENDED.
	  </t>

	  <t>
	    When receiving the offer, the answerer MUST 
	    determine whether it becomes the active or passive
	    party. 
	  </t>
	    
	  <t>
	    If the SDP in the offer indicates that the offerer is
	    only able to become the active party, the answerer needs
	    to determine whether it is able to become the passive
	    party. If this is not possible, e.g., due to the answerer
	    not knowing its international E.164 number, the answerer
	    MUST reject the circuit-switched media by setting the port
	    number to zero on the answer. If the answerer is aware of
	    its international E.164 number, it MUST include the
	    "setup" attribute in the answer and set it to value
	    "passive" or "holdconn". The answerer MUST also include
	    its E.164 number in the "c=" line.
	  </t>

	  <t>
	    If the SDP in the offer indicates that the offerer is only
	    able to become the passive party, the answerer MUST verify
	    that the offerer's E.164 number is included in the "c="
	    line of the offer. If the number is included, the answerer
	    MUST include the "setup" attribute in the answer and set 
	    it to value "active" or "holdconn". If the number is not
	    included, the recipient of the offer is not willing to
	    establish a connection the E.164 based on a priori
	    knowledge of cost, or other reasons, call establishment is
	    not possible, and the answerer MUST reject the
	    circuit-switched media by setting the port number to zero
	    in the answer.  
	  </t>
	    
	  <t>
	    If the SDP in the offer indicates that the offerer is able
	    to become either the active or passive party, the answerer
	    determines which role it will take. If the offer
	    includes an international E.164 number in the 
	    "c=" line, the answerer SHOULD become the active
	    party. If the answerer does not become the active party
	    and if the answerer is aware of its E.164 number, it MUST
	    become the passive party. If the answerer does not become
	    the active or the passive party, it MUST reject the
	    circuit-switched media by setting the port number to zero
	    in the answer.
	  </t>

	  <t>
	    For each media description where the offer includes a
	    "cs&nbhy;correlation" attribute, the answerer MUST select
	    from the offer those correlation mechanisms it supports
	    and include in the answer one "a=cs&nbhy;correlation" attribute
	    line containing those mechanisms it is willing to use. The
	    answerer MUST only add one "cs&nbhy;correlation" attribute in
	    those media descriptions where also the offer included a
	    "cs&nbhy;correlation" attribute. The answerer MUST NOT add
	    any mechanisms that were not included in the offer. If
	    there is more than one "cs&nbhy;correlation" attribute per
	    media description in the offer, the answerer MUST discard
	    all but the first for any media description. Also, the
	    answerer MUST discard all unknown "cs&nbhy;correlation"
	    attribute values. 
	  </t>
	  
	  <t>
	    If the answerer becomes the active party, it MUST 
	    add a value to any of the possible subfields. 
	  </t>
	  
	  <t>
	    If the answerer becomes the passive party, it MUST NOT add
	    any values to the subfields in the "cs&nbhy;correlation" attribute.
	  </t>

	  <t>
	    After generating and sending the answer, if the answerer
	    became the active party, it
	    <list style="symbols">
	      <t>MUST extract the E.164 number from the "c=" line  
	      of the offer and MUST establish a circuit-switched
	      bearer to that address.</t> 
	      <t>if the SDP answer contained a value for the
	      "callerid" subfield, MUST set the Calling Party Number
	      Information Element to that number.</t>
	      <t>if the SDP answer contained a value for the "uuie"
	      subfield, MUST send the User-User Information Element
	      according to the rules defined for the circuit-switched
	      technology used and set the value of the Information
	      Element to that received in the SDP offer.</t> 
	      <t>if the SDP answer contained a value for the "dtmf"
	      subfield, MUST send those DTMF digits according to
	      the circuit-switched technology used.</t>
	    </list>
	  </t>

	  <t>
	    If, on the other hand, the answerer became the passive
	    party, it 
	    <list style="symbols">
	      <t>MUST be prepared to receive a circuit-switched
	      bearer,</t>
	      <t>if the offer contained a value for the "callerid"
	      subfield, MUST compare that value to the
	      Calling Party Number Information Element of the
	      circuit-switched bearer. If the received Calling Party
	      Number Information Element matches the value of the
	      "callerid" subfield, the call SHOULD be treated as
	      correlated to the ongoing session.</t>
	      <t>if the offer contained a value for the "dtmf"
	      subfield, MUST be prepared to receive and collect DTMF digits
	      once the circuit-switched bearer is set up. The answerer
	      MUST compare the received DTMF digits to the value of
	      the "dtmf" subfield. If the received DTMF digits match
	      the value of the "dtmf" subfield in the
	      "cs&nbhy;correlation" attribute, the call SHOULD be treated
	      as correlated to the ongoing session.</t>


	      <t>if the offer contained a value for the "uuie"
	      subfield, MUST be prepared to receive a User-User Information
	      Element once the circuit-switched bearer is set up. The
	      answerer MUST compare the received UUIE to the value of
	      the "uuie" subfield. If the value of the received UUIE
	      matches the value of the "uuie" subfield, the call
	      SHOULD be treated as correlated to the ongoing
	      session.</t>
<t>if the offer contained an "external" subfield, MUST be prepared to
receive a circuit-switched call and use the external means
(typically, the human user) for accepting or rejecting the call.
</t>

	    </list>
	  </t>

	  <t>
	    If the answerer becomes the active party, generates an SDP
	    answer, and then it finds out that the circuit-switched
	    call cannot be established, then the answerer MUST create
	    a new SDP offer where the circuit-switched stream is removed
	    from the session (actually, by setting the corresponding
	    port in the "m=" line to zero) and send it to its
	    counterpart. This is to synchronize both parties (and
	    potential intermediaries) on the state of the session. 
	  </t>

	</section>

	<section title="Offerer Processing the Answer">
	  <t>
	    When receiving the answer, if the SDP does
	    not contain an "a=cs&nbhy;correlation" attribute line, the offerer
	    should take that as an indication that the other party
	    does not support or is not willing to use the procedures
	    defined in the document for this session and MUST revert
	    to normal processing of SDP. 
	  </t>

	  <t>
	    When receiving the answer, the offerer MUST first
	    determine whether it becomes the active or passive
	    party, as described in <xref
	    target="sec-connection-direction"/>. 
	  </t>

	  <t>
	    If the offerer becomes the active party, it 
	    <list style="symbols">
	      <t>MUST  extract the E.164 number from the "c=" line
	      and MUST establish a circuit-switched bearer to that
	      address. </t>
	      <t>if the SDP answer contained a value for the "uuie"
	      subfield, MUST send the User-User Information Element
	      according to the rules defined for the circuit-switched
	      technology used and set the value of the Information
	      Element to that received in the SDP answer.</t>
	      <t>if the SDP answer contained a value for the "dtmf"
	      subfield, MUST send those DTMF digits according to the
	      circuit-switched technology used.</t>
	    </list>
	  </t>

	  <t>
	    If the offerer becomes the passive party:
	    <list style="symbols">

	      <t>It MUST be prepared to receive a circuit-switched
	      bearer.</t>

	      <t>Note that if delivery of the answer is delayed for
	      some reason, the circuit-switched call attempt may
	      arrive at the offerer before the answer has been
	      processed. In this case, since the correlation
	      mechanisms are negotiated as part of the offer/answer
	      exchange, the answerer cannot know whether or not the
	      incoming circuit-switched call attempt is correlated
	      with the session being negotiated; thus, the offerer SHOULD
	      answer the circuit-switched call attempt only after it
	      has received and processed the answer.</t>

	      <t>If the answer contained a value for the "dtmf"
	      subfield, the offerer MUST be prepared to receive and collect DTMF
	      digits once the circuit-switched bearer is set up. The
	      offerer SHOULD compare the received DTMF digits to the
	      value of the "dtmf" subfield. If the received DTMF
	      digits match the value of the "dtmf" subfield in the
	      "cs&nbhy;correlation" attribute, the call SHOULD be treated
	      as correlated to the ongoing session.</t>
	      
	      <t>If the answer contained a value for the "uuie"
	      subfield, the offerer MUST be prepared to receive a User-User
	      Information Element once the circuit-switched bearer is
	      set up. The offerer SHOULD compare the received UUIE to
	      the value of the "uuie" subfield. If the value of the
	      received UUIE matches the value of the "uuie" subfield,
	      the call SHOULD be treated as correlated to the ongoing
	      session.</t>

<t>If the answer contained an "external" subfield, the offerer MUST be
prepared to receive a circuit-switched call and use the external
means (typically, the human user) for accepting or rejecting the
call.
</t>
	    </list>
	  </t>

	  <t>
	    According the <xref target="RFC3264">"An Offer/Answer Model with
the Session Description Protocol (SDP)"</xref>, the offerer needs to be ready to receive media
	    as soon as the offer has been sent. It may happen that the
	    answerer, if it became the active party, will initiate a
	    circuit-switched bearer setup that will arrive at the
	    offerer before the answer has arrived. However, the
	    offerer needs to receive the answer and examine the
	    information about the correlation mechanisms in order to
	    successfully perform correlation of the
	    circuit-switched call to the session. Therefore, if the
	    offerer receives an incoming circuit-switched call, it
	    MUST NOT accept the call before the answer has been
	    received. If no answer is received during an
	    implementation-specific time, the offerer MUST either
	    modify the session according to <xref target="RFC3264"/>
	    or terminate it according to the session signaling
	    procedures in question (for terminating a SIP session, see
	    Section 15 of <xref target="RFC3261"/>). 
	  </t>

	</section>

	<section title="Modifying the Session">
	  <t>
	    If, at a later time, one of the parties wishes to modify
	    the session, e.g., by adding a new media stream or by
	    changing properties used on an existing stream, it may do
	    so via the mechanisms defined in <xref
	    target="RFC3264">"An Offer/Answer Model with the Session Description
Protocol (SDP)"</xref>.
	  </t>

	  <t>
	    If there is an existing circuit-switched bearer between
	    the endpoints and the offerer wants to reuse that, the
	    offerer MUST set the value of the "connection" attribute
	    to "existing". 
	  </t>
  
	  <t>
	    If either party removes the circuit-switched media from
	    the session (by setting the port number to zero), it MUST
	    terminate the circuit-switched bearer using whatever
	    mechanism is appropriate for the technology in question.
	  </t>

	  <t>
	    If either party wishes to drop and reestablish an existing
	    call, that party MUST first remove the circuit-switched
	    media from the session by setting the port number to zero
	    and then use another offer/answer exchange where it MUST
	    set the "connection" attribute to "new". If the media
	    types are different (for example, a different codec will
	    be used for the circuit-switched bearer), the media
	    descriptions for terminating the existing bearer and the
	    new bearer can be in the same offer.
	  </t>

          <t>
            If either party would like to remove existing RTP-based
            media from the session and replace that with a
            circuit-switched bearer, it would create a new offer to
            add the circuit-switched media as described in <xref
            target="sec-generating-the-initial-offer"/> above,
            replacing the RTP-based media description with the
            circuit-switched media description, as specified
            in <xref target="RFC3264">RFC 3264</xref>.
          </t>

          <t>
            Once the offer/answer
            exchange is done, but the circuit-switched bearer is not
            yet established, there may be a period of time when no
            media is available. Also, it may happen that correlating
            the circuit-switched call fails for reasons discussed in
            <xref target="sec-neg-endpoint-behaviour"/>. In this case,
            even if the offer/answer exchange was successful,
            endpoints are not able to receive or send media. It is up
            to the implementation to decide the behavior in this case;
            if nothing else is done, the user most likely hangs up
            after a while if there is no other media in the
            session. Note that this may also happen when switching
            from one RTP media to another RTP media (for example, when
            firewall blocks the new media stream).
          </t>

          <t>
            If either party would like to remove existing
            circuit-switched media from the session and replace that
            with RTP-based media, it would modify the media
            description as per the procedures defined in <xref
            target="RFC3264">RFC 3264</xref>. The endpoint MUST then
            terminate the circuit-switched bearer using whatever
            mechanism is appropriate for the technology in question.
          </t>


	</section>

      </section>

      <section title="Formal Syntax" anchor="sec-syntax">

	<t>
	  The following is the formal <xref target="RFC5234">
	  Augmented Backus-Naur Form (ABNF) </xref> syntax that
	  supports the extensions defined in this specification.  The
	  syntax is built above the <xref target="RFC4566"> SDP
	  </xref> and the <xref target="RFC3966">tel URI </xref>
	  grammars. Implementations that are compliant with this specification
	  MUST be compliant with this syntax.
	</t>

	<t>
	  <xref target="fig-sdp-syntax"/> shows the formal syntax of the
	  extensions defined in this memo.
	</t>
	<figure anchor="fig-sdp-syntax" title="Syntax of the SDP
					       Extensions"><artwork type="abfn"><![CDATA[
        ; extension to the connection field originally specified
        ; in RFC 4566

        connection-field   =  [%x63 "=" nettype SP addrtype SP
        connection-address CRLF]
        ; CRLF defined in RFC 5234

        ;nettype and addrtype are defined in RFC 4566

        connection-address /=  global-number-digits / "-"
        ; global-number-digits specified in RFC 3966

        ;subrules for correlation attribute
        attribute          /= cs-correlation-attr
        ; attribute defined in RFC 4566
        cs-correlation-attr = "cs-correlation:" corr-mechanisms
        corr-mechanisms    = corr-mech *(SP corr-mech)
        corr-mech          = caller-id-mech / uuie-mech /
                             dtmf-mech / external-mech /
                             ext-mech
        caller-id-mech     = "callerid" [":" caller-id-value]
        caller-id-value    = "+" 1*15DIGIT
        ; DIGIT defined in RFC5234
        uuie-mech          = "uuie" [":" uuie-value]
        uuie-value         = 1*65(HEXDIG HEXDIG)
                             ;This represents up to 130 HEXDIG
                             ; (65 octets)
                             ;HEXDIG defined in RFC 5234
                             ;HEXDIG defined as 0-9, A-F
        dtmf-mech          = "dtmf" [":" dtmf-value]
        dtmf-value         = 1*32(DIGIT / %x41-44 / %x23 / %x2A )
                             ;0-9, A-D, '#' and '*'
        external-mech      = "external"
        ext-mech           = ext-mech-name [":" ext-mech-value]
        ext-mech-name      = token
        ext-mech-value     = token
        ; token is specified in RFC 4566
]]></artwork></figure>

      </section>

    </section>
    
    <section title="Examples" anchor="sec-sdp-examples">

      <t>
	In the examples below, where an SDP line is too long to be
	displayed as a single line, a breaking character "\" indicates
	continuation in the following line. Note that this 
	character is included for display purposes
	only. Implementations MUST write a single line without breaks. 
      </t>

      <section title="Single PSTN Audio Stream"
	       anchor="sec-sdp-simple-exsample">

	<figure anchor="fig-example-basic-flow" title="Basic Flow" align="center">
	  <artwork><![CDATA[
         Endpoint A                        Endpoint B
           |                                  |
           | (1) SDP offer (PSTN audio)       |
           |--------------------------------->|
           |                                  |
           | (2) SDP answer (PSTN audio)      |
           |<---------------------------------|
           |                                  |
           |   PSTN call setup                |
           |<---------------------------------|
           |                                  |
           |<==== media over PSTN bearer ====>|
           |                                  |
  ]]></artwork>
	</figure>
	

	<t>
	  <xref target="fig-example-basic-flow"/> shows a basic
	  example that describes a single audio media stream over a
	  circuit-switched bearer. Endpoint A generates an SDP offer,
	  which is shown in <xref 
	  target="fig-example-basic-flow-offer-1"/>. The offer
	  describes a PSTN circuit-switched bearer in the "m=" and
	  "c=" line where it also
	  indicates its international E.164 number
	  format. Additionally, Endpoint A expresses that  
	  it can initiate the circuit-switched
	  bearer or be the recipient of it in the "a=setup"
	  attribute line. The SDP offer also includes
	  correlation identifiers that this endpoint will 
	  insert in the Calling Party Number and/or User-User
	  Information Element of the PSTN call setup if eventually
	  this endpoint initiates the PSTN call. Endpoint A also includes 
"external" as one
correlation mechanism, indicating that it can use the human user to
perform correlation in case other mechanisms fail.
	</t>

	<figure title="SDP Offer (1)" anchor="fig-example-basic-flow-offer-1"><artwork><![CDATA[
        v=0 
        o=alice 2890844526 2890842807 IN IP4 192.0.2.5
        s= 
        t=0 0 
        m=audio 9 PSTN - 
        c=PSTN E164 +441134960123  
        a=setup:actpass
        a=connection:new
        a=cs-correlation:callerid:+441134960123 \
          uuie:56A390F3D2B7310023 external
]]></artwork></figure>

	<t>
	  Endpoint B generates an SDP answer (<xref
	  target="fig-example-basic-flow-answer-1"/>), describing a
	  PSTN audio media on 
	  port 9 without information on the media subtype on the "m="
	  line. The "c=" line contains B's international E.164
	  number. In the "a=setup" line, Endpoint B indicates 
	  that it is willing to become the active endpoint when
	  establishing the PSTN call, and it also includes the
	  "a=cs-correlation" attribute line containing the values it is
	  going to include in the Calling Party Number and User-User
	  Information Element of the PSTN call establishment. Endpoint B is
also able to perform
correlation by external means, in case other correlation mechanisms
fail.
	</t>  

      <figure title="SDP Answer with Circuit-Switched Media"
	      anchor="fig-example-basic-flow-answer-1"><artwork><![CDATA[
      v=0
      o=- 2890973824 2890987289 IN IP4 192.0.2.7
      s=
      t=0 0
      m=audio 9 PSTN -
      c=PSTN E164 +441134960124
      a=setup:active
      a=connection:new
      a=cs-correlation:callerid:+441134960124 \
        uuie:74B9027A869D7966A2 external
	      ]]></artwork></figure>


      <t>
	When Endpoint A receives the answer, it examines that B is
	willing to become the active endpoint when setting up the PSTN
	call. Endpoint A temporarily stores B's E.164 number and the
	User-User IE value of the "cs-correlation" attribute and
	waits for a circuit-switched bearer establishment.
      </t>

      <t>
	Endpoint B initiates a circuit-switched bearer using whatever
	circuit-switched technology is available for it. The Called
	Party Number is set to A's number, and the Calling Party
	Number is set to B's own number. Endpoint B also sets the User-User
	Information Element value to the one contained in the SDP answer.
      </t>

      <t>
	When Endpoint A receives the circuit-switched bearer establishment,
	it examines the UUIE and the Calling Party Number and, by
	comparing those received during the offer/answer exchange, determines that
	the call is related to the SDP session.
      </t>

      <t>
	It may also be that neither the UUIE nor the Calling Party
	Number is received by the called party, or the format of the
	Calling Party Number is changed by the PSTN. Implementations
	may still accept such call establishment attempts as being
	related to the session that was established in the IP
	network. As it cannot be guaranteed that the values used for
	correlation are always passed intact through the network, they
	should be treated as additional hints that the
	circuit-switched bearer is actually related to the session.
      </t>

      </section>

      <section title="Advanced SDP Example: Circuit-Switched Audio and Video Streams" anchor="sec-example-audio-and-video">

	<figure anchor="fig-example-cs-audio-video-flow" title="Circuit-Switched
							     Audio and
							     Video Streams" align="center">
	  <artwork><![CDATA[
 Endpoint A                                Endpoint B
   |                                            |
   | (1) SDP offer (PSTN audio and video)       |
   |------------------------------------------->|
   |                                            |
   | (2) SDP answer (PSTN audio)                |
   |<-------------------------------------------|
   |                                            |
   |   PSTN call setup                          |
   |<-------------------------------------------|
   |                                            |
   |<======== media over PSTN bearer ==========>|
   |                                            |
  ]]></artwork></figure>
	<t>
	  <xref target="fig-example-cs-audio-video-flow"/> shows an
	  example of negotiating audio and video media streams over
	  circuit-switched bearers.
	</t>


     <figure title="SDP Offer with Circuit-Switched Audio and Video (1)"
	      anchor="fig-example-cs-audio-video-offer-1"><artwork><![CDATA[ 
      v=0
      o=alice 2890844526 2890842807 IN IP4 192.0.2.5
      s=
      t=0 0
      a=setup:actpass
      a=connection:new
      c=PSTN E164 +441134960123
      m=audio 9 PSTN -
      a=cs-correlation:dtmf:1234536
      m=video 9 PSTN 34
      a=rtpmap:34 H263/90000
      a=cs-correlation:callerid:+441134960123
      ]]></artwork></figure>


      <t>
	Upon receiving the SDP offer described in <xref
	target="fig-example-cs-audio-video-offer-1"/>, Endpoint B
	rejects the video stream as the device does not currently
	support video, but it accepts the circuit-switched audio
	stream. As Endpoint A indicated that it is able to become
	either the active or passive party, Endpoint B gets to select
	which role it would like to take. Since the offer contained
	the international E.164 number of Endpoint A, Endpoint B
	decides that it becomes the active party in setting up the
	circuit-switched bearer. B includes a new value in the "dtmf"
	subfield of the "cs-correlation" attribute, which it is going
	to send as DTMF tones once the bearer setup is complete. The
	answer is described in <xref
	target="fig-example-cs-audio-video-answer-2"/>.
      </t>


      <figure title="SDP Answer with Circuit-Switched Audio and Video (2)"
	      anchor="fig-example-cs-audio-video-answer-2"><artwork><![CDATA[
      v=0 
      o=- 2890973824 2890987289 IN IP4 192.0.2.7
      s= 
      t=0 0 
      a=setup:active
      a=connection:new
      c=PSTN E164 +441134960124
      m=audio 9 PSTN - 
      a=cs-correlation:dtmf:654321
      m=video 0 PSTN 34 
      a=cs-correlation:callerid:+441134960124
	      ]]></artwork></figure>
      
      </section> 


    </section>



    
    <section title="Security Considerations" anchor="sec-security">
      <t>
	This document provides an extension to <xref
	target="RFC4566">RFC 4566</xref> and <xref target="RFC3264">RFC
	3264</xref>. As such, the security considerations of those
	documents apply. 
      </t>

      <t>
	This memo provides mechanisms to agree on a correlation
	identifier or identifiers that are used to evaluate whether an
	incoming circuit-switched bearer is related to an ongoing
	session in the IP domain. If an attacker replicates the
	correlation identifier and establishes a call within the time
	window the receiving endpoint is expecting a call, the
	attacker may be able to hijack the circuit-switched
	bearer. These types of attacks are not specific to the
	mechanisms presented in this memo. For example, Caller ID
	spoofing is a well-known attack in the PSTN. Users are advised
	to use the same caution before revealing sensitive information
	as they would on any other phone call. Furthermore, users
	are advised that mechanisms that may be in use in the IP
	domain for securing the media, like Secure RTP (SRTP) <xref
	target="RFC3711"/>, are not available in the CS domain.
      </t>

      <t>
	For the purposes of establishing a circuit-switched bearer,
	the active endpoint needs to know the passive endpoint's phone
	number. Phone numbers are sensitive information, and some
	people may choose not to reveal their phone numbers when
	calling using supplementary services like Calling Line
	Identification Restriction (CLIR) in GSM. Implementations
	should take the caller's preferences regarding calling line
	identification into account if possible, by restricting the
	inclusion of the phone number in the SDP "c=" line if the caller
	has chosen to use CLIR. If this is not possible,
	implementations may present a prompt informing the user
	that their phone number may be transmitted to the other
	party. 
      </t>

      <t>
	As with IP addresses, if there is a desire to
	protect the SDP containing phone numbers carried in SIP,
	implementers are advised to follow the security mechanisms
	defined in <xref target="RFC3261"/>.
      </t>
      
      <t>
	It is possible that an attacker creates a circuit-switched
	session whereby the attacked endpoint should dial a
	circuit-switched number, perhaps even a premium-rate telephone
	number. To mitigate the consequences of this attack, endpoints
	MUST authenticate and trust remote endpoints users who try to
	remain passive in the circuit-switched connection
	establishment. It is RECOMMENDED that endpoints have local
	policies precluding the active establishment of circuit-switched
connections to certain numbers (e.g., international,
	premium, and long distance). Additionally, it is strongly
	RECOMMENDED that the end user is asked for consent prior to
	the endpoint initiating a circuit-switched connection.
      </t>

    </section>
    
    <section title="IANA Considerations" anchor="sec-iana">
      <t>
	IANA has registered a number of SDP
	tokens according to the following data.
      </t>
      
      <section title="Registration of the New &#34;cs-correlation&#34; SDP Attribute">
	<t>
	  <list>
	    <t>Contact: Miguel Garcia &lt;miguel.a.garcia@ericsson.com&gt;</t>
	    <t>Attribute name: cs-correlation</t>
	    <t>Long-form attribute name: PSTN Correlation Identifier</t>
	    <t>Type of attribute: media level only</t>
	    <t>Subject to charset: No</t>
	    <t>Description: This attribute provides the Correlation
	    Identifier used in PSTN signaling</t>
	    <t>Appropriate values: see <xref target="sec-corr-attr"/></t>
	    <t>Specification: RFC 7195</t>
	  </list>
	</t>

	<t>
	  The IANA has created a subregistry for the
	  "cs&nbhy;correlation" attribute under the "Session Description
	  Protocol (SDP) Parameters" registry. The initial values for
	  the subregistry are presented in the following; IANA has
	  registered these values accordingly:
	</t>

	<t>
	  <figure><artwork>
Value of "cs-correlation" attribute Reference Description
----------------------------------- --------- -------------------
callerid                            RFC 7195  Caller ID
uuie                                RFC 7195  User-User 
                                              Information Element
dtmf                                RFC 7195  Dual-Tone 
                                              Multi-Frequency
external                            RFC 7195  External
	</artwork></figure>
	</t>

	<t>
	  As per the terminology in <xref target="RFC5226"/>, the
	  registration policy for new values of the "cs-correlation"
	  attribute is "Specification Required".
	</t>

      </section>
      
      
      <section title="Registration of a New &#34;nettype&#34; Value"
	       anchor="sec-iana-nettype">
	<t>
	  IANA has registered a new
	  "nettype" in the <xref
	  target="IANA">"Session Description Protocol (SDP) Parameters" registry</xref>. The
	  registration data, according to <xref target="RFC4566">RFC
	  4566</xref>, is as follows.
	</t>
	<figure><artwork>
Type             SDP Name             Reference
--------------   ------------------   ---------
nettype          PSTN                 RFC 7195
       </artwork></figure>

     </section>

     <section title="Registration of a New &#34;addrtype&#34; Value"
	 anchor="sec-iana-addrtype">
       <t>
 	 IANA has registered a new
	 "addrtype" in the <xref
	 target="IANA">"Session Description Protocol (SDP) Parameters" registry</xref>. The
	 registration data, according to <xref target="RFC4566">RFC
	 4566</xref>, is as follows.
       </t>
       <figure><artwork>
Type             SDP Name             Reference
--------------   ------------------   ---------
addrtype         E164                 RFC 7195
       </artwork></figure>

       <t>
	 Note: This document defines the "E164" addrtype in
	 the context of the "PSTN" nettype only. RFC 3108 <xref
target="RFC3108"/> also defines address type "E.164". This
definition is distinct from the one defined by this memo and shall
not be used with &lt;nettype&gt; "PSTN".
       </t>

     </section>

     <section title="Registration of a New &#34;proto&#34; Value"
	 anchor="sec-iana-proto">
       <t>
 	 IANA has registered a new
	 "proto" in the <xref
	 target="IANA">"Session Description Protocol (SDP) Parameters" registry</xref>. The
	 registration data, according to <xref target="RFC4566">RFC
	 4566</xref>, is as follows.
       </t>
       <figure><artwork>
Type             SDP Name             Reference
--------------   ------------------   ---------
proto            PSTN                 RFC 7195
       </artwork></figure>

       <t>
	 The related "fmt" namespace reuses the conventions and
	 payload type number defined for RTP/AVP. In this document,
	 the RTP audio and video media types, when applied to PSTN
	 circuit-switched bearers, represent merely an audio or video
	 codec in its native format directly on top of a single PSTN
	 bearer.  
       </t>
       <t>
	 In some cases, the endpoint is not able to determine the list
	 of available codecs for circuit-switched media streams. In
	 this case, in order to be syntactically compliant with SDP
	 <xref target="RFC4566"/>, the endpoint MUST include a single
	 dash ("-") in the &lt;fmt&gt; subfield.
       </t>

     </section>

    </section>


    <section title="Acknowledgments" anchor="sec-acks">
      <t>
	The authors want to thank Paul Kyzivat, Flemming Andreasen,
	Thomas Belling, John Elwell, Jari Mutikainen, Miikka
	Poikselka, Jonathan Rosenberg, Ingemar Johansson, Christer
	Holmberg, Alf Heidermark, Tom Taylor, Thomas Belling, Keith
	Drage, and Andrew Allen for providing their insight and
	comments on this document.
      </t>
    </section>

  </middle>
  
  <back>

    <references title="Normative References">
      <?rfc include="reference.RFC.2119" ?>
      <?rfc include="reference.RFC.3264" ?>
      <?rfc include="reference.RFC.3966" ?>
      <?rfc include="reference.RFC.4145" ?>
      <?rfc include="reference.RFC.4566" ?>
      <?rfc include="reference.RFC.4648" ?>
      <?rfc include="reference.RFC.5226" ?>
      <?rfc include="reference.RFC.5234" ?>



<reference anchor="ITU.Q931.1998">
<front>
<title>Digital Subscriber Signalling System No. 1 - ISDN User-Network
Interface Layer 3 Specification for Basic Call Control</title>
<author>
<organization>International Telecommunications Union</organization>
</author>
<date month="May" year="1998" />
</front>

<seriesInfo name="ITU-T" value="Recommendation Q931" />

</reference>

    </references>

    <references title="Informative References">
      <?rfc include="reference.RFC.3108" ?>
      <?rfc include="reference.RFC.3550" ?>
      <?rfc include="reference.RFC.3551" ?>
      <?rfc include="reference.RFC.3261" ?>
      <?rfc include="reference.RFC.3725" ?>
      <?rfc include="reference.RFC.4975" ?>
      <?rfc include="reference.RFC.3711" ?>


<reference anchor="IANA" target="http://www.iana.org/assignments/sdp-parameters">
<front>
<title>Session Description Protocol (SDP) Parameters Registry</title>
<author>
<organization>IANA</organization>
</author>
<date month="" year="" />
</front>

</reference>



<reference anchor="ITU.E164.2010">
<front>
<title>The International Public Telecommunication Numbering Plan</title>
<author>
<organization>International Telecommunications Union</organization>
</author>
<date month="" year="2010" />
</front>

<seriesInfo name="ITU-T" value="Recommendation E.164" />

</reference>

<!--  ietf-cuss-sip-uui  IESG State -->

<reference anchor='SIP-UUI'>
<front>
<title>A Mechanism for Transporting User to User Call Control Information in SIP</title>

<author initials='A' surname='Johnston' fullname='Alan Johnston'>
    <organization />
</author>

<author initials='J' surname='Rafferty' fullname='James Rafferty'>
    <organization />
</author>

<date month='April' day='2' year='2014' />

</front>

<seriesInfo name='Work in' value='Progress' />

</reference>


      <reference anchor="ITU.Q23.1988">
	<front>
	  <title>Technical features of push-button telephone sets
	  </title>
	  <author>
	    <organization>International Telecommunications Union</organization>
	  </author>
	  <date month="" year="1988" />
	</front>
	<seriesInfo name="ITU-T Technical Recommendation" value="Q.23"/>
      </reference>


      <reference anchor="TS.24.008">
	<front>
	  <title>
	    Mobile radio interface Layer 3 specification; Core
	    network protocols; Stage 3
	  </title>
	  <author>
	    <organization>
	      3GPP
	    </organization>
	  </author>
	  <date day="15" month="December" year="2005"/>
	</front>
	<seriesInfo name="3GPP TS" value="24.008 3.20.0"/>
     </reference>

      
    </references>
    
    
  </back>
  
</rfc>

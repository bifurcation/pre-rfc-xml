<?xml version="1.0" encoding="US-ASCII"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [

<!ENTITY RFC2119 SYSTEM "reference.RFC.2119.xml">
<!ENTITY RFC1771 SYSTEM "reference.RFC.1771.xml">
<!ENTITY RFC4098 SYSTEM "reference.RFC.4098.xml">
<!ENTITY RFC1242 SYSTEM "reference.RFC.1242.xml">
<!ENTITY RFC4760 SYSTEM "reference.RFC.4760.xml">
<!ENTITY RFC2545 SYSTEM "reference.RFC.2545.xml">
<!ENTITY RFC5925 SYSTEM "reference.RFC.5925.xml">
<!ENTITY RFC2918 SYSTEM "reference.RFC.2918.xml">
<!ENTITY RFC4724 SYSTEM "reference.RFC.4724.xml">
<!ENTITY RFC1983 SYSTEM "reference.RFC.1983.xml">
<!ENTITY RFC4271 SYSTEM "reference.RFC.4271.xml">
<!ENTITY RFC2285 SYSTEM "reference.RFC.2285.xml">
<!ENTITY RFC6412 SYSTEM "reference.RFC.6412.xml">
<!ENTITY RFC6414 SYSTEM "reference.RFC.6414.xml">
<!ENTITY RFC7115 SYSTEM "reference.RFC.7115.xml">
<!ENTITY RFC2918 SYSTEM "reference.RFC.2918.xml">
 ]>

 <?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
 <?rfc toc="yes"?>
 <?rfc tocdepth="4"?>
 <?rfc symrefs="yes"?>
 <?rfc sortrefs="yes" ?>
 <?rfc compact="yes" ?>
 <?rfc subcompact="no" ?>

 <rfc number="7747" 
      category="info"
      submissionType="IETF"
      consensus="yes"
      ipr="pre5378Trust200902">

  <front>

     <title abbrev="BGP Convergence Methodology">
     Basic BGP Convergence Benchmarking Methodology for&nbsp;Data&nbhy;Plane&nbsp;Convergence</title>

     <author fullname="Rajiv Papneja" initials="R.P."
	     surname="Papneja">
       <organization>Huawei Technologies</organization>

       <address>

	 <email>rajiv.papneja@huawei.com</email>

       </address>
     </author>

     <author fullname="Bhavani Parise" initials="B.P."
	     surname="Parise">
       <organization>Skyport Systems</organization>

       <address>

	 <email>bparise@skyportsystems.com</email>

	 <!-- uri and facsimile elements may also be added -->
       </address>
     </author>

     <author fullname="Susan Hares" initials="S.H."
	     surname="Hares">
       <organization>Huawei Technologies</organization>

       <address>

	 <email>shares@ndzh.com</email>

	 <!-- uri and facsimile elements may also be added -->
       </address>
     </author>

     <author fullname="Dean Lee" initials="D.L."
	     surname="Lee">
       <organization>IXIA</organization>

       <address>

	 <email>dlee@ixiacom.com</email>

	 <!-- uri and facsimile elements may also be added -->
       </address>
     </author>

     <author fullname="Ilya Varlashkin" initials="I.V."
	     surname="Varlashkin">
       <organization>Google</organization>

       <address>

	 <email>ilya@nobulus.com</email>

	 <!-- uri and facsimile elements may also be added -->
       </address>
     </author>


     <date month="February" year="2016" />

     <area>General</area>

     <workgroup>Benchmarking Working Group</workgroup>

     <keyword>BMWG</keyword>

 <abstract>
 <t>
 BGP is widely deployed and used by several service providers as the default
 inter-AS (Autonomous System) routing protocol. It is of utmost importance to ensure that when a
 BGP peer or a downstream link of a BGP peer fails, the alternate paths are
 rapidly used and routes via these alternate paths are installed. 

 <!-- [rfced] Throughout the text, the following terminology appears to 
be used inconsistently. Please review these occurrences and let us know
if/how they may be made consistent.

 Convergence Event vs. convergence event
 Convergence TimeX vs. convergence time
 Tester vs. tester
 Emulator vs. emulator
 Helper Node vs. Helper node vs. helper node vs. HLP
 Scenario vs. scenario
 Time vs. time
 Node vs. node
 -->

 This document provides the basic BGP benchmarking methodology using existing BGP convergence terminology as defined in RFC 4098. 
 </t>
 </abstract>

   </front>

   <middle>

 <section anchor="introduction" title="Introduction">
 <t>
 This document defines the methodology for benchmarking data-plane Forwarding
 Information Base (FIB) convergence performance of BGP in routers and switches using topologies of three or four nodes. 
 The methodology proposed in this document applies to both IPv4 and IPv6, and if
 a particular test is unique to one version, it is marked accordingly.  For
 IPv6 benchmarking, the Device Under Test (DUT) will require the support of
 Multiprotocol BGP (MP-BGP) <xref target="RFC4760"/> <xref target="RFC2545"/>. Similarly, both Internal BGP (iBGP) and External BGP (eBGP) are covered in the tests as applicable.  

 </t>

<!-- [rfced] May the word "protocol" be removed here, or is 
the repetition intentional?

Original:
   The scope of this document is to provide methodology for BGP protocol
   FIB convergence measurements with BGP functionality limited to ...

Perhaps:
   The scope of this document is to provide methodology for BGP FIB
   convergence measurements with BGP functionality limited to ...
-->
 <t>
 The scope of this document is to provide methodology for BGP FIB
 convergence measurements with BGP functionality limited to IPv4 and IPv6 as
 defined in <xref target="RFC4271"/> and MP-BGP <xref target="RFC4760"/> <xref target="RFC2545"/>. Other BGP extensions to support Layer 2 and Layer 3 Virtual Private Networks (VPNs) are outside the scope of this document. Interaction with IGPs (IGP interworking) is outside the scope of this document. 
 </t>
       <section title="Benchmarking Definitions">
	  <t>The terminology used in this document is defined in <xref target="RFC4098"/>. One 
	 additional term is defined in this document as follows.
	  </t>
<!-- [rfced] Do you want to make instances of this term consistent 
about whether "BGP" is included? If so, please let us know which
form is preferred.

Examples:
a) FIB (data-plane) convergence
b) FIB (data-plane) BGP convergence
  [This instance was cut in order to make the text more concise in Section 1.1.]
c) BGP FIB (data-plane) convergence
-->

	  <t>FIB (data-plane) convergence is defined as the completion of all FIB 
	 changes so that all forwarded traffic then takes the newly proposed 
	 route. RFC 4098 defines the terms 'BGP device', 'FIB', and 'forwarded 
	 traffic'. Data-plane convergence is different than control-plane 
	 convergence within a node.  
	  </t>

	 <t>This document defines methodology to test 	 
	 <list style="symbols">
	  <t>data-plane convergence on a single BGP device that supports the
	  BGP functionality with a scope as outlined above; and</t>
	  <t>using test topology of three or four nodes that are sufficient to recreate the convergence events used in the various tests of this document.</t>
	 </list></t>
       </section>
       <section title="Purpose of BGP FIB (Data-Plane) Convergence">
	 <t>In the current Internet architecture, the inter-AS transit is primarily available through BGP. To maintain 
	 reliable connectivity within intra-domains or across inter-domains, 
	 fast recovery from failures remains most critical. To ensure minimal 
	 traffic losses, many service providers are requiring BGP 
	 implementations to converge the entire Internet routing table within 
	 sub-seconds at FIB level. 
	   </t>
	   <t>Furthermore, to compare these numbers amongst various devices, 
	 service providers are also looking at ways to standardize the 
	 convergence measurement methods. This document offers test methods 
	 for simple topologies. These simple tests will provide a quick high-level check of BGP data-plane convergence 
	 across multiple implementations from different vendors.
	   </t>
	 </section>
       <section title="Control-Plane Convergence">
	 <t>The convergence of BGP occurs at two levels: Routing Information
	 Base (RIB) and FIB 
	 convergence. RFC 4098 defines terms for BGP control-plane 
	 convergence. Methodologies that test control-plane convergence are 
	 out of scope for this document.
	   </t>
	 </section>
       <section title="Benchmarking Testing">
	   <t>In order to ensure that the results obtained in tests are 
	 repeatable, careful setup of initial conditions and exact steps are 
	 required.
	   </t>
	   <t>This document proposes these initial conditions, test steps, and 
	 result checking. To ensure uniformity of the results, all optional 
	 parameters SHOULD be disabled and all settings SHOULD be changed to 
	 default; these may include BGP timers as well.
	   </t>
	 </section>
     </section> <!-- for Introductions section -->

 <section title="Existing Definitions and Requirements">
	 <t>"Benchmarking Terminology for Network Interconnect 
	 Devices" <xref target="RFC1242"/> and "Benchmarking Terminology for LAN 
	 Switching Devices" <xref target="RFC2285"/> SHOULD be reviewed in conjunction with 
	 this document. 

 <!-- [rfced] The citation [802.11] did not have a corresponding reference
in the references section.  We have added it as normative; please review
and let us know if you prefer otherwise.

Original:
   WLAN-specific terms and definitions are also provided in
   Clauses 3 and 4 of the IEEE 802.11 standard [802.11].
 -->

 WLAN-specific terms and definitions are also 
	 provided in Clauses 3 and 4 of the IEEE 802.11 standard <xref target="IEEE.802.11"/>.  
	  Commonly used terms may also be found in RFC 1983 <xref target="RFC1983"/>. 
	 </t>
	 <t>For the sake of clarity and continuity, this document adopts the      
	 general template for benchmarking terminology set out in Section 2 
	 of <xref target="RFC1242"/>. Definitions are organized in alphabetical order and 
	 grouped into sections for ease of reference.
	   The following terms are assumed to be taken as defined in RFC 1242    
	 <xref target="RFC1242"/>: Throughput, Latency, Constant Load, Frame Loss Rate, and 
	 Overhead Behavior. In addition, the following terms are taken as 
	 defined in <xref target="RFC2285"/>: Forwarding Rates, Maximum Forwarding 
	 Rate, Loads, Device Under Test (DUT), and System Under Test (SUT). 
	 </t>
	 <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
	 "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
	 document are to be interpreted as described in RFC 2119 <xref target="RFC2119"/>. 
	 </t>
 </section> <!-- for Existing Definitions section -->

 <section anchor="Topologies" title="Test Topologies">
	 <t>This section describes the test setups for use in BGP 
	 benchmarking tests measuring convergence of the FIB (data-plane) 
	 after BGP updates have been received.  
	 </t>
	 <t>These test setups have three or four nodes with the following 
	 configuration:  
	 <list style="numbers">
	 <t>Basic test setup</t>
       <t>Three-node setup for iBGP or eBGP convergence</t> 
       <t>Setup for eBGP multihop test Scenario</t> 
       <t>Four-node setup for iBGP or eBGP convergence</t>
	 </list></t>
	 <t> </t>
	 <t> Individual tests refer to these topologies.</t>
	 <t> Figures 1 through 4 use the following conventions:</t>
	 <t><list style="symbols">
	 <t> AS-X: Autonomous System X</t>
       <t> Loopback Int: Loopback interface on a BGP-enabled device</t>
       <t>HLP, HLP1, HLP2: Helper routers running the same version of BGP as
       the DUT</t> 
       <t>All devices MUST be synchronized using NTP or some other clock
       synchronization mechanism</t>	
	 </list></t>

 <section title="General Reference Topologies">
	 <t>Emulator acts as one or more BGP peers for different test cases.</t>

 <t>
       <figure align="center" title="Basic Test Setup" anchor="basic_test_setup">
         <artwork align="center"><![CDATA[
   +----------+                             +------------+ 
   |          |   Traffic Interfaces        |            | 
   |          |-----------------------1---- | tx         |  
   |          |-----------------------2---- | tr1        |
   |          |-----------------------3-----| tr2        |
   |    DUT   |                             | Emulator   | 
   |          |    Routing Interfaces       |            | 
   |      Dp1 |---------------------------  |Emp1        | 
   |          |      BGP Peering            |            | 
   |      Dp2 |---------------------------- |Emp2        |  
   |          |      BGP Peering            |            | 
   +----------+                             +------------+ 
             ]]></artwork>
       </figure>
 </t>


 <t>
 <figure align="center" title="Three-Node Setup for eBGP and iBGP Convergence" anchor="three_node_setup">
 <artwork align="center"><![CDATA[

   +------------+        +-----------+           +-----------+
   |            |        |           |           |           | 
   |            |        |           |           |           | 
   |   HLP      |        |  DUT      |           | Emulator  |
   |  (AS-X)    |--------| (AS-Y)    |-----------|  (AS-Z)   |
   |            |        |           |           |           | 
   |            |        |           |           |           | 
   |            |        |           |           |           | 
   +------------+        +-----------+           +-----------+
           |                                            |
           |                                            |
           +--------------------------------------------+
          ]]></artwork>
       </figure>
 </t>
 <t>
       <figure align="center" title="BGP Convergence for eBGP Multihop Scenario" anchor="bgp_convergence">
   <artwork align="center"><![CDATA[

        +----------------------------------------------+
        |                                              |
        |                                              |
   +------------+        +-----------+           +-----------+
   |            |        |           |           |           | 
   |            |        |           |           |           | 
   |   HLP      |        |  DUT      |           | Emulator  |
   |  (AS-X)    |--------| (AS-Y)    |-----------|  (AS-Z)   | 
   |            |        |           |           |           | 
   |            |        |           |           |           | 
   |            |        |           |           |           | 
   +------------+        +-----------+           +-----------+                              
        |Loopback-Int         |Loopback-Int 
        |                     | 
        +                     + 
          ]]></artwork>
       </figure>
 </t>

 <t>
       <figure align="center" title="Four-Node Setup for eBGP and iBGP Convergence" anchor="four_node_setup">
 <artwork align="center"><![CDATA[

   +---------+     +--------+     +--------+     +---------+ 
   |         |     |        |     |        |     |         | 
   |         |     |        |     |        |     |         | 
   |  HLP1   |     |  DUT   |     |  HLP2  |     |Emulator | 
   | (AS-X)  |-----| (AS-X) |-----| (AS-Y) |-----| (AS-Z)  | 
   |         |     |        |     |        |     |         | 
   |         |     |        |     |        |     |         | 
   |         |     |        |     |        |     |         | 
   +---------+     +--------+     +--------+     +---------+ 
        |                                             |
        |                                             | 
        +---------------------------------------------+
          ]]></artwork>
       </figure>
 </t>

 </section>
 </section> <!-- for Test Topologies section -->

 <section anchor="Considerations" title="Test Considerations">
	 <t>The test cases for measuring convergence for iBGP and eBGP are 
	 different. Both iBGP and eBGP use different mechanisms to advertise, 
	 install, and learn the routes. Typically, an iBGP route on the DUT 
	 is installed and exported when the next hop is valid. For 
	 eBGP, the route is installed on the DUT with the remote interface 
	 address as the next hop, with the exception of the multihop test 
	 case (as specified in the test).
	 </t>
 <section title="Number of Peers">
	 <t>"Number of Peers" is defined as the number of BGP neighbors or 
	 sessions the DUT has at the beginning of the test.  
	  The peers are established before the tests begin.  
	 The relationship could be either iBGP or eBGP peering depending 
	 upon the test case requirement.
	 </t>  

<!-- [rfced] Please clarify this sentence. 

Original:
The DUT establishes one or more BGP sessions with one more emulated
routers or helper nodes.

Perhaps:
The DUT establishes one or more BGP sessions with one or more emulated
routers or helper nodes.
--> 

	 <t>The DUT establishes one or more BGP peer sessions with one or more emulated 
	 routers or Helper Nodes. Additional peers can be added based on the 
	 testing requirements. The number of peers enabled during the testing 
	 should be well documented in the report matrix. 
	 </t>
 </section>
 <section title="Number of Routes per Peer">
	 <t>"Number of Routes per Peer" is defined as the number of routes 
	 advertised or learned by the DUT per session or through a neighbor 
	 relationship with an emulator or Helper Node. 

 <!-- [rfced] Please clarify this sentence. 

 Original:
  The tester, emulating as neighbor MUST advertise at least 
  one route per peer.

 Perhaps:
  The tester, emulating as the neighbor, MUST advertise at least 
  one route per peer.

 Or:
  The tester emulating a neighbor MUST advertise at least one 
  route per peer.
 -->    

	 The Tester, emulating 
	 as a BGP neighbor, MUST advertise at least one route per BGP peer.
	 </t>
	 <t>Each test run must identify the route stream in terms of route 
	 packing, route mixture, and number of routes. This route stream must 
	 be well documented in the reporting stream. RFC 4098 defines these 
	 terms.
	 </t>
	 <t>It is RECOMMENDED that the user consider advertising the entire 
	 current Internet routing table per peering session using an Internet 
	 route mixture with unique or non-unique routes.  
	 If multiple peers are used, it is important to precisely document 
	 the timing sequence between the peer sending routes (as defined in 
	 RFC 4098). 
	 </t>
 </section>
 <section title="Policy Processing/Reconfiguration">
	 <t>The DUT MUST run one baseline test where the policy is Minimal policy as 
	 defined in RFC 4098. 

<!-- [rfced] Please clarify this sentence. If "setup" is a noun, then
we suggest Option A. 

Original:
Additional runs may be done with policy set-up before 
the tests begin.

Option A:
Additional runs may be done with the policy setup before 
the tests begin.

Option B:
Additional runs may be done with the policy that was set up before 
the tests begin.
-->
Additional runs may be done with policy that was set up 
	 before the tests began. Exact policy settings MUST be documented 
	 as part of the test.
	 </t>
 </section>
 <section title="Configured Parameters (Timers, etc.)" anchor="config_param">
	 <t>There are configured parameters and timers that may impact the 
	 measured BGP convergence times. 
	 </t>
	 <t>The benchmark metrics MAY be measured at any fixed values for these 
	 configured parameters.
	 </t>
	 <t>It is RECOMMENDED these configure parameters have the following 
	 settings: a) default values specified by the respective RFC,
	 b) platform-specific default parameters, and c) values as expected in 
	 the operational network. 
	 All optional BGP settings MUST be kept consistent across iterations 
	 of any specific tests
	 </t>
	 <t>Examples of the configured parameters that may impact measured BGP 
	 convergence time include, but are not limited to:
	 </t>
	 <t>
	       <list>
		    <t>1. Interface failure detection timer</t>
		    <t>2. BGP keepalive timer</t>
		    <t>3. BGP holdtime</t> 
		    <t>4. BGP update delay timer </t> 
		    <t>5. ConnectRetry timer </t> 
		    <t>6. TCP segment size </t>  
		    <t>7. Minimum Route Advertisement Interval (MRAI)</t>  
		    <t>8. MinASOriginationInterval (MAOI)</t>  

<!-- [rfced] This document uses "flap dampening";
however, RFC 4098 uses "flap damping". Should this be
changed in this document?
-->
		    <t>9. Route flap damping parameters</t> 
		    <t>10. TCP Authentication Option (TCP AO or TCP MD5)</t>
		    <t>11. Maximum TCP window size </t>
		    <t>12. MTU </t>
		 </list>
	     </t>
	 <t>The basic-test settings for the parameters should be:</t>
	 <t>
	       <list>
		    <t>1. Interface failure detection timer (0 ms)</t>
		    <t>2. BGP keepalive timer (1 min)</t>
		    <t>3. BGP holdtime (3 min)</t> 
		    <t>4. BGP update delay timer (0 s)</t> 
		    <t>5. ConnectRetry timer (1 s)</t> 
		    <t>6. TCP segment size (4096 bytes)</t>  
		    <t>7. Minimum Route Advertisement Interval (MRAI) (0 s)</t>  
		    <t>8. MinASOriginationInterval (MAOI) (0 s)</t>  
		    <t>9. Route flap damping parameters (off)</t> 
		    <t>10. TCP Authentication Option (off)</t>  
		 </list>
	     </t>
 </section>
 <section title="Interface Types">
	 <t>The type of media dictates which test cases may be executed; each 
	 interface type has a unique mechanism for detecting link failures, and 
	 the speed at which that mechanism operates will influence the 
	 measurement results. All interfaces MUST be of the same media and 
	 throughput for all iterations of each test case. 
	 </t>
 </section>
 <section title="Measurement Accuracy">
	 <t>Since observed packet loss is used to measure the route convergence 
	 time, the time between two successive packets offered to each 
	 individual route is the highest possible accuracy of any packet-loss-based 
	 measurement. When packet jitter is much less than the 
	 convergence time, it is a negligible source of error, and hence, it 
	 will be treated as within tolerance.
	 </t>

<!-- [rfced] The original cited [MPLSProt] without a corresponding reference.
We have changed it to [RFC6414] and added it as an informative
reference. Please review whether this is accurate. (We note that RFC 6414
is the only RFC that mentions "Timestamp-Based Method".)

Original:
   Other options to measure convergence are the Time-Based Loss Method
   (TBLM) and Timestamp Based Method(TBM)[MPLSProt].

Current:
   Other options to measure convergence are the Time-Based Loss Method
   (TBLM) and Timestamp-Based Method (TBM) [RFC6414].
-->

	 <t>Other options to measure convergence are the Time-Based Loss Method
	 (TBLM) and Timestamp-Based Method (TBM) <xref target="RFC6414"/>.
	 </t>
	 <t>An exterior measurement on the input media (such as Ethernet) is defined 
	 by this specification.
	 </t>
 </section>
 <section title="Measurement Statistics">
	 <t>The benchmark measurements may vary for each trial due to the 
	 statistical nature of timer expirations, CPU scheduling, etc.  
	 It is recommended to repeat the test multiple times.  Evaluation of 
	 the test data must be done with an understanding of generally 
	 accepted testing practices regarding repeatability, variance, and 
	 statistical significance of a small number of trials. 
	 </t>
	 <t>For any repeated tests that are averaged to remove variance, all 
	 parameters MUST remain the same.
	 </t>
 </section>
 <section title="Authentication">

<!-- [rfced] Per mail from Dean Lee on 4 Oct 2015, we have made this update:

2. Replace "TCP MD5 Signature Option" in section 4.8 with "TCP
Authentication Option".

In addition, we changed "MD5 hash" to simply "hash" in the subesequent sentence.
Do the other mentions of "MD5" in this document require an update?
-->

	 <t>Authentication in BGP is done using the TCP Authentication Option 
	 <xref target="RFC5925"/>. (In some legacy situations, the
	 authentication may still be with TCP MD5). The processing of the
	 authentication hash, particularly in devices 
	 with a large number of BGP peers and a large amount of update 
	 traffic, can have an impact on the control plane of the device. If 
	 authentication is enabled, it MUST be documented correctly in the 
	 reporting format. 
	 </t>
	 <t>
	 Also, it is recommended that trials MUST be with the same Secure
	 Inter-Domain Routing (SIDR) features
	 <xref target="RFC7115"/> <xref target="BGPsec"/>. 
	 The best convergence tests would be with no SIDR features and then to
	 repeat the convergence tests with the same SIDR features.
	 </t>
 </section>
 <section title="Convergence Events">
	 <t>Convergence events or triggers are defined as abnormal occurrences 
	 in the network, which initiate route flapping in the network and 
	 hence forces the reconvergence of a steady state network. In a real 
	 network, a series of convergence events may cause convergence 
	 latency operators desire to test.
	 </t>
	 <t>These convergence events must be defined in terms of the sequences 
	 defined in RFC 4098. This basic document begins all tests with a 
	 router initial setup. Additional documents will define BGP data-plane 
	 convergence based on peer initialization.
	 </t>
	 <t>The convergence events may or may not be tied to the actual failure.  
	 A soft reset <xref target="RFC4098"/> does not clear the RIB or FIB tables. A 
	 hard reset clears BGP peer sessions, RIB tables, and FIB 
	 tables.
	 </t>
 </section>
 <section title="High Availability">
	 <t>Due to the different Non-Stop-Routing (sometimes referred to High-
	 Availability) solutions available from different vendors, it is 
	 RECOMMENDED that any redundancy available in the routing processors 
	 should be disabled during the convergence measurements.
	 For cases where the redundancy cannot be disabled, the results are no longer comparable and the 
	 level of impact on the measurements is out of scope of this document.
	 </t>
 </section>
 </section> <!-- for Test Considerations section -->



 <section title="Test Cases" anchor="test_cases">
	 <t>All tests defined under this section assume the following:</t>
	 <t>
	 <list style="letters">
		 <t>BGP peers are in Established state.</t>
		 <t>BGP state should be cleared from Established state to Idle prior to each test. 
		    This is recommended to ensure that all tests start with BGP peers being forced back 
		    to Idle state and databases flushed.</t>
		 <t>Furthermore, the traffic generation and routing should be verified 
		    in the topology to ensure there is no packet loss observed on any advertised routes.</t>
		 <t>The arrival timestamp of advertised routes can be measured by installing an inline monitoring 
		 device between the emulator and the DUT or by using the span port
		 of the DUT connected with an external analyzer. 
		 The time base of such an inline monitor or external analyzer
		 needs to be synchronized with the protocol 
		 and traffic emulator. Some modern emulators may have the capability to capture and timestamp every 
		 NLRI packet leaving and arriving at the emulator ports. The timestamps of these NLRI packets will 
		 be almost identical to the arrival time at the DUT if the cable distance between the emulator and DUT is 
		 relatively short.</t>
	 </list>
	 </t>
	 <section title="Basic Convergence Tests" anchor="basic_conv_tests">
	 <t>These test cases measure characteristics of a BGP implementation in 
	 non-failure scenarios like:</t>
	 <t>
	 <list style="numbers">
		 <t>RIB-IN Convergence</t> 
	 <t>RIB-OUT Convergence</t> 
	 <t>eBGP Convergence</t> 
	 <t>iBGP Convergence</t> 
	 </list></t><t></t>

	 <section title="RIB-IN Convergence">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the convergence time taken to receive and install a 
		 route in RIB using BGP.</t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t>This test uses the setup as shown in <xref target="basic_test_setup"/></t>
		 </list></t>
		 <t>Procedure:</t>
		 <t>
		 <list style="format %C.">
		    <t>All variables affecting convergence should be set to a basic
		   test state (as defined in <xref target="config_param"/>).</t>    
		    <t>Establish BGP adjacency between the DUT and one peer of
		    the emulator, Emp1.</t>  
		<t>To ensure adjacency establishment, wait for three
		keepalives to be received from the DUT or a configurable delay before proceeding with the rest 
		   of the test.</t>
		<t>Start the traffic from the emulator tx towards the DUT 
		   targeted at a route specified in the route mixture (e.g., routeA). 
		   Initially, no traffic SHOULD be observed on the egress interface 
		   as routeA is not installed in the forwarding database of 
		   the DUT.</t>
		<t>Advertise routeA from the peer (Emp1) to the DUT and record the 
		   time.
			   <list style="empty"><t>This is Tup(Emp1,Rt-A), also named XMT-Rt-time(Rt-A).</t></list></t>
		    <t>Record the time when routeA from Emp1 is received at the 
		   DUT.              
		  <list style="empty"><t>This is Tup(DUT,Rt-A), also named RCV-Rt-time(Rt-A).</t></list></t>
		    <t>Record the time when the traffic targeted towards routeA is 
		   received by the emulator on the appropriate traffic egress interface.
			   <list style="empty"><t>This is TR(TDr,Rt-A), also named DUT-XMT-Data-Time(Rt-A).</t></list></t>
		    <t>The difference between the Tup(DUT,RT-A) and traffic received 
		   time (TR (TDr, Rt-A) is the FIB convergence time for routeA in 
		   the route mixture. A full convergence for the route update is the measurement  
		   between the first route (Rt-A) and the last route (Rt-last).
			   <list style="empty"><t>Route update convergence is</t> 
		       <t>TR(TDr, Rt-last)- Tup(DUT, Rt-A), or </t>                     
		       <t>(DUT-XMT-Data-Time - RCV-Rt-Time)(Rt-A).</t></list></t>  
		 </list></t>
		 <t>Note: It is recommended that a single test with the same route 
		    mixture be repeated several times. A report should provide the 
		    standard deviation and the average of all tests.</t>
		 <t>Running tests with a varying number of routes and route mixtures 
		    is important to get a full characterization of a single peer.</t>  
	 </section>

	 <section title="RIB-OUT Convergence">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the convergence time taken by an implementation to 
			 receive, install, and advertise a route using BGP.</t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t>This test uses the setup as shown in <xref target="three_node_setup"/>.</t>
		 </list></t>
		 <t>Procedure:</t>
		 <t>
		 <list style="format %C.">
		     <t>The Helper Node (HLP) MUST run same version of BGP as
		     the DUT.</t>  
		     <t>All devices MUST be synchronized using NTP or some local 
		  reference clock.</t> 
		     <t>All configuration variables for the Helper Node, DUT, and emulator SHOULD 
		    be set to the same values. These values MAY be basic test or a 
		    unique set completely described in the test setup.</t> 
		     <t>Establish BGP adjacency between the DUT and the emulator.</t> 
		     <t>Establish BGP adjacency between the DUT and the Helper Node.</t> 
		     <t>To ensure adjacency establishment, wait for three
		     keepalives to be received from 
		    the DUT or a configurable delay before proceeding with the rest 
		    of the test.</t>
		     <t>Start the traffic from the emulator towards the Helper Node 
		  targeted at a specific route (e.g., routeA). 
		    Initially, no traffic SHOULD be observed on the egress interface 
		  as routeA is not installed in the forwarding database of 
		  the DUT.</t> 
		     <t>Advertise routeA from the emulator to the DUT and note the 
		  time.
			     <list style="empty"><t>This is Tup(EMx, Rt-A), also named EM-XMT-Data-Time(Rt-A).</t></list></t>
		     <t>Record when routeA is received by the DUT.
			     <list style="empty"><t>This is Tup(DUTr, Rt-A), also named DUT-RCV-Rt-Time(Rt-A).</t></list></t>
		     <t>Record the time when routeA is forwarded by the DUT towards the Helper Node.
		     <list style="empty"><t>This is Tup(DUTx, Rt-A), also named DUT-XMT-Rt-Time(Rt-A).</t></list></t>
		     <t>Record the time when the traffic targeted towards routeA is 
		  received on the Route Egress Interface.

<!--[rfced] We note that the formatting for the following item is
inconsistent with the formatting of other, similarly worded items. Please
let us know if/how you would like this to be reformatted.

Original:
      K.  Record the time when the traffic targeted towards routeA is
          received on the Route Egress Interface.  This is TR(EMr,
          Rt-A), also named DUT-XMT-Data Time(Rt-A).

Perhaps:
   K.  Record the time when the traffic targeted towards routeA is
       received on the Route Egress Interface.  

           This is TR(EMr, Rt-A), also named DUT-XMT-Data Time(Rt-A).
-->

		    This is TR(EMr, Rt-A), also named DUT-XMT-Data Time(Rt-A).
			     <list style="empty"><t>FIB convergence = (DUT-XMT-Data-Time -DUT-RCV-Rt-Time)(Rt-A)</t>                                                   
					       <t>RIB convergence = (DUT-XMT-Rt-Time - DUT-RCV-Rt-Time)(Rt-A)</t>							<t>Convergence for a route stream is characterized by</t>
							 <t>a) individual route
							 convergence for FIB
							 and RIB, and</t>
						 <t>b) all route convergence of</t> 
						 <t>FIB-convergence =
						 DUT-XMT-Data-Time(last) -
						 DUT-RCV-Rt-Time(first), and</t>                                                   
					       <t>RIB-convergence = DUT-XMT-Rt-Time(last) - DUT-RCV-Rt-Time(first).</t> 

			     </list></t>
		 </list></t>
			 </section>

		 <section title="eBGP Convergence">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the convergence time taken by an implementation to 
			 receive, install, and advertise a route in an eBGP Scenario.</t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t>This test uses the setup as shown in <xref target="three_node_setup"/>, and the scenarios 
			 described in RIB-IN and RIB-OUT are applicable to this test case.</t>
		 </list></t>
		 </section>


		 <section title="iBGP Convergence">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the convergence time taken by an implementation to 
			 receive, install, and advertise a route in an iBGP Scenario.</t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t>This test uses the setup as shown in <xref target="three_node_setup"/>, and the scenarios 
			 described in RIB-IN and RIB-OUT are applicable to this test case.</t>
		 </list></t>
		 </section>


		 <section title="eBGP Multihop Convergence">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the convergence time taken by an implementation to 
			 receive, install, and advertise a route in an eBGP Multihop Scenario.</t>
		 </list></t>	
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t>This test uses the setup as shown in <xref
		    target="bgp_convergence"/>. The DUT is used along 
			 with a Helper Node.</t>
		 </list></t>
		 <t>Procedure:</t>
		 <t>
		 <list style="format %C.">
			 <t>The Helper Node MUST run the same version of BGP 
		 as the DUT.</t> 
		 <t>All devices MUST be synchronized using NTP or some local
		 reference clock.</t>
		 <t>All variables affecting convergence, like authentication, 
		 policies, and timers, SHOULD be set to basic settings.</t> 
		 <t>All three devices, the DUT, emulator, and Helper Node, are configured 
		 with different ASs.</t>
		 <t>Loopback interfaces are configured on the DUT and Helper Node, and 
		 connectivity is established between them using any config 
		 options available on the DUT.</t> 
		 <t>Establish BGP adjacency between the DUT and the emulator.</t> 
		 <t>Establish BGP adjacency between the DUT and the Helper Node.</t> 
		 <t>To ensure adjacency establishment, wait for three
		 keepalives to be received from 
		 the DUT or a configurable delay before proceeding 
		 with the rest of the test</t> 
		 <t>Start the traffic from the emulator towards the DUT 
		 targeted at a specific route (e.g., routeA).</t>  
		 <t>Initially, no traffic SHOULD be observed on the egress 
		 interface as routeA is not installed in the forwarding 
		 database of the DUT.</t> 
		 <t>Advertise routeA from the emulator to the DUT and note the 
		 time (Tup(EMx,RouteA), also named Route-Tx-time(Rt-A).</t>
		 <t>Record the time when the route is received by the DUT. This
		 is Tup(EMr,DUT), also named Route-Rcv-time(Rt-A).</t>               
		 <t> Record the time when the traffic targeted towards routeA is 
		 received from the egress interface of the DUT on the emulator.       
		 This is Tup(EMd,DUT) named Data-Rcv-time(Rt-A)</t> 
		 <t>Record the time when routeA is forwarded by the DUT towards
		 the Helper Node. This is Tup(EMf,DUT), also named Route-Fwd-time(Rt-A). 
		   <list style="empty"><t>FIB Convergence =  
		   (Data-Rcv-time  - Route-Rcv-time)(Rt-A)</t>
			 <t>RIB Convergence =
		   (Route-Fwd-time - Route-Rcv-time)(Rt-A)</t>
			 </list></t>
		 </list></t>
		 <t>Note: It is recommended that the test be repeated with a varying number 
		 of routes and route mixtures. With each set route mixture, the test 
		 should be repeated multiple times. The results should record
		 the average, 
		 mean, standard deviation.</t>	
		 </section>
 </section> <!-- for Basic Convergence Tests -->

 <section title="BGP Failure/Convergence Events" anchor="bgp_failure_conv_events">
		 <section title="Physical Link Failure on DUT End" anchor="plf_dut">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the route convergence time due to a local link failure 
			 event at the DUT's Local Interface.</t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t>This test uses the setup as shown in <xref target="basic_test_setup"/>. The shutdown event is 
		     defined as an administrative shutdown event on the DUT.</t>
		 </list></t>
		 <t>Procedure:</t>
		 <t><list style="format %C.">
		 <t> All variables affecting convergence, like authentication, 
		policies, and timers, should be set to basic-test policy.</t>
		 <t> Establish two BGP adjacencies from the DUT to the emulator, one over 
		the peer interface and the other using a second peer 
		interface.</t>  

<!-- [rfced] How may this sentence be rephrased for clarity?
It seems words are missing.

Original (Section 5.2.1):
      C.  Advertise the same route, routeA over both the adjacencies and
          (Emp1) Interface to be the preferred next hop.

FYI, similar text has been edited as follows within this document:
      C.  Advertise the same route, routeA, over both the adjacencies and
          make Best Egress Interface the preferred next hop.
-->

	     <t> Advertise the same route, routeA, over both adjacencies
	     with preferences so that the Best Egress Interface for the
	     preferred next hop is (Emp1) interface.</t>
	     <t> To ensure adjacency establishment, wait for three keepalives
	     to be received from 
		the DUT or a configurable delay before proceeding with the 
		rest of the test.</t> 
	     <t> Start the traffic from the emulator towards the DUT targeted 
		at a specific route (e.g., routeA). Initially, traffic would be 
		observed on the best egress route, Emp1, instead of Emp2.</t> 
	     <t> Trigger the shutdown event of Best Egress Interface on the DUT 
		(Dp1). This time is called Shutdown time.</t>
	     <t> Measure the convergence time for the event to be detected and 
		traffic to be forwarded to Next-Best Egress Interface (Dp2).
		 <list style="empty"><t>Time = Data-detect(Emp2) - Shutdown time</t>
			 </list></t>
	     <t> Stop the offered load and wait for the queues to drain. Restart the data flow.</t> 
	     <t> Bring up the link on the DUT's Best Egress Interface.</t> 
	     <t> Measure the convergence time taken for the traffic to be 
		rerouted from Dp2 to Best Egress Interface, Dp1.
		 <list style="empty"><t>Time = Data-detect(Emp1) - Bring Up time</t>
			 </list></t>
	     <t> It is recommended that the test be repeated with a varying 
		number of routes and route mixtures or with a number of routes 
		and route mixtures closer to what is deployed in operational 
		networks.</t> 
		 </list></t>
		 </section>

		 <section title="Physical Link Failure on Remote/Emulator End">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the route convergence time due to a local link failure 
			 event at the Tester's Local Interface.</t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t> This test uses the setup as shown in <xref target="basic_test_setup"/>.  The shutdown event is 
			 defined as a shutdown of the local interface of the
			 Tester via a logical shutdown event. The procedure
			 used in <xref target="plf_dut"/> is used for the 
			 termination. </t>
		 </list></t>
		 </section>

		 <section title="ECMP Link Failure on DUT End">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the route convergence time due to a local link failure 
			 event at the ECMP member. The FIB configuration and BGP are set to allow two 
			 ECMP routes to be installed. However, policy directs the routes to be 
			 sent only over one of the paths.</t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t> This test uses the setup as shown in <xref target="basic_test_setup"/>, and the
		    procedure used in <xref target="plf_dut"/>.</t>
		 </list></t>
		 </section>
 </section> <!-- for BGP Failure/Convergence Events -->

		 <section title="BGP Adjacency Failure (Non-Physical Link
				 Failure) on Emulator">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the route convergence time due to BGP Adjacency 
			 Failure on the emulator. </t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t> This test uses the setup as shown in <xref target="basic_test_setup"/>. </t>
		 </list></t>
		 <t>Procedure:
		 <list style="format %C.">
			 <t>All variables affecting convergence, like authentication, 
		 policies, and timers, should be set to basic-policy. </t>
			 <t>Establish two BGP adjacencies from the DUT to the emulator: one over 
		 the Best Egress Interface and the other using the Next-Best 
		 Egress Interface.</t> 
		 <t>Advertise the same route, routeA, over both adjacencies
		 with preferences so that the Best Egress Interface for the preferred next hop
		 is (Emp1) interface.</t> 
		 <t>To ensure adjacency establishment, wait for three
		 keepalives to be received from 
		 the DUT or a configurable delay before proceeding with the 
		 rest of the test.</t> 
		 <t>Start the traffic from the emulator towards the DUT targeted
		 at a specific route (e.g., routeA).  Initially, traffic would be 
		 observed on the Best Egress Interface.</t> 
		 <t>Remove BGP adjacency via a software adjacency down on the 
		 emulator on the Best Egress Interface. This time is called
			 BGPadj-down-time, also termed BGPpeer-down.</t>
			 <t>Measure the convergence time for the event to be detected and 
		 traffic to be forwarded to Next-Best Egress Interface. This time is Tr-rr2, 
			 also called TR2-traffic-on.
				 <list style="empty"><t>Convergence = TR2-traffic-on - BGPpeer-down</t>
				 </list></t>
			 <t>Stop the offered load and wait for the queues to drain and 
		 restart the data flow.</t> 
		 <t>Bring up BGP adjacency on the emulator over the Best Egress 
		 Interface. This time is BGP-adj-up, also called BGPpeer-up.</t>
		 <t>Measure the convergence time taken for the traffic to be 
		 rerouted to the Best Egress Interface. This time is Tr-rr1, also called TR1-traffic-on.

		 <list style="empty"><t>Convergence = TR1-traffic-on - BGPpeer-up</t>
		 </list></t>
		 </list></t>
		 </section>

     <section title="BGP Hard Reset Test Cases" anchor="bgp_hard_reset">
		 <section title="BGP Non-Recovering Hard Reset Event on DUT">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the route convergence time due to a hard reset on the 
			 DUT. </t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t>This test uses the setup as shown in <xref target="basic_test_setup"/>.</t>
		 </list></t>
		 <t>Procedure:</t>
		 <t>
		 <list style="format %C.">
		 <t>The requirement for this test case is that the hard reset 
		event should be non-recovering and should affect only the 
		adjacency between the DUT and the emulator on the Best Egress 
		Interface. </t> 
	     <t>All variables affecting the test SHOULD be set to basic-test values.</t>  
	     <t> Establish two BGP adjacencies from the DUT to the emulator: one over 
		the Best Egress Interface and the other using the Next-Best 
		Egress Interface.</t> 
	     <t>Advertise the same route, routeA, over both adjacencies with preferences
		so that the Best Egress Interface for the preferred next hop
		is (Emp1) interface.</t>
	     <t>To ensure adjacency establishment, wait for three keepalives
	     to be received from 
		the DUT or a configurable delay before proceeding with the 
		rest of the test.</t> 
	     <t>Start the traffic from the emulator towards the DUT targeted 
		at a specific route (e.g., routeA). Initially, traffic would be 
		observed on the Best Egress Interface.</t> 
	     <t>Trigger the hard reset event of the Best Egress Interface on
	     the DUT. This time is called time reset.</t> 

	     <t>This event is detected and traffic is forwarded to the Next-Best Egress Interface. 
	     This time is called time-traffic flow.</t>
	     <t>Measure the convergence time for the event to be detected and 
		traffic to be forwarded to Next-Best Egress Interface. 
			 <list style="empty"><t>Time of convergence = time-traffic flow - time-reset</t>
			 </list></t>
	     <t>Stop the offered load and wait for the queues to drain and 
		restart.</t> 
	     <t>It is recommended that the test be repeated with a varying 
		number of routes and route mixtures or with a number of routes 
		and route mixtures closer to what is deployed in operational 
		networks.</t> 

<!--[rfced] Was "[IGPData]" intended to be RFC 6412?  The text has 
been updated as follows. Please let us know if you prefer otherwise.

Original:
      L.  When varying number of routes are used, convergence Time is
          measured using the Loss Derived method [IGPData].

Current:
   L.  When varying number of routes are used, Convergence Time is
       measured using the Loss-Derived method [RFC6412].
-->

	     <t>When varying number of routes are used, convergence time is 
		measured using the Loss-Derived method <xref target="RFC6412"/>.</t>
	     <t> Convergence time in this scenario is influenced by failure 
		detection time on the Tester, BGP keepalive time and routing, and
		forwarding table update time.</t> 
		 </list></t>
		 </section>
     </section> <!-- for BGP Hard Reset Test Cases -->

		 <section title="BGP Soft Reset">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the route convergence time taken by an 
		    implementation to service a BGP Route Refresh message and advertise a 
		    route.</t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t>This test uses the setup as shown in <xref target="three_node_setup"/>.</t>
		 </list></t>
		 <t>Procedure:</t>
		 <t>
		 <list style="format %C.">
		 <t>The BGP implementation on the DUT and Helper Node needs to support 
		BGP Route Refresh Capability <xref target="RFC2918"/>.</t> 
	     <t>All devices MUST be synchronized using NTP or some local
		 reference clock.</t> 
	     <t>All variables affecting convergence, like authentication, 
		policies, and timers, should be set to basic-test defaults.</t> 
	     <t>The DUT and the Helper Node are configured in the same AS, whereas the 
	     emulator is configured under a different AS.</t> 
	     <t>Establish BGP adjacency between the DUT and the emulator.</t> 
	     <t>Establish BGP adjacency between the DUT and the Helper Node.</t> 
	     <t>To ensure adjacency establishment, wait for three keepalives
	     to be received from 
		the DUT or a configurable delay before proceeding with the 
		rest of the test.</t> 
	     <t>Configure a policy under the BGP on the Helper Node to deny routes 
		received from the DUT.</t> 
	     <t>Advertise routeA from the emulator to the DUT.</t> 
	     <t>The DUT will try to advertise the route to the Helper Node; it will 
		be denied.</t> 
	     <t>Wait for three keepalives.</t>  
	     <t>Start the traffic from the emulator towards the Helper Node 
		targeted at a specific route, say routeA. Initially, no traffic
		    would be observed on the egress interface, as routeA is not 
		present.</t> 
	     <t>Remove the policy on the Helper Node and issue a route refresh 
		request towards the DUT. Note the timestamp of this event. This 
		is the RefreshTime.</t>  
	     <t>Record the time when the traffic targeted towards routeA is 
		received on the egress interface. This is RecTime.</t>
	     <t>The following equation represents the Route Refresh 
		Convergence Time per route. 
		  <list style="empty"><t>Route Refresh Convergence Time = (RecTime - 
		     RefreshTime)</t>
			 </list></t>
		 </list></t>
	 </section>

		 <section title="BGP Route Withdrawal Convergence Time">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the route convergence time taken by an 
			 implementation to service a BGP withdraw message and advertise the 
			 withdraw. 
		    </t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t>This test uses the setup as shown in <xref target="three_node_setup"/>.</t>
		 </list></t>
		 <t>Procedure:</t>
		 <t>
		 <list style="format %C.">
	     <t>This test consists of two steps to determine the Total Withdraw 
		Processing Time.</t> 
	     <t> Step 1: 
		  <list style="format (%d)"><t>All devices MUST be synchronized using NTP or some local
		 reference clock.</t> 
		 <t>All variables should be set to basic-test parameters.</t> 
		 <t>The DUT and Helper Node are configured in the same 
		     AS, whereas the emulator is configured under a 
		     different AS.</t> 
		 <t>Establish BGP adjacency between the DUT and the emulator.</t> 
			 <t>To ensure adjacency establishment, wait for three keepalives 
		    to be received from the DUT or a configurable delay before proceeding 
		     with the rest of the test.</t> 
		 <t>Start the traffic from the emulator towards the DUT 
		     targeted at a specific route (e.g., routeA). Initially, no
		    traffic would be observed on the egress interface as
		     routeA is not present on the DUT.</t> 
		 <t>Advertise routeA from the emulator to the DUT.</t> 
		 <t>The traffic targeted towards routeA is received on the 
		     egress interface.</t> 
		 <t>Now the Tester sends a request to withdraw routeA to the DUT. 
		     TRx(Awith) is also called WdrawTime1(Rt-A).</t>                     
		 <t>Record the time when no traffic is observed as determined by the 
		     emulator. This is the RouteRemoveTime1(Rt-A).</t> 
		 <t>The difference between the RouteRemoveTime1 and 
		     WdrawTime1 is the WdrawConvTime1.
				 <list style="empty"><t>WdrawConvTime1(Rt-A) = RouteRemoveTime1(Rt-A) - WdrawTime1(Rt-A)</t>
				 </list></t>
			 </list></t>
	     <t> Step 2: 
		  <list style="format (%d)"><t>Continuing from Step 1,
		  re-advertise routeA back to the DUT 
		     from the Tester.</t> 
		 <t>The DUT will try to advertise routeA to the Helper Node
		     (this assumes there exists a session between the DUT and 
		     Helper Node).</t> 
		     <t>Start the traffic from the emulator towards the Helper Node
		    targeted at a specific route (e.g., routeA). Traffic 
		     would be observed on the egress interface after routeA 
		     is received by the Helper Node.
				 <list style="empty"><t>WATime=time traffic first flows</t>
				 </list></t>
		 <t>Now the Tester sends a request to withdraw routeA to 
		     DUT. This is the WdrawTime2(Rt-A). 
				 <list style="empty"><t>WAWtime-TRx(Rt-A) = WdrawTime2(Rt-A)</t>
				 </list></t>
			 <t>DUT processes the withdraw and sends it to the
			 Helper Node.</t> 
		 <t>Record the time when no traffic is observed as determined by the 
		     emulator. This is:
				 <list style="empty"><t>TR-WAW(DUT,RouteA) = RouteRemoveTime2(Rt-A)</t>
				 </list></t>
		 <t>Total Withdraw Processing Time is:  
	 <list style="empty"><t>TotalWdrawTime(Rt-A) = ((RouteRemoveTime2(Rt-A) - WdrawTime2(Rt-A)) -
			    WdrawConvTime1(Rt-A))</t>
				 </list></t>
			 </list></t>

		 </list></t>
	 </section>

	 <section title="BGP Path Attribute Change Convergence Time">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the convergence time taken by an implementation to 
			 service a BGP Path Attribute Change.</t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t>This test uses the setup as shown in <xref target="basic_test_setup"/>.</t>
		 </list></t>
		 <t>Procedure:</t>
		 <t>
		 <list style="format %C.">
	     <t>This test only applies to Well-Known Mandatory Attributes 
		like origin, AS path, and next hop.</t> 
	     <t>In each iteration of the test, only one of these mandatory 
		attributes need to be varied whereas the others remain the 
		same.</t>
	     <t>All devices MUST be synchronized using NTP or some local
		 reference clock.</t> 
	     <t>All variables should be set to basic-test parameters.</t> 
	     <t>Advertise the same route, routeA, over both adjacencies with preferences
		so that the Best Egress Interface for the preferred next hop
		is (Emp1) interface.</t>
	     <t>To ensure adjacency establishment, wait for three keepalives
	     to be received from 
		the DUT or a configurable delay before proceeding with the 
		rest of the test.</t>
	     <t>Start the traffic from the emulator towards the DUT targeted 
		at the specific route (e.g., routeA). Initially, traffic would be 
		observed on the Best Egress Interface.</t> 
	     <t>Now advertise the same route, routeA, on the Next-Best Egress 
		Interface but by varying one of the well-known mandatory 
		attributes to have a preferred value over that interface. We
		call this Tbetter. The other values need to be the same as what 
		was advertised on the Best-Egress adjacency.
		 <list style="empty"><t>TRx(Path-Change(Rt-A)) =  Path Change Event Time(Rt-A)</t></list></t>
		 <t>Measure the convergence time for the event to be detected and 
		traffic to be forwarded to Next-Best Egress Interface. 
			 <list style="empty"><t>DUT(Path-Change, Rt-A) = Path-switch time(Rt-A)</t>
						   <t>Convergence = Path-switch time(Rt-A) - Path Change Event Time(Rt-A)</t></list></t>
		 <t>Stop the offered load and wait for the queues to drain and 
		restart.</t>
		 <t>Repeat the test for various attributes.</t>
	  </list></t>

	 </section>

	 <section title="BGP Graceful Restart Convergence Time">
		 <t>Objective:</t>
		 <t><list>
		    <t>This test measures the route convergence time taken by an 
		    implementation during a Graceful Restart Event as detailed in the
		    terminology document <xref target="RFC4098"/>.</t>
		 </list></t>
		 <t>Reference Test Setup:</t>
		 <t><list>
		    <t>This test uses the setup as shown in <xref target="four_node_setup"/>.</t>
		 </list></t>
		 <t>Procedure:</t>
		 <t>
		 <list style="format %C.">
	     <t>It measures the time taken by an implementation to service a 
		BGP Graceful Restart Event and advertise a route.</t>  
	     <t>The Helper Nodes are the same model as the DUT and run the same 
		BGP implementation as the DUT.</t>
	     <t>The BGP implementation on the DUT and Helper Node needs to support the
		BGP Graceful Restart Mechanism <xref target="RFC4724"/>.</t> 
	     <t>All devices MUST be synchronized using NTP or some local
		 reference clock.</t> 
	     <t>All variables are set to basic-test values.</t> 

<!-- [rfced] We suggest removing the hyphen in each name
because it seems unnecessary. Please let us know if you agree.

Original:  Helper Node-1 and Helper Node-2
Suggested: Helper Node 1 and Helper Node 2
-->

	     <t>The DUT and Helper Node 1 (HLP1) are configured in the same AS, 
		whereas the emulator and Helper Node 2 (HLP2) are configured 
		under different ASs.</t> 
	     <t>Establish BGP adjacency between the DUT and Helper Nodes.</t> 
	     <t>Establish BGP adjacency between the Helper Node 2 and the emulator.</t> 
	     <t>To ensure adjacency establishment, wait for three keepalives
	     to be received from 
		the DUT or a configurable delay before proceeding with the 
		rest of the test.</t> 
	     <t>Configure a policy under the BGP on Helper Node 1 to deny routes 
		received from the DUT.</t> 
	     <t>Advertise routeA from the emulator to Helper Node 2.</t>  
	     <t>Helper Node 2 advertises the route to the DUT and the DUT will try to 
		advertise the route to Helper Node 1, which will be denied.</t> 
	     <t>Wait for three keepalives.</t>  
	     <t>Start the traffic from the emulator towards the Helper Node 1 
		targeted at the specific route (e.g., routeA). Initially, no 
		traffic would be observed 

<!-- [rfced] Regarding capitalization of
egress interface vs. Egress interface vs. Egress Interface:
should it be all lowercase when it's not part of the following terms?

  Preferred Egress Interface
  Next-Best Egress Interface
  Route Egress Interface
  Best Egress Interface

(We note that RFC 6412 uses 'the egress interface'.)

For example, should changes be made as follows?
Original: on the Egress interface 
Perhaps: on the egress interface
-->

on the egress interface as 
		routeA is not present.</t> 
	     <t>Perform a Graceful Restart Trigger Event on the DUT and note the 
		time. This is the GREventTime.</t> 
	     <t>Remove the policy on Helper Node 1.</t> 
	     <t>Record the time when the traffic targeted towards routeA is 
		received on the egress interface.
		 <list style="empty"><t>This is TRr(DUT, routeA), also called RecTime(Rt-A).</t></list></t>
		 <t>The following equation represents the Graceful Restart 
		Convergence Time. 
			 <list style="empty"><t>Graceful Restart Convergence Time(Rt-A) = ((RecTime(Rt-A) - 
		     GREventTime) - RIB-IN)</t></list></t>
		 <t>It is assumed in this test case that after a switchover is 
		triggered on the DUT, it will not have any cycles to process the 
		BGP Refresh messages.  
		The reason for this assumption is that there is a narrow 
		window of time where after switchover, when we remove the 
		policy from Helper Node 1, implementations might generate 
		Route Refresh automatically and this request might be 
		serviced before the DUT actually switches over and 
		re-establishes BGP adjacencies with the peers.</t>


	  </list></t>
	 </section>

 </section> <!-- for Test Cases -->

 <section anchor="Reporting" title="Reporting Format">

	 <t>For each test case, it is recommended that the reporting tables 
	 below are completed, and all time values SHOULD be reported with 
	 resolution as specified in <xref target="RFC4098"/>.</t>

<!-- [rfced] Does "POS" refer to "PPP over SONET" 
or "Packet over SONET" or otherwise?

Original:
    Interface type                   GigE, POS, ATM, other
-->

 <t>
  <figure align="center"> 
    <artwork align="center"><![CDATA[
Parameter                        Units or Description
===========================      ==========================
Test case                        Test case number 

Test topology                    1, 2, 3, or 4

Parallel links                   Number of parallel links 

Interface type                   Gigabit Ethernet (GigE), 
                                 Packet over SONET (POS), ATM, other

Convergence Event                Hard reset, soft reset, link
                                 failure, or other defined 

eBGP sessions                    Number of eBGP sessions 

iBGP sessions                    Number of iBGP sessions 

eBGP neighbor                    Number of eBGP neighbors 

iBGP neighbor                    Number of iBGP neighbors 

Routes per peer                  Number of routes 

Total unique routes              Number of routes 

Total non-unique routes          Number of routes 

IGP configured                   IS-IS, OSPF, static, or other

Route mixture                    Description of route mixture

Route packing                    Number of routes included in an update 

Policy configured                Yes, No

SIDR origin authentication       Yes, No
[RFC7115]

bgp-sec [BGPsec]                 Yes, No

Packet size offered              Bytes
to the DUT    

Offered load                     Packets per second 

Packet sampling interval         Seconds 
on Tester 

Forwarding delay threshold       Seconds 

Timer values configured on DUT
     
  Interface failure              Seconds 
   indication delay 
  Hold time                      Seconds 
  MinRouteAdvertisementInterval  Seconds
     (MRAI)
  MinASOriginationInterval       Seconds 
     (MAOI)
  Keepalive time                 Seconds 
  ConnectRetry                   Seconds

TCP parameters for DUT and Tester
  Maximum Segment Size (MSS)     Bytes
  Slow start threshold           Bytes 
  Maximum window size            Bytes 
            ]]></artwork>
         </figure>      

 </t>

 <t>Test Details:</t>
   <t>
   <list style="letters">
       <t>If the Offered Load matches a subset of routes, describe how 
	  this subset is selected.</t> 
       <t>Describe how the convergence event is applied; does it cause 
	  instantaneous traffic loss or not?</t> 
       <t>If there is any policy configured, describe the configured   
	  policy.</t>
   </list> 
   </t>
   <t> Complete the table below for the initial convergence event and 
       the reversion convergence event.</t>
 <t>
       <figure align="center">
         <artwork align="center"><![CDATA[
 Parameter                        Unit
 ===========================      ==========================
 Convergence Event                Initial or reversion 

 Traffic Forwarding Metrics       
   Total number of packets        Number of packets 
    offered to the DUT 
   Total number of packets        Number of packets 
    forwarded by the DUT 
   Connectivity packet loss       Number of packets 
   Convergence packet loss        Number of packets 
   Out-of-order packets           Number of packets 
   Duplicate packets              Number of packets 

 Convergence Benchmarks           

   Rate-Derived Method [RFC6412]: 
    First route convergence       Seconds 
     time 
    Full convergence time         Seconds 

   Loss-Derived Method [RFC6412]: 
    Loss-Derived convergence      Seconds 
     time 

   Route-Specific (R-S) Loss-Derived 
   Method: 
    Minimum R-S convergence       Seconds 
     time 
    Maximum R-S convergence       Seconds 
     time 
    Median R-S convergence        Seconds 
     time 
    Average R-S convergence       Seconds 
     time 

 Loss of Connectivity (LoC) Benchmarks  

   Loss-Derived Method:          
    Loss-Derived loss of          Seconds 
     connectivity period 

   Route-Specific Loss-Derived   
    Method: 
    Minimum LoC period [n]        Array of seconds 
    Minimum Route LoC period      Seconds 
    Maximum Route LoC period      Seconds 
    Median Route LoC period       Seconds 
    Average Route LoC period      Seconds 

             ]]></artwork>
       </figure>
 </t>

 </section> <!-- for Reporting Format -->

     <!-- Possibly a 'Contributors' section ... -->

     <section anchor="Security" title="Security Considerations">
 <t>
	 Benchmarking activities as described in this memo are limited to 
	 technology characterization using controlled stimuli in a laboratory 
	 environment, with dedicated address space and the constraints 
	 specified in the sections above.</t> 

 <t>     The benchmarking network topology is an independent test setup 
	 and MUST NOT be connected to devices that may forward the test 
	 traffic into a production network or misroute traffic to the test 
	 management network.</t>

 <t>     Further, benchmarking is performed on a "black-box" basis, relying 
	 solely on measurements observable and external to the DUT/SUT.</t> 

 <t>     Special capabilities SHOULD NOT exist in the DUT/SUT specifically 
	 for benchmarking purposes.  Any implications for network security 
	 arising from the DUT/SUT SHOULD be identical in the lab and in 
	 production networks.</t>

     </section>

   </middle>

   <!--  *****BACK MATTER ***** -->

   <back>

     <references title="Normative References">

<reference anchor='IEEE.802.11' target='http://ieeexplore.ieee.org/servlet/opac?punumber=6178209'>
 <front>
  <title>IEEE Standard for Information technology -- Telecommunications and
  information exchange between systems Local and metropolitan area networks --
  Specific requirements Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications</title>
  <author>
   <organization>IEEE</organization>
  </author>
  <date day='5' month='April' year='2012' />
  <abstract><t>This revision specifies technical corrections and clarifications to IEEE Std 802.11 for wireless local area networks (WLANS) as well as enhancements to the existing medium access control (MAC) and physical layer (PHY) functions. It also incorporates Amendments 1 to 10 published in 2008 to 2011.</t>
   </abstract>
 </front>
 <seriesInfo name='IEEE' value='802.11-2012' />
 <seriesInfo name='DOI' value='10.1109/ieeestd.2012.6178212' />
</reference>

       &RFC2119;

	 &RFC2918;

	 &RFC4098;

	 &RFC4271;

	 &RFC6412;

     </references>

     <references title="Informative References">
&RFC7115;

&RFC6414;

<!-- draft-ietf-sidr-bgpsec-protocol-14: I-D Exists -->

<reference anchor='BGPsec'>
<front>
<title>BGPsec Protocol Specification</title>

<author initials='M' surname='Lepinski' fullname='Matt Lepinski' role='editor'>
    <organization />
</author>

<date month='December' year='2015' />

</front>

<seriesInfo name='Work in Progress,' value='draft-ietf-sidr-bgpsec-protocol-14' />

</reference>


        &RFC4760;

	&RFC1242;

        &RFC2545;

	&RFC2285;

        &RFC5925;

	&RFC4724;

	&RFC1983;

    </references>


<section title="Acknowledgements"  numbered="no">
<t>We would like to thank Anil Tandon, Arvind Pandey, Mohan Nanduri, Jay
   Karthik, and Eric Brendel for their input and discussions on various
   sections in the document.  We also like to acknowledge Will Liu, Hubert Gee,
   Semion Lisyansky, and Faisal Shah for their review and feedback on the
   document.</t>
</section>
  </back>
</rfc>

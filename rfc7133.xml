<?xml version="1.0" encoding="US-ASCII"?>

<!-- used v2 -->
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
    <!ENTITY rfc0791 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.0791.xml'>
    <!ENTITY rfc2119 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml'>
    <!ENTITY rfc2460 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2460.xml'>
    <!ENTITY rfc2804 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2804.xml'>
    <!ENTITY rfc3031 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3031.xml'>
    <!ENTITY rfc3032 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3032.xml'>
    <!ENTITY rfc7011 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.7011.xml'>
    <!ENTITY rfc7012 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.7012.xml'>
    <!ENTITY rfc7013 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.7013.xml'>
    <!ENTITY rfc5477 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5477.xml'>
    <!ENTITY rfc6313 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.6313.xml'>
    <!ENTITY rfc6325 PUBLIC ''
      'http://xml.resource.org/public/rfc/bibxml/reference.RFC.6325.xml'>
    <!ENTITY VXLAN PUBLIC 'VXLAN'
      'http://xml.resource.org/public/rfc/bibxml3/reference.I-D.mahalingam-dutt-dcops-vxlan.xml'>
]>

<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>

<?rfc autobreaks="yes" ?>
<?rfc toc="yes" ?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes" ?>
<?rfc rfcedstyle="yes"?>
<?rfc compact="yes"?>  
<?rfc subcompact="no"?>

<rfc number="7133"  category="std" ipr="trust200902" submissionType="IETF" consensus="yes">
<front>
    <title abbrev='Data Link Layer Information Elements'>Information Elements for Data Link Layer Traffic Measurement</title>
    <author initials='S.K.' surname="Kashima" fullname='Shingo Kashima'>
        <organization abbrev='NTT'>Nippon Telegraph and Telephone Corporation</organization>
        <address>
            <postal>
		            <street>1-5-1 Otemachi</street>
                <city>Chiyoda-ku</city>
                <region>Tokyo</region>
                <code>100-8116</code>
                <country>Japan</country>
            </postal>
            <phone>+81 3 6838 5267</phone>
            <email>kashima@nttv6.net</email>
        </address>
    </author>
    <author initials='A.K.' surname="Kobayashi, Ed." fullname='Atsushi Kobayashi'>
        <organization abbrev='NTT East'>Nippon Telegraph and Telephone East Corporation</organization>
        <address>
            <postal>
		            <street>3-19-2 Nishi-shinjuku</street>
                <city>Shinjuku-ku</city>
                <region>Tokyo</region>
                <code>163-8019</code>
                <country>Japan</country>
            </postal>
            <phone>+81 3 5359 4351</phone>
            <email>akoba@nttv6.net</email>
        </address>
    </author>
    <author initials='P.A.' surname="Aitken" fullname='Paul Aitken'>
        <organization abbrev='Cisco Systems, Inc.'>Cisco Systems, Inc.</organization>
        <address>
            <postal>
            		<street>96 Commercial Quay</street>
                <city>Commercial Street</city>
                <region>Edinburgh</region>
                <code>EH6 6LX</code>
                <country>United Kingdom</country>
            </postal>
            <phone>+44 131 561 3616</phone>
            <email>paitken@cisco.com</email>
        </address>
    </author>

    <date month="May" year="2014"/>
    <area></area>
    <workgroup>IP Flow Information Export</workgroup>


	<abstract>
		<t>This document describes Information Elements related to the data link layer. They are used by the IP Flow Information Export (IPFIX) protocol for encoding measured data link layer traffic information.</t>
	</abstract>
</front>

<middle>

<section title="Introduction"> <!-- 1 -->

<t>Ethernet <xref target="IEEE802.1D" /> and VLAN (Virtual LAN) technologies
had been used only in Local Area Networks. Recently, they have been used in
Wide Area Networks, e.g., Layer 2 VPN (L2 VPN) services. Accordingly, carrier networks using
VLAN technologies have been enhanced to <xref target="IEEE802.1Q">Provider
Bridged Networks and Provider Backbone Bridged Networks</xref>. In addition, Ethernet in
data centers has also been enhanced for server virtualization and input/output
(I/O) consolidation.</t>

<t>While these innovations provide flexibility, scalability, and mobility to an existing network architecture, they increase the complexity of traffic measurement due to the existence of various Ethernet header formats. To cope with this, a more sophisticated method of traffic measurement is required.</t>

<t>IPFIX and Packet Sampling (PSAMP) help to resolve these problems. However, the PSAMP
Information Model <xref target="RFC5477" /> and the IPFIX Information Model
<xref target="RFC7011" /> don't yet contain enough Information Elements related
to the data link layer, e.g., Ethernet header forms. This document describes
existing and new Information Elements related to data link layers that enable a
more sophisticated traffic measurement method.</t>



<t>Note that this document does not update <xref target="RFC5477"/> or <xref target="RFC7011"/> because IANA's IPFIX registry <xref target="IANA-IPFIX"/> is the ultimate Information Element reference, per Section 1 of <xref target="RFC7012"/>.</t>

<section title="Conventions Used in This Document"> <!-- 1.1 -->

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <xref target="RFC2119">RFC 2119</xref>.</t>

</section> <!-- 1.1 -->
</section> <!-- 1 -->

<section title="Extended Ethernet Technology"> <!-- 2 -->

<section title="Wide-Area Ethernet Technology Summary"> <!-- 2.1 -->

<t><xref target="IEEE802.1Q"> Provider Bridge and Provider Backbone Bridge</xref>, which are standards for Wide-Area Ethernet, are described below.</t>

<t>
<list style="symbols">

<t>In <xref target="IEEE802.1Q">Provider Bridge</xref>, there are two VLAN IDs: Service VLAN Identifier (S-VID) and Customer VLAN Identifier (C-VID). S-VID is assigned to an Ethernet frame by a service provider, while C-VID is independently assigned to an Ethernet frame by a customer. Frame switching in a service provider network is based on only S-VID.</t>

<t>In <xref target="IEEE802.1Q">Provider Backbone Bridge</xref>, new Ethernet fields, such as Backbone VLAN Identifier (B-VID) and Backbone Service Instance Identifier (I-SID), are introduced to overcome the limitations on the VLAN identifier space and to isolate the service provider and customer identifier spaces. Frame switching is based on a 12-bit B-VID, and customer identification is based on a 24-bit I-SID. A flexible network design has become possible because network management is separated from customer management. Other Ethernet fields that indicate quality of service (QoS) class are Backbone VLAN Priority Code Point (B-PCP), Backbone VLAN Drop Eligible Indicator (B-DEI), Backbone Service Instance Priority Code Point (I-PCP), and Backbone Service Instance Drop Eligible Indicator (I-DEI).</t>
</list>
</t>

<t>The Provider Backbone Bridge technologies have enhanced a Wide-Area Ethernet
service from a flat network to a hierarchical network consisting of a Provider Bridged Network and Provider Backbone Bridged Network.</t>

<t>
Frame formats used in Wide-Area Ethernet are shown in <xref target="appa"/>.
</t>

</section> <!-- 2.1 -->

<section title="Virtual Ethernet Technology Summary"> <!-- 2.2 -->


<t>
There have been several challenges in the existing virtual switches environment
in a data center. One is the lack of network management visibility: limited
features on virtual switches make it difficult to monitor traffic among virtual
machines (VMs). Another is the lack of management scalability and flexibility:
increasing the number of VMs for multi-tenant architecture causes an increase in the number of virtual switches and in the number of the traffic control policies, which reach the limitations of network management scalability and flexibility.
</t>

<t>
In this situation, the IEEE 802.1 working group is standardizing virtual
bridging technologies such as Edge Virtual Bridging (EVB), including two kinds of
Edge Relays: Virtual Edge Bridge (VEB) and Virtual Edge Port Aggregator
(VEPA) <xref target="IEEE802.1Qbg" />. The VEB is a bridge that provides
bridging among multiple VMs and the external bridging environment. The VEPA is a bridge-like device on a host that forwards all internal traffic to the adjacent EVB bridge and then distributes any traffic received from the adjacent EVB bridge to VMs. The VEPA makes all the VM-to-VM traffic visible to the EVB bridge so that the traffic can be monitored and so that the EVB bridge can apply filtering to the traffic.
</t>
<t>
To improve flexibility, a virtual link between a host system and EVB bridge is
standardized as S-channel. S-channel allows a bridge to treat the traffic in
the virtual link as if it comes in on a separate port. For example, in the
host, an S-channel may be attached to a VEB or a VEPA or directly to an
internal port in order to apply each port-based filtering rule to the
traffic. S-channel over the link between a host and its adjacent bridge uses
Service VLAN Tag (S-TAG) <xref target="IEEE802.1Q" />.
When S-channel is in use, frames on the link carry an S-TAG to identify the S-channel.
</t>
<t>
On the other hand, Bridge Port Extension emulates single Extended Bridge from
multiple physical switches and virtual switches, and it also simplifies network management. Also, it solves the lack of network management visibility by forwarding all traffic into a central Controlling Bridge using E-channel. E-channel over the link between a Bridge Port Extender and a Controlling Bridge uses E-TAG defined in <xref target="IEEE802.1BR" />.
</t>
<t>
Traffic monitoring over S-channel and E-channel is required in order to get
visibility of VM-to-VM traffic and visibility of each channel's traffic on a virtual link. 
</t>
<t>
Frame formats with E-TAG used in E-channel and S-TAG used in S-channel are
shown in <xref target="appa"/>.&nbsp; Though these frames carry special tags while on the link, those tags identify a virtual port (or for multicast in the downstream direction, a set of virtual ports) to which they are destined. These tag values only have local meaning, and the Flow would be reported as sent and arriving on the corresponding virtual ports. Therefore, IPFIX does not need to monitor data based on these tags.
</t>

</section> <!-- 2.2 -->

</section> <!-- 2 -->

<section title="Modification and Addition of Information Elements Related to Data Link Layer" anchor="ie"> <!-- 3 -->

<t>The Information Elements listed in the upper section of Table 1 are necessary for enabling IPFIX and PSAMP traffic measurement for the data link layer, which is not limited to Ethernet because the method can be applied to other data link protocols as well.</t>

<t>Information Elements in the middle section of Table 1 are necessary for enabling the IPFIX and PSAMP traffic measurement for <xref target="IEEE802.1Q" />.</t>

<t>Information Elements in the lower section of Table 1 are octet counter or packet length for layer 2, and they are necessary for enabling IPFIX and PSAMP traffic measurement for the data link layer.</t>

<figure title="Table 1: Information Elements Related to Data Link Layer" align="center">
<artwork align="center"><![CDATA[
+-----+------------------------------------+
| ID  | Name                               |
+-----+------------------------------------+
| 312 | dataLinkFrameSize                  |
| 315 | dataLinkFrameSection               |
| 408 | dataLinkFrameType                  |
| 409 | sectionOffset                      |
| 410 | sectionExportedOctets              |
+-----+------------------------------------+
| 411 | dot1qServiceInstanceTag            |
| 412 | dot1qServiceInstanceId             |
| 413 | dot1qServiceInstancePriority       |
| 414 | dot1qCustomerSourceMacAddress      |
| 415 | dot1qCustomerDestinationMacAddress |
+-----+------------------------------------+
| 352 | layer2OctetDeltaCount              |
| 353 | layer2OctetTotalCount              |
| 417 | postL2OctetDeltaCount              |
| 418 | postMCastL2OctetDeltaCount         |
| 420 | postL2OctetTotalCount              |
| 421 | postMCastL2OctetTotalCount         |
| 422 | minimumL2TotalLength               |
| 423 | maximumL2TotalLength               |
| 424 | droppedL2OctetDeltaCount           |
| 425 | droppedL2OctetTotalCount           |
| 426 | ignoredL2OctetTotalCount           |
| 427 | notSentL2OctetTotalCount           |
| 428 | layer2OctetDeltaSumOfSquares       |
| 429 | layer2OctetTotalSumOfSquares       |
| 430 | layer2FrameDeltaCount              |
| 431 | layer2FrameTotalCount              |
+-----+------------------------------------+
]]></artwork>
</figure>

<section title="Existing Information Elements" anchor="existingie"> <!-- 3.1 -->

<t>Some existing Information Elements are required for data link layer export.
Their details are reproduced here from IANA's IPFIX registry <xref
target="IANA-IPFIX"/>. Additions per this document appear between *.</t>

<t><xref target="dataLinkFrameSize"/> introduces the missing Data Type
Semantics for the dataLinkFrameSize Information Element, which is held to be an
interoperable change per #4 in Section 5.2 of <xref target="RFC7013"/>.</t>

<t><xref target="dataLinkFrameSection"/> extends the definition of the dataLinkFrameSection Information Element with reference to the new
sectionOffset Information Element, which is also an interoperable change per #4
in Section 5.2 of <xref target="RFC7013"/>.</t>

<t>The layer2OctetDeltaCount Information Element reports the number of layer 2 octets since the previous report in incoming packets for this Flow, while the layer2OctetTotalCount Information Element reports the total number of layer 2 octets in incoming packets for this Flow. The layer2FrameDeltaCount Information Element reports the number of incoming layer 2 frames since the previous report for this Flow, while layer2FrameTotalCount Information Element reports the total number of incoming layer 2 frames for this Flow. All of these Information Elements are unchanged from the existing IANA <xref target="IANA-IPFIX"/> definitions, and are reproduced in <xref target="layer2OctetDeltaCount"/> through <xref target="layer2FrameTotalCount"/> below for completeness.</t>

<t>Therefore, these changes do not introduce any backward-compatibility issues.</t>

<t>Per Section 5.2 of <xref target="RFC7013"/>, for each of these changes, [RFC7133] has been appended to the requester in IANA's IPFIX registry <xref target="IANA-IPFIX"/>, the Information Element's revision number has been incremented by one, and the Information Element's revision date column has been updated.</t>

<section title="dataLinkFrameSize" anchor="dataLinkFrameSize">
<t>Description:</t>
<t>
<list>
<t>This Information Element specifies the length of the selected data link frame.</t>

<t>The data link layer is defined in <xref target="ISO_IEC.7498-1_1994"/>.</t>
</list>
</t>
<t>Abstract Data Type: unsigned16</t>
<t>*Data Type Semantics: quantity*</t>
<t>ElementId: 312</t>
<t>References: <xref target="ISO_IEC.7498-1_1994"/></t>
<t>Status: current</t>
</section>

<section title="dataLinkFrameSection" anchor="dataLinkFrameSection">

<t>Description:</t>
<t>
<list>
<t>This Information Element carries n octets from the data link frame of a selected frame, starting sectionOffset octets into the frame.</t>

<t>*However, if no sectionOffset field corresponding to this Information
Element is present, then a sectionOffset of zero applies, and the octets MUST be from the start of the data link frame.*</t>

<t>The sectionExportedOctets expresses how much data was observed, while the remainder is padding.</t>

<t>When the sectionExportedOctets field corresponding to this Information
Element exists, this Information Element MAY have a fixed length and MAY be padded, or it MAY have a variable length.</t>

<t>When the sectionExportedOctets field corresponding to this Information Element does not exist, this Information Element SHOULD have a variable length and MUST NOT be padded. In this case, the size of the exported section may be constrained due to limitations in the IPFIX protocol.</t>

<t>Further Information Elements, i.e., dataLinkFrameType and dataLinkFrameSize, are needed to specify the data link type and the size of the data link frame of this Information Element.  A set of these Information Elements MAY be contained in a structured data type, as expressed in 
<xref target="RFC6313"/>. Or a set of these Information Elements MAY be
contained in one Flow Record as shown in <xref target="appb"/> of [RFC7133].</t>

<t>The data link layer is defined in <xref target="ISO_IEC.7498-1_1994"/>.</t>
</list>
</t>
<t>Abstract Data Type: octetArray</t>
<t>ElementId: 315</t>
<t>References: <xref target="RFC6313"/> [RFC7133] <xref target="ISO_IEC.7498-1_1994"/></t>
<t>Status: current</t>
</section>

<section title="layer2OctetDeltaCount" anchor="layer2OctetDeltaCount">
<t>The layer2OctetDeltaCount Information Element is unchanged from the existing IANA <xref target="IANA-IPFIX"/> definition and is reproduced here for reference only.</t>
<t>Description</t>
<t>
<list>
<t>The number of layer 2 octets since the previous report (if any) in incoming packets for this Flow at the Observation Point. The number of octets includes layer 2 header(s) and layer 2 payload.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: deltaCounter</t>
<t>Units: octets</t>
<t>ElementId: 352</t>
<t>Status: current</t>
</section>

<section title="layer2OctetTotalCount" anchor="layer2OctetTotalCount">
<t>The layer2OctetTotalCount Information Element is unchanged from the existing IANA <xref target="IANA-IPFIX"/> definition and is reproduced here for reference only.</t>
<t>Description:</t>
<t>
<list>
<t>The total number of layer 2 octets in incoming packets for this Flow at the Observation Point since the Metering Process (re-)initialization for this Observation Point. The number of octets includes layer 2 header(s) and layer 2 payload.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>Units: octets</t>
<t>ElementId: 353</t>
<t>Status: current</t>
</section>

<section title="layer2FrameDeltaCount" anchor="layer2FrameDeltaCount">
<t>The layer2FrameDeltaCount Information Element is unchanged from the existing IANA <xref target="IANA-IPFIX"/> definition and is reproduced here for reference only.</t>
<t>Description:</t>
<t>
<list>
<t>The number of incoming layer 2 frames since the previous report (if any) for this Flow at the Observation Point.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: deltaCounter</t>
<t>Units: frames</t>
<t>ElementId: 430</t>
<t>Status: current</t>
</section>

<section title="layer2FrameTotalCount" anchor="layer2FrameTotalCount">
<t>The layer2FrameTotalCount Information Element is unchanged from the existing IANA <xref target="IANA-IPFIX"/> definition and is reproduced here for reference only.</t>
<t>Description:</t>
<t>
<list>
<t>The total number of incoming layer 2 frames for this Flow at the Observation Point since the Metering Process (re-)initialization for this Observation Point.</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>Units: frames</t>
<t>ElementId: 431</t>
<t>Status: current</t>
</section>



</section> <!-- 3.1 -->

<section title="New Information Elements" anchor="newie"> <!-- 3.2 -->

<t>The following new Information Elements have been added for data link layer monitoring.</t>

<t>In IANA's IPFIX registry <xref target="IANA-IPFIX"/>, the Requester has been
set to [RFC7133], the Information Element's Revision has been set to zero, and
the Information Element's Date set to the date upon which the new Information
Elements have been added to the registry. All other columns that are not explicitly mentioned below (e.g., Units, Range, References) are not applicable and are to be left blank since the registry does not explicitly record "not applicable".</t>



<section title="dataLinkFrameType">
<t>Description:</t>
<t>
<list>
<t>This Information Element specifies the type of the selected data link frame.</t>

<t>The following data link types are defined here:</t>

<t>- 0x01 IEEE802.3 ETHERNET <xref target="IEEE802.3"/></t>
<t>- 0x02 IEEE802.11 MAC Frame format <xref target="IEEE802.11"/></t>

<t>Further values may be assigned by IANA. Note that the assigned values are bits so that multiple observations can be OR'd together.</t>

<t>The data link layer is defined in <xref target="ISO_IEC.7498-1_1994"/>.</t>
</list>
</t>
<t>Abstract Data Type: unsigned16</t>
<t>Data Type Semantics: flags</t>
<t>ElementId: 408</t>
<t>References: <xref target="IEEE802.3"/> <xref target="IEEE802.11"/> <xref target="ISO_IEC.7498-1_1994"/></t>
<t>Status: current</t>
</section>

<section title="sectionOffset">
<t>Description:</t>
<t>
<list>
<t>This Information Element specifies the offset of the packet section (e.g., dataLinkFrameSection, ipHeaderPacketSection, ipPayloadPacketSection, mplsLabelStackSection, and mplsPayloadPacketSection). If this Information Element is omitted, it defaults to zero (i.e., no offset).</t>
<t>If multiple sectionOffset Information Elements are specified within a single Template, then they apply to the packet section Information Elements in order: the first sectionOffset applies to the first packet section, the second to the second, and so on. Note that the "closest" sectionOffset and packet section Information Elements within a given Template are not necessarily related. If there are fewer sectionOffset Information Elements than packet section Information Elements, then subsequent packet section Information Elements have no offset, i.e., a sectionOffset of zero applies to those packet section Information Elements. If there are more sectionOffset Information Elements than the number of packet section Information Elements, then the additional sectionOffset Information Elements are meaningless.</t>
</list>
</t>
<t>Abstract Data Type: unsigned16</t>
<t>Data Type Semantics: quantity</t>
<t>ElementId: 409</t>
<t>Status: current</t>
</section>

<section title="sectionExportedOctets">
<t>Description:</t>
<t>
<list>
<t>This Information Element specifies the observed length of the packet section (e.g., dataLinkFrameSection, ipHeaderPacketSection, ipPayloadPacketSection, mplsLabelStackSection, and mplsPayloadPacketSection) when padding is used.</t>

<t>The packet section may be of a fixed size larger than the sectionExportedOctets. In this case, octets in the packet section beyond the sectionExportedOctets MUST follow the <xref target="RFC7011"/> rules for padding (i.e., be composed of zero (0) valued octets).</t></list>
</t>
<t>Abstract Data Type: unsigned16</t>
<t>Data Type Semantics: quantity</t>
<t>ElementId: 410</t>
<t>References: <xref target="RFC7011"/></t>
<t>Status: current</t>
</section>


<section title="dot1qServiceInstanceTag">
<t>Description:</t>
<t>
<list>
<t>This Information Element, which is 16 octets long, represents the Backbone
Service Instance Tag (I-TAG) Tag Control Information (TCI) field of an Ethernet
frame as described in <xref target="IEEE802.1Q" />. It encodes the Backbone
Service Instance Priority Code Point (I-PCP), Backbone Service Instance Drop Eligible Indicator (I-DEI), Use Customer Addresses (UCAs), Backbone Service Instance Identifier (I-SID), Encapsulated Customer Destination Address (C-DA), Encapsulated Customer Source Address (C-SA), and reserved fields. The structure and semantics within the Tag Control Information field are defined in <xref target="IEEE802.1Q" />.</t>
</list>
</t>
<t>Abstract Data Type: octetArray</t>
<t>Data Type Semantics: default</t>
<t>ElementId: 411</t>
<t>References: <xref target="IEEE802.1Q"/></t>
<t>Status: current</t>
</section>

<section title="dot1qServiceInstanceId">
<t>Description:</t>
<t>
<list>
<t>The value of the 24-bit Backbone Service Instance Identifier (I-SID) portion of the Backbone Service Instance Tag (I-TAG) Tag Control Information (TCI) field of an Ethernet frame as described in <xref target="IEEE802.1Q" />. </t>
</list>
</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: 412</t>
<t>References: <xref target="IEEE802.1Q"/></t>
<t>Status: current</t>
<t>Range: The valid range is 0 - 16777215 (i.e., 24 bits).</t>
</section>

<section title="dot1qServiceInstancePriority">
<t>Description:</t>
<t>
<list>
<t>The value of the 3-bit Backbone Service Instance Priority Code Point (I-PCP) portion of the Backbone Service Instance Tag (I-TAG) Tag Control Information (TCI) field of an Ethernet frame as described in <xref target="IEEE802.1Q" />.</t>
</list>
</t>
<t>Abstract Data Type: unsigned8</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: 413</t>
<t>References: <xref target="IEEE802.1Q"/></t>
<t>Status: current</t>
<t>Range: The valid range is 0-7.</t>
</section>

<section title="dot1qCustomerSourceMacAddress">
<t>Description:</t>
<t>
<list>
<t>The value of the Encapsulated Customer Source Address (C-SA) portion of the Backbone Service Instance Tag (I-TAG) Tag Control Information (TCI) field of an Ethernet frame as described in <xref target="IEEE802.1Q" />.</t>
</list>
</t>
<t>Abstract Data Type: macAddress</t>
<t>Data Type Semantics: default</t>
<t>ElementId: 414</t>
<t>References: <xref target="IEEE802.1Q"/></t>
<t>Status: current</t>
</section>

<section title="dot1qCustomerDestinationMacAddress">
<t>Description:</t>
<t>
<list>
<t>The value of the Encapsulated Customer Destination Address (C-DA) portion of the Backbone Service Instance Tag (I-TAG) Tag Control Information (TCI) field of an Ethernet frame as described in <xref target="IEEE802.1Q" />.</t>
</list>
</t>
<t>Abstract Data Type: macAddress</t>
<t>Data Type Semantics: default</t>
<t>ElementId: 415</t>
<t>References: <xref target="IEEE802.1Q"/></t>
<t>Status: current</t>
</section>


<section title="postL2OctetDeltaCount">
<t>Description:</t>
<t>
<list>
<t>The definition of this Information Element is identical to the definition of
the layer2OctetDeltaCount Information Element, except that it reports a potentially modified value caused by a middlebox function after the packet passed the Observation Point.</t>
<t>This Information Element is the layer 2 version of postOctetDeltaCount (ElementId #23).</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: deltaCounter</t>
<t>ElementId: 417</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="postMCastL2OctetDeltaCount">
<t>Description:</t>
<t>
<list>
<t>The number of layer 2 octets since the previous report (if any) in outgoing multicast packets sent for packets of this Flow by a multicast daemon within the Observation Domain. This property cannot necessarily be observed at the Observation Point but may be retrieved by other means. The number of octets includes layer 2 header(s) and layer 2 payload.
</t>
<t>This Information Element is the layer 2 version of postMCastOctetDeltaCount (ElementId #20). </t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: deltaCounter</t>
<t>ElementId: 418</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="postL2OctetTotalCount">
<t>Description:</t>
<t>
<list>
<t>The definition of this Information Element is identical to the definition of
the layer2OctetTotalCount Information Element, except that it reports a potentially modified value caused by a middlebox function after the packet passed the Observation Point.</t>
<t>This Information Element is the layer 2 version of postOctetTotalCount (ElementId #171).</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: 420</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="postMCastL2OctetTotalCount">
<t>Description:</t>
<t>
<list>
<t>The total number of layer 2 octets in outgoing multicast packets sent for packets of this Flow by a multicast daemon in the Observation Domain since the Metering Process (re-)initialization. This property cannot necessarily be observed at the Observation Point but may be retrieved by other means. The number of octets includes layer 2 header(s) and layer 2 payload.</t>
<t>This Information Element is the layer 2 version of postMCastOctetTotalCount (ElementId #175).</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: 421</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="minimumL2TotalLength">
<t>Description:</t>
<t>
<list>
<t>Layer 2 length of the smallest packet observed for this Flow. The packet
length includes the length of the layer 2 header(s) and the length of the layer 2 payload.</t>

<t>This Information Element is the layer 2 version of minimumIpTotalLength (ElementId #25).</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>ElementId: 422</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="maximumL2TotalLength">
<t>Description:</t>
<t>
<list>
<t>Layer 2 length of the largest packet observed for this Flow. The packet
length includes the length of the layer 2 header(s) and the length of the layer 2 payload.</t>
<t>This Information Element is the layer 2 version of maximumIpTotalLength (ElementId #26).</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>ElementId: 423</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="droppedL2OctetDeltaCount">
<t>Description:</t>
<t>
<list>
<t>The number of layer 2 octets since the previous report (if any) in packets
of this Flow dropped by packet treatment. The number of octets includes layer 2
header(s) and layer 2 payload.</t>
<t>This Information Element is the layer 2 version of droppedOctetDeltaCount (ElementId #132).</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: deltaCounter</t>
<t>ElementId: 424</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="droppedL2OctetTotalCount">
<t>Description:</t>
<t>
<list>
<t>The total number of octets in observed layer 2 packets (including the layer 2 header) that were dropped by packet treatment since the (re-)initialization of the Metering Process.</t>
<t>This Information Element is the layer 2 version of droppedOctetTotalCount (ElementId #134).</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: 425</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="ignoredL2OctetTotalCount">
<t>Description:</t>
<t>
<list>
<t>The total number of octets in observed layer 2 packets (including the layer 2 header) that the Metering Process did not process since the (re-)initialization of the Metering Process.</t>
<t>This Information Element is the layer 2 version of ignoredOctetTotalCount (ElementId #165).</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: 426</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="notSentL2OctetTotalCount">
<t>Description:</t>
<t>
<list>
<t>The total number of octets in observed layer 2 packets (including the layer 2 header) that the Metering Process did not process since the (re-)initialization of the Metering Process.</t>
<t>This Information Element is the layer 2 version of notSentOctetTotalCount (ElementId #168).</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: 427</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="layer2OctetDeltaSumOfSquares">
<t>Description:</t>
<t>
<list>
<t>The sum of the squared numbers of layer 2 octets per incoming packet since the previous report (if any) for this Flow at the Observation Point. The number of octets includes layer 2 header(s) and layer 2 payload.</t>
<t>This Information Element is the layer 2 version of octetDeltaSumOfSquares (ElementId #198).</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: deltaCounter</t>
<t>ElementId: 428</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

<section title="layer2OctetTotalSumOfSquares">
<t>Description:</t>
<t>
<list>
<t>The total sum of the squared numbers of layer 2 octets in incoming packets for this Flow at the Observation Point since the Metering Process (re-)initialization for this Observation Point. The number of octets includes layer 2 header(s) and layer 2 payload.</t>
<t>This Information Element is the layer 2 version of octetTotalSumOfSquares (ElementId #199).</t>
</list>
</t>
<t>Abstract Data Type: unsigned64</t>
<t>Data Type Semantics: totalCounter</t>
<t>ElementId: 429</t>
<t>References: <xref target="RFC5477"/></t>
<t>Status: current</t>
<t>Units: octets</t>
</section>

</section> <!-- 3.2 -->

</section> <!-- 3 -->


<section title="Modification of Existing Information Elements Related to Packet
Section" anchor="modificationps"> <!-- 4 -->

<t>The new Information Elements related to packet section (i.e., sectionOffset
and sectionExportedOctets) can be applied to not only dataLinkFrameSection but
also to all kinds of packet section (i.e., ipHeaderPacketSection, ipPayloadPacketSection, mplsLabelStackSection, and mplsPayloadPacketSection defined in <xref target="RFC5477" />). Therefore, existing Information Elements Descriptions should be modified as follows.</t>

<section title="ipHeaderPacketSection">

<t>
This Information Element is defined in <xref target="RFC5477" />. The description has been updated from <xref target="RFC5477" />.
</t>

<t>Description:</t>
<t>
<list>
<t>
This Information Element carries a series of n octets from the IP header of a sampled packet, starting sectionOffset octets into the IP header.</t>
<t>However, if no sectionOffset field corresponding to this Information Element is present, then a sectionOffset of zero applies, and the octets MUST be from the start of the IP header.</t>

<t>
With sufficient length, this element also reports octets from the IP payload. However, full packet capture of arbitrary packet streams is explicitly out of scope per the Security Considerations sections of <xref target="RFC5477" /> and <xref target="RFC2804" />.
</t>

<t>
The sectionExportedOctets expresses how much data was exported, while the remainder is padding.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element
exists, this Information Element MAY have a fixed length and MAY be padded, or
it MAY have a variable length.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element does not exist, this Information Element SHOULD have a variable length and MUST NOT be padded. In this case, the size of the exported section may be constrained due to limitations in the IPFIX protocol.
</t>

</list>
</t>

<t>Abstract Data Type: octetArray</t>
<t>ElementId: 313</t>
<t>References: <xref target="RFC2804"/> <xref target="RFC5477"/></t>
<t>Status: current</t>

</section>

<section title="ipPayloadPacketSection">

<t>
This Information Element is defined in <xref target="RFC5477" />. The description is updated from <xref target="RFC5477" />.
</t>

<t>Description:</t>
<t>
<list>
<t>
This Information Element carries a series of n octets from the IP payload of a sampled packet, starting sectionOffset octets into the IP payload.</t>
<t>However, if no sectionOffset field corresponding to this Information Element is present, then a sectionOffset of zero applies, and the octets MUST be from the start of the IP payload.</t>

<t>
The IPv4 payload is that part of the packet that follows the IPv4 header and any options, which <xref target="RFC0791" /> refers to as "data" or "data octets".  For example, see the examples in <xref target="RFC0791" />, Appendix A.
</t>
<t>
The IPv6 payload is the rest of the packet following the 40-octet IPv6 header. Note that any extension headers present are considered part of the payload.  See <xref target="RFC2460" /> for the IPv6 specification.
</t>

<t>
The sectionExportedOctets expresses how much data was observed, while the remainder is padding.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element
exists, this Information Element MAY have a fixed length and MAY be padded, or
it MAY have a variable length.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element does not exist, this Information Element SHOULD have a variable length and MUST NOT be padded. In this case, the size of the exported section may be constrained due to limitations in the IPFIX protocol.
</t>

</list>
</t>

<t>Abstract Data Type: octetArray</t>
<t>ElementId: 314</t>
<t>References: <xref target="RFC0791"/> <xref target="RFC2460"/></t>
<t>Status: current</t>

</section>

<section title="mplsLabelStackSection">

<t>
This Information Element is defined in <xref target="RFC5477" />. The description is updated from <xref target="RFC5477" />.
</t>

<t>Description:</t>
<t>
<list>
<t>
This Information Element carries a series of n octets from the MPLS label stack of a sampled packet, starting sectionOffset octets into the MPLS label stack.</t>
<t>However, if no sectionOffset field corresponding to this Information Element is present, then a sectionOffset of zero applies, and the octets MUST be from the head of the MPLS label stack.</t>

<t>
With sufficient length, this element also reports octets from the MPLS payload. However, full packet capture of arbitrary packet streams is explicitly out of scope per the Security Considerations sections of <xref target="RFC5477" /> and <xref target="RFC2804" />.
</t>
<t>
See <xref target="RFC3031" /> for the specification of MPLS packets.
</t>
<t>
See <xref target="RFC3032" /> for the specification of the MPLS label stack.
</t>

<t>
The sectionExportedOctets expresses how much data was observed, while the remainder is padding.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element
exists, this Information Element MAY have a fixed length and MAY be padded, or
it MAY have a variable length.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element does not exist, this Information Element SHOULD have a variable length and MUST NOT be padded. In this case, the size of the exported section may be constrained due to limitations in the IPFIX protocol.
</t>

</list>
</t>

<t>Abstract Data Type: octetArray</t>
<t>ElementId: 316</t>
<t>References: <xref target="RFC2804"/> <xref target="RFC3031"/> <xref target="RFC3032"/> <xref target="RFC5477"/></t>
<t>Status: current</t>

</section>

<section title="mplsPayloadPacketSection">

<t>
This Information Element is defined in <xref target="RFC5477" />. The description is updated from <xref target="RFC5477" />.
</t>

<t>Description:</t>
<t>
<list>
<t>
The mplsPayloadPacketSection carries a series of n octets from the
MPLS payload of a sampled packet, starting sectionOffset octets
into the MPLS payload, as it is data that follows immediately after
the MPLS label stack.
</t>

<t>However, if no sectionOffset field corresponding to this Information Element is present, then a sectionOffset of zero applies, and the octets MUST be from the start of the MPLS payload.</t>

<t>
See <xref target="RFC3031" /> for the specification of MPLS packets.
</t>
<t>
See <xref target="RFC3032" /> for the specification of the MPLS label stack.
</t>

<t>
The sectionExportedOctets expresses how much data was observed, while the remainder is padding.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element
exists, this Information Element MAY have a fixed length and MAY be padded, or
it MAY have a variable length.
</t>

<t>
When the sectionExportedOctets field corresponding to this Information Element does not exist, this Information Element SHOULD have a variable length and MUST NOT be padded. In this case, the size of the exported section may be constrained due to limitations in the IPFIX protocol.
</t>

</list>
</t>

<t>Abstract Data Type: octetArray</t>
<t>ElementId: 317</t>
<t>References: <xref target="RFC3031"/> <xref target="RFC3032"/></t>
<t>Status: current</t>

</section>

</section> <!-- 4 -->

<section title="Modification of Existing Information Elements Related to VLAN
Tag" anchor="modificationvlan"> <!-- 5 -->

<t>
The traffic measurement using IPFIX and PSAMP for a Provider Backbone Bridged
Network requires the Information Elements related to Backbone Service Instance
Tag (I-TAG) and Backbone VLAN Tag (B-TAG). The set of Information Elements
related to I-TAG is added in <xref target="ie"/>, because I-TAG structure and semantics are different from that of Service VLAN Tag (S-TAG) and Customer VLAN Tag (C-TAG). The set of Information Elements related to B-TAG reuses the existing Information Elements, because B-TAG structure and semantics are identical to  that of C-TAG and S-TAG. This section modifies existing descriptions and references related to C-TAG and S-TAG as follows.

</t>

<section title="dot1qVlanId">
<t>Description:</t>
<t>
<list>
<t>The value of the 12-bit VLAN Identifier portion of the Tag Control
Information field of an Ethernet frame. The structure and semantics within the
Tag Control Information field are defined in <xref target="IEEE802.1Q" />. In
Provider Bridged Networks, it represents the Service VLAN identifier in the
Service VLAN Tag (S-TAG) Tag Control Information (TCI) field or the Customer
VLAN identifier in the Customer VLAN Tag (C-TAG) Tag Control Information (TCI)
field as described
in <xref target="IEEE802.1Q" />. In Provider Backbone Bridged Networks, it
represents the Backbone VLAN identifier in the Backbone VLAN Tag (B-TAG) Tag Control Information
(TCI) field as described in <xref target="IEEE802.1Q" />. In a virtual link
between a host system and EVB bridge, it represents the Service VLAN identifier
indicating S-channel as described in <xref target="IEEE802.1Qbg" />.

</t>
<t>
In the case of a multi-tagged frame, it represents the outer tag's VLAN
identifier, except for I-TAG.
</t>
</list>
</t>

<t>Abstract Data Type: unsigned16</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: 243</t>
<t>Status: current</t>
<t>References: <xref target="IEEE802.1Q"/> <xref target="IEEE802.1Qbg"/></t>
</section>

<section title="dot1qPriority">
<t>Description:</t>
<t>
<list>
<t>The value of the 3-bit User Priority portion of the Tag Control Information
field of an Ethernet frame. The structure and semantics within the Tag Control
Information field are defined in <xref target="IEEE802.1Q" />. In the case of a multi-tagged frame, it represents the 3-bit Priority Code Point (PCP) portion of the outer tag's Tag Control Information (TCI) field as described in <xref target="IEEE802.1Q" />, except for I-TAG.</t>
</list>
</t>

<t>Abstract Data Type: unsigned8</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: 244</t>
<t>Status: current</t>
<t>References: <xref target="IEEE802.1Q"/></t>
</section>

<section title="dot1qCustomerVlanId">
<t>Description:</t>
<t>
<list>
<t>The value represents the Customer VLAN identifier in the Customer VLAN Tag (C-TAG) Tag Control Information (TCI) field as described in <xref target="IEEE802.1Q" />.</t>
</list>
</t>

<t>Abstract Data Type: unsigned16</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: 245</t>
<t>Status: current</t>
<t>References: <xref target="IEEE802.1Q"/></t>
</section>

<section title="dot1qCustomerPriority">
<t>Description:</t>
<t>
<list>
<t>The value represents the 3-bit Priority Code Point (PCP) portion of the
Customer VLAN Tag (C-TAG) Tag Control Information (TCI) field as described in <xref target="IEEE802.1Q" />.</t>
</list>
</t>

<t>Abstract Data Type: unsigned8</t>
<t>Data Type Semantics: identifier</t>
<t>ElementId: 246</t>
<t>Status: current</t>
<t>References: <xref target="IEEE802.1Q"/></t>
</section>

</section> <!-- 5 -->


<section title="The Relationship between Ethernet Header Fields and Information Elements"> <!-- 6 -->

<t></t>
<t>The following figures show a summary of various Ethernet header fields and the Informational Elements that would be used to represent each of the fields.</t>

<figure title="Customer-Tagged Frame Header Fields" anchor="fig1">
<artwork><![CDATA[
 <-- 6 --> <-- 6 --> <-- 4 --> <---- 2 ---->
+---------+---------+---------+-------------+
|         |         |         |             |
|  C-DA   |  C-SA   |  C-TAG  | Length/Type |
|    a    |    b    |    c    |      d      |
+---------+---------+---------+-------------+

a.(Information Element)  destinationMacAddress (80)
b.(Information Element)  sourceMacAddress (56)
c.(Information Elements) dot1qVlanId (243), dot1qPriority (244)
d.(Information Element)  ethernetType (256)
]]></artwork>
</figure>

<figure title="Service-Tagged Frame Header Fields" anchor="fig2">
<artwork><![CDATA[

 <-- 6 --> <-- 6 --> <-- 4 --> <-- 4 --> <---- 2 ---->
+---------+---------+---------+---------+-------------+
|         |         |         |         |             |
|  C-DA   |  C-SA   |  S-TAG  |  C-TAG  | Length/Type |
|    a    |    b    |    c    |    d    |      e      |
+---------+---------+---------+---------+-------------+

a.(Information Element)  destinationMacAddress (80)
b.(Information Element)  sourceMacAddress (56)
c.(Information Elements) dot1qVlanId (243), dot1qPriority (244)
d.(Information Elements) dot1qCustomerVlanId (245),
                         dot1qCustomerPriority (246)
e.(Information Element)  ethernetType (256)
]]></artwork>
</figure>


<figure title="Backbone-VLAN-Tagged Frame Header Fields" anchor="fig3">
<artwork><![CDATA[

 <-- 6 --> <-- 6 --> <-- 4 --> <--- 16 ---> <-- 4 --> <---- 2 ---->
+---------+---------+---------+------------+---------+-------------+
|         |         |         |            |         |             |
|  B-DA   |  B-SA   |  B-TAG  |   I-TAG    |  C-TAG  | Length/Type |
|    a    |    b    |    c    |     d      |    e    |      f      |
+---------+---------+---------+------------+---------+-------------+

a.(Information Element)  destinationMacAddress (80)
b.(Information Element)  sourceMacAddress (56)
c.(Information Elements) dot1qVlanId (243), dot1qPriority (244)
d.(Information Elements) dot1qServiceInstanceTag (411), or 
                         a set of dot1qServiceInstanceId (412),
                         dot1qServiceInstancePriority (413),
                         dot1qCustomerSourceMacAddress (414)
                         dot1qCustomerDestinationMacAddress (415),
e.(Information Elements) dot1qCustomerVlanId (245),  
                         dot1qCustomerPriority (246)
f.(Information Element)  ethernetType (256)
]]></artwork>
</figure>

</section> <!-- 6 -->


<section title="Security Considerations"> <!-- 7 -->
<t>Reporting more granular data may increase the risk of DoS attacks against a Collector. Protection against DoS attacks is discussed in Section 11.4 of <xref target="RFC7011"/>.</t>
<t>The recommendations in this document do not otherwise introduce any additional security issues beyond those already mentioned in <xref target="RFC7011"/> and <xref target="RFC5477"/>.</t>
</section> <!-- 6 -->

<section title="IANA Considerations"> <!-- 8 -->

<t>Existing IPFIX Information Elements <xref
target="IANA-IPFIX"/> have been modified as indicated in Sections <xref
target="existingie" format="counter"/>, <xref target="modificationps"
format="counter"/>, and <xref target="modificationvlan" format="counter"/>.</t>


<t>Per Section 5.2 of <xref target="RFC7013"/>, for each of these changes, [RFC7133] has been appended to the Requester in IANA's IPFIX registry <xref target="IANA-IPFIX"/>, the Information Element's Revision number has been incremented by one, and the Information Element's revision Date column has been updated.</t>
<t>New IPFIX Information Elements <xref
target="IANA-IPFIX"/> have been allocated as shown in <xref target="newie"/>.</t>

</section> <!-- 8 -->


<section title="Acknowledgments"> <!-- 9 -->
<t>
Thanks to Brian Trammell and the IPFIX working group participants who
contributed to mailing-list discussions throughout the development of this
document. Special thanks to Pat Thaler for her help with the IEEE 802 aspects of this work.
</t>
</section> <!-- 9 -->

</middle>

<back>
<references title="Normative References">
&rfc0791;
&rfc2119;
&rfc2460;
&rfc3031;
&rfc3032;
&rfc7011;
&rfc5477;
&rfc6313;



<reference anchor="IEEE802.1Q">
	<front>
	<title>
IEEE Standard for Local and metropolitan area networks: Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks
	</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE</organization>
	</author>
	<date month="August" year="2011" />
	</front>
	<seriesInfo name="IEEE Std" value="802.1Q-2011" />
</reference>

<reference anchor="IEEE802.1BR">
	<front>
	<title>
IEEE Standard for Local and metropolitan area networks: Virtual Bridged Local Area Networks: Bridge Port Extension
	</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE</organization>
	</author>
	<date month="July" year="2012" />
	</front>
	<seriesInfo name="IEEE Std" value="802.1BR-2012" />
</reference>

<reference anchor="IEEE802.1Qbg">
	<front>
	<title>
IEEE Standard for Local and metropolitan area networks: Media Access Control (MAC) Bridges and Virtual Bridged Local Area Networks: Amendment 21: Edge Virtual Bridging
</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE</organization>
	</author>
	<date month="July" year="2012" />
	</front>
	<seriesInfo name="IEEE Std" value="802.1Qbg-2012" />
</reference>

<reference anchor="IEEE802.3">
	<front>
	<title>
IEEE Standard for Ethernet
	</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE</organization>
	</author>
	<date month="December" year="2012" />
	</front>
	<seriesInfo name="IEEE Std" value="802.3-2012" />
</reference>

<reference anchor="IEEE802.11">
	<front>
	<title>
IEEE Standard for Information technology.  Telecommunications and information
exchange between systems Local and metropolitan area networks.  Specific requirements Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications
	</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE</organization>
	</author>
	<date month="March" year="2012" />
	</front>
	<seriesInfo name="IEEE Std" value="802.11-2012" />
</reference>

</references>


<references title="Informative References">

&rfc7012;
&rfc7013;
&rfc2804;


<reference anchor="IEEE802.1D">
	<front>
	<title>
IEEE Standard for Local and metropolitan area networks: Media Access Control (MAC) Bridges</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="">IEEE</organization>
	</author>
	<date month="June" year="2004" />
	</front>
	<seriesInfo name="IEEE Std" value="802.1D-2004" />
</reference>

<reference anchor="ISO_IEC.7498-1_1994">
	<front>
	<title>Information technology -- Open Systems Interconnection -- Basic Reference Model: The Basic Mode</title>
	<author initials="" surname="" fullname="">
	<organization abbrev="International Organization for Standardization">International Organization for Standardization</organization>
	</author>
	<date month="June" year="1996" />
	</front>
	<seriesInfo name="ISO Standard" value="7498-1:1994" />
</reference>


<reference anchor="IANA-IPFIX" target="http://www.iana.org/assignments/ipfix">
        <front>
        <title>IP Flow Information Export (IPFIX) Entities</title>
        <author>
        <organization>IANA</organization>
        </author>
        <date/>
        </front>

</reference>

</references>


<section title="Frame Formats" anchor="appa"> <!-- Appendix A -->

<figure title="Figure A-1: Untagged Frame Format">
<artwork><![CDATA[
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-2: C-TAG Tagging Frame Format">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        C-TAG TPID=0x8100      |C-PCP|C|         C-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-3: S-TAG Tagging Frame Format in Provider Bridged Networks">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        S-TAG TPID=0x88a8      |S-PCP|D|         S-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-4: S-TAG and C-TAG Tagging Frame Format in Provider Bridged Networks">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        S-TAG TPID=0x88a8      |S-PCP|D|         S-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        C-TAG TPID=0x8100      |C-PCP|C|         C-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-5: B-TAG and I-TAG Tagging Frame Format in Provider Backbone Bridged Networks">
<artwork><![CDATA[
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              B-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              B-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        B-TAG TPID=0x88a8      |B-PCP|D|         B-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        I-TAG TPID=0x88e7      |I-PCP|D|U| Res |     I-SID     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             I-SID             |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-DA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-SA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |          Length/Type          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-6: B-TAG, I-TAG, and C-TAG Tagging Frame Format in Provider Backbone Bridged Networks">
<artwork><![CDATA[
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              B-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              B-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        B-TAG TPID=0x88a8      |B-PCP|D|         B-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        I-TAG TPID=0x88e7      |I-PCP|D|U| Res |     I-SID     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|             I-SID             |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-DA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-SA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |        C-TAG TCI=0x8100       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|C-PCP|C|         C-VID         |          Length/Type          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-7: S-TAG Tagging Frame Format for S-channel over the Link between an End Station and Its Adjacent Bridge">
<artwork><![CDATA[
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        S-TAG TPID=0x88a8      |S-PCP|D|         S-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>
<t>
Note: The frame format in Figure A-7 is identical to the format in Figure A-3.
</t>

<figure title="Figure A-8: S-TAG and C-TAG Tagging Frame Format over the Link between an End Station and Its Adjacent Bridge">
<artwork><![CDATA[

0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        S-TAG TPID=0x88a8      |S-PCP|D|         S-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        C-TAG TPID=0x8100      |C-PCP|C|         C-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>
<t>
Note: The frame format in Figure A-8 is identical to the format in Figure A-4.
</t>

<figure title="Figure A-9: E-TAG Tagging Frame Format over the Link between a Controlling Bridge and a Bridge Port Extender">
<artwork><![CDATA[
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        E-TAG TPID=0x893F      |E-PCP|D|   Ingress_E-CID_base  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Res|GRP|      E-CID_base       |Ingre_E-CID_ext|    E-CID_ext  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>

<figure title="Figure A-10: E-TAG and C-TAG Tagging Frame Format over the Link between a Controlling Bridge and a Bridge Port Extender">
<artwork><![CDATA[
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              C-DA                             |
+                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                              C-SA                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        E-TAG TPID=0x893F      |E-PCP|D|   Ingress_E-CID_base  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Res|GRP|      E-CID_base       |Ingre_E-CID_ext|    E-CID_ext  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        C-TAG TPID=0x8100      |C-PCP|C|         C-VID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Length/Type          |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                                                               |
~                         Customer Data                         ~
~                                                               ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>
</section> <!-- Appendix A -->

<section title="Template Format Example" anchor="appb"> <!-- Appendix B -->
<figure title="Figure B-1: Template Format Example">
<artwork><![CDATA[
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|        Set ID (2)             |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      Template ID (256)        |     Field Count (8)           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   ingressInterface (10)       |     Field Length (4)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   egressInterface (14)        |     Field Length (4)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| observationTimeSeconds (322)  |     Field Length (8)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   dataLinkFrameSize (312)     |     Field Length (2)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| dataLinkFrameSection (315)    |     Field Length (65535)      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   dataLinkFrameType (408)     |     Field Length (2)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     sectionOffset (409)       |     Field Length (2)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| sectionExportedOctets (410)   |     Field Length (2)          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
</figure>
</section> <!-- Appendix B -->

</back>
</rfc>

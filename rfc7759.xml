<?xml version="1.0" encoding="US-ASCII"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "reference.RFC.2119.xml">
<!ENTITY RFC2629 SYSTEM "reference.RFC.2629.xml">
<!ENTITY RFC3552 SYSTEM "reference.RFC.3552.xml">
<!ENTITY I-D.narten-iana-considerations-rfc2434bis SYSTEM "reference.I-D.narten-iana-considerations-rfc2434bis.xml">
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>

<?rfc toc="yes"?>

<?rfc tocdepth="4"?>

<?rfc symrefs="yes"?>

<?rfc sortrefs="yes" ?>

<?rfc compact="yes" ?>

<?rfc subcompact="no" ?>

<rfc number="7759" category="std" submissionType="IETF" consensus="yes" ipr="trust200902">
  
  <front>
    
    <title abbrev="Extensions for MPLS-TP OAM Config.">Configuration of Proactive 
	Operations, Administration,&nbsp;and&nbsp;Maintenance&nbsp;(OAM)&nbsp;Functions for MPLS-Based Transport&nbsp;Networks&nbsp;Using&nbsp;Label Switched Path (LSP) Ping</title>


    
    <author fullname="Elisa Bellagamba" initials="E.B."
            surname="Bellagamba">
      <organization></organization>
      <address>
        <email>elisa.bellagamba@gmail.com</email>

      </address>
    </author>
    
      <author fullname="Gregory Mirsky" initials="G."
            surname="Mirsky">
      <organization>Ericsson</organization>
      <address>
        <email>Gregory.Mirsky@ericsson.com</email>

      </address>
    </author>
    
    <author fullname="Loa Andersson" initials="L." 
            surname="Andersson">
      <organization>Huawei Technologies</organization>
      <address>
        <email>loa@mail01.huawei.com</email>

      </address>
    </author>
    
    <author fullname="Pontus Skoldstrom" initials="P.S."
            surname="Skoldstrom">
      <organization>Acreo AB</organization>
      <address>
        <postal>
          <street>Electrum 236</street>

          <city>Kista</city>
          <region></region>
          <code>164 40</code>
          <country>Sweden</country>
        </postal>
        <phone>+46 8 6327731</phone>
        <email>pontus.skoldstrom@acreo.se</email>

      </address>
    </author>
    
    <author fullname="Dave Ward" initials="D.W." surname="Ward">
      <organization>Cisco</organization>
      <address>
        <postal>
          <street></street>

          <city></city>
          <region></region>
          <code></code>
          <country></country>
        </postal>
        <phone></phone>
        <email>dward@cisco.com</email>

      </address>
    </author>
    
    <author fullname="John Drake" initials="J.D."  surname="Drake">
      <organization>Juniper</organization>
      <address>
        <postal>
          <street></street>

          <city></city>
          <region></region>
          <code></code>
          <country></country>
        </postal>
        <phone></phone>
        <email>jdrake@juniper.net</email>

      </address>
    </author>
    
    <date month="February" year="2016" />
    <area>Signaling</area>
    <workgroup>MPLS Working Group</workgroup>
    <keyword>LSP-PING</keyword>
    <keyword>MPLS</keyword>
    <keyword>MPLS-TP</keyword>
    <keyword>OAM</keyword>
    
    <abstract>
      <t>
      This specification describes the configuration of proactive MPLS-TP
      Operations, Administration, and Maintenance (OAM) functions for a given
      Label Switched Path (LSP) using a set of TLVs that are carried by the
      LSP Ping protocol.
      </t>

 </abstract>
</front>
<middle>
  <section title="Introduction">
    
    <t>The MPLS Transport Profile (MPLS-TP) describes a profile of MPLS that
     enables operational models typical in transport networks while providing
     additional Operations, Administration, and Maintenance (OAM),
     survivability, and other maintenance functions not
     currently supported by MPLS.  <xref target="RFC5860"/> defines the requirements for the
     OAM functionality of MPLS-TP.</t>
     
     <t>This document describes the configuration of proactive MPLS-TP
    OAM functions for a given
    Label Switched Path (LSP) using TLVs carried in LSP Ping <xref target="RFC4379"/>.  
    
    In particular, it specifies the mechanisms necessary to establish MPLS-TP OAM 
    entities at the maintenance points for monitoring and performing measurements on an LSP, as well
    as defining information elements and procedures to configure proactive
    MPLS-TP OAM functions running between Label Edge Routers (LERs).  Initialization and control of on-demand MPLS-TP OAM
    functions are expected to be carried out by directly accessing network
    nodes via a management interface; hence, configuration and control of
    on-demand OAM functions are out of scope for this document.</t>
    

    <t>The Transport Profile of MPLS must, by definition <xref target="RFC5654"/>, be
    capable of operating without a control plane. Therefore, there are a few options for configuring MPLS-TP OAM: without a control plane using a Network Management System (NMS), implementing LSP Ping instead or with a control plane implementing extensions to signaling protocols RSVP Traffic Engineering (RSVP-TE) <xref target="RFC3209" /> and/or Targeted LDP <xref target="RFC5036" />.

    </t>      

      <t>Proactive MPLS-TP OAM is performed by a set of protocols:
      Bidirectional Forwarding Detection (BFD) <xref target="RFC6428"/> for Continuity
      Check/Connectivity Verification, the Delay Measurement (DM) protocol
      <xref target="RFC6374"/>, <xref target="RFC6375"/> for delay and delay variation (jitter) measurements, and the
      Loss Measurement (LM) protocol <xref target="RFC6374"/>, <xref target="RFC6375"/> for packet loss and throughput
      measurements. Additionally, there are a number of Fault Management Signals
      that can be configured <xref target="RFC6427"/>.
    </t>
    
    <t>BFD is a protocol that provides low-overhead, fast detection of
    failures in the path between two forwarding engines, including the
    interfaces, data link(s), and to the extent possible, the forwarding
    engines themselves. BFD can be used to detect the continuity and mis-connection
    defects of MPLS-TP point-to-point and might also be
    extended to support point-to-multipoint LSPs.
  </t>
  
  <t>The delay and loss measurements protocols <xref target="RFC6374"/> 
  and <xref target="RFC6375"/> use a simple
      query/response model for performing both unidirectional and bidirectional measurements that allow
      the originating node to measure packet loss and delay in forward, or forward and reverse
      directions. By timestamping and/or writing current packet counters to the
      measurement packets (four times, Transmit and Receive in both directions), current
      delays and packet losses can be calculated. By performing successive delay
      measurements, the delay and/or inter-packet delay variation (jitter) can be calculated. Current
      throughput can be calculated from the packet loss measurements by dividing
      the number of packets sent/received with the time it took to perform the
      measurement, given by the timestamp in the LM header. Combined with a packet
      generator, the throughput measurement can be used to measure the maximum
      capacity of a particular LSP. It should be noted that this document does not
      specify how to configure on-demand throughput estimates based on saturating the
      connection as defined in <xref target="RFC6371"/>; rather, it only
      specifies how to enable the estimation
      of the current throughput based on loss measurements.
</t>

     <section title="Conventions Used in This Document">
         <section title="Terminology">
<t>BFD - Bidirectional Forwarding Detection</t>
<t>DM - Delay Measurement</t>
<t>FMS - Fault Management Signal</t>
<t>G-ACh - Generic Associated Channel</t>
<t>LSP - Label Switched Path</t>
<t>LM - Loss Measurement</t>
<t>MEP - Maintenance Entity Group End Point</t>
<t>MPLS - Multi-Protocol Label Switching</t>
<t>MPLS-TP - MPLS Transport Profile</t>
<t>NMS - Network Management System</t>
<t>PM - Performance Monitoring</t>
<t>RSVP-TE - RSVP Traffic Engineering</t>
<t>TC - Traffic Class</t>

         </section>
         
         <section title ="Requirements Language">
  <t>
    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
    document are to be interpreted as described
    in <xref target="RFC2119">RFC 2119</xref>.
  </t>
  </section>
</section>

</section>



<section anchor="theory-operation" title="Theory of Operations">
  <section anchor="operation-overview" title="MPLS OAM Configuration Operation Overview">
     
  <t>The MPLS-TP OAM tool set is described in <xref target="RFC6669"/>. </t>
  
  <t>LSP Ping, or alternatively RSVP-TE <xref target="RFC7487"/>, can be used to
  easily enable the different OAM functions by setting the corresponding
  flags in the MPLS OAM Functions TLV (refer to <xref target="mpls-oam-tlv"/>).  
  For a more detailed configuration, one
  may include sub-TLVs for the different OAM functions in order to specify
  various parameters in detail.</t>
  
  <t>Typically, intermediate nodes simply forward OAM configuration TLVs to
  the end node
  without any processing or modification. 
  At least one exception to this is if the FMS sub-TLV (refer to <xref target="fms-sub-tlv"/>
)
  is present. This sub-TLV MUST be examined even by intermediate nodes that support this extension.
  The sub-TLV MAY be present if a flag is set in the MPLS OAM Functions TLV.</t>
  
    <section anchor="config-bfd" title="Configuration of BFD Sessions">
      
      <t> For this specification, BFD MUST run in either one of the two modes:</t>
      <t>
	<list style="symbols">
	  <t>Asynchronous mode, where both sides are in active mode</t>
	  <t>Unidirectional mode</t>
	</list>
      </t>
      
      <t>In the simplest scenario, LSP Ping <xref target="RFC5884"/>, or alternatively RSVP-TE <xref target="RFC7487"/>, 
      is used only to bootstrap a BFD session for an LSP, without any timer negotiation.</t>
      
      <t>Timer negotiation can be performed either in subsequent BFD control 
      messages (in this case the operation is similar to bootstrapping based on LSP Ping 
      described in <xref target="RFC5884"/>), or directly in the LSP Ping configuration messages.</t>

      <t>When BFD Control packets are transported in the Associated Channel
      Header (ACH) encapsulation, they are not
      protected by any end-to-end checksum; only lower layers provide error detection/correction. A single bit error, e.g., a flipped bit in
      the BFD State field, could cause the receiving end to wrongly conclude
      that the link is down and in turn trigger protection switching. To
      prevent this from happening, the BFD Configuration sub-TLV 
      (refer to <xref target="bfd-config-sub-tlv"/>) has an
      Integrity flag that, when set, enables BFD Authentication using Keyed SHA1
      with an empty key (all 0s) <xref target="RFC5880"/>. This would make every BFD Control
      packet carry a SHA1 hash of itself that can be used to detect
      errors.</t>
      
      <t>If BFD Authentication using a pre-shared key/password is desired
      (i.e., authentication and not only error detection), the BFD
      Authentication sub-TLV (refer to <xref target="bfd-authent-sub-tlv"/>) MUST be included in the BFD Configuration
      sub-TLV. The BFD Authentication sub-TLV is used to specify which
      authentication method that should be used and which pre-shared key/password
      that should be used for this particular session. How the key
      exchange is performed is out of scope of this document.</t>	
    </section>
    
    <section title="Configuration of Performance Monitoring">
      <t>It is possible to configure Performance Monitoring functionalities such as 
      Loss, 
Delay, Delay/Interpacket Delay variation (jitter), and throughput as 
      described in <xref target="RFC6374"/>.</t>
      
      <t>When configuring Performance Monitoring functionalities, it is
      possible to choose either the default configuration, by only setting the
      respective flags in the MPLS OAM functions TLV, or a customized
      configuration. To customize the configuration, one would set the
      respective flags in the MPLS OAM functions TLV and include the
      respective Loss and/or Delay
 sub-TLVs. </t>

      <t>By setting the PM Loss flag in the MPLS OAM Functions TLV and including the
      PM Loss sub-TLV (refer to <xref target="loss-sub-tlv"/>), one can configure the measurement interval
      and loss threshold values for triggering protection.</t>
      
      <t>Delay measurements are configured by setting the PM Delay flag in the MPLS OAM
      Functions TLV and by including the PM Delay sub-TLV (refer to <xref
      target="delay-sub-tlv"/>), one can
      configure the measurement interval and the delay threshold values for
      triggering protection.</t>
    </section>
    
    <section anchor="fms-config" title="Configuration of Fault Management Signals">
    
      <t>To configure Fault Management Signals (FMSs) and their refresh time, the
      FMS Flag in the MPLS OAM Functions TLV MUST be set and the FMS
      sub-TLV MUST be included. When configuring an FMS, 
      an implementation can enable the default configuration by setting the 
      FMS Flag in the OAM Function Flags sub-TLV.  In order to modify the
      default configuration, the MPLS OAM FMS sub-TLV MUST be included. </t>
      
      <t>If an intermediate point is meant to originate FMS messages, this means that such an intermediate point is
      associated with a Server MEP through a co-located MPLS-TP client/server
      adaptation function, and the Fault Management subscription flag in the
      MPLS OAM FMS sub-TLV has been set as an indication of the request to create
      the association at each intermediate node of the client LSP. 
      The corresponding Server MEP needs to be configured by its
      own LSP Ping session or, alternatively, via a Network Management System (NMS) or RSVP-TE. </t>

    </section>
  </section>
  
  <section anchor="mpls-oam-tlv" title="MPLS OAM Functions TLV">
    <t>
    The MPLS OAM Functions TLV presented in <xref target="mpls-oam-tlv-figure"/> 
    is carried as a TLV of the MPLS
 Echo Request/Reply messages <xref target="RFC4379"/>.
    </t>

    <t>
	<figure align="left" anchor="mpls-oam-tlv-figure"
                title="MPLS OAM Functions TLV Format">
	  <artwork><![CDATA[ 
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  MPLS OAM Func. Type (27)     |           Length              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    MPLS OAM Function Flags                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                           sub-TLVs                            ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>                                             
	</figure>                                                                                                  
      </t>
      <t>The MPLS OAM Functions TLV contains the MPLS OAM Function Flags field.
      The MPLS OAM Function Flags indicate which 
      OAM functions should be activated as well as OAM function-specific sub-TLVs 
      with configuration parameters for the particular function.</t>
      <t>Type: Indicates the MPLS OAM Functions TLV (<xref target="IANA"/>).</t>
      <t>Length: The length of the MPLS OAM Function Flags field including the
	total length of the sub-TLVs in octets.</t>
      <t>MPLS OAM Function Flags: A bitmap numbered from left to right as shown in
	<xref target="mpls-oam-flags-figure"/>. These
     flags are managed by IANA (refer to <xref target="IANA-Flags"/>). Flags defined in this document are
     presented in <xref target="mpls-oam-tlv-flags-table"/>. 
     Undefined flags MUST be set to
     zero and unknown flags MUST be ignored.  The flags indicate what 
     OAM is being configured and direct the presence of optional sub-TLVs as set
     out below.
</t>

<t>
	<figure align="left" anchor="mpls-oam-flags-figure"
                title="MPLS OAM Function Flags Format">
	  <artwork><![CDATA[ 
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|C|V|F|L|D|T|Unassigned MUST be zero (MBZ)                    |R|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>                                             
	</figure>                                                                                                  
      </t>

      <t>
      Sub-TLVs corresponding to the different flags are as follows.
      No meaning should be attached to the order of sub-TLVs.
      </t>
  <t><list style="symbols">

	<t>If a flag in the MPLS OAM Function Flags is set and
	the corresponding sub-TLVs listed below are absent,
	then this MPLS OAM function MUST be initialized according to its default
	settings. Default settings of MPLS OAM functions are outside the scope
	of this document.
	</t>
	
	<t>If any sub-TLV is present without the corresponding flag being set,    
               the sub-TLV SHOULD be ignored.  
	</t>

	<t>BFD Configuration sub-TLV, which MUST be included if either the CC, the CV,
	    or both MPLS OAM Function flags are being set in the MPLS OAM Functions TLV.

	    </t>
	    
	    <t>Performance Monitoring sub-TLV MUST be used to carry PM Loss sub-TLV and/or
	    PM Delay sub-TLV. If neither one of these sub-TLVs is present, then Performance Monitoring
	    sub-TLV SHOULD NOT be included. Empty, i.e., no enclosed sub-TLVs, Performance
	    Monitoring sub-TLV SHOULD be ignored.
	    </t>

	  <t>PM Loss sub-TLV MAY be included if the
	    PM/Loss OAM Function flag is set. If the "PM Loss sub-TLV"
	    is not included, default configuration values are used. Such sub-TLV MAY also be 
	    included in case the Throughput function flag is set and there is the need
	    to specify a measurement interval different from 
                   the default ones. In fact, the throughput measurement makes use of the same
                   tool as the loss measurement;
	    hence, the same TLV is used.</t>

	  <t>PM Delay sub-TLV MAY be included if the
	    PM/Delay OAM Function flag is set. If the "PM Delay
	    sub-TLV" is not included, default configuration values are used.</t>

	  <t>FMS sub-TLV, that MAY be included if the FMS OAM
	    Function flag is set. If the "FMS sub-TLV" is not included,
	    default configuration values are used.</t>

      </list></t>
      
      <t>
      If all flags in the MPLS OAM Function Flags field have the same value of
      zero, that MUST be interpreted as meaning that
      the MPLS OAM Functions TLV is not present in the MPLS Echo Request. If more than one MPLS OAM
      Functions TLV is present in the MPLS Echo request packet, then the first TLV SHOULD be processed and 
      the rest ignored. Any parsing error within nested sub-TLVs that is not specified
      in <xref target="ErrorSummary"/> SHOULD be treated as described in
      <xref target="RFC4379"/>.
      </t>

      <section anchor="bfd-config-sub-tlv" title="BFD Configuration Sub-TLV">
	<t>The BFD Configuration sub-TLV, depicted in <xref target="bfd-sub-tlv-figure"/>, is defined for BFD
	  OAM-specific configuration parameters.  The "BFD Configuration
	  sub-TLV" is carried as a sub-TLV of the "OAM Functions TLV".</t>

	<t>This TLV accommodates generic BFD OAM information and carries
	  sub-TLVs.</t>

	<t>
	  <figure align="left" anchor="bfd-sub-tlv-figure"
                title="BFD Configuration Sub-TLV Format">
	    <artwork><![CDATA[ 
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| BFD Conf. Sub-type    (100)   |           Length              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Vers.|N|S|I|G|U|B|         Reserved (set to all 0s)            |      
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                           sub-TLVs                            ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+     
]]></artwork>                                             
	  </figure>                                                                                                  
	</t>

	<t>Sub-type: Indicates a new sub-type, the BFD Configuration sub-TLV (value 100).</t>

	<t>Length: Indicates the length of the Value field in octets.</t>

	<t>Version: Identifies the BFD protocol version. If a node does not
	  support a specific BFD version, an error must be generated: "OAM
	  Problem/Unsupported BFD Version".</t>

	<t>BFD Negotiation (N): If set, timer negotiation/renegotiation via
	  BFD Control Messages is enabled. When cleared, it is disabled
	  and timer configuration is achieved using the BFD Negotiation Timer Parameters
	  sub-TLV as described in <xref target="time-param-sub-tlv"/>.</t>
	
	<t>Symmetric session (S): If set, the BFD session MUST use symmetric
	  timing values. If cleared, the BFD session MAY use any timing values
	  either negotiated or explicitly configured.</t>

	<t>Integrity (I): If set, BFD Authentication MUST be enabled. If the BFD
	Configuration sub-TLV does not include a BFD Authentication sub-TLV, the
	authentication MUST use Keyed SHA1 with an empty pre-shared key (all 0s). 
	If the egress LSR does not support BFD Authentication, an error MUST be
	generated: "OAM Problem/BFD Authentication unsupported".
 If the Integrity
	flag is clear, then Authentication MUST NOT be used.
</t>

	<t>Encapsulation Capability (G): If set, 
	it shows the capability of encapsulating BFD messages into the G-ACh channel.
	If both the G bit and U bit are set, configuration gives precedence to the G bit.</t> 

	<t>Encapsulation Capability (U): If set, 
	it shows the capability of encapsulating BFD messages into IP/UDP packets.
	If both the G bit and U bit are set, configuration gives precedence to the G bit.</t>

<t>
               If the egress LSR does not support any of the ingress LSR Encapsulation
               Capabilities, an error MUST be generated: "OAM Problem/Unsupported BFD
               Encapsulation format".
</t>
	<t>Bidirectional (B): If set, it configures BFD in the Bidirectional mode. 
	If it is not set, it configures BFD in the unidirectional mode. In the second case, 
	the source node does not expect any Discriminator values back from the destination node.</t> 

	<t>Reserved: Reserved for future specification; set to 0 on transmission and ignored when received.</t>
	
	<t>The BFD Configuration sub-TLV MUST include the following sub-TLVs
	  in the MPLS Echo Request message:</t>

	<t><list style="symbols">
	    <t>BFD Local Discriminator sub-TLV, if the B flag is set in the MPLS Echo Request;</t>
	    <t>BFD Negotiation Timer Parameters sub-TLV, if the N flag is
 cleared.</t>
	</list></t>

	<t>The BFD Configuration sub-TLV MUST include the following sub-TLVs
	  in the MPLS Echo Reply message:</t>

	<t><list style="symbols">
	    <t>BFD Local Discriminator sub-TLV;</t>
	    <t>BFD Negotiation Timer Parameters sub-TLV if:
	      <list style="symbols">
		<t>The N and S flags are cleared, or if: </t>

		<t>The N flag is cleared and the S flag is set, and the BFD Negotiation Timer Parameters
		sub-TLV received by the egress contains unsupported values. 
			 In this case, an updated BFD Negotiation Timer Parameters sub-TLV, containing
			 values supported by the egress node <xref target="RFC7419"/>, is returned to the ingress.</t>
	      </list>
	    </t>
	</list></t>
      </section>
	<section anchor="discriminator-sub-tlv" title="BFD Local Discriminator Sub-TLV">

	  <t>The BFD Local Discriminator sub-TLV is carried as a sub-TLV of the
	    "BFD Configuration sub-TLV" and is depicted in <xref target="local-discr-sub-tlv-figure"/>.</t>
	  <t>
	    <figure align="left" anchor="local-discr-sub-tlv-figure"
                title="BFD Local Discriminator Sub-TLV Format">
	      <artwork><![CDATA[ 
 0                   1                   2                   3 
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|  Locl. Discr. Sub-type (101)  |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|                       Local Discriminator                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
	    </figure>                                                                                                  
	  </t>

	  <t>Sub-type: Indicates a new sub-type, the "BFD Local Discriminator sub-TLV"
 (value 101).</t>

	  <t>Length: Indicates the length of the Value field in octets (4).</t>

	  <t>Local Discriminator: A nonzero discriminator value
 that is unique in the
	    context of the transmitting system that generates it. It is used
	    to demultiplex multiple BFD sessions between the same pair of
	    systems.</t>
	  
	</section>

	<section anchor ="time-param-sub-tlv" title="BFD Negotiation Timer Parameters Sub-TLV">
	  <t>The BFD Negotiation Timer Parameters sub-TLV is carried as a
	    sub-TLV of the BFD Configuration sub-TLV and is depicted
 in
	    <xref target="timer-param-sub-tlv-figure"/>.</t>

	  <t>
	    <figure align="left" anchor="timer-param-sub-tlv-figure"
                title="BFD Negotiation Timer Parameters Sub-TLV Format">
	      <artwork><![CDATA[ 
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Nego. Timer Sub-type (102)    |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Acceptable Min. Asynchronous TX interval              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Acceptable Min. Asynchronous RX interval              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|               Required Echo TX Interval                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>                                             
	    </figure>
	  </t>

	  <t>Sub-type: Indicates a new sub-type, the BFD Negotiation Timer Parameters sub-TLV (value 102).</t>

	  <t>Length: Indicates the length of the Value field in octets (12).</t>

	  <t>Acceptable Min. Asynchronous TX interval: If the S (symmetric)
	  flag is set in the BFD Configuration sub-TLV, defined in <xref target="bfd-config-sub-tlv"/>, 
	  it expresses the desired time
	  interval (in microseconds) at which the ingress LER 
	  intends to both transmit and receive BFD periodic control packets. If
	  the receiving edge LSR cannot support such a value, it SHOULD
	  reply with an interval greater than the one proposed.</t>

	  <t>If the S (symmetric) flag is cleared in the BFD Configuration
	    sub-TLV, this field expresses the desired time interval (in
	    microseconds) at which an edge LSR intends to transmit BFD periodic
	    control packets in its transmitting direction.</t>

	  <t>Acceptable Min. Asynchronous RX interval: If the S (symmetric)
	  flag is set in the BFD Configuration sub-TLV, <xref target="bfd-sub-tlv-figure"/>, this field MUST be equal to
	  Acceptable Min. Asynchronous TX interval and has no additional
	  meaning respect to the one described for "Acceptable Min. Asynchronous
	  TX interval".</t>

	  <t>If the S (symmetric) flag is cleared in the BFD Configuration
	  sub-TLV, it expresses the minimum time interval (in microseconds) at
	  which edge LSRs can receive BFD periodic control packets. If this
	  value is greater than the value of Acceptable Min. Asynchronous TX interval
	  received from the other edge LSR, such an edge LSR MUST adopt the
	  interval expressed in this Acceptable Min. Asynchronous RX
 interval.</t>

	  <t>Required Echo TX Interval: The minimum interval (in microseconds)
	    between received BFD Echo packets that this system is capable of
	    supporting, less any jitter applied by the sender as described in
	    Section 6.8.9 of <xref target="RFC5880"/>. This value is also an indication for the
	    receiving system of the minimum interval between transmitted BFD
	    Echo packets.  If this value is zero, the transmitting system does
	    not support the receipt of BFD Echo packets.  If the receiving
	    system cannot support this value, the "Unsupported BFD TX Echo rate interval"
	    error MUST be generated.
 By default, the value is set to 0.</t>
	</section>

	<section anchor="bfd-authent-sub-tlv" title="BFD Authentication Sub-TLV">
	  <t>The "BFD Authentication sub-TLV" is carried as a sub-TLV of the
	    "BFD Configuration sub-TLV" and is depicted in <xref target="bfd-authent-sub-tlv-figure"/>.</t>
	  <t>
            <figure align="left" anchor="bfd-authent-sub-tlv-figure"
                title="BFD Authentication Sub-TLV Format">
              <artwork><![CDATA[ 
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    BFD Auth. Sub-type (103)   |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Auth Type   |  Auth Key ID  |         Reserved (0s)         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
             ]]></artwork>                                             
	    </figure>
	  </t>
	  <t>Sub-type: Indicates a new sub-type, the BFD Authentication sub-TLV (value 103).</t>
	  <t>Length:  Indicates the length of the Value field in octets (4).</t>
	  <t>Auth Type: Indicates which type of authentication to use. The
	    same values as are defined in Section 4.1 of <xref target="RFC5880"/> are
	    used. Simple Password SHOULD NOT be used if other authentication types are available.</t>
	  <t>Auth Key ID: Indicates which authentication key or password
	    (depending on Auth Type) should be used. How the key exchange is
	    performed is out of scope of this document. If the egress LSR does not
                   support this Auth Key ID, an "OAM Problem/Mismatch of BFD
                   Authentication Key ID" error MUST be generated.</t>
      <t>Reserved: Reserved for future specification; set to 0 on transmission and ignored when received.</t>
      <t>
      An implementation MAY change the mode of authentication if an operator re-evaluates 
      the security situation in and around the administrative domain.
      If the BFD Authentication sub-TLV is used for a BFD session in Up state, then the Sender of the MPLS LSP Echo Request SHOULD
      ensure that old and new modes of authentication, i.e., a combination of Auth.Type and Auth. Key ID, are used to send and receive BFD
      control packets, until the Sender can confirm that its peer has switched to the new authentication.
      </t>
	</section>      

	<section anchor="traffic-class-sub-tlv" title="Traffic Class Sub-TLV">

	  <t>The Traffic Class sub-TLV is carried as a sub-TLV of the
	    "BFD Configuration sub-TLV" and "Fault Management Signal Sub-TLV" (<xref target="fms-sub-tlv"/>)
	    and is depicted in <xref target="traffic-class-sub-tlv-figure"/>.</t>
	  <t>
	    <figure align="left" anchor="traffic-class-sub-tlv-figure"
                title="Traffic Class Sub-TLV Format">
	      <artwork><![CDATA[ 
 0                   1                   2                   3 
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
| Traffic Class Sub-type (104)  |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
|  TC |                 Reserved (set to all 0s)                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
	    </figure>                                                                                                  
	  </t>

	  <t>Sub-type: Indicates a new sub-type, the "Traffic Class sub-TLV" (value 104).</t>

	  <t>Length: Indicates the length of the Value field in octets (4).</t>

	<t>TC: Identifies the Traffic Class (TC) <xref target="RFC5462"/> for periodic
	continuity monitoring messages or packets with fault
	management information.</t>
	
	<t>If the TC sub-TLV is present, then the sender of any periodic continuity
	monitoring messages or packets with fault management information on the 
	LSP, with a Forwarding Equivalence Class (FEC) that corresponds to the FEC for which fault detection is being 
	performed, MUST use the value contained in the TC field of the sub-TLV as the value 
	of the TC field in the top label stack entry of the MPLS label stack. If the TC sub-TLV is absent
	from either "BFD Configuration sub-TLV" or "Fault Management Signal
	sub-TLV", then selection of
 the TC value is a local decision.
	</t>
	  
	</section>

      <section anchor="pm-sub-tlv" title="Performance Monitoring Sub-TLV">

	<t>If the MPLS OAM Functions TLV has any of the L (Loss), D (Delay), and T (Throughput) 
	flags set, the Performance Monitoring sub-TLV MUST be present. Failure to
               include the correct sub-TLVs MUST result in an "OAM Problem/PM Configuration Error" being generated.</t>

	<t>The Performance Monitoring sub-TLV provides the configuration information mentioned in Section 7 of
	<xref target="RFC6374"/>. It includes support for the configuration of quality thresholds
	and, as described in <xref target="RFC6374"/>: <list><t>...the
	crossing of which will trigger warnings or alarms, and result in reporting and exception notification will be
	integrated into the system-wide network management and reporting framework.</t></list></t>
	
	<t>In case the values need to be different than the default ones, the Performance Monitoring sub-TLV
	 MAY include the following sub-TLVs:
		<list style="symbols">
		<t>PM Loss sub-TLV, if the L flag is set in the MPLS OAM Functions TLV;</t>
		<t>PM Delay sub-TLV, if the D flag is set in the MPLS OAM Functions TLV.</t>
		</list>
	</t>

	<t> The Performance Monitoring sub-TLV depicted in <xref target="pm-sub-tlv-figure"/>
	is carried as a
 sub-TLV of the MPLS OAM Functions TLV.
	</t>

	<t>

	<figure align="left" anchor="pm-sub-tlv-figure"
                title="Performance Monitoring Sub-TLV Format">
	    <artwork><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Perf. Monitoring Sub-type (200)|          Length               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     PM Configuration Flags                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                           sub-TLVs                            ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+     
]]></artwork>                                             
	  </figure>  
	</t> 
	
	<t>Sub-type: Indicates a new sub-type, the Performance Monitoring sub-TLV (value 200).</t> 

	<t> Length:  Indicates the length of the Value field in octets, including
	PM Configuration Flags and optional sub-TLVs.</t>

	<t>
	<figure align="left" anchor="pm-config-flags"
                title="PM Configuration Flags Format">
	    <artwork><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|D|L|J|Y|K|C|            Reserved (set to all 0s)               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>                                             
	  </figure>  
	</t> 

	<t>The PM Configuration Flags format is presented in <xref
	target="pm-config-flags"/>. For the specific
	function description, please refer to <xref target="RFC6374"/>:
		<list style="hanging" hangIndent="6">
		<t hangText="D:">Delay inferred/direct (0=INFERRED, 1=DIRECT). If the egress
                                     LSR does not support the specified mode, an "OAM Problem/Unsupported
                                     Delay Mode" error MUST be generated.</t>
		<t hangText="L:">Loss inferred/direct (0=INFERRED, 1=DIRECT). If the egress
                                     LSR does not support the specified mode, an "OAM Problem/Unsupported
                                     Loss Mode" error MUST be generated.</t>
		<t hangText="J:">Delay variation/jitter (1=ACTIVE, 0=NOT ACTIVE). If the
                                     egress LSR does not support Delay variation measurements and the J
                                     flag is set, an "OAM Problem/Delay variation unsupported" error MUST be generated.</t>
		<t hangText="Y:">Dyadic (1=ACTIVE, 0=NOT ACTIVE). If the egress LSR does not
                                     support Dyadic mode and the Y flag is set, an "OAM Problem/Dyadic
                                     mode unsupported" error MUST be generated.</t>
		<t hangText="K:">Loopback (1=ACTIVE, 0=NOT ACTIVE). If the egress LSR does
                                      not support Loopback mode and the K flag is set, an "OAM Problem/
                                      Loopback mode unsupported" error MUST be generated.</t>
		<t hangText="C:">Combined (1=ACTIVE, 0=NOT ACTIVE). If the egress LSR does
                                      not support Combined mode and the C flag is set, an "OAM Problem/Combined mode unsupported" error MUST be generated.</t>
	
	<t hangText="Reserved:">Reserved for future specification; set to 0 on transmission and ignored when received.</t>
    	</list>
	</t>  </section>
      
      <section anchor="loss-sub-tlv" title="PM Loss Measurement Sub-TLV">
	<t>The PM Loss Measurement sub-TLV depicted in <xref target="pm-loss-sub-tlv-figure"/>
	 is carried as a
 sub-TLV of the Performance Monitoring sub-TLV.</t>
	
	<t>
	  <figure align="left" anchor="pm-loss-sub-tlv-figure"
                title="PM Loss Measurement Sub-TLV Format">
	    <artwork><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PM Loss Sub-type (201)       |          Length               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| OTF |T|B|              Reserved (set to all 0s)               |    
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Measurement Interval                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Test Interval                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Loss Threshold                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>                                             
	  </figure>                                                                                                  
		</t>
		
		<t>Sub-type: Indicates a new sub-type, the PM Loss Measurement sub-TLV (value 201).</t>
		
		<t>Length: Indicates the length of the Value field in octets (16).</t>

		<t>OTF: Origin Timestamp Format of the Origin Timestamp field described in <xref target="RFC6374"/>.
		By default, it is set to IEEE 1588 version 1. If the egress LSR cannot support this value, an 
		"OAM Problem/Unsupported Timestamp Format" error MUST be generated.</t>	
		<t>Configuration Flags, please refer to <xref target="RFC6374"/> for further details:
		  <list style="hanging" hangIndent="6">
		    <t hangText="T:">Traffic-class-specific measurement indicator. Set to 1 when
			the measurement operation is scoped to packets of a particular
			traffic class (Differentiated Services Code Point value), and 0 otherwise.  When set to 1, the
			Differentiated Services (DS) field of the message indicates the measured traffic class. 
			By default, it is set to 1.</t>
		    <t hangText="B:">Octet (byte) count. When set to 1, indicates that the Counter
			1-4 fields represent octet counts.  When set to 0, indicates that 
			the Counter 1-4 fields represent packet counts. 
			By default, it is set to 0.</t>
		  </list>
		</t>
        <t>Reserved: Reserved for future specification; set to 0 on transmission and ignored when received.</t>
	  <t>Measurement Interval: The time interval (in milliseconds) at which
		  Loss Measurement query messages MUST be sent on both directions. If
		  the edge LSR receiving the Path message cannot support such a value, it
	  SHOULD reply with a higher interval. By default, it is set to (100) as per <xref target="RFC6375"/>.</t>

	  <t>Test Interval: Test messages interval in milliseconds as described in <xref target="RFC6374"/>.
	  By default, it is set to (10) as per <xref target="RFC6375"/>.</t>

	  <t>Loss Threshold: The threshold value of measured lost packets per measurement over which action(s)
	  SHOULD be triggered. </t>

	  </section>	

	<section anchor="delay-sub-tlv" title="PM Delay Measurement Sub-TLV">
		<t>The &quot;PM Delay Measurement sub-TLV&quot; depicted in <xref target="pm-delay-sub-tlv-figure"/>
		 is carried as a
 sub-TLV of the Performance Monitoring sub-TLV.</t>

		<t>
		  <figure align="left" anchor="pm-delay-sub-tlv-figure"
                title="PM Delay Measurement Sub-TLV Format">
	    <artwork><![CDATA[ 
 0                   1                   2                   3 
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  PM Delay Sub-type (202)      |          Length               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| OTF |T|B|             Reserved (set to all 0s)                |    
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Measurement Interval                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Test Interval                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      Delay Threshold                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>                                             
	  </figure>                                                                                                  
		</t>

		<t>Sub-type: Indicates a new sub-type, the &quot;PM Delay Measurement sub-TLV&quot; (value 202).</t>
		
		<t>Length: Indicates the length of the Value field in octets (16).</t>

		<t>OTF: Origin Timestamp Format of the Origin Timestamp field described in <xref target="RFC6374"/>. 
		By default, it is set to IEEE 1588 version 1. If the egress LSR cannot support this value, an "OAM Problem/Unsupported
                             Timestamp Format" error MUST be generated.</t>	
		<t>Configuration Flags, please refer to <xref target="RFC6374"/> for further details:
		  <list style="hanging" hangIndent="6">

		    <t hangText="T:">Traffic-class-specific measurement indicator. Set to 1 when
			the measurement operation is scoped to packets of a particular
			traffic class (Differentiated Services Code Point value), and 0 otherwise.  When set to 1, the
			DS field of the message indicates the measured traffic class. 
			By default, it is set to 1.</t>
		    <t hangText="B:">Octet (byte) count. When set to 1, indicates that the Counter
			1-4 fields represent octet counts.  When set to 0, indicates that 
			the Counter 1-4 fields represent packet counts. 
			By default, it is set to 0.</t>
		  </list>
		</t>
        <t>Reserved: Reserved for future specification; set to 0 on transmission and ignored when received.</t>

	  <t>Measurement Interval: The time interval (in milliseconds) at which
		  Delay Measurement query messages MUST be sent on both directions. If
		  the edge LSR receiving the Path message cannot support such a value, it
	  can reply with a higher interval. By default, it is set to (1000) as per <xref target="RFC6375"/>.</t>

	  <t>Test Interval: Test messages interval (in milliseconds) as described in <xref target="RFC6374"/>.
	  By default, it is set to (10) as per <xref target="RFC6375"/>.</t>

	  <t>Delay Threshold: The threshold value of measured two-way delay (in milliseconds) over which action(s)
	  SHOULD be triggered. </t>
	</section>


      <section anchor="fms-sub-tlv" title="Fault Management Signal Sub-TLV">
	<t>The FMS sub-TLV depicted in <xref target="fms-sub-tlv-figure"/> is carried as a sub-TLV of
	the MPLS OAM Configuration sub-TLV. When both working and protection paths
	are configured, both LSPs SHOULD be configured with identical settings of
	the E flag, T flag, and the refresh timer. An implementation MAY configure the
	working and protection LSPs with different settings of these fields in case of 1:N protection.</t>
	<t>
          <figure align="left" anchor="fms-sub-tlv-figure"
                title="Fault Management Signal Sub-TLV Format">
	    <artwork><![CDATA[ 
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       FMS Sub-type (300)      |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|E|S|T|            Reserved           |      Refresh Timer      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
~                           sub-TLVs                            ~
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ 
]]></artwork>                                             
	  </figure>                                                                                                  
	</t>

	<t>Sub-type: Indicates a new sub-type, the FMS sub-TLV (value 300).</t>

	<t>Length: Indicates the length of the Value field in octets.</t>

	<t>FMS Flags are used to enable the FMS Flags at end point MEPs and
	the Server MEPs of the links over which the LSP is forwarded. In this
	document, only the S flag pertains to Server MEPs. </t>

	<t>The following flags are defined:
	
	  <list style="hanging" hangIndent="6">
	  <t hangText="E:">Enable Alarm Indication Signal (AIS) and Lock Report (LKR) signaling 
	  as described in <xref target="RFC6427"/>. Default value is 1 (enabled). If the egress MEP does not support FMS Flag
                 generation, an "OAM Problem/Fault management signaling unsupported"
                 error MUST be generated.</t>
	  
	  <t hangText="S:">Indicate to a Server MEP that it should transmit AIS and LKR signals on 
	  the client LSP. Default value is 0 (disabled). If a Server MEP that is capable of generating FMS
	  messages is, for some reason, unable to do so for the LSP being signaled, an "OAM
                 Problem/Unable to create fault management association" error MUST be generated.</t>

	  <t hangText="T:">Set timer value, enabled the configuration of a specific timer value. 
	  Default value is 0 (disabled).</t>
	  
</list></t>
	  <t>Reserved: Bits 4-16 that follow the FMS Flags are reserved for future allocation. These bits MUST be set to 0 on transmit and ignored on receipt if not allocated.</t>
	 
	<t>Refresh Timer: Indicates the refresh timer of fault indication messages, in seconds. The value MUST be
	between 1 to 20 seconds as specified for the Refresh Timer field in <xref target="RFC6427"/>. If the edge LSR receiving the
	Path message cannot support the value, it SHOULD reply with a higher timer value. </t>

	<t>FMS sub-TLV MAY include Traffic Class sub-TLV (<xref target="traffic-class-sub-tlv"/>). If the TC sub-TLV is present,
	the value of the TC field MUST be used as the value of the TC field  of an MPLS label stack entry
	for FMS messages. If the TC sub-TLV is absent, then selection of the
	TC value is a local decision.</t>

      </section>
      
      <section anchor="source-mep-id-sub-tlv" title="Source MEP-ID Sub-TLV">
	<t>The Source MEP-ID sub-TLV depicted in <xref target="source-mep-id-sub-tlv-figure"/>
	 is carried as a sub-TLV of the MPLS OAM Functions TLV.</t>
	  
	<t>Note that support of ITU IDs is out of scope.</t>
	  
	<t>
	  <figure align="left" anchor="source-mep-id-sub-tlv-figure"
                title="Source MEP-ID Sub-TLV Format">
	    <artwork><![CDATA[ 
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Source MEP-ID Sub-type (400)  |           Length              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Source Node ID                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Tunnel ID           |           LSP ID              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>                                             
	  </figure>                                                                                                  
	</t>

	<t>Sub-type: Indicates a new sub-type, the Source MEP-ID sub-TLV
 (value 400).</t>

	<t>Length: Indicates the length of the Value field in octets (8).</t>

	<t>Source Node ID: 32-bit node identifier as defined in
	  <xref target="RFC6370"/>.</t>

	<t>Tunnel ID: A 16-bit unsigned integer unique to the node as
	  defined in <xref target="RFC6370"/>.</t>

	<t>LSP ID: A 16-bit unsigned integer unique within the Tunnel_ID as
	  defined in <xref target="RFC6370"/>.</t>

      </section>

    </section>
    
  </section>
 
    <section anchor="ErrorSummary" title="Summary of MPLS OAM Configuration Errors">

      <t>This is the summary of Return Codes <xref target="RFC4379"/> defined in this document: </t>

	<t><list style="symbols">
	  <t>If an egress LSR does not support the specified BFD version, an error MUST be generated: "OAM Problem/Unsupported BFD Version".</t>
	  
	  <t>If an egress LSR does not support the specified BFD Encapsulation format, an error MUST be generated: "OAM Problem/Unsupported BFD Encapsulation format".</t>
	  
	  <t>If an egress LSR does not support BFD Authentication, and it is requested, 
	  an error MUST be generated: "OAM Problem/BFD Authentication unsupported".</t>

	  <t>If an egress LSR does not support the specified BFD Authentication Type,
	  an error MUST be generated: "OAM Problem/Unsupported BFD Authentication Type".</t>

	  <t>If an egress LSR is not able to use the specified Authentication Key ID, an
	  error MUST be generated: "OAM Problem/Mismatch of BFD Authentication
	  Key ID".</t>


         <t>If PM flags in MPLS OAM Functions TLV don't have corresponding PM sub-TLVs present, an error MUST be generated: "OAM Problem/PM Configuration Error".</t>
	  
	  <t>If an egress LSR does not support the specified Timestamp Format, an error MUST be generated: "OAM Problem/Unsupported Timestamp
	  Format".</t>

	  <t>If an egress LSR does not support specified Delay mode, an "OAM
	  Problem/Unsupported Delay Mode" error MUST be generated.</t>

	  <t>If an egress LSR does not support specified Loss mode, an "OAM
	  Problem/Unsupported Loss Mode" error MUST be generated.</t>

	  <t>If an egress LSR does not support Delay variation measurements, and it
	  is requested, an "OAM Problem/Delay variation unsupported" error MUST
	  be generated.</t>

	  <t>If an egress LSR does not support Dyadic mode, and it is requested, an
	  "OAM Problem/Dyadic mode unsupported" error MUST be generated.</t>

	  <t>If an egress LSR does not support Loopback mode, and it is requested, an
	  "OAM Problem/Loopback mode unsupported" error MUST be generated.</t>

	  <t>If an egress LSR does not support Combined mode, and it is requested, an
	  "OAM Problem/Combined mode unsupported" error MUST be generated.</t>

	  <t>If an egress LSR does not support Fault Monitoring Signals, and it is requested, an
	  "OAM Problem/Fault management signaling unsupported" error MUST be generated.</t>

	  <t>If an intermediate Server MEP supports Fault Monitoring Signals, but is unable to create an association,
	  when requested to do so, an "OAM Problem/Unable to create fault management association" error MUST be generated.</t>

	</list>
	</t>
	<t>
	Ingress LSR MAY combine multiple MPLS OAM configuration TLVs and sub-TLVs into single MPLS echo request.
	In case an egress LSR doesn't support any of the requested modes, it MUST set the return code to report the first
	unsupported mode in the list of TLVs and sub-TLVs. And if any of the requested OAM configuration is not supported, the egress LSR
	SHOULD NOT process OAM Configuration TLVs and sub-TLVs listed in the MPLS echo request.
	</t>

    </section>

  <section anchor="IANA" title="IANA Considerations">

    <section anchor="IANA-TLV" title="TLV and Sub-TLV Allocation">

   
    <t>IANA maintains the  "Multi-Protocol Label Switching (MPLS) Label 
   Switched Paths (LSPs) Ping Parameters" registry and, within that registry, 
   a subregistry for TLVs and sub-TLVs.</t>
   <t>IANA has allocated a new MPLS OAM Functions TLV 
   from the Standards Action <xref target="RFC5226" /> range (0-16383)
   and sub-TLVs as follows from subregistry presented in <xref target="iana-allocation-table"/>, 
   called &quot;Sub-TLVs for TLV Type 27&quot;. </t>
   <t>
     Registration procedures for Sub-TLVs from ranges 0-16383 and
    32768-49161 are by Standards Action. Ranges 16384-31743 and
    49162-64511 are through Specification Required (Experimental
    RFC Needed).
   </t>
   
   <texttable anchor="iana-allocation-table" title="IANA TLV Type Allocation">
    <ttcol align='left'>Type</ttcol>
    <ttcol align='left'>Sub-type</ttcol>
    <ttcol align='left'>Value Field</ttcol>
    <ttcol align='left'>Reference</ttcol>
    <c>27</c><c></c><c>MPLS OAM Functions</c><c>This document</c>
    <c></c><c>100</c><c>BFD Configuration</c><c>This document</c>
     <c></c><c>101</c><c>BFD Local Discriminator</c><c>This document</c>
     <c></c><c>102</c><c>BFD Negotiation Timer Parameters</c><c>This document</c>
     <c></c><c>103</c><c>BFD Authentication</c><c>This document</c>
     <c></c><c>104</c><c>Traffic Class</c><c>This document</c>
     <c></c><c>200</c><c>Performance Monitoring</c><c>This document</c>
     <c></c><c>201</c><c>PM Loss Measurement</c><c>This document</c>
      <c></c><c>202</c><c>PM Delay Measurement</c><c>This document</c>
      <c></c><c>300</c><c>Fault Management Signal</c><c>This document</c>
      <c></c><c>400</c><c>Source MEP-ID</c><c>This document</c>
                                </texttable>

    </section> 

<section anchor="IANA-Flags" title="MPLS OAM Function Flags Allocation">
<t>
   IANA has created a new registry called the "MPLS OAM Function Flags" registry.
   Assignments of bit positions 0 through 31 are via Standards Action. 
   The new registry is to be populated as follows.
</t>

  <texttable anchor="mpls-oam-tlv-flags-table" title="MPLS OAM Function Flags">
     <ttcol align='center'>Bit Position</ttcol>
    <ttcol align='center'>MPLS OAM&nbsp;Function Flag</ttcol>
    <ttcol align='left'>Description</ttcol>
    <c>0&nbsp;</c> <c>C&nbsp;</c> <c>Continuity Check (CC)&nbsp;</c>
    <c>1&nbsp;</c> <c>V&nbsp;</c> <c>Connectivity Verification (CV)&nbsp;</c>
    <c>2&nbsp;</c> <c>F&nbsp;</c> <c>Fault Management Signal (FMS)&nbsp;</c>
     <c>3&nbsp;</c> <c>L&nbsp;</c> <c>Performance Monitoring/Loss (PM/Loss)&nbsp;</c>
     <c>4&nbsp;</c> <c>D&nbsp;</c> <c>Performance Monitoring/Delay (PM/Delay)&nbsp;</c>
     <c>5&nbsp;</c> <c>T&nbsp;</c> <c>Throughput Measurement&nbsp;</c>
     <c>6-30&nbsp;</c> <c>&nbsp;</c> <c>Unassigned (Must be zero)&nbsp;</c>             
     <c>31&nbsp;</c> <c>&nbsp;</c> <c>Reserved&nbsp;</c>
    </texttable>

</section>      

  <section anchor="oam-config-err" title="OAM Configuration Errors">
    <t>IANA maintains a registry "Multi-Protocol Label Switching (MPLS) Label 
   Switched Paths (LSPs) Ping Parameters", and within that registry 
   a subregistry "Return Codes".</t>
   
   <t>IANA has assigned new Return Codes from the Standards Action
   range (0-191) as follows:</t>
   
  <texttable anchor="iana-ret-sub-codes-allocation-table" title="IANA Return Codes Allocation">

    <ttcol align='left'>Error Value Sub-codes</ttcol>
    <ttcol align='left'>Description</ttcol>
    <ttcol align='left'>Reference</ttcol>
    <c>21</c>
    <c>OAM Problem/Unsupported BFD Version</c>
    <c>This document</c>
    <c>22</c>
    <c>OAM Problem/Unsupported BFD Encapsulation format</c>
    <c>This document</c>
    <c>23</c>
    <c>OAM Problem/Unsupported BFD Authentication Type</c>
    <c>This document</c>
    <c>24</c>
    <c>OAM Problem/Mismatch of BFD Authentication Key ID</c>
    <c>This document</c>
    <c>25</c>
    <c>OAM Problem/Unsupported Timestamp Format</c>
    <c>This document</c>
    <c>26</c>
    <c>OAM Problem/Unsupported Delay Mode</c>
    <c>This document</c>
    <c>27</c>
    <c>OAM Problem/Unsupported Loss Mode</c>
    <c>This document</c>
    <c>28</c>
    <c>OAM Problem/Delay variation unsupported</c>
    <c>This document</c>
    <c>29</c>
    <c>OAM Problem/Dyadic mode unsupported</c>
    <c>This document</c>
    <c>30</c>
    <c>OAM Problem/Loopback mode unsupported</c>
    <c>This document</c>
    <c>31</c>
    <c>OAM Problem/Combined mode unsupported</c>
    <c>This document</c>
    <c>32</c>
    <c>OAM Problem/Fault management signaling unsupported</c>
    <c>This document</c>
    <c>33</c>
    <c>OAM Problem/Unable to create fault management association</c>
    <c>This document</c>
    <c>34</c>
    <c>OAM Problem/PM Configuration Error</c>
    <c>This document</c>

   </texttable>
   </section>		

</section>
 
<section anchor="Security" title="Security Considerations">
  <t>The signaling of OAM-related parameters and the automatic establishment
  of OAM entities introduces additional security considerations to those
  discussed in <xref target="RFC4379"/>.  In particular, a network element could be
  overloaded if an attacker were to request high-frequency liveliness
  monitoring of a large number of LSPs, targeting a single network element. Implementations must
  be made cognizant of available OAM resources and MAY refuse new OAM configurations
  that would overload a node. Additionally, policies to manage OAM resources may be used
  to provide some fairness in OAM resource distribution among monitored LSPs.</t>

  <t>
  Security of OAM protocols configured with extensions to LSP Ping described in this
  document are discussed in <xref target="RFC5880"/>, <xref target="RFC5884"/>,
  <xref target="RFC6374"/>, <xref target="RFC6427"/>, and <xref target="RFC6428"/>.
  </t>
  
<t>
In order that the configuration of OAM functionality can be achieved securely through the techniques described
in this document, security mechanisms must already be in place and operational for LSP Ping. Thus, the
exchange of security parameters (such as keys) for use in securing OAM is outside the scope of this
document and is assumed to use an off-line mechanism or an established secure
key exchange protocol.
  
</t>  
<t>Additional discussion of security for MPLS protocols can be found in <xref target="RFC5920"/>.</t>
  

</section>

 

</middle>

<back>

  <references title="Normative References">



    <?rfc include="reference.RFC.2119"?>
    <?rfc include="reference.RFC.4379"?>
    <?rfc include="reference.RFC.5654"?>
    <?rfc include="reference.RFC.5880"?>
    <?rfc include="reference.RFC.5884"?>
    <?rfc include="reference.RFC.6370"?>
    <?rfc include="reference.RFC.6374"?>
    <?rfc include="reference.RFC.6427"?>
    <?rfc include="reference.RFC.6428"?>



  </references>

  <references title="Informative References">

    <?rfc include="reference.RFC.6371"?>
    <?rfc include="reference.RFC.7419"?>
    <?rfc include="reference.RFC.3209"?>
    <?rfc include="reference.RFC.6669"?>
    <?rfc include="reference.RFC.5036"?>
    <?rfc include="reference.RFC.6375"?>
    <?rfc include="reference.RFC.5462"?>
    <?rfc include="reference.RFC.5860"?>
    <?rfc include="reference.RFC.5920"?>
    <?rfc include="reference.RFC.7487"?>
    <?rfc include="reference.RFC.5226"?>
   
  </references>
    <section title="Acknowledgements" numbered="no">
      <t>The authors would like to thank Nobo Akiya, David Allan, and Adrian Farrel for
      their thorough reviews and insightful comments.</t>
    </section>

</back>
</rfc>

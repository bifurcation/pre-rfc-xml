<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">

<rfc ipr="pre5378Trust200902" 
     submissionType="IETF"
     consensus="yes"
     number="7970" 
     obsoletes="5070, 6685" 
     category="std">
	
<?rfc compact='yes'?>
<?rfc toc='yes'?>
<?rfc subcompact='no'?>
<?rfc sortrefs='yes'?>
<?rfc symrefs='yes'?>

<front>

<title abbrev="IODEF Version 2">
The Incident Object Description Exchange Format Version 2</title>

<author initials="R." surname="Danyliw" fullname="Roman Danyliw">
    <organization>CERT</organization>
      <address>
        <postal>
	 <street>Software Engineering Institute</street>
	 <street>Carnegie Mellon University</street>
         <street>4500 Fifth Avenue</street>
          <city>Pittsburgh</city>
	  <region>PA</region>
          <country>United States of America</country>
        </postal>
        <email>rdd@cert.org</email>
      </address>
    </author>
     
<date month="November" year="2016"/>
<area>Security</area>
<workgroup>MILE Working Group</workgroup>

<keyword>incident data format</keyword>
<keyword>incident report</keyword>
<keyword>cyber threat indicators</keyword>
<keyword>computer security incident</keyword>
<keyword>computer security incident response team</keyword>
<keyword>CSIRT</keyword>
<keyword>CERT</keyword>
<keyword>security data sharing</keyword>
<keyword>Computer Network Defense Service Provider</keyword>
<keyword>CNDSP</keyword>
<keyword>information sharing</keyword>
<keyword>automated information sharing</keyword>
<keyword>cyber indicators</keyword>

<abstract>
<t>The Incident Object Description Exchange Format (IODEF) defines a data representation for security incident reports and indicators commonly exchanged by operational security teams for mitigation and watch and warning.  This document describes an updated information model for the IODEF and provides an associated data model specified with the XML schema.  This new information and data model obsoletes RFCs 5070 and 6685. 
</t>
</abstract>
</front>

<middle>

<section title="Introduction" anchor="introduction">
<t>
Organizations require help from other parties to mitigate malicious activity targeting their network and to gain insight into potential threats.  This coordination might entail working with an ISP to filter attack traffic, contacting a remote site to take down a botnet, or sharing watch lists of known malicious indicators in a consortium.
</t>
<t>
The Incident Object Description Exchange Format (IODEF) is a format for representing computer security information commonly exchanged between Computer Security Incident Response Teams (CSIRTs) or other operational security teams.  It provides an XML representation for conveying:
<list style="symbols">
<t>indicators to characterize a threat;</t>
<t>security incident reports to document attacks against an organization;</t>
<t>response activity taken or that could be taken in response to an incident; and</t>
<t>metadata so that these various classes of information can be exchanged among parties.</t>
</list>
</t>

<t>
The purpose of the IODEF is to enhance the operational capabilities of CSIRTs.  Adoption of the IODEF will improve the ability of a CSIRT to resolve security incidents; understand threats; and coordinate response activities and proactive mitigations by simplifying collaboration and data sharing with its partners.  This structured format provided by the IODEF allows for:
</t>

<t>
<list style="symbols">
<t>machine-to-machine exchange of incident and indicator data;</t>
<t>automated processing of this data whereby allowing more rapid execution of appropriate courses of action; and</t>
<t>the development of an ecosystem of interoperable tools enabling security operations.</t>
</list>
</t>

<t>
Sharing and coordinating with other organizations is not strictly a technical problem.  There are numerous procedural, cultural, legal, and trust-related barriers to overcome.  The IODEF does not attempt to address them directly.  However, operational implementations of the IODEF will need to consider these challenges.
</t>

<t>
<xref target="introduction" /> provides the background for the IODEF.  Sections <xref target="datamodel" format="counter"/> and <xref target="schema" format="counter"/> specify the IODEF information and data model, respectively.  The data types used in this document are described in <xref target="iodef_data_types" />.  Processing considerations, extending the specification, internationalization, and security issues are covered in Sections <xref target="processing" format="counter"/>, <xref target="extending" format="counter"/>, <xref target="internationalization" format="counter"/>, and <xref target="security_considerations" format="counter"/>, respectively.  Examples are listed in <xref target="examples" />.  
</t>
			
<section title="Terminology" anchor="terminology">
<t>
The key words "MUST," "MUST NOT," "REQUIRED," "SHALL," "SHALL NOT," "SHOULD," "SHOULD NOT," "RECOMMENDED," "MAY," and "OPTIONAL" in this document are to be interpreted as described in <xref target="RFC2119" />.
</t>
</section> 

<section title="Notations" anchor="notation">
<t>The IODEF is specified as an Extensible Markup Language (XML) <xref target="W3C.XML" /> schema <xref target="W3C.SCHEMA" />.  The normative IODEF data model is found in the XML schema in <xref target="schema"/>.  To aid in the understanding of the data elements, <xref target="datamodel"/> also depicts the underlying information model using Unified Modeling Language (UML).  This abstract presentation of the IODEF is not normative.
</t>
<t>
For clarity in this document, the term "XML document" will be used when referring generically to any instance of an XML document.  The term "IODEF document" will be used to refer to an XML document conforming to the IODEF specification.  The terms "schema" will be used to refer to <xref target="schema"/> of this document.  The terms "data model" and "schema" will be used interchangeably.  The terms "class" and "element" will be used to reference either the corresponding data element in the UML-based information or XML schema-based data models, respectively.
</t>
</section> 

<section title="About the IODEF Data Model" anchor="about_dm">
<t>
A number of considerations were made in the design of the IODEF data model.
</t>

<t>
<list style="symbols">
<t>The data model found in this document is an evolution of the one previously specified in <xref target="RFC5070" />.  New fields were added to represent additional information.  <xref target="RFC5070" /> was developed primarily to represent incident reports.  This document builds upon it by adding support for indicators and revising it to reflect the current challenges faced by CSIRTs.  An attempt was made to preserve backward compatibility, but this was not possible in all cases.  See <xref target="differencesfromv1" />.  This document obsoletes <xref target="RFC5070" />.</t>

<t>
The IODEF is a transport format.  Therefore, the data model may not be the optimal archival or in-memory processing format.
</t>

<t>
The IODEF is intended to be a framework to convey only commonly exchanged information.  It ensures that there are mechanisms for extensibility to support organization-specific information and techniques to reference information kept outside of the data model.
</t>

<t>
Not all commonly exchanged information has a well-defined format or taxonomy.  The IODEF attempts to strike a balance between enforcing sufficient structure to allow automated processing and supporting free-form content that enables maximum flexibility.
</t>

<t>
The IODEF fits into a broader ecosystem of standards and conventions.  An attempt was made to harmonize the data model with this context.
</t>

</list>
</t>
</section> 

<section title="Changes from RFC 5070" anchor="about_changelog">
<t>
A detailed list of additions made to the data model in <xref target="RFC5070" /> are enumerated in this section.  See <xref target="differencesfromv1" /> for a list of incompatible changes.
</t>

<t>
<list style="symbols">
<t>Updated the data types (<xref target="iodef_data_types" />) to improve internationalization, clarify ambiguity, and ensure consistency in extensions.</t>
<t>Added the observable-id attribute (<xref target="observableid_attribute" />) and IndicatorData class (<xref target="IndicatorData"/>) to represent indicators.</t>
<t>Added the private-enum-name and private-enum-id attributes to the IODEF-Document class (<xref target="IODEF-Document" />) to disambiguate private extensions.</t>
<t>Updated the Incident class (<xref target="Incident" />) to represent additional timing and workflow information.</t>
<t>Added the ThreatActor (<xref target="ThreatActor" />) and Campaign (<xref target="Campaign" />) classes to represent attack attribution information.</t>
<t>Updated the Contact class (<xref target="Contact"/>) and its children to improve internationalization and represent additional information about an entity.</t>
<t>Updated the Method class (<xref target="Method"/>) to improve extensibility through externally referenced resources.</t>
<t>Added the Discovery class (<xref target="Discovery"/>) to describe how an incident was discovered.</t>
<t>Updated the Assessment class (<xref target="Assessment" />) to enable more descriptive characterizations of the impact of an incident.</t>
<t>Updated the HistoryItem (<xref target="HistoryItem" />) and Expectation (<xref target="Expectation" />) classes to support a reference to a course of action.</t>
<t>Updated the EventData class (<xref target="EventData" />) with additional metadata added to the Incident class.</t>
<t>Updated the System class (<xref target="System" />) with additional metadata.</t>
<t>Updated the Counter class (<xref target="Counter" />) to support additional rate metrics.</t>
<t>Added DomainData (<xref target="DomainData" />), EmailData (<xref target="EmailData" />), WindowsRegistryKeysModified (<xref target="WindowsRegistryKeysModified" />), CertificateData (<xref target="CertificateData" />), and FileData (<xref target="FileData" />) classes to improve the description of an incident and support this data as indicators.</t>
<t>Added the SignatureData (<xref target="SignatureData"/>) and HashData (<xref target="HashData"/>) classes to represent digital signatures and hashes.</t>
<t>Added support for public enumerated attribute extensions using IANA registries (<xref target="extending_enums_public" />).</t>
<t>Updated numerous enumerated attributes for completeness.</t>
</list>
</t>
</section> 



</section> 

<section title="IODEF Data Types" anchor="iodef_data_types">
<t>
The IODEF uses a number of simple and complex types.  This section describes these data types.
</t>

<section title="Integers" anchor="dt_integers">
<t>An integer is represented in the information model by the INTEGER data type.  Integer data MUST be encoded in Base 10.</t>

<t>The INTEGER data type is implemented in the data model as an "xs:integer" type per Section 3.3.13 of <xref target="W3C.SCHEMA.DTYPES" />.</t>

</section>

<section title="Real Numbers" anchor="dt_real_numbers">
<t>A real (floating-point) number is represented in the information model by the REAL data type.  Real data MUST be encoded in Base 10.</t>

<t>The REAL data type is implemented in the data model as an "xs:float" type per Section 3.2.4 of <xref target="W3C.SCHEMA.DTYPES" />.</t>

</section>

<section title="Characters and Strings" anchor="dt_char_strings">
<t>A single character is represented in the information model by the CHARACTER data type.  A string is represented by the STRING data type.  Special characters MUST be encoded using entity references.  See <xref target="encoding" />.</t>

<t>The CHARACTER and STRING data types are implemented in the data model as an "xs:string" type per Section 3.2.1 of <xref target="W3C.SCHEMA.DTYPES" />.</t>

</section>

<section title="Multilingual Strings" anchor="dt_ml_strings">
<t>A string that needs to be represented in a human-readable language different than the default encoding of the document is represented in the information model by the ML_STRING data type.</t>

<t>The ML_STRING data type is implemented in the data model as the "iodef:MLStringType" type.  This type extends the "xs:string" to include two attributes.</t>

<t>
<figure title="The iodef:MLStringType Type" anchor="figure_mlstringtype_type">
<artwork><![CDATA[
+------------------------+
| iodef:MLStringType     |
+------------------------+
| xs:string              |
|                        |
| ENUM xml:lang          |
| STRING translation-id  |
+------------------------+
]]></artwork>
</figure>
</t>

<t>The content of the class is a character string of type "xs:string" whose language MAY be specified by the xml:lang attribute.</t>

<t>The attributes of the iodef:MLStringType type are:
<list style="hanging">
<t hangText="xml:lang"><vspace />Optional.  ENUM.  A language identifier per Section 2.12 of <xref target="W3C.XML" /> whose values and format are described in <xref target="RFC5646" />.  The interpretation of this code is described in <xref target="internationalization" />.</t>

<t hangText="translation-id"><vspace />Optional.  STRING.  An identifier to relate other instances of this class with the same parent as translations of this text.  The scope of this identifier is limited to all of the direct, peer child classes of a given parent class.</t>
</list>
</t>

<t>Using this class enables representing translations of the same text in multiple languages.  Each translation is a distinct instance of this class with a common parent.  A group of classes each with a translated instance of text is related by setting a common identifier in the translation-id attribute.  The language of a given class is set by the xml:lang attribute.  See <xref target="internationalization" /> for more details on representing translations of free-form text.</t>


</section>

<section title="Binary Strings" anchor="dt_bstring">
<t>Binary octets can be represented with two encodings.</t>

<section title="Base64 Bytes" anchor="dt_bytes">
<t>A binary octet encoded with base64 is represented in the information model by the BYTE data type.  A sequence of these octets is of the BYTE[] data type.</t>

<t>The BYTE and BYTE[] data types are implemented in the data model as an "xs:base64Binary" type per Section 3.2.16 of <xref target="W3C.SCHEMA.DTYPES" />.</t>
</section>

<section title="Hexadecimal Bytes" anchor="dt_hexbin">
<t>A binary octet encoded as a character tuple consistent of two hexadecimal digits is represented in the information model by the HEXBIN data type.  A sequence of these octets is of the HEXBIN[] data type.</t>

<t>The HEXBIN and HEXBIN[] data types are implemented in the data model as an "xs:hexBinary" type per Section 3.2.15 of <xref target="W3C.SCHEMA.DTYPES" />.</t>
</section>
</section>

<section title="Enumerated Types" anchor="dt_enumerated">
<t>An enumerated type is represented in the information model by the ENUM data type.  It is an ordered list of acceptable string values.  Each value has a representative keyword.  Within the data model, the enumerated type keywords are used as attribute values.</t>

<t>The ENUM data type is implemented in the data model as values of an "xs:NMTOKEN" type per Section 3.3.4 of <xref target="W3C.SCHEMA.DTYPES" />.</t>

</section>

<section title="Date-Time String" anchor="dt_date_time">
<t>A date-time string that describes a particular instant in time is represented in the information model by the DATETIME data type.  Ranges are not supported.</t>

<t>The DATETIME data type is implemented in the data model as an "xs:dateTime" type per Section 3.2.7 of <xref target="W3C.SCHEMA.DTYPES" />.</t>
</section>

<section title="Timezone String" anchor="dt_timezone">
<t>A timezone offset from UTC is represented in the information model by the TIMEZONE data type.  It is formatted according to the following regular expression: "Z|[\+\-](0[0-9]|1[0-4]):[0-5][0-9]".
</t>
<t>The TIMEZONE data type is implemented in the data model as an "iodef:TimezoneType" type.</t>
</section>  


<section title="Port Lists" anchor="dt_port_list">
<t>A list of network ports is represented in the information model by the PORTLIST data type.  A PORTLIST consists of a comma-separated list of numbers and ranges (N-M means ports N through M, inclusive).  It is formatted according to the following regular expression: "\d+(\-\d+)?(,\d+(\-\d+)?)*".  For example, "2,5-15,30,32,40-50,55-60".</t>

<t>The PORTLIST data type is implemented in the data model as an "iodef:PortlistType" type.</t>
</section>

<section title="Postal Address" anchor="dt_postal_address">
<t>A postal address is represented in the information model by the POSTAL data type.  The format of the POSTAL data type is documented in Section 2.23 of <xref target="RFC4519" /> as a free-form multi-line string separated by the "$" character.
</t>

<t>The POSTAL data type is implemented in the data model as an "iodef:MLStringType" type.</t>
</section> 

<section title="Telephone Number" anchor="dt_phone">
<t>A telephone number is represented in the information model by the PHONE data type.  The format of the PHONE data type is documented in <xref target="E.164" />.
</t>
<t>The PHONE data type is implemented in the data model as an "xs:string" type per Section 3.2.1 of <xref target="W3C.SCHEMA.DTYPES" />.</t>
</section>

<section title="Email String" anchor="dt_email">
<t>An email address is represented in the information model by the EMAIL data type.  The format of the EMAIL data type is documented in Section 3.4.1 of <xref target="RFC5322" /> and Section 3.3 of <xref target="RFC6531" />.
</t>
<t>The EMAIL data type is implemented in the data model as an "xs:string" type per Section 3.2.1 of <xref target="W3C.SCHEMA.DTYPES" />.</t>
</section>  

<section title="Uniform Resource Locator Strings" anchor="dt_url">
<t>A uniform resource locator (URL) is represented in the information model by the URL data type.  The format of the URL data type is documented in <xref target="RFC3986" />.
</t>
<t>The URL data type is implemented as an "xs:anyURI" type per Section 3.2.17 of <xref target="W3C.SCHEMA.DTYPES" />.</t>
</section>  

<section title="Identifiers and Identifier References" anchor="dt_ids">
<t>An identifier unique to the IODEF document is represented in the information model by the ID data type.  A reference to this identifier is represented by the IDREF data type.
</t>
<t>The ID and IDREF data types are implemented in the model as "xs:ID" and "xs:IDREF" types per Sections 3.3.8 and 3.3.9  of <xref target="W3C.SCHEMA.DTYPES" />.</t>
</section>  

<section title="Software" anchor="dt_software">
<t>A particular version of software is represented in the information model by the SOFTWARE data type.  This software can be described by using a reference, a URL, or with free-form text.</t>

<t>The SOFTWARE data type is implemented in the data model as the "iodef:SoftwareType" type.</t>

<t> 
<figure title="The SoftwareType Type" anchor="figure_softwaretype_type">
<artwork><![CDATA[
+--------------------+
| iodef:SoftwareType |
+--------------------+
|                    |<>--{0..1}--[ SoftwareReference ]
|                    |<>--{0..*}--[ URL               ]
|                    |<>--{0..*}--[ Description       ] 
+--------------------+
]]></artwork>
</figure>
</t>
 
<t>The aggregate classes of the SoftwareType type are:
<list style="hanging">
<t hangText="SoftwareReference"><vspace/>Zero or one.  Reference to a software application.  See <xref target="SoftwareReference" />.</t>

<t hangText="URL"><vspace/>Zero or more.  URL.  A URL to a resource describing the software.</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the software.</t>
</list>
</t>

<t>At least one of these classes MUST be present.</t>
							
<t>The iodef:SoftwareType type has no attributes.</t>

<section title="SoftwareReference Class" anchor="SoftwareReference">
<t>The SoftwareReference class is a reference to a particular version of software.</t>
 
<t>
<figure title="The SoftwareReference Class" anchor="figure_softwarereference_class">
<artwork><![CDATA[
+----------------------+
| SoftwareReference    |
+----------------------+
| xs:any               |
|                      |
| ENUM spec-name       |
| STRING ext-spec-name |
| ENUM dtype           |
| STRING ext-dtype     |
+----------------------+
]]></artwork>
</figure>
</t>

<t>The element content varies according to the value of the spec-name attribute.  It is defined in the data model as "xs:any" per <xref target="W3C.SCHEMA" />.</t>
 
<t>The attributes of the SoftwareReference class are:
<list style="hanging">
<t hangText="spec-name"><vspace />Required. ENUM.  Identifies the format and semantics of the element body of this class.  Formal standards and specifications can be referenced as well as a free-form text description with a user-provided data type.  These values are maintained in the "SoftwareReference-spec-id" IANA registry per <xref target="enum_value_registries" />

<list style="numbers">
<t>custom.  The element content is free-form and of the data type specified by the dtype attribute.  If this value is selected, then the dtype attribute MUST be set.</t>

<t>cpe.  The element content describes a Common Platform Enumeration (CPE) entry per <xref target="NIST.CPE" />.</t>

<t>swid. The element content describes a software identification (SWID) tag per <xref target="ISO19770" />.</t>

<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-spec-name"><vspace/>Optional.  STRING.  A means by which to extend the spec-name attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="dtype"><vspace/>Optional.  ENUM.  The data type of the element content.  The permitted values for this attribute are shown below. The default value is "string".  These values are maintained in the "SoftwareReference-dtype" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>bytes.  The element content is of type HEXBIN.</t>

<t>integer.  The element content is of type INTEGER.</t>

<t>real.  The element content is of type REAL.</t>

<t>string.  The element content is of type STRING.</t>

<t>xml.  The element content is XML.  See <xref target="extending_classes" />.</t>

<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-dtype"><vspace/>Optional.  STRING.  A means by which to extend the dtype attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>
</section>

</section> 

<section title="Extension" anchor="dt_extension">
<t>Information not otherwise represented in the IODEF can be added using the EXTENSION data type.  This data type is a generic extension mechanism. </t>

<t>The EXTENSION data type is implemented in the data model as the "iodef:ExtensionType" type.</t>

<t>
The data type of an EXTENSION is described by the dtype attribute.  For simple information, atomic data types (e.g., integers, strings) are supported.  Their semantics are further described by the meaning and formatid attributes.  Encapsulating XML documents conforming to another schema is also supported.  A detailed discussion of extending the schema can be found in <xref target="extending" />.  Additional coordination may be required to ensure that a recipient of a document using this type can parse and process it.
</t>

<t>
<figure title="The iodef:ExtensionType Type" anchor="figure_extensiontype_type">
<artwork><![CDATA[
+------------------------+
| iodef:ExtensionType    |
+------------------------+
| xs:any                 |
|                        |
| STRING name            |
| ENUM dtype             |
| STRING ext-dtype       |
| STRING meaning         |
| STRING formatid        |
| ENUM restriction       |
| STRING ext-restriction |
| ID observable-id       |
+------------------------+
]]></artwork></figure></t>
	
<t>The element content of this type is the extension being added to the data model.  This content is defined in the data model as "xs:any" per <xref target="W3C.SCHEMA" />.</t>

<t>The attributes of the iodef:ExtensionType type are:
<list style="hanging">
<t hangText="name"><vspace/>Optional.  STRING.  A free-form name of the field or data element.</t>

<t hangText="dtype"><vspace/>Required.  ENUM.  The data type of the element content.  The default value is "string".  These values are maintained in the "ExtensionType-dtype" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>boolean.  The element content is of type BOOLEAN.</t>

<t>byte.  The element content is of type BYTE.</t>

<t>bytes.  The element content is of type HEXBIN.</t>

<t>character.  The element content is of type CHARACTER.</t>

<t>date-time.  The element content is of type DATETIME.</t>	

<t>ntpstamp.  Same as date-time.</t>

<t>integer.  The element content is of type INTEGER.</t>

<t>portlist.  The element content is of type PORTLIST.</t>

<t>real.  The element content is of type REAL.</t>

<t>string.  The element content is of type STRING.</t>

<t>file.  The element content is a base64-encoded binary file encoded as a BYTE[] type.</t>

<t>path.  The element content is a file-system path encoded as a STRING type. </t>

<t>frame.  The element content is a Layer 2 frame encoded as a HEXBIN type.</t>

<t>packet.  The element content is a Layer 3 packet encoded as a HEXBIN type. </t>

<t>ipv4-packet.  The element content is an IPv4 packet encoded as a HEXBIN type.</t>

<t>ipv6-packet.  The element content is an IPv6 packet encoded as a HEXBIN type. </t>

<t>url.  The element content is of type URL.</t>

<t>csv.  The element content is a comma-separated value (CSV) list per Section 2 of <xref target="RFC4180" /> encoded as a STRING type.</t>

<t>winreg.  The element content is a Microsoft Windows registry key encoded as a STRING type.</t>

<t>xml.  The element content is XML.  See <xref target="extending_classes" />.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-dtype"><vspace/>Optional.  STRING.  A means by which to extend the dtype attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="meaning"><vspace/>Optional.  STRING.  A free-form text description of the element content.</t>

<t hangText="formatid"><vspace/>Optional.  STRING.  An identifier referencing the format or semantics of the element content.
</t>

<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list>
</t>
</section> 

</section>

<section title="The IODEF Information Model" anchor="datamodel">
<t>
The specifics of the IODEF information model are discussed in this section.  Each class and its relationships with the other classes is described.  When necessary, clarifications are made about translating this information model to the schema in <xref target="schema" />.
</t>

<section title="IODEF-Document Class" anchor="IODEF-Document">
<t>
The IODEF-Document class is the top level class in the IODEF data model.  All IODEF documents are an instance of this class.
</t>
  
<t>
<figure title="The IODEF-Document Class" anchor="figure_iodef-message_class">
<artwork><![CDATA[
+--------------------------+       
| IODEF-Document           |
+--------------------------+
| STRING version           |<>--{1..*}--[ Incident       ]
| ENUM xml:lang            |<>--{0..*}--[ AdditionalData ]
| STRING format-id         |
| STRING private-enum-name |
| STRING private-enum-id   |
+--------------------------+
]]></artwork>
</figure>
</t>

<t>The aggregate classes of the IODEF-Document class are:
<list style="hanging">
<t hangText="Incident"><vspace/>One or more.  The information related to a single incident.  See <xref target="Incident" />.</t> 
<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  Mechanism by which to extend the data model.</t>
</list>
</t>

<t>The attributes of the IODEF-Document class are:
<list style="hanging">
<t hangText="version"><vspace/>Required.  STRING.  The IODEF specification version number to which this IODEF document conforms.  The value of this attribute MUST be "2.00".</t>

<t hangText="xml:lang"><vspace />Optional.  ENUM.  A language identifier per Section 2.12 of <xref target="W3C.XML" /> whose values and form are described in <xref target="RFC5646" />.  The interpretation of this code is described in <xref target="internationalization" />.</t>

<t hangText="format-id"><vspace/>Optional.  STRING.  A free-form string to convey processing instructions to the recipient of the document.  Its semantics must be negotiated out of band.</t>

<t hangText="private-enum-name"><vspace/>Optional.  STRING.  A globally unique identifier for the CSIRT generating the document to deconflict private extensions used in the document.  The fully qualified domain name (FQDN) associated with the CSIRT MUST be used as the identifier.  See <xref target="conflict_extension" />.</t>

<t hangText="private-enum-id"><vspace/>Optional.  STRING.  An organizationally unique identifier for an extension used in the document.  If this attribute is set, the private-enum-name MUST also be set.  See <xref target="conflict_extension" />.</t>

</list></t>

</section> 


<section title="Incident Class" anchor="Incident">
<t>
The Incident class describes commonly exchanged information when reporting or sharing derived analysis from security incidents.</t>

<t>
<figure title="The Incident Class" anchor="figure_incident_class">
<artwork><![CDATA[
+-------------------------+
| Incident                |
+-------------------------+
| ENUM purpose            |<>----------[ IncidentID      ]
| STRING ext-purpose      |<>--{0..1}--[ AlternativeID   ]
| ENUM status             |<>--{0..*}--[ RelatedActivity ]
| STRING ext-status       |<>--{0..1}--[ DetectTime      ]
| ENUM xml:lang           |<>--{0..1}--[ StartTime       ]
| ENUM restriction        |<>--{0..1}--[ EndTime         ]
| STRING ext-restriction  |<>--{0..1}--{ RecoveryTime    ]
| ID observable-id        |<>--{0..1}--[ ReportTime      ]
|                         |<>----------[ GenerationTime  ]
|                         |<>--{0..*}--[ Description     ]
|                         |<>--{0..*}  [ Discovery       ]
|                         |<>--{0..*}--[ Assessment      ]
|                         |<>--{0..*}--[ Method          ]
|                         |<>--{1..*}--[ Contact         ]
|                         |<>--{0..*}--[ EventData       ]
|                         |<>--{0..1}--[ IndicatorData   ]
|                         |<>--{0..1}--[ History         ]
|                         |<>--{0..*}--[ AdditionalData  ]
+-------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Incident class are:

<list style="hanging">
<t hangText="IncidentID"><vspace/>One.  An incident tracking number assigned to this incident by the CSIRT that generated the IODEF document.  See <xref target="IncidentID" />.</t>

<t hangText="AlternativeID"><vspace/>Zero or one.  The incident tracking numbers used by other CSIRTs to refer to the incident described in the document.  See <xref target="AlternativeID" />.</t>

<t hangText="RelatedActivity"><vspace/>Zero or more.  Related activity and attribution of this activity.  See <xref target="RelatedActivity" />.</t>

<t hangText="DetectTime"><vspace/>Zero or one.  DATETIME.  The time the incident was first detected.</t>

<t hangText="StartTime"><vspace/>Zero or one.  DATETIME.  The time the incident started.</t>

<t hangText="EndTime"><vspace/>Zero or one.  DATETIME.  The time the incident ended.</t>

<t hangText="RecoveryTime"><vspace/>Zero or one.  DATETIME.  The time the site recovered from the incident.</t>

<t hangText="ReportTime"><vspace/>Zero or one.  DATETIME.  The time the incident was reported.</t>

<t hangText="GenerationTime"><vspace/>One.  DATETIME.  The time the content in this Incident class was generated.</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the incident.</t>

<t hangText="Discovery"><vspace/>Zero or more.  The means by which this incident was detected.  See <xref target="Discovery" />.</t>

<t hangText="Assessment"><vspace/>Zero or more.  A characterization of the impact of the incident.  See <xref target="Assessment" />.</t>

<t hangText="Method"><vspace/>Zero or more.  The techniques used by the threat actor in the incident.  See <xref target="Method" />.</t>

<t hangText="Contact"><vspace/>One or more.  Contact information for the parties involved in the incident.  See <xref target="Contact" />.</t>

<t hangText="EventData"><vspace/>Zero or more.  Description of the events comprising the incident.  See <xref target="EventData" />.</t>

<t hangText="IndicatorData"><vspace/>Zero or one.  Indicators from the analysis of an incident.  See <xref target="IndicatorData" />.</t>

<t hangText="History"><vspace/>Zero or one.  A log of significant events or actions that occurred during the course of handling the incident.  See <xref target="History" />.</t>


<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  Mechanism by which to extend the data model.</t>
</list></t>

<t>The attributes of the Incident class are:
<list style="hanging">

<t hangText="purpose"><vspace/>Required.  ENUM.  The purpose attribute describes the rationale for documenting the information in this class.  It is closely related to the <xref target="Expectation">Expectation class</xref>.  These values are maintained in the "Incident-purpose" IANA registry per <xref target="enum_value_registries" />.

This attribute is defined as an enumerated list:

<list style="numbers">
<t>traceback.  The incident was sent for trace-back purposes.</t>

<t>mitigation.  The incident was sent to request aid in mitigating the described activity.</t>

<t>reporting.  The incident was sent to comply with reporting requirements.</t> 

<t>watch.  The incident was sent to convey indicators that should be monitored.</t>

<t>other.  The incident was sent for purposes specified in the Expectation class.</t>

<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<t hangText="ext-purpose"><vspace/>Optional.  STRING.  A means by which to extend the purpose attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="status"><vspace/>Optional.  ENUM.  The status attribute conveys the state in a workflow where the incident is currently found.  These values are maintained in the "Incident-status" IANA registry per <xref target="enum_value_registries" />.

This attribute is defined as an enumerated list:

<list style="numbers">

<t>new.  The incident is newly reported, and no action has been taken.</t>

<t>in-progress.  The incident is under investigation.</t>

<t>forwarded.  The incident has been forwarded to another party for handling.</t> 

<t>resolved.  The investigation into the activity in this incident has concluded.</t>

<t>future. The described activity has not yet been detected.</t>

<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<t hangText="ext-status"><vspace/>Optional.  STRING.  A means by which to extend the status attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="xml:lang"><vspace />Optional.  ENUM.  A language identifier per Section 2.12 of <xref target="W3C.XML" /> whose values and form are described in <xref target="RFC5646" />.  The interpretation of this code is described in <xref target="internationalization" />.</t>

<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.  The default value is "private".</t>

<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>
						
</list></t>

</section>  

<section title="Common Attributes" anchor="common_attributes">
<t>There are a number of recurring attributes used in the information model.  They are documented in this section.</t>

<section title="restriction Attribute" anchor="restriction">
<t>
The restriction attribute indicates the disclosure guidelines to which the sender expects the recipient to adhere for the information represented in this class and its children.  This guideline provides no security since there are no technical means to ensure that the recipient of the document handles the information as the sender requested.
</t>
<t>
The value of this attribute is logically inherited by the children of this class.  That is to say, the disclosure rules applied to this class also apply to its children.  
</t>
<t>
It is possible to set a granular disclosure policy, since all of the high-level classes (i.e., children of the Incident class) have a restriction attribute.  Therefore, a child can override the guidelines of a parent class, be it to restrict or relax the disclosure rules (e.g., a child has a weaker policy than an ancestor; or an ancestor has a weak policy, and the children selectively apply more rigid controls).  The implicit value of the restriction attribute for a class that did not specify one can be found in the closest ancestor that did specify a value.
</t>
<t>
This attribute is defined as an enumerated value with a default value of "private".  Note that the default value of the restriction attribute is only defined in the context of the Incident class.  In other classes where this attribute is used, no default is specified.</t>

<t>These values are maintained in the "Restriction" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>public.  The information can be freely distributed without restriction.</t>
<t>partner.  The information may be shared within a closed community of peers, partners, or affected parties, but cannot be openly published.</t>
<t>need-to-know.  The information may be shared only within the organization with individuals that have a need to know.</t>
<t>private.  The information may not be shared.</t>
<t>default.  The information can be shared according to an information disclosure policy pre-arranged by the communicating parties.</t>
<t>white. Same as 'public'.</t>
<t>green. Same as 'partner'.</t>
<t>amber. Same as 'need-to-know'.</t>
<t>red. Same as 'private'.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>
</section> 

<section title="observable-id Attribute" anchor="observableid_attribute">
<t>
The observable-id attribute tags information in the document as an observable so that it can be referenced later in the description of an indicator.  The value of this attribute is a unique identifier in the scope of the document.  It is used by the ObservableReference class to enumerate observables when defining an indicator with the IndicatorData class.</t>  
</section> 

</section>

<section title="IncidentID Class" anchor="IncidentID">
<t>The IncidentID class represents a tracking number that is unique in the context of the CSIRT.  It serves as an identifier for an incident or a document identifier when sharing indicators.  This identifier would serve as an index into a CSIRT's incident handling or knowledge management system.</t>

<t>The combination of the name attribute and the string in the element content MUST be a globally unique identifier describing the activity.  Documents generated by a given CSIRT MUST NOT reuse the same value unless they are referencing the same incident.</t>

<figure title="The IncidentID Class" anchor="figure_incidentid_class">
<artwork><![CDATA[
+------------------------+
| IncidentID             |
+------------------------+
| STRING                 |
|                        |
| STRING name            |
| STRING instance        |
| ENUM restriction       |
| STRING ext-restriction |
+------------------------+
]]></artwork>
</figure>

<t>The content of the class is an incident identifier of type STRING.</t>

<t>The attributes of the IncidentID class are:
<list style="hanging">
<t hangText="name"><vspace/>Required.  STRING.  An identifier describing the CSIRT that created the document.  In order to have a globally unique CSIRT name, the fully qualified domain name associated with the CSIRT MUST be used.</t>

<t hangText="instance"><vspace/>Optional.  STRING.  An identifier referencing a subset of the named incident.</t>

<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>

<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>

</list>
</t>
</section> 

<section title="AlternativeID Class" anchor="AlternativeID">
<t>The AlternativeID class lists the tracking numbers used by CSIRTs, other than the one generating the document, to refer to the identical activity described in the IODEF document.  A tracking number listed as an AlternativeID references the same incident detected by another CSIRT.  The tracking numbers of the CSIRT that generated the IODEF document must never be considered an AlternativeID.
</t>

<t>
<figure title="The AlternativeID Class" anchor="figure_AlternativeID_class">
<artwork><![CDATA[
+------------------------+
| AlternativeID          |
+------------------------+
| ENUM restriction       |<>--{1..*}--[ IncidentID ]
| STRING ext-restriction |
+------------------------+
      ]]></artwork></figure></t>
	
<t>The aggregate class of the AlternativeID class is:
<list style="hanging">

<t hangText="IncidentID"><vspace/>One or more.  The tracking number of another CSIRT.  See <xref target="IncidentID" />.</t> 
</list></t>
	
<t>The attributes of the AlternativeID class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>

</list></t>
</section>

<section title="RelatedActivity Class" anchor="RelatedActivity">
<t>The RelatedActivity class relates the information described in the rest of the document to previously observed incidents or activity and allows attribution to a specific actor or campaign.</t>

<t>
<figure title="The RelatedActivity Class" anchor="figure_RelatedActivity_class">
<artwork><![CDATA[
+------------------------+
| RelatedActivity        |
+------------------------+
| ENUM restriction       |<>--{0..*}--[ IncidentID     ]
| STRING ext-restriction |<>--{0..*}--[ URL            ]
|                        |<>--{0..*}--[ ThreatActor    ]
|                        |<>--{0..*}--[ Campaign       ]
|                        |<>--{0..*}--[ IndicatorID    ]
|                        |<>--{0..1}--[ Confidence     ]
|                        |<>--{0..*}--[ Description    ]
|                        |<>--{0..*}--[ AdditionalData ]
+------------------------+
      ]]></artwork></figure>
	</t>

<t>The aggregate classes of the RelatedActivity class are:
<list style="hanging">

<t hangText="IncidentID"><vspace/>Zero or more.  The tracking number of a related incident.  See <xref target="IncidentID" />.</t> 

<t hangText="URL"><vspace/>Zero or more.  URL.  A URL to activity related to this incident.</t> 

<t hangText="ThreatActor"><vspace/>Zero or more.  The threat actor to whom the incident activity is attributed.  See <xref target="ThreatActor" />.</t> 

<t hangText="Campaign"><vspace/>Zero or more.  The campaign of a given threat actor to whom the described activity is attributed.  See <xref target="Campaign" />.</t> 

<t hangText="IndicatorID"><vspace/>Zero or more.  A reference to a related indicator.  See <xref target="IncidentID" />.</t> 

<t hangText="Confidence"><vspace/>Zero or one.  An estimate of the confidence in attributing this RelatedActivity to the events described in the document.  See <xref target="Confidence" />.</t> 

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A description of how these relationships were derived.</t> 

<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  A mechanism by which to extend the data model.</t> 

</list></t>

<t>The RelatedActivity class MUST have at least one instance of any of the following child classes: IncidentID, URL, ThreatActor, Campaign, Description, or AdditionalData.</t>

<t>The attributes of the RelatedActivity class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

   </section>

<section title="ThreatActor Class" anchor="ThreatActor">
<t>The ThreatActor class describes a threat actor.
</t> 

<t>
<figure title="The ThreatActor Class" anchor="figure_ThreatActor_class">
<artwork><![CDATA[
+------------------------+
| ThreatActor            |
+------------------------+
| ENUM restriction       |<>--{0..*}--[ ThreatActorID  ]
| STRING ext-restriction |<>--{0..*}--[ URL            ]
|                        |<>--{0..*}--[ Description    ]
|                        |<>--{0..*}--[ AdditionalData ]
+------------------------+
      ]]></artwork></figure>
	</t>

<t>The aggregate classes of the ThreatActor class are:
<list style="hanging">

<t hangText="ThreatActorID"><vspace/>Zero or more.  STRING. An identifier for the threat actor.</t> 

<t hangText="URL"><vspace/>Zero or more.  URL.  A URL to a reference describing the threat actor.</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A description of the threat actor.</t> 

<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  A mechanism by which to extend the data model.</t> 

</list></t>

<t>The ThreatActor class MUST have at least one instance of a child class.</t>

<t>The attributes of the ThreatActor class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

</section> 

<section title="Campaign Class" anchor="Campaign">
<t>The Campaign class describes a campaign of attacks by a threat actor.
</t> 

<t>
<figure title="The Campaign Class" anchor="figure_Campaign_class">
<artwork><![CDATA[
+------------------------+
| Campaign               |
+------------------------+
| ENUM restriction       |<>--{0..*}--[ CampaignID     ]
| STRING ext-restriction |<>--{0..*}--[ URL            ]
|                        |<>--{0..*}--[ Description    ]
|                        |<>--{0..*}--[ AdditionalData ]
+------------------------+
      ]]></artwork></figure>
	</t>

<t>The aggregate classes of the Campaign class are:
<list style="hanging">

<t hangText="CampaignID"><vspace/>Zero or more.  STRING. An identifier for the campaign.</t> 

<t hangText="URL"><vspace/>Zero or more.  URL.  A URL to a reference describing the campaign.</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A description of the campaign.</t> 

<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  A mechanism by which to extend the data model.</t> 

</list></t>

<t>The Campaign class MUST have at least one instance of a child class.</t>

<t>The attributes of the Campaign class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

</section> 
	
<section title="Contact Class" anchor="Contact">
<t>The Contact class describes contact information for organizations and personnel involved in the incident.  This class allows for the naming of the involved party, specifying contact information for them, and identifying their role in the incident.
</t>

<t>People and organizations are treated interchangeably as contacts; one can be associated with the other using the recursive definition of the class (the Contact class is aggregated into the Contact class).  The type attribute disambiguates the type of contact information being provided.
</t>

<t>
The recursive definition of Contact provides a way to relate information without requiring the explicit use of identifiers or duplication of data.  A complete point of contact is derived by a particular traversal from the root Contact class to the leaf Contact class.  Each child Contact class logically inherits contact information from its ancestors.
</t>

<t>
<figure title="The Contact Class" anchor="figure_contact_class">
<artwork><![CDATA[
+------------------------+
| Contact                |
+------------------------+
| ENUM role              |<>--{0..*}--[ ContactName    ]
| STRING ext-role        |<>--{0..*}--[ ContactTitle   ]
| ENUM type              |<>--{0..*}--[ Description    ]
| STRING ext-type        |<>--{0..*}--[ RegistryHandle ]
| ENUM restriction       |<>--{0..*}--[ PostalAddress  ]
| STRING ext-restriction |<>--{0..*}--[ Email          ]
|                        |<>--{0..*}--[ Telephone      ]
|                        |<>--{0..1}--[ Timezone       ]
|                        |<>--{0..*}--[ Contact        ]
|                        |<>--{0..*}--[ AdditionalData ]
+------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Contact class are:
<list style="hanging">

<t hangText="ContactName"><vspace/>Zero or more.  ML_STRING.  The name of the contact.  The contact may either be an organization or a person.  The type attribute disambiguates the semantics.</t>

<t hangText="ContactTitle"><vspace/>Zero or more.  ML_STRING.  The title for the individual named in the ContactName.</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the contact.</t>

<t hangText="RegistryHandle"><vspace/>Zero or more.  A handle name into the registry of the contact.  See <xref target="RegistryHandle" />.</t>

<t hangText="PostalAddress"><vspace/>Zero or more.  The postal address of the contact.  See <xref target="postaladdress" />.</t>

<t hangText="Email"><vspace/>Zero or more.  The email address of the contact.  See <xref target="email" />.</t>

<t hangText="Telephone"><vspace/>Zero or more.  The telephone number of the contact.  See <xref target="telephone" />.</t>

<t hangText="Timezone"><vspace/>Zero or one.  TIMEZONE. The timezone in which the contact resides.</t>

<t hangText="Contact"><vspace/>Zero or more.  A recursive definition of the Contact class.  This definition can be used to group common data pertaining to multiple points of contact and is especially useful when listing multiple contacts at the same organization.</t>

<t hangText="AdditionalData"><vspace/>Zero or more. EXTENSION.  A mechanism by which to extend the data model.</t>

</list>
</t>

<t>At least one of the aggregate classes MUST be present in an instance of the Contact class.</t>

<t>The attributes of the Contact class are:
<list style="hanging">

<t hangText="role"><vspace/>Required.  ENUM.  Indicates the role the contact fulfills.   These values are maintained in the "Contact-role" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>creator.  The entity that generates the document.</t>
<t>reporter.  The entity that reported the information.</t>
<t>admin.  An administrative contact or business owner for an asset or organization.</t>
<t>tech.  An entity responsible for the day-to-day management of technical issues for an asset or organization.</t>
<t>provider.  An external hosting provider for an asset.</t>
<t>user.  An end-user of an asset or part of an organization.</t>
<t>billing.  An entity responsible for billing issues for an asset or organization.</t>
<t>legal.  An entity responsible for legal issues related to an asset or organization.</t>
<t>irt.  An entity responsible for handling security issues for an asset or organization.</t>
<t>abuse.  An entity responsible for handling abuse originating from an asset or organization.</t>
<t>cc.  An entity that is to be kept informed about the events related to an asset or organization.</t>
<t>cc-irt.  A CSIRT or information-sharing organization coordinating activity related to an asset or organization.</t>
<t>leo.  A law enforcement organization supporting the investigation of activity affecting an asset or organization.</t>
<t>vendor.  The vendor that produces an asset.</t>
<t>vendor-support.  A vendor that provides services.</t>
<t>victim. A victim in the incident.</t>
<t>victim-notified.  A victim in the incident who has been notified.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<t hangText="ext-role"><vspace/>Optional.  STRING.  A means by which to extend the role attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="type"><vspace/>Required.  ENUM.  Indicates the type of contact being described. This attribute is defined as an enumerated list.  These values are maintained in the "Contact-type" IANA registry per <xref target="enum_value_registries" />.
<list style="numbers">

<t>person. The information for this contact references an individual.</t>
<t>organization. The information for this contact references an organization.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<t hangText="ext-type"><vspace/>Optional.  STRING.  A means by which to extend the type attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>

<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>

</list></t>

<section title="RegistryHandle Class" anchor="RegistryHandle">
<t>The RegistryHandle class represents a handle into an Internet registry or community-specific database.</t>

<t>
<figure title="The RegistryHandle Class" anchor="figure_registryhandle_class">
<artwork><![CDATA[
+---------------------+
| RegistryHandle      |
+---------------------+
| STRING              |
|                     |
| ENUM registry       |
| STRING ext-registry |
+---------------------+
]]></artwork>
</figure></t>

<t>The content of the class is a handle into a registry of type STRING.</t>

<t>The attributes of the RegistryHandle class are:
<list style="hanging">
<t hangText="registry"><vspace/>Required.  ENUM.  The database to which the handle belongs.  These values are maintained in the "RegistryHandle-registry" IANA registry per <xref target="enum_value_registries" />.  The possible values are:


<list style="numbers">
<t>internic.  Internet Network Information Center</t>
<t>apnic.  Asia Pacific Network Information Center</t>
<t>arin.  American Registry for Internet Numbers</t>
<t>lacnic.  Latin American and Caribbean Internet Addresses Registry</t>
<t>ripe.  Reseaux IP Europeens</t>
<t>afrinic. African Network Information Center</t>
<t>local.  A database local to the CSIRT</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-registry"><vspace/>Optional.  STRING.  A means by which to extend the registry attribute.  See <xref target="extending_enums_private" />.</t>

</list>
</t>
</section> 

<section title="PostalAddress Class" anchor="postaladdress">
<t>The PostalAddress class specifies a postal address and associated annotation.</t>

<t>
<figure title="The PostalAddress Class" anchor="figure_postaladdress_class">
<artwork><![CDATA[
+--------------------+
| PostalAddress      |
+--------------------+
| ENUM type          |<>----------[ PAddress         ]
| STRING ext-type    |<>--{0..*}--[ Description      ]
+--------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the PostalAddress class are:
<list style="hanging">
<t hangText="PAddress"><vspace/>One.  POSTAL.  A postal address.</t> 
<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the address.</t>
</list></t>

<t>The attributes of the PostalAddress class are:
<list style="hanging">
<t hangText="type"><vspace />Optional.  ENUM.  Categorizes the type of address described in the PAddress class. These values are maintained in the "PostalAddress-type" IANA registry per <xref target="enum_value_registries" />.
<list style="numbers">
<t>street.  An address describing a physical location.</t>
<t>mailing. An address to which correspondence should be sent.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>
<t hangText="ext-type"><vspace/>Optional.  STRING.  A means by which to extend the type attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>


</section> 

<section title="Email Class" anchor="email">
<t>The Email class specifies an email address and associated annotation.</t>

<t>
<figure title="The Email Class" anchor="figure_email_class">
<artwork><![CDATA[
+--------------------+
| Email              |
+--------------------+
| ENUM type          |<>----------[ EmailTo          ]
| STRING ext-type    |<>--{0..*}--[ Description      ]
+--------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Email class are:
<list style="hanging">
<t hangText="EmailTo"><vspace/>One.  EMAIL.  An email address.</t> 
<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the email address.</t>
</list></t>

<t>The attributes of the Email class are:
<list style="hanging">
<t hangText="type"><vspace />Optional.  ENUM.  Categorizes the type of email address described in the EmailTo class. These values are maintained in the "Email-type" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>direct.  An email address of an individual.</t>
<t>hotline. An email address regularly monitored for operational purposes.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-type"><vspace/>Optional.  STRING.  A means by which to extend the type attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>
</section> 

<section title="Telephone Class" anchor="telephone">
<t>The Telephone class describes a telephone number and associated annotation.</t>

<t>
<figure title="The Telephone Class" anchor="figure_telephone">
<artwork><![CDATA[
+--------------------+
| Telephone          |
+--------------------+
| ENUM type          |<>----------[ TelephoneNumber  ]
| STRING ext-type    |<>--{0..*}--[ Description      ]
+--------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Telephone class are:
<list style="hanging">
<t hangText="TelephoneNumber"><vspace/>One.  PHONE.  A telephone number.</t> 
<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the phone number.</t>
</list></t>

<t>The attributes of the Telephone class are:
<list style="hanging">
<t hangText="type"><vspace />Optional.  ENUM.  Categorizes the type of telephone number described in the TelephoneNumber class. These values are maintained in the "Telephone-type" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>wired.  A number of a wire-line (land-line) phone.</t>
<t>mobile. A number of a mobile phone.</t>
<t>fax. A number to a fax machine.</t>
<t>hotline. A number to a regularly monitored operational hotline.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-type"><vspace/>Optional.  STRING.  A means by which to extend the type attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>
</section>

		
</section>  

<section title="Discovery Class" anchor="Discovery">
<t>The Discovery class describes how an incident was detected.

<figure title="The Discovery Class" anchor="figure_discovery_class">
<artwork><![CDATA[
+------------------------+
| Discovery              |
+------------------------+
| ENUM source            |<>--{0..*}--[ Description      ]
| STRING ext-source      |<>--{0..*}--[ Contact          ]
| ENUM restriction       |<>--{0..*}--[ DetectionPattern ]
| STRING ext-restriction |
+------------------------+
]]></artwork>
</figure>
</t>

<t>The aggregate classes of the Discovery class are:
<list style="hanging">
<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of how this incident was detected.</t>

<t hangText="Contact"><vspace/>Zero or more.  Contact information for the party that discovered the incident.  See <xref target="Contact" />.</t> 

<t hangText="DetectionPattern"><vspace/>Zero or more.  Describes an application-specific configuration that detected the incident.   See <xref target="DetectionPattern" />.
</t>
</list></t>

<t>The attributes of the Discovery class are:
<list style="hanging">

<t hangText="source"><vspace />Optional.  ENUM.  Categorizes the techniques used to discover the incident.  These values are partially derived from Table 3-1 of <xref target="NIST800.61rev2" />. These values are maintained in the "Discovery-source" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>nidps.  Network Intrusion Detection or Prevention System.</t>
<t>hips.  Host-based Intrusion Prevention System.</t>
<t>siem.  Security Information and Event Management System.</t>
<t>av.  Antivirus or antispam software.</t>
<t>third-party-monitoring.  Contracted third-party monitoring service.</t>
<t>incident.  The activity was discovered while investigating an unrelated incident.</t>
<t>os-log.  Operating system logs.</t>
<t>application-log.  Application logs.</t>
<t>device-log.  Network device logs.</t>
<t>network-flow.  Network flow analysis.</t>
<t>passive-dns.  Passive DNS analysis.</t>
<t>investigation.  Manual investigation initiated based on notification of a new vulnerability or exploit.</t>
<t>audit.  Security audit.</t>
<t>internal-notification.  A party within the organization reported the activity.</t>
<t>external-notification.  A party outside of the organization reported the activity.</t>
<t>leo.  A law enforcement organization notified the victim organization.</t>
<t>partner.  A customer or business partner reported the activity to the victim organization.</t>
<t>actor.  The threat actor directly or indirectly reported this activity to the victim organization.</t>
<t>unknown.  Unknown detection approach.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-source"><vspace/>Optional.  STRING.  A means by which to extend the source attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>

<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>

</list></t>

<section title="DetectionPattern Class" anchor="DetectionPattern">
<t>The DetectionPattern class describes a configuration or signature that can be used by an Intrusion Detection System (IDS) / Intrusion Prevention System (IPS), SIEM, antivirus, endpoint protection, network analysis, malware analysis, or host forensics tool to identify a particular phenomenon.  This class requires the identification of the target application and allows the configuration to be described in either free form or machine-readable form.

<figure title="The DetectionPattern Class" anchor="figure_detectionpattern_class">
<artwork><![CDATA[
+------------------------+
| DetectionPattern       |
+------------------------+
| ENUM restriction       |<>----------[ Application            ]
| STRING ext-restriction |<>--{0..*}--[ Description            ]
| ID observable-id       |<>--{0..*}--[ DetectionConfiguration ]
+------------------------+
]]></artwork>
</figure>
</t>

<t>The aggregate classes of the DetectionPattern class are:
<list style="hanging">
<t hangText="Application"><vspace/>One.  SOFTWARE.  The application for which the DetectionConfiguration or Description is being provided.
</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text
description of how to use the information provided in the Application or DetectionConfiguration classes.
</t>

<t hangText="DetectionConfiguration"><vspace/>Zero or more.  STRING.  A machine-consumable configuration to find a pattern of activity. 
</t>
</list></t>

<t>An instance of either the Description or DetectionConfiguration class MUST be present.</t>

<t>The attributes of the DetectionPattern class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list></t>
</section> 

</section> 


<section title="Method Class" anchor="Method">
<t>The Method class describes the tactics, techniques,  procedures, or weakness used by the threat actor in an incident.  This class consists of both a list of references describing the attack methods and weaknesses and a free-form text description.

<figure title="The Method Class" anchor="figure_method_class">
<artwork><![CDATA[
+------------------------+
| Method                 |
+------------------------+
| ENUM restriction       |<>--{0..*}--[ Reference         ]
| STRING ext-restriction |<>--{0..*}--[ Description       ]
|                        |<>--{0..*}--[ sci:AttackPattern ]
|                        |<>--{0..*}--[ sci:Vulnerability ]
|                        |<>--{0..*}--[ sci:Weakness      ]
|                        |<>--{0..*}--[ AdditionalData    ]
+------------------------+
]]></artwork>
</figure>
</t>

<t>The aggregate classes of the Method class are:
<list style="hanging">
<t hangText="Reference"><vspace/>Zero or more.  A reference to a vulnerability, malware sample, advisory, or analysis of an attack technique.  See <xref target="Reference" />.
</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of techniques, tactics, or procedures used by the threat actor.
</t>

<t hangText="sci:AttackPattern"><vspace/>Zero or more.  A reference to a pattern of attack or exploitation per <xref target="RFC7203" />.
</t>

<t hangText="sci:Vulnerability"><vspace/>Zero or more.  A reference to a vulnerability per <xref target="RFC7203" />.
</t>

<t hangText="sci:Weakness"><vspace/>Zero or more.  A reference to the exploited weakness per <xref target="RFC7203" />.
</t>

<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  A mechanism by which to extend the data model.
</t>
</list></t>

<t>An instance of one of these children MUST be present.</t>

<t>The attributes of the Method class are:
<list style="hanging">
	<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<section title="Reference Class" anchor="Reference">
<t>The Reference class is an external reference to relevant information such as a vulnerability, IDS alert, malware sample, advisory, or attack technique.
 
<figure title="The Reference Class" anchor="figure_reference_class">
<artwork><![CDATA[
+-------------------------+
| Reference               |
+-------------------------+
| ID observable-id        |<>--{0..1}--[ enum:ReferenceName ]
|                         |<>--{0..*}--[ URL                ]
|                         |<>--{0..*}--[ Description        ]
+-------------------------+
]]></artwork>
</figure>
</t>

<t>The aggregate classes of the Reference class are:
<list style="hanging">
<t hangText="enum:ReferenceName"><vspace/>Zero or one.  Reference identifier per <xref target="RFC7495" />.</t>

<t hangText="URL"><vspace/>Zero or more.  URL.  A URL to a reference.</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of this reference.</t>
</list>
</t>

<t>At least one of these classes MUST be present.</t>
							
<t>The attribute of the Reference class is:
<list style="hanging">								
<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list>
</t>

</section>  
</section> 

<section title="Assessment Class" anchor="Assessment">
<t>The Assessment class describes the repercussions of the incident to the victim.</t>

<t> 
<figure title="The Assessment Class" anchor="figure_assessment_class">
<artwork><![CDATA[
+-------------------------+
| Assessment              |
+-------------------------+ 
| ENUM occurrence         |<>--{0..*}--[ IncidentCategory ]
| ENUM restriction        |<>--{0..*}--[ SystemImpact     ]
| STRING ext-restriction  |<>--{0..*}--[ BusinessImpact   ]
| ID observable-id        |<>--{0..*}--[ TimeImpact       ]
|                         |<>--{0..*}--[ MonetaryImpact   ]
|                         |<>--{0..*}--[ IntendedImpact   ]
|                         |<>--{0..*}--[ Counter          ]
|                         |<>--{0..*}--[ MitigatingFactor ]
|                         |<>--{0..*}--[ Cause            ]
|                         |<>--{0..1}--[ Confidence       ]
|                         |<>--{0..*}--[ AdditionalData   ]
+-------------------------+
]]></artwork>
</figure>
</t>

<t>The aggregate classes of the Assessment class are:
<list style="hanging">
<t hangText="IncidentCategory"><vspace/>Zero or more.  ML_STRING.  A free-form text description categorizing the type of incident.
</t>

<t hangText="SystemImpact"><vspace/>Zero or more.  A technical characterization of the impact of the incident activity on the victim's enterprise.  See <xref target="SystemImpact" />.
</t> 

<t hangText="BusinessImpact"><vspace/>Zero or more.  Impact of the incident activity on the business functions of the victim organization.  See <xref target="BusinessImpact" />.
</t> 

<t hangText="TimeImpact"><vspace/>Zero or more.  A characterization of the victim organization due to the incident activity as a function of time.  See <xref target="TimeImpact" />.
</t> 

<t hangText="MonetaryImpact"><vspace/>Zero or more.  The financial loss due to the incident activity.  See <xref target="monetaryimpact" />.
</t> 

<t hangText="IntendedImpact"><vspace/>Zero or more.  The intended outcome to the victim sought by the threat actor.  Defined identically to the BusinessImpact defined in <xref target="BusinessImpact" /> but describes intent rather than the realized impact.</t> 

<t hangText="Counter"><vspace/>Zero or more.  A counter with which to summarize the magnitude of the activity.  See <xref target="Counter" />.</t>

<t hangText="MitigatingFactor"><vspace/>Zero or more.  ML_STRING.  A description of a mitigating factor relative to the impact on the victim organization.
</t> 

<t hangText="Cause"><vspace/>Zero or more.  ML_STRING.  A description of an underlying cause of the impact.
</t> 

<t hangText="Confidence"><vspace/>Zero or one.  An estimate of confidence in the impact assessment.  See <xref target="Confidence" />.
</t> 

<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  A mechanism by which to extend the data model.
</t> 

</list>
	</t>
<t>At least one instance of the possible five impact classes (i.e., SystemImpact, BusinessImpact, TimeImpact, MonetaryImpact, or IntendedImpact) MUST be present.</t>

<t>The attributes of the Assessment class are:
<list style="hanging">

<t hangText="occurrence"><vspace />Optional.  ENUM.  Specifies whether the assessment is describing actual or potential outcomes.

<list style="numbers">
<t>actual.  This assessment describes activity that has occurred.</t>
<t>potential.  This assessment describes potential activity that might occur.</t>
</list>
</t>

<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>

</list></t>

<section title="SystemImpact Class" anchor="SystemImpact">

<t>The SystemImpact class describes the technical impact of the incident to the systems on the network.</t>

<t>
<figure title="The SystemImpact Class" anchor="figure_systemimpact_class">
<artwork><![CDATA[
+-----------------------+
| SystemImpact          |
+-----------------------+ 
| ENUM severity         |<>--{0..*}--[ Description ]
| ENUM completion       |
| ENUM type             |
| STRING ext-type       |
+-----------------------+
]]></artwork>
</figure></t>

<t>The aggregate class of the SystemImpact class is:
<list style="hanging">
<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the impact to the system.</t>
</list>
</t>

<t>The attributes of the SystemImpact class are:
<list style="hanging">
<t hangText="severity"><vspace />Optional.  ENUM.  An estimate of the relative severity of the activity.  The permitted values are shown below.  There is no default value.
<list style="numbers">
<t>low.  Low severity</t>
<t>medium. Medium severity</t>
<t>high. High severity</t>
</list>
</t>

<t hangText="completion"><vspace/>Optional.  ENUM.  An indication whether the described activity was successful. The permitted values are shown below.  There is no default value.

<list style="numbers">
<t>failed.  The attempted activity was not successful.</t>
<t>succeeded.  The attempted activity succeeded.</t>
</list></t>

<t hangText="type"><vspace />Required.  ENUM.  Classifies the impact.  The permitted values are shown below.  The default value is "unknown".  These values are maintained in the "SystemImpact-type" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>takeover-account.  Control was taken of a given account.</t>
<t>takeover-service.  Control was taken of a given service.</t>
<t>takeover-system.  Control was taken of a given system.</t>
<t>cps-manipulation. A cyber-physical system was manipulated. </t>
<t>cps-damage. A cyber-physical system was damaged. </t>
<t>availability-data. Access to particular data was degraded or denied.</t>
<t>availability-account.  Access to an account was degraded or denied.</t>
<t>availability-service. Access to a service was degraded or denied.</t>
<t>availability-system.  Access to a system was degraded or denied.</t> 
<t>damaged-system.  Hardware on a system was irreparably damaged.</t>
<t>damaged-data. Data on a system was deleted.</t>
<t>breach-proprietary.  Sensitive or proprietary information was accessed or exfiltrated.</t>
<t>breach-privacy.  Personally identifiable information was accessed or exfiltrated.</t>
<t>breach-credential.  Credential information was accessed or exfiltrated.</t>
<t>breach-configuration.  System configuration or data inventory was access or exfiltrated.</t>
<t>integrity-data.  Data on the system was modified.</t>
<t>integrity-configuration. Application or system configuration was modified.</t>
<t>integrity-hardware.  Firmware of a hardware component was modified.</t>
<t>traffic-redirection. Network traffic on the system was redirected</t>
<t>monitoring-traffic. Network traffic emerging from a host or enclave was monitored.</t>
<t>monitoring-host.  System activity (e.g., running processes, keystrokes) were monitored.</t>
<t>policy. Activity violated the system owner's acceptable use policy.</t>
<t>unknown.  The impact is unknown.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<t hangText="ext-type"><vspace/>Optional.  STRING.  A means by which to extend the type attribute.  See <xref target="extending_enums_private" />.</t>

</list></t>

</section> 

<section title="BusinessImpact Class" anchor="BusinessImpact">

<t>The BusinessImpact class describes and characterizes the degree to which the function of the organization was impacted by the incident.</t>

<t>
<figure title="The BusinessImpact Class" anchor="figure_businessimpact_class">
<artwork><![CDATA[
+-------------------------+ 
| BusinessImpact          | 
+-------------------------+ 
| ENUM severity           |<>--{0..*}--[ Description ]
| STRING ext-severity     |
| ENUM type               |
| STRING ext-type         | 
+-------------------------+
]]></artwork>
</figure></t>

<t>The aggregate class of the BusinessImpact class is:
<list style="hanging">
<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the impact to the organization.</t>
</list>
</t>

<t>The attributes of the BusinessImpact class are:
<list style="hanging">
<t hangText="severity"><vspace />Optional.  ENUM.  Characterizes the severity of the incident on business functions.  The permitted values are shown below.  They were derived from Table 3-2 of <xref target="NIST800.61rev2" />. The default value is "unknown".  These values are maintained in the "BusinessImpact-severity" IANA registry per <xref target="enum_value_registries" />.
<list style="numbers">
<t>none.  No effect to the organization's ability to provide all services to all users.</t>
<t>low.  Minimal effect as the organization can still provide all critical services to all users but has lost efficiency.</t>
<t>medium. The organization has lost the ability to provide a critical service to a subset of system users.</t>
<t>high. The organization is no longer able to provide some critical services to any users.</t>
<t>unknown.  The impact is not known.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<t hangText="ext-severity"><vspace/>Optional.  STRING.  A means by which to extend the severity attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="type"><vspace />Required.  ENUM.  Characterizes the effect this incident had on the business.  The permitted values are shown below.  The default value is "unknown".  These values are maintained in the "BusinessImpact-type" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>breach-proprietary.  Sensitive or proprietary information was accessed or exfiltrated.</t>
<t>breach-privacy.  Personally identifiable information was accessed or exfiltrated.</t>
<t>breach-credential.  Credential information was accessed or exfiltrated.</t>
<t>loss-of-integrity.  Sensitive or proprietary information was changed or deleted.</t>
<t>loss-of-service. Service delivery was disrupted.</t>
<t>theft-financial.  Money was stolen.</t>
<t>theft-service.  Services were misappropriated.</t>
<t>degraded-reputation.  The reputation of the organization's brand was diminished.</t>
<t>asset-damage.  A cyber-physical system was damaged.</t>
<t>asset-manipulation.  A cyber-physical system was manipulated.</t>
<t>legal.  The incident resulted in legal or regulatory action.</t>
<t>extortion.  The incident resulted in actors extorting the victim organization.</t>
<t>unknown.  The impact is unknown.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<t hangText="ext-type"><vspace/>Optional.  STRING.  A means by which to extend the type attribute.  See <xref target="extending_enums_private" />.</t>

</list></t>

</section> 


<section title="TimeImpact Class" anchor="TimeImpact">
<t>The TimeImpact class describes the impact of the incident on an organization as a function of time.  It provides a way to convey down time and recovery time.
</t>

<t>
<figure title="The TimeImpact Class" anchor="figure_time_impact_class">
<artwork><![CDATA[
+---------------------+
| TimeImpact          |
+---------------------+ 
| REAL                |
|                     |
| ENUM severity       |
| ENUM metric         |
| STRING ext-metric   |
| ENUM duration       |
| STRING ext-duration |
+---------------------+
]]></artwork>
</figure></t>

<t>The content of the class is of type REAL and specifies an amount of time.  The duration attribute provides units for this content, and the metric attribute explains what this content is measuring.
</t>

<t>The attributes of the TimeImpact class are:
<list style="hanging">

<t hangText="severity"><vspace />Optional.  ENUM.  An estimate of the relative severity of the activity.  The permitted values are shown below.  There is no default value. 
	<list style="numbers">
		<t>low.  Low severity</t>
		<t>medium. Medium severity</t>
		<t>high. High severity</t>
	</list></t>

<t hangText="metric"><vspace/>Required.  ENUM.  Defines the meaning of the value in the element content.  These values are maintained in the "TimeImpact-metric" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>labor.  Total staff time to recovery from the activity (e.g., 2 employees working 4 hours each would be 8 hours).</t>
<t>elapsed.  Elapsed time from the beginning of the recovery to its completion (i.e., wall-clock time).</t>
<t>downtime.  Duration of time for which some provided service(s) was not available.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<t hangText="ext-metric"><vspace/>Optional.  STRING.  A means by which to extend the metric attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="duration"><vspace />Optional.  ENUM.  Defines the unit of time for the value in the element content.  The default value is "hour".  These values are maintained in the "TimeImpact-duration" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>second.  The unit of the element content is seconds.</t>
<t>minute.  The unit of the element content is minutes.</t>
<t>hour. The unit of the element content is hours.</t>
<t>day.  The unit of the element content is days.</t>
<t>month.  The unit of the element content is months.</t>
<t>quarter.  The unit of the element content is quarters.</t>
<t>year.  The unit of the element content is years.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<t hangText="ext-duration"><vspace/>Optional.  STRING.  A means by which to extend the duration attribute.  See <xref target="extending_enums_private" />.</t>

</list></t>

</section> 

<section title="MonetaryImpact Class" anchor="monetaryimpact">
<t>The MonetaryImpact class describes the financial impact of the activity on an organization.  For example, this impact may consider losses due to the cost of the investigation or recovery, diminished productivity of the staff, or a tarnished reputation that will affect future opportunities.
</t>

<t>
<figure title="The MonetaryImpact Class" anchor="figure_monetary_impact_class">
<artwork><![CDATA[
+------------------+
| MonetaryImpact   |
+------------------+ 
| REAL             |
|                  |
| ENUM severity    |
| STRING currency  |
+------------------+
]]></artwork>
</figure></t>

<t>The content of the class is of type REAL and specifies a quantity of money.  The currency attribute defines the currency of this value.
</t>

<t>The attributes of the MonetaryImpact class are:
<list style="hanging">


<t hangText="severity"><vspace />Optional.  ENUM.  An estimate of the relative severity of the activity.  The permitted values are shown below.  There is no default value. 
	<list style="numbers">
		<t>low.  Low severity</t>
		<t>medium. Medium severity</t>
		<t>high. High severity</t>
	</list></t>

<t hangText="currency"><vspace />Optional.  STRING.  Defines the currency in which the value in the element content is expressed.  The permitted values are defined in "Codes for the representation of currencies" <xref target="ISO4217" />.  There is no default value.</t>
</list></t>

</section> 

<section title="Confidence Class" anchor="Confidence">

<t>The Confidence class represents an estimate of the validity and accuracy of data expressed in the document.  This estimate can be expressed as a category or a numeric calculation.
</t>

<t>
<figure title="The Confidence Class" anchor="figure_confidence_class">
<artwork><![CDATA[
+-------------------+
| Confidence        |
+-------------------+ 
| REAL              |
|                   |
| ENUM rating       |
| STRING ext-rating |
+-------------------+
]]></artwork>
</figure></t>

<t>The content of the class is of type REAL and specifies a numerical assessment in the confidence of the data when the value of the rating attribute is "numeric".  Otherwise, this element MUST be empty.
</t>

<t>The attributes of the Confidence class are:
<list style="hanging">
<t hangText="rating"><vspace />Required.  ENUM.  A qualitative assessment of confidence.  These values are maintained in the "Confidence-rating" IANA registry per <xref target="enum_value_registries" />
<list style="numbers">
<t>low.  Low confidence.</t>
<t>medium. Medium confidence.</t>
<t>high. High confidence.</t>
<t>numeric.  The element content contains a number that conveys the confidence of the data.  The semantics of this number is outside the scope of this specification.</t>
<t>unknown.  The confidence rating value is not known.</t>								
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<t hangText="ext-rating"><vspace/>Optional.  STRING.  A means by which to extend the rating attribute.  See <xref target="extending_enums_private" />.</t>

</list>
</t>

</section> 

</section>



<section title="History Class" anchor="History">
<t>The History class is a log of the significant events or actions performed by the involved parties during the course of handling the incident.
</t>
<t>The level of detail maintained in this log is left up to the discretion of those handling the incident.  
</t>
<t>
<figure title="The History Class" anchor="figure_history_class">
<artwork><![CDATA[
+------------------------+
| History                |
+------------------------+
| ENUM restriction       |<>--{1..*}--[ HistoryItem ]
| STRING ext-restriction |
+------------------------+        
]]></artwork></figure></t>

<t>The aggregate classes of the History class are:
<list style="hanging">
<t hangText="HistoryItem"><vspace/>One or more.  An entry in the history log of significant events or actions performed by the involved parties.  See <xref target="HistoryItem" />.
</t> 
</list>

	</t>

<t>The attributes of the History class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<section title="HistoryItem Class" anchor="HistoryItem">
<t>The HistoryItem class is an entry in the <xref target="History">History</xref> log that documents a particular action or event that occurred in the course of handling the incident.  The details of the entry are a free-form text description, but each can be categorized with the type attribute.
</t>

<t>
<figure title="The HistoryItem Class" anchor="figure_historyitem_class">
<artwork><![CDATA[
+-------------------------+
| HistoryItem             |
+-------------------------+ 
| ENUM action             |<>----------[ DateTime       ]
| STRING ext-action       |<>--{0..1}--[ IncidentID     ]
| ENUM restriction        |<>--{0..1}--[ Contact        ]
| STRING ext-restriction  |<>--{0..*}--[ Description    ]
| ID observable-id        |<>--{0..*}--[ DefinedCOA     ]
|                         |<>--{0..*}--[ AdditionalData ]
+-------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the HistoryItem class are:
<list style="hanging">

<t hangText="DateTime"><vspace/>One.  DATETIME.  A timestamp of this entry in the history log.
</t> 

<t hangText="IncidentID"><vspace/>Zero or one.  In a history log created by multiple parties, the IncidentID provides a mechanism to specify which CSIRT created a particular entry and references this organization's tracking number.  When a single organization is maintaining the log, this class can be ignored.  See <xref target="IncidentID" />.
</t> 

<t hangText="Contact"><vspace/>Zero or one.  Provides contact information for the entity that performed the action documented in this class.  See <xref target="Contact" />.
</t> 

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the action or event.
</t> 

<t hangText="DefinedCOA"><vspace/>Zero or more.  STRING.  An identifier meaningful to the sender and recipient of this document that references a course of action (COA).  This class MUST be present if the action attribute is set to "defined-coa".</t>

<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  A mechanism by which to extend the data model.</t> 
</list>
</t>

<t>The attributes of the HistoryItem class are:
<list style="hanging">

<t hangText="action"><vspace/>Required.  ENUM.  Classifies a performed action or occurrence documented in this history log entry.  As activity will likely have been instigated either through a previously conveyed expectation or through an internal investigation, this attribute is identical to the action attribute of the Expectation class.  The difference is only one of tense.  When an action is in this class, it has been completed.  See <xref target="Expectation" />.</t>

<t hangText="ext-action"><vspace/>Optional.  STRING.  A means by which to extend the action attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>

<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list>
</t>
</section>

</section> 

<section title="EventData Class" anchor="EventData">
<t>The EventData class is a container class to organize data about events that occurred during an incident.
</t>

<t>
<figure title="The EventData Class" anchor="figure_eventdata_class">
<artwork><![CDATA[
+-------------------------+
| EventData               |
+-------------------------+
| ENUM restriction        |<>--{0..*}--[ Description    ]
| STRING ext-restriction  |<>--{0..1}--[ DetectTime     ]
| ID observable-id        |<>--{0..1}--[ StartTime      ]
|                         |<>--{0..1}--[ EndTime        ]
|                         |<>--{0..1}--[ RecoveryTime   ]
|                         |<>--{0..1}--[ ReportTime     ]
|                         |<>--{0..*}--[ Contact        ]
|                         |<>--{0..*}--[ Discovery      ]
|                         |<>--{0..1}--[ Assessment     ]
|                         |<>--{0..*}--[ Method         ]
|                         |<>--{0..*}--[ Flow           ]
|                         |<>--{0..*}--[ Expectation    ]
|                         |<>--{0..1}--[ Record         ]
|                         |<>--{0..*}--[ EventData      ]
|                         |<>--{0..*}--[ AdditionalData ]
+-------------------------+
]]></artwork></figure></t>

<t>The aggregate classes of the EventData class are:
<list style="hanging">

<t hangText="Description"><vspace/> Zero or more.  ML_STRING.  A free-form text description of the event.</t> 

<t hangText="DetectTime"><vspace/>Zero or one.  DATETIME.  The time the event was detected.</t>

<t hangText="StartTime"><vspace/>Zero or one.  DATETIME.  The time the event started.</t>

<t hangText="EndTime"><vspace/>Zero or one.  DATETIME.  The time the event ended.</t>

<t hangText="RecoveryTime"><vspace/>Zero or one.  DATETIME.  The time the site recovered from the event.</t>

<t hangText="ReportTime"><vspace/>Zero or one.  DATETIME.  The time the event was reported.</t>

<t hangText="Contact"><vspace/>Zero or more.  Contact information for the parties involved in the event.  See <xref target="Contact" />.</t>

<t hangText="Discovery"><vspace/>Zero or more.  The means by which the event was detected.  See <xref target="Discovery" />.</t>

<t hangText="Assessment"><vspace/>Zero or one.  The impact of the event on the victim and the actions taken.  See <xref target="Assessment" />.</t>

<t hangText="Method"><vspace/>Zero or more.  The technique used by the threat actor in the event.  See <xref target="Method" />.</t>

<t hangText="Flow"><vspace/>Zero or more.  A description of the systems or networks involved.  See <xref target="Flow" />.</t>

<t hangText="Expectation"><vspace/>Zero or more.  The expected action to be performed by the recipient for the described event.  See <xref target="Expectation" />.</t>

<t hangText="Record"><vspace/>Zero or one.  Supportive data (e.g., log files) that provides additional information about the event.  See <xref target="Record" />.</t>

<t hangText="EventData"><vspace/>Zero or more.  A recursive definition of the EventData class.  See <xref target="eventdata_cardinality" /> for an explanation on using this class.</t>

<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  An extension mechanism for
data not explicitly represented in the data model.</t>
	</list>
   </t>

<t>At least one of the aggregate classes MUST be present in an instance of the EventData class.</t>

<t>The attributes of the EventData class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />. The default value is "default".</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>
	
					</list></t>

<section title="Relating the Incident and EventData Classes" anchor="Incident_Event">

<t>There is substantial overlap in the child classes aggregated in the Incident and EventData classes.  Nevertheless, the semantics of these classes are quite different.  The Incident class provides summary information about the entire incident, while the EventData class provides information about the individual events comprising the incident.  In the common case, the EventData class will provide more specific information for the general description provided in the Incident class.  However, in the case where the summarized information in the Incident class conflicts with the detailed information in an EventData class, the more specific EventData class MUST supersede the more generic information provided in the Incident class.
</t>
</section>

<section title="Recursive Definition of EventData" anchor="eventdata_cardinality">

<t>The EventData class is a container for the properties of an event in an incident.  These properties include: the hosts involved, impact of the incident activity on the hosts, forensic logs, etc.  The recursive definition of EventData allows for the grouping of related information with common properties.  This approach eliminates the need for explicit identifiers to relate information or duplicate it.  Instead, the relative depth (nesting) of a class is used to group (relate) information.
</t>

<t>
For example, consider a case where two hosts experience different impacts during an incident.  However, these two hosts have common contact information.  A depiction of how this situation would be represented can be found in <xref target="figure_reventdata_class" />.  EventData (2) and (3) group each of the two hosts with their unique impact.  EventData (1) describes the common Contact class these two hosts share.
</t>

<t>
<figure title="Recursion in the EventData Class" anchor="figure_reventdata_class">
<artwork><![CDATA[
+------------------+
| EventData (1)    |
+------------------+
|                  |<>----[ Contact    ]
|                  |
|                  |<>----[ EventData (2) ]<>----[ Flow       ]
|                  |      [               ]<>----[ Assessment ]
|                  |
|                  |<>----[ EventData (3) ]<>----[ Flow       ]
|                  |      [               ]<>----[ Assessment ]
+------------------+
]]></artwork></figure></t>
</section>

</section>  

<section title="Expectation Class" anchor="Expectation">
<t>The Expectation class conveys to the recipient of the IODEF document the actions the sender is requesting.

<figure title="The Expectation Class" anchor="figure_expectation_class">
<artwork><![CDATA[
+-------------------------+
| Expectation             |
+-------------------------+ 
| ENUM action             |<>--{0..*}--[ Description ]
| STRING ext-action       |<>--{0..*}--[ DefinedCOA  ]
| ENUM severity           |<>--{0..1}--[ StartTime   ]
| ENUM restriction        |<>--{0..1}--[ EndTime     ]
| STRING ext-restriction  |<>--{0..1}--[ Contact     ]
| ID observable-id        | 
+-------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Expectation class are:

<list style="hanging">
<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the desired action(s).</t>

<t hangText="DefinedCOA"><vspace/>Zero or more.  STRING.  A unique identifier meaningful to the sender and recipient of this document that references a course of action.  This class MUST be present if the action attribute is set to "defined-coa".</t>

<t hangText="StartTime"><vspace/>Zero or one.  DATETIME.  The time at which the sender would like the action performed.  A timestamp that is earlier than the ReportTime specified in the Incident class denotes that the sender would like the action performed as soon as possible.  The absence of this element indicates no expectations of when the recipient would like the action performed.</t>

<t hangText="EndTime"><vspace/>Zero or one.  DATETIME.  The time by which the sender expects the recipient to complete the action.  If the recipient cannot complete the action before EndTime, the recipient MUST NOT carry out the action.  Because of transit delays and clock drift, the sender MUST be prepared for the recipient to have carried out the action, even if it completes past EndTime.</t>

<t hangText="Contact"><vspace/>Zero or one.  The entity expected to perform the action.  See <xref target="Contact" />.</t>
</list></t>
	
<t>The attributes of the Expectation class are:
<list style="hanging">

<t hangText="action"><vspace/>Optional.  ENUM.  Classifies the type of action requested.  The default value of "other".  These values are maintained in the "Expectation-action" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>nothing.  No action is requested.  Do nothing with the information.</t>
<t>contact-source-site.  Contact the site(s) identified as the source of the activity.</t>
<t>contact-target-site.  Contact the site(s) identified as the target of the activity.</t>
<t>contact-sender.  Contact the originator of the document.</t>
<t>investigate.  Investigate the system(s) listed in the event.</t>
<t>block-host.  Block traffic from the machine(s) listed as sources in the event.</t>
<t>block-network. Block traffic from the network(s) lists as sources in the event.</t>
<t>block-port. Block the port listed as sources in the event.</t>
<t>rate-limit-host.  Rate-limit the traffic from the machine(s) listed as sources in the event.</t>
<t>rate-limit-network. Rate-limit the traffic from the network(s) lists as sources in the event.</t>
<t>rate-limit-port. Rate-limit the port(s) listed as sources in the event.</t>
<t>redirect-traffic. Redirect traffic from the intended recipient for further analysis.</t>
<t>honeypot. Redirect traffic from systems listed in the event to a honeypot for further analysis.</t> 
<t>upgrade-software.  Upgrade or patch the software or firmware on an asset listed in the event.</t>
<t>rebuild-asset.  Reinstall the operating system or applications on an asset listed in the event.</t>
<t>harden-asset. Change the configuration of an asset listed in the event to reduce the attack surface.</t>
<t>remediate-other. Remediate the activity in a way other than by rate-limiting or blocking.</t>
<t>status-triage.  Confirm receipt and begin triaging the incident.</t>
<t>status-new-info.  Notify the sender when new information is  received for this incident.</t>
<t>watch-and-report.  Watch for the described activity or indicators, and notify the sender when seen.</t>
<t>training. Train user to identify or mitigate the described threat.</t>
<t>defined-coa.  Perform a predefined course of action (COA).  The COA is named in the DefinedCOA class.</t>
<t>other.  Perform a custom action described in the Description class.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<t hangText="ext-action"><vspace/>Optional.  STRING.  A means by which to extend the action	attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="severity"><vspace/>Optional.  ENUM.  Indicates the desired priority
of the action.   This attribute is an enumerated list with no default value, and the semantics of these relative measures are context dependent.

<list style="numbers">
<t>low.  Low priority</t>
<t>medium. Medium priority</t>
<t>high. High priority</t>
</list></t>

<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />. The default value is "default".</t>

<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>


<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>

</list></t>
	
</section>  

<section title="Flow Class" anchor="Flow">
<t>The Flow class describes the systems and networks involved in the incident and the relationships between them.
</t>

<t>
<figure title="The Flow Class" anchor="figure_flow_class">
<artwork><![CDATA[
+------------------+
| Flow             |
+------------------+
|                  |<>--{1..*}--[ System   ]
+------------------+
]]></artwork>
</figure></t>

<t>The aggregate class of the Flow class is:

<list style="hanging">
<t hangText="System"><vspace/>One or More. A host or network involved in an event.  See <xref target="System" />.</t>
</list>
</t>

<t>The Flow class has no attributes.</t>

</section> 

<section title="System Class" anchor="System">
<t>
The System class describes a system or network involved in an event.

<figure title="The System Class" anchor="figure_system_class">
<artwork><![CDATA[
+------------------------+
| System                 |
+------------------------+
| ENUM category          |<>----------[ Node            ]
| STRING ext-category    |<>--{0..*}--[ NodeRole        ]
| STRING interface       |<>--{0..*}--[ Service         ]
| ENUM spoofed           |<>--{0..*}--[ OperatingSystem ]
| ENUM virtual           |<>--{0..*}--[ Counter         ]
| ENUM ownership         |<>--{0..*}--[ AssetID         ]
| STRING ext-ownership   |<>--{0..*}--[ Description     ]
| ENUM restriction       |<>--{0..*}--[ AdditionalData  ]
| STRING ext-restriction |
| ID observable-id       |
+------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the System class are:

<list style="hanging">
<t hangText="Node"><vspace/>One.  A host or network involved in the incident.  See <xref target="Node" />.</t>

<t hangText="NodeRole"><vspace/>Zero or more.  The intended purpose of the system.  See <xref target="NodeRole" />.</t>

<t hangText="Service"><vspace/>Zero or more.  A network service running on the system.  See <xref target="Service" />.</t>

<t hangText="OperatingSystem"><vspace/>Zero or more.  SOFTWARE.  The operating system running on the system.</t>

<t hangText="Counter"><vspace/>Zero or more.  A counter with which to summarize properties of this host or network.  See <xref target="Counter" />.</t>

<t hangText="AssetID"><vspace/>Zero or more.  STRING. An asset identifier for the System.</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the System.</t>

<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  A mechanism by which to extend the data model.</t> 
</list>
</t>

<t>The attributes of the System class are:
<list style="hanging">

<t hangText="category"><vspace/>Optional.  ENUM.  Classifies the role the host or network played in the incident.  These values are maintained in the "System-category" IANA registry per <xref target="enum_value_registries" />.
<list style="numbers">

<t>source.  The System was the source of the event.</t>
<t>target.  The System was the target of the event.</t>
<t>intermediate.  The System was an intermediary in the event.</t>
<t>sensor.  The System was a sensor monitoring the event.</t>
<t>infrastructure.  The System was an infrastructure node of the IODEF document exchange.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-category"><vspace/>Optional.  STRING.  A means by which to extend the category attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="interface"><vspace/>Optional.  STRING.  Specifies the interface on which the event(s) on this System originated.  If the Node class specifies a network rather than a host, this attribute has no meaning.
</t>

<t hangText="spoofed"><vspace/>Optional.  ENUM.  An indication of confidence in whether this System was the true target or attacking host.  The permitted values for this attribute are shown below.  The default value is "unknown".

<list style="numbers">
<t>unknown.  The accuracy of the category attribute value is unknown.</t>

<t>yes.  The category attribute value is likely incorrect.  In the case of a source, the System is likely a decoy; with a target, the System was likely not the intended victim.</t>

<t>no.  The category attribute value is believed to be correct.</t>
</list>
</t>

<t hangText="virtual"><vspace/>Optional.  ENUM.  Indicates whether this System is a virtual or physical device.  The default value is "unknown".

<list style="numbers">
<t>yes.  The System is a virtual device.</t>
<t>no.  The System is a physical device.</t>
<t>unknown.  It is not known if the System is virtual.</t>
</list>
</t>

<t hangText="ownership"><vspace/>Optional.  ENUM.  Describes the ownership of this System relative to the victim in the incident.  These values are maintained in the "System-ownership" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>organization.  Corporate or enterprise owned.</t>
<t>personal.  Personally owned by an employee or affiliate of the corporation or enterprise.</t>
<t>partner.  Owned by a partner of the corporation or enterprise.</t>
<t>customer.  Owned by a customer of the corporation or enterprise.</t>
<t>no-relationship.  Owned by an entity that has no known relationship with the victim organization.</t>
<t>unknown.  Ownership is unknown.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-ownership"><vspace/>Optional.  STRING.  A means by which to extend the ownership attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>

<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>

</list></t>

</section> 

<section title="Node Class" anchor="Node">
<t>The Node class identifies a system, asset, or network and its location.</t>

<t>
<figure title="The Node Class" anchor="figure_node_class">
<artwork><![CDATA[
+---------------+
| Node          |
+---------------+
|               |<>--{0..*}--[ DomainData    ]
|               |<>--{0..*}--[ Address       ]
|               |<>--{0..1}--[ PostalAddress ]
|               |<>--{0..*}--[ Location      ]
|               |<>--{0..*}--[ Counter       ]
+---------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Node class are:
<list style="hanging">

<t hangText="DomainData"><vspace/>Zero or more.  The domain (DNS) information associated with this node.  If an Address is not provided, at least one DomainData MUST be specified.  See <xref target="DomainData" />.
</t>

<t hangText="Address"><vspace/>Zero or more.  The hardware, network, or application address of the node.  If a DomainData is not provided, at least one Address MUST be specified.  See <xref target="Address" />.
</t>

<t hangText="PostalAddress"><vspace/>Zero or one.  POSTAL.  The postal address of the node.
</t>

<t hangText="Location"><vspace/>Zero or more.  ML_STRING.  A free-form text
description of the physical location of the node.  This description may
provide a more detailed description of where at the address specified by the
PostalAddress class this node is found (e.g., room number, rack number, or slot number in a chassis).
</t>

<t hangText="Counter"><vspace/>Zero or more.  A counter with which to summarize properties of this host or network.  See <xref target="Counter" />.</t>
</list>
</t>
<t>The Node class has no attributes.</t>

<section title="Address Class" anchor="Address">
<t>The Address class represents a hardware (Layer 2), network (Layer 3), or application (Layer 7) address.
</t>

<t>
<figure title="The Address Class" anchor="figure_address_class">
<artwork><![CDATA[
+-------------------------+
| Address                 |
+-------------------------+  
| STRING                  |
|                         |
| ENUM category           |
| STRING ext-category     |
| STRING vlan-name        |
| INTEGER vlan-num        |
| ID observable-id        |
+-------------------------+
]]></artwork>
</figure></t>

<t>The content of the class is an address of type STRING whose semantics are determined by the category attribute.</t>

<t>The attributes of the Address class are:
<list style="hanging">
<t hangText="category"><vspace/>Required.  ENUM.  The type of address represented.  The default value is "ipv6-addr".  These values are maintained in the "Address-category" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>asn.  Autonomous System Number.</t>
<t>atm.  Asynchronous Transfer Mode (ATM) address.</t>
<t>e-mail.   Email address, per the EMAIL data type.</t>
<t>ipv4-addr.  IPv4 host address in dotted-decimal notation (i.e., a.b.c.d).</t>
<t>ipv4-net.  IPv4 network address in dotted-decimal notation, slash, significant bits (i.e., a.b.c.d/nn).</t>
<t>ipv4-net-masked.  A sanitized IPv4 address with significant bits per "ipv4-net" but with the character 'x' replacing any digit(s) in the address or prefix.</t> 
<t>ipv4-net-mask.  IPv4 network address in dotted-decimal notation, slash, network mask in dotted-decimal notation (i.e., a.b.c.d/w.x.y.z).</t>
<t>ipv6-addr.  IPv6 host address per Section 4 of <xref target="RFC5952" />.</t>
<t>ipv6-net.  IPv6 network address, slash, prefix per Section 2.3 of <xref target="RFC4291" />.</t>
<t>ipv6-net-masked.  A sanitized IPv6 address and prefix per "ipv6-net" but with the character 'x' replacing any hexadecimal digit(s) in the address or digit(s) in the prefix.</t> 
<t>mac.  Media Access Control (MAC) address (i.e., aa:bb:cc:dd:ee:ff).</t>
<t>site-uri.  A URL or URI for a resource, per the URL data type.</t>				
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-category"><vspace/>Optional.  STRING.  A means by which to extend the category attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="vlan-name"><vspace/>Optional.  STRING.  The name of the Virtual LAN to which the address belongs.</t>
<t hangText="vlan-num"><vspace/>Optional.  INTEGER.  The number of the Virtual LAN to which the address belongs.</t>
<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list>
</t>
</section> 

<section title="NodeRole Class" anchor="NodeRole">
<t>The NodeRole class describes the function performed by or role of a particular system, asset, or network.</t>

<t>
<figure title="The NodeRole Class" anchor="figure_noderole_class">
<artwork><![CDATA[
+-----------------------+
| NodeRole              |
+-----------------------+
| ENUM category         |<>--{0..*}--[ Description ]
| STRING ext-category   |
+-----------------------+
]]></artwork>
</figure></t>

<t>The aggregate class of the NodeRole class is:
<list style="hanging">
<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the role of the system.</t>
</list>
</t>

<t>The attributes of the NodeRole class are:
<list style="hanging">
<t hangText="category"><vspace />Required.  ENUM.  Function or role of a node. These values are maintained in the "NodeRole-category" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>client.  Client computer.</t>
<t>client-enterprise.  Client computer on the enterprise network.</t>
<t>client-partner.  Client computer on network of a partner.</t>
<t>client-remote.  Client computer remotely connected to the enterprise network.</t>
<t>client-kiosk.  Client computer serving as a kiosk.</t>
<t>client-mobile.  Mobile device.</t>
<t>server-internal.  Server with internal services.</t>
<t>server-public.  Server with public services.</t>
<t>www.  WWW server.</t>
<t>mail.  Mail server.</t>
<t>webmail.  Web mail server.</t>
<t>messaging.  Messaging server (e.g., NNTP, IRC, IM).</t>
<t>streaming.  Streaming-media server.</t>
<t>voice.  Voice server (e.g., SIP, H.323).</t>
<t>file.  File server.</t>
<t>ftp.  FTP server.</t>
<t>p2p.  Peer-to-peer node.</t>
<t>name.  Name server (e.g., DNS, WINS).</t>
<t>directory.  Directory server (e.g., LDAP, finger, whois).</t>
<t>credential.  Credential server (e.g., domain controller, Kerberos).</t>
<t>print.  Print server.</t>
<t>application.  Application server.</t>
<t>database.  Database server.</t>
<t>backup.  Backup server.</t>
<t>dhcp.  DHCP server.</t>
<t>assessment. Assessment server (e.g., vulnerability scanner, endpoint assessment).</t>
<t>source-control. Source code control server.</t> 
<t>config-management.  Configuration management server.</t>
<t>monitoring. Security monitoring server (e.g., IDS).</t>  
<t>infra.  Infrastructure server (e.g., router, firewall, DHCP).</t>
<t>infra-firewall.  Firewall.</t>
<t>infra-router.  Router.</t>
<t>infra-switch.  Switch.</t>
<t>camera.  Camera and video system.</t>
<t>proxy.  Proxy server.</t>
<t>remote-access.  Remote access server.</t>
<t>log.  Log server (e.g., syslog).</t>
<t>virtualization.  Server running virtual machines.</t>
<t>pos.  Point-of-sale device.</t>
<t>scada. Supervisory control and data acquisition (SCADA) system.</t>
<t>scada-supervisory. Supervisory system for a SCADA.</t>
<t>sinkhole. Traffic sinkhole destination.</t>
<t>honeypot. Honeypot server.</t>
<t>anonymization.  Anonymization server (e.g., Tor node).</t>
<t>c2-server. Malicious command and control server.</t>
<t>malware-distribution. Server that distributes malware</t>
<t>drop-server. Server to which exfiltrated content is uploaded.</t>
<t>hop-point. Intermediary server used to get to a victim.</t>
<t>reflector. A system used in a reflector attack.</t>
<t>phishing-site. Site hosting phishing content.</t>
<t>spear-phishing-site. Site hosting spear-phishing content.</t>
<t>recruiting-site. Site to recruit.</t>
<t>fraudulent-site. Fraudulent site.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>	

<t hangText="ext-category"><vspace/>Optional.  STRING.  A means by which to extend the category attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

</section> 

<section title="Counter Class" anchor="Counter">
<t>The Counter class summarizes multiple occurrences of an  event or conveys counts or rates of various features.
</t>

<t>The complete semantics of this class are context dependent based on the class in which it is aggregated.</t>

<t>
<figure title="The Counter Class" anchor="figure_counter_class">
<artwork><![CDATA[
+---------------------+
| Counter             |
+---------------------+
| REAL                |
|                     |
| ENUM type           |
| STRING ext-type     |
| ENUM unit           |
| STRING ext-unit     |
| STRING meaning      |
| ENUM duration       |
| STRING ext-duration |
+---------------------+
]]></artwork>
</figure></t>

<t>The content of the class is a value of type REAL whose meaning and units are determined by the type and duration attributes, respectively. 

 If the duration attribute is present, the element content is a rate.  Otherwise, it is a simple counter.</t>

<t>The attributes of the Counter class are:
<list style="hanging">

<t hangText="type"><vspace/>Required.  ENUM.  Specifies the type of counter specified in the element content.  These values are maintained in the "Counter-type" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>count.  The Counter class value is a counter.</t>
<t>peak.  The Counter class value is a peak value.</t>
<t>average.  The Counter class value is an average.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-type"><vspace/>Optional.  STRING.  A means by which to extend the type attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="unit"><vspace/>Required.  ENUM.  Specifies the units of the element content.  These values are maintained in the "Counter-unit" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>byte.  Bytes transferred.</t>
<t>mbit.  Megabits (Mbits) transferred.</t>
<t>packet.  Packets.</t>
<t>flow.  Network flow records.</t>
<t>session.  Sessions.</t>
<t>alert.  Notifications generated by another system (e.g., IDS or SIEM system).</t>
<t>message.  Messages (e.g., mail messages).</t>
<t>event.  Events.</t>
<t>host.  Hosts.</t>
<t>site.  Site.</t>
<t>organization.  Organizations.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-unit"><vspace/>Optional.  STRING.  A means by which to extend the unit attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="meaning"><vspace/>Optional.  STRING.  A free-form text description of the metric represented by the Counter.</t>

<t hangText="duration"><vspace/>Optional.  ENUM.  If present, the Counter class represents a rate. This attribute specifies a unit of time over which the rate whose units are specified in the unit attribute is being conveyed.  This attribute is the denominator of the rate (where the unit attribute specified the nominator).  The possible values of this attribute are defined in the duration attribute of <xref target="TimeImpact" /></t>

<t hangText="ext-duration"><vspace/>Optional.  STRING.  A means by which to extend the duration attribute.  See <xref target="extending_enums_private" />.</t>

</list>
</t>

</section> 

</section> 

<section title="DomainData Class" anchor="DomainData">
<t>The DomainData class describes a domain name and metadata associated with this domain.</t>

<t>
<figure title="The DomainData Class" anchor="figure_domaindata_class">
<artwork><![CDATA[
+--------------------------+
| DomainData               |
+--------------------------+
| ENUM system-status       |<>----------[ Name                 ]
| STRING ext-system-status |<>--{0..1}--[ DateDomainWasChecked ]
| ENUM domain-status       |<>--{0..1}--[ RegistrationDate     ]
| STRING ext-domain-status |<>--{0..1}--[ ExpirationDate       ]
| ID observable-id         |<>--{0..*}--[ RelatedDNS           ]
|                          |<>--{0..*}--[ Nameservers          ]
|                          |<>--{0..1}--[ DomainContacts       ]
+--------------------------+
]]></artwork></figure></t>

<t>The aggregate classes of the DomainData class are:
<list style="hanging">

<t hangText="Name"><vspace/>One.  STRING.  The domain name of a system.</t>

<t hangText="DateDomainWasChecked"><vspace/>Zero or one.  DATETIME.  A timestamp of when the domain listed in the Name class was resolved.</t>

<t hangText="RegistrationDate"><vspace/>Zero or one.  DATETIME.  A timestamp of when domain listed in the Name class was registered.</t>

<t hangText="ExpirationDate"><vspace/>Zero or one.  DATETIME.  A timestamp of when the domain listed in the Name class is set to expire.</t>

<t hangText="RelatedDNS"><vspace/>Zero or more.  EXTENSION.  Additional DNS records associated with this domain.</t>

<t hangText="Nameservers"><vspace/>Zero or more.  The nameservers identified for the domain listed in the Name class.  See <xref target="Nameservers" />.</t>

<t hangText="DomainContacts"><vspace/>Zero or one.  Contact information for the domain listed in the Name class supplied by the registrar or through a whois query.</t>

</list>
</t>

<t>The attributes of the DomainData class are:
<list style="hanging">

<t hangText="system-status"><vspace/>Required.  ENUM.  Assesses the domain's involvement in the event.  These values are maintained in the "DomainData-system-status" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>spoofed.  This domain was spoofed.</t>
<t>fraudulent. This domain was operated with fraudulent intentions.</t>
<t>innocent-hacked. This domain was compromised by a third party.</t>
<t>innocent-hijacked. This domain was deliberately hijacked.</t>
<t>unknown.  No categorization for this domain known. </t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-system-status"><vspace/>Optional.  STRING.  A means by which to extend the system-status attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="domain-status"><vspace/>Required.  ENUM.  Categorizes the registry status of the domain at the time the document was generated.  These values and their associated descriptions are derived from Section 3.2.2 of <xref target="RFC3982" />.  These values are maintained in the "DomainData&nbhy;domain&nbhy;status" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>reservedDelegation.  The domain is permanently inactive.</t>
<t>assignedAndActive.  The domain is in a normal state.</t>
<t>assignedAndInactive.  The domain has an assigned registration, but the delegation is inactive.</t>
<t>assignedAndOnHold.  The domain is in dispute.</t>
<t>revoked.  The domain is in the process of being purged from the database.</t>
<t>transferPending.  The domain is pending a change in authority.</t>
<t>registryLock.  The domain is on hold by the registry.</t>
<t>registrarLock.  Same as "registryLock".</t>
<t>other.  The domain has a known status, but it is not one of the redefined enumerated values. </t>
<t>unknown.  The domain has an unknown status.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-domain-status"><vspace/>Optional.  STRING.  A means by which to extend the domain-status attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list>
</t>

<section title="Nameservers Class" anchor="Nameservers">
<t>The Nameservers class describes the nameservers associated with a given domain.</t>
<t>
<figure title="The Nameservers Class" anchor="figure_nameservers_class">
<artwork><![CDATA[
+--------------------+
| Nameservers        |
+--------------------+
|                    |<>----------[ Server  ]
|                    |<>--{1..*}--[ Address ]
+--------------------+
]]></artwork></figure></t>

<t>The aggregate classes of the Nameservers class are:
<list style="hanging">

<t hangText="Server"><vspace/>One.  STRING.  The domain name of the nameserver.</t>

<t hangText="Address"><vspace/>One or more.  The address of the nameserver.  The value of the category attribute MUST be either "ipv4-addr" or "ipv6-addr".  See <xref target="Address" />.</t>
</list>
</t>

<t>The Nameservers class has no attributes.</t>

</section> 

<section title="DomainContacts Class" anchor="DomainContacts">
<t>The DomainContacts class describes the contact information for a given domain provided either by the registrar or through a whois query.</t>

<t> This contact information can be explicitly described through a Contact class, or a reference can be provided to a domain with identical contact information.  Either a single SameDomainContact or one or more Contact classes MUST be present.</t>
<t>
<figure title="The DomainContacts Class" anchor="figure_domaincontacts_class">
<artwork><![CDATA[
+--------------------+
| DomainContacts     |
+--------------------+
|                    |<>--{0..1}--[ SameDomainContact ]
|                    |<>--{1..*}--[ Contact ]
+--------------------+
]]></artwork></figure></t>

<t>The aggregate classes of the DomainContacts class are:
<list style="hanging">

<t hangText="SameDomainContact"><vspace/>Zero or one.  STRING.  A domain name already cited in this document or through previous exchange that contains the identical contact information as the domain name in question.  The domain contact information associated with this domain should be used instead of an explicit definition with the Contact class.</t>

<t hangText="Contact"><vspace/>One or more.  Contact information for the domain. See <xref target="Contact" />.</t>
</list>
</t>

<t>The DomainContacts class has no attributes.</t>

</section> 

</section> 

<section title="Service Class" anchor="Service">
<t>The Service class describes a network service. The service is described by a protocol, port, protocol header field, and application providing or using the service.
</t>

<t>
<figure title="The Service Class" anchor="figure_service_class">
<artwork><![CDATA[
+-------------------------+
| Service                 |
+-------------------------+
| INTEGER ip-protocol     |<>--{0..1}--[ ServiceName       ]                  
| ID observable-id        |<>--{0..1}--[ Port              ]
|                         |<>--{0..1}--[ Portlist          ]
|                         |<>--{0..1}--[ ProtoCode         ]
|                         |<>--{0..1}--[ ProtoType         ]
|                         |<>--{0..1}--[ ProtoField        ]
|                         |<>--{0..1}--[ ApplicationHeader ]
|                         |<>--{0..1}--[ EmailData         ]
|                         |<>--{0..1}--[ Application       ]
+-------------------------+
]]></artwork></figure></t>


<t>The aggregate classes of the Service class are:
<list style="hanging">

<t hangText="ServiceName"><vspace/>Zero or one.  A protocol name.</t>

<t hangText="Port"><vspace/>Zero or one.  INTEGER.  A port number.</t>

<t hangText="Portlist"><vspace/>Zero or one.  PORTLIST.  A list of port numbers.
</t>

<t hangText="ProtoCode"><vspace/>Zero or one.  INTEGER.  A transport-layer (Layer 4) protocol-specific code field (e.g., ICMP code field).
</t>

<t hangText="ProtoType"><vspace/>Zero or one.  INTEGER.  A transport-layer (Layer 4) protocol-specific type field (e.g., ICMP type field). 
</t>

<t hangText="ProtoField"><vspace/>Zero or one.  INTEGER.  A transport-layer (Layer 4) protocol-specific flag field (e.g., TCP flag field).
</t>

<t hangText="ApplicationHeader"><vspace/>Zero or one.  A protocol header.  See <xref target="ApplicationHeader" />.
</t>

<t hangText="EmailData"><vspace/>Zero or one.  Headers associated with an email message.  See <xref target="EmailData" />.
</t>

<t hangText="Application"><vspace/>Zero or one.  SOFTWARE.  The application acting as either the client or the server for the service.
</t>
</list>
</t>

<t>At least one of these classes MUST be present.</t>

<t>When a given System class with category="source" and another with category="target" are aggregated into a single Flow class, and each of these System classes has a Service and Portlist class, an implicit relationship between these Portlists exists.  If N ports are listed for a System@category="source", and M ports are listed for System@category="target", the number of ports in N must be equal to M.  Likewise, the ports MUST be listed in an identical sequence such that the n-th port in the source corresponds to the n-th port of the target.  If N is greater than 1, a given instance of a Flow class MUST only have a single instance of a System@category="source" and System@category="target".</t>

<t>The attributes of the Service class are:
<list style="hanging">
<t hangText="ip-protocol"><vspace />Optional. INTEGER.   The IANA-assigned IP protocol number per <xref target="IANA.Protocols" />.  The attribute MUST be set if a Port, Portlist, ProtoCode, ProtoType, or ProtoField class is present.</t>
<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list>
</t>

<section title="ServiceName Class" anchor="ServiceName">
<t>The ServiceName class identifies an application protocol.  It can be described by referencing an IANA-registered protocol, by referencing a URL, or with free-form text.
</t>

<t> 
<figure title="The ServiceName Class" anchor="figure_servicename_class">
<artwork><![CDATA[
+--------------------+
| ServiceName        |
+--------------------+
|                    |<>--{0..1}--[ IANAService       ]
|                    |<>--{0..*}--[ URL               ]
|                    |<>--{0..*}--[ Description       ] 
+--------------------+
]]></artwork>
</figure>
</t>
 
<t>The aggregate classes of the ServiceName class are:
<list style="hanging">
<t hangText="IANAService"><vspace/>Zero or one.  STRING.  The name of the service per the "Service Name" field of the registry <xref target="IANA.Ports" />.</t>

<t hangText="URL"><vspace/>Zero or more.  URL.  A URL to a resource describing the service.</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the service.</t>
</list>
</t>

<t>At least one of these classes MUST be present.</t>
							
<t>The ServiceName class has no attributes.</t>

</section> 


<section title="ApplicationHeader Class" anchor="ApplicationHeader">
<t>The ApplicationHeader class describes arbitrary fields from a protocol header and its corresponding value.</t>

<t>
<figure title="The ApplicationHeader Class" anchor="figure_applicationheader_class">
<artwork><![CDATA[
+--------------------------+
| ApplicationHeader        |
+--------------------------+
|                          |<>--{1..*}--[ ApplicationHeaderField ]
+--------------------------+
]]></artwork></figure></t>

<t>The aggregate class of the ApplicationHeader class is:
<list style="hanging">
<t hangText="ApplicationHeaderField"><vspace/>One or more.  EXTENSION.  A field name and value in a protocol header.  The name attribute MUST be set to the field name.  The field value MUST be set in the element content.
</t>
</list>
</t>

<t>The ApplicationHeader class has no attributes.</t>
</section> 

</section> 

<section title="EmailData Class" anchor="EmailData">
<t>The EmailData class describes headers from an email message and cryptographic hashes and signatures applied to it.</t>

<t>
<figure title="EmailData Class" anchor="figure_emaildata_class">
<artwork><![CDATA[
+-------------------------+
| EmailData               |
+-------------------------+
| ID observable-id        |<>--{0..*}--[ EmailTo          ]
|                         |<>--{0..1}--[ EmailFrom        ]
|                         |<>--{0..1}--[ EmailSubject     ]
|                         |<>--{0..1}--[ EmailX-Mailer    ]
|                         |<>--{0..*}--[ EmailHeaderField ]
|                         |<>--{0..1}--[ EmailHeaders     ]
|                         |<>--{0..1}--[ EmailBody        ]
|                         |<>--{0..1}--[ EmailMessage     ]
|                         |<>--{0..*}--[ HashData         ]
|                         |<>--{0..*}--[ SignatureData    ]
+-------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the EmailData class are:
<list style="hanging">
<t hangText="EmailTo"><vspace/>Zero or more.  EMAIL.  The value of the "To:" header field (Section 3.6.3 of <xref target="RFC5322" />) in an email.</t>
<t hangText="EmailFrom"><vspace/>Zero or one.  EMAIL.  The value of the "From:" header field (Section 3.6.2 of <xref target="RFC5322" />) in an email.</t>

<t hangText="EmailSubject"><vspace/>Zero or one.  STRING.  The value of the "Subject:" header field in an email.  See Section 3.6.5 of <xref target="RFC5322" />.</t>
<t hangText="EmailX-Mailer"><vspace/>Zero or one.  STRING.  The value of the "X-Mailer:" header field in an email.</t>
<t hangText="EmailHeaderField"><vspace/>Zero or more.  EXTENSION.  The header name and value of an arbitrary header field of the email message.  The name attribute MUST be set to the header name.  The header value MUST be set in the element body.  The dtype attribute MUST be set to "string". </t>
<t hangText="EmailHeaders"><vspace/>Zero or one.  STRING.  The headers of an email message.</t>
<t hangText="EmailBody"><vspace/>Zero or one.  STRING.  The body of an email message.</t>
<t hangText="EmailMessage"><vspace/>Zero or one.  STRING.  The headers and body of an email message.</t>
<t hangText="HashData"><vspace />Zero or more.  Hash(es) associated with this email message.  See <xref target="HashData" />.</t>
<t hangText="SignatureData"><vspace />Zero or more.  Signature(s) associated with this email message.  See <xref target="SignatureData" />.</t>

</list>
</t>

<t>The attribute of the EmailData class is:
<list style="hanging">
<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list>
</t>

</section> 

<section title="Record Class" anchor="Record">
<t>The Record class is a container class for log and audit data that provides supportive information about the events in an incident.  The source of this data will often be the output of monitoring tools.  These logs substantiate the activity described in the document.</t>
<t>
<figure title="The Record Class" anchor="figure_record_class">
<artwork><![CDATA[
+------------------------+
| Record                 |
+------------------------+
| ENUM restriction       |<>--{1..*}--[ RecordData ]
| STRING ext-restriction |
+------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Record class are:
<list style="hanging">

<t hangText="RecordData"><vspace/>One or more.  Log or audit data generated by a particular tool.  Separate instances of the RecordData class SHOULD be used for each type of log.  See <xref target="RecordData" />.
</t>
</list>
</t>

<t>The attributes of the Record class are:

<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<section title="RecordData Class" anchor="RecordData">
<t>The RecordData class describes or references log or audit data from a given type of tool and provides a means to annotate the output.
   </t>
   <t>
<figure title="The RecordData Class" anchor="figure_recorddata_class">
<artwork><![CDATA[
+------------------------+
| RecordData             |
+------------------------+
| ENUM restriction       |<>--{0..1}--[ DateTime               ]
| STRING ext-restriction |<>--{0..*}--[ Description            ]
| ID observable-id       |<>--{0..1}--[ Application            ]
|                        |<>--{0..*}--[ RecordPattern          ]
|                        |<>--{0..*}--[ RecordItem             ] 
|                        |<>--{0..*}--[ URL                    ]                 
|                        |<>--{0..*}--[ FileData               ]
|                        |<>--{0..*}--
|                        |       [ WindowsRegistryKeysModified ]
|                        |<>--{0..*}--[ CertificateData        ]
|                        |<>--{0..*}--[ AdditionalData         ]
+------------------------+
]]></artwork>
</figure></t>
					
<t>The aggregate classes of the RecordData class are:
<list style="hanging">
<t hangText="DateTime"><vspace/>Zero or one.  DATETIME.  A timestamp of the data found in the RecordItem or URL classes.</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of the data provided in the RecordItem or URL classes.</t>

<t hangText="Application"><vspace/>Zero or one.  SOFTWARE.  Identifies the tool used to generate the data in the RecordItem or URL classes.</t>

<t hangText="RecordPattern"><vspace/>Zero or more.  A search string to precisely find the relevant data in the RecordItem or URL classes.  See <xref target="RecordPattern" />.</t>

<t hangText="RecordItem"><vspace/>Zero or more.  EXTENSION.  Log, audit, or forensic data to support the conclusions made during the course of analyzing the incident.</t>

<t hangText="URL"><vspace/>Zero or more.  URL.  A URL reference to a log or audit data.</t>

<t hangText="FileData"><vspace/>Zero or one.  The files involved in the incident.  See <xref target="FileData" />.</t>

<t hangText="WindowsRegistryKeysModified"><vspace/>Zero or more.  The registry keys that were involved in the incident.  See <xref target="WindowsRegistryKeysModified" />.</t>

<t hangText="CertificateData"><vspace/>Zero or more.  The certificates that were involved in the incident.  See <xref target="CertificateData" />.</t>

<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  An extension mechanism for data not explicitly represented in the data model.</t>

</list>
</t>

<t>At least one of the following classes MUST be present: RecordItem, URL, FileData, WindowsRegistryKeysModified, CertificateData, or AdditionalData.</t>

<t>The attributes of the RecordData class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
<t hangText="observable-id"><vspace/>Optional.  ID.  See <xref target="observableid_attribute" />.</t>

</list>
</t>
</section>

<section title="RecordPattern Class" anchor="RecordPattern">
<t>The RecordPattern class describes where in the log data provided or referenced in the RecordData class relevant information can be found.  It provides a way to reference subsets of information, identified by a pattern, in a large log file, audit trail, or forensic data.
</t>
<t>
<figure title="The RecordPattern Class" anchor="figure_recordpattern_class">
<artwork><![CDATA[
+-----------------------+
| RecordPattern         |
+-----------------------+
| STRING                |
|                       |
| ENUM type             |
| STRING ext-type       |
| INTEGER offset        |
| ENUM offsetunit       |
| STRING ext-offsetunit |
| INTEGER instance      |
+-----------------------+
]]></artwork>
</figure></t>

<t>The content of the class is of type STRING and specifies a search pattern.</t>

<t>The attributes of the RecordPattern class are:
<list style="hanging">
<t hangText="type"><vspace />Required.  ENUM.  Describes the type of pattern being specified in the element content.  The default is "regex".  These values are maintained in the "RecordPattern-type" IANA registry per <xref target="enum_value_registries" />.

<list style="numbers">
<t>regex.  Regular expression as defined by POSIX Extended Regular Expressions (ERE) in Chapter 9 of <xref target="IEEE.POSIX"/>.</t>
<t>binary. Binhex-encoded binary pattern, per the HEXBIN data type.</t>
<t>xpath.  XML Path (XPath) <xref target="W3C.XPATH" />.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-type"><vspace/>Optional.  STRING.  A means by which to extend the type attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="offset"><vspace />Optional.  INTEGER.  Amount of units (determined by the offsetunit attribute) to seek into the RecordItem data before matching the pattern.</t>

<t hangText="offsetunit"><vspace />Optional.  ENUM.  Describes the units of the offset attribute.  The default is "line". These values are maintained in the "RecordPattern-offsetunit" IANA registry per <xref target="enum_value_registries" />.
<list style="numbers">
<t>line.  Offset is a count of lines.</t>
<t>byte. Offset is a count of bytes.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-offsetunit"><vspace/>Optional.  STRING.  A means by which to extend the offsetunit attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="instance"><vspace />Optional.  INTEGER.  Number of times to apply the specified pattern.</t>
</list>
</t>
</section>

</section>

<section title="WindowsRegistryKeysModified Class" anchor="WindowsRegistryKeysModified">
<t>The WindowsRegistryKeysModified class describes Windows operating system registry keys and the operations that were performed on them.  This class was derived from <xref target="RFC5901" />.
</t>
<t>
<figure title="The WindowsRegistryKeysModified Class" anchor="figure_windowsregistrykeysmodified_class">
<artwork><![CDATA[
+-----------------------------+
| WindowsRegistryKeysModified |
+-----------------------------+
| ID observable-id            |<>--{1..*}--[ Key ]
+-----------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the WindowsRegistryKeysModified class are:
<list style="hanging">
<t hangText="Key"><vspace/>One or more.  The Windows registry key.  See <xref target="Key" />.</t>
</list>
</t>
<t>The attribute of the WindowsRegistryKeysModified class is:
<list style="hanging">
<t hangText="observable-id"><vspace />Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list>
</t>

<section title="Key Class" anchor="Key">
<t>The Key class describes a Windows operating system registry key name and value pair, as well as the operation performed on it.
</t>
<t>
<figure title="The Key Class" anchor="figure_key_class">
<artwork><![CDATA[
+---------------------------+
| Key                       |
+---------------------------+
| ENUM registryaction       |<>----------[ KeyName  ]
| STRING ext-registryaction |<>--{0..1}--[ KeyValue ]
| ID observable-id          |
+---------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Key class are:
<list style="hanging">

<t hangText="KeyName"><vspace/>One.  STRING.  The name of a Windows operating system registry key (e.g., [HKEY_LOCAL_MACHINE\Software\Test\KeyName]).</t>

<t hangText="KeyValue"><vspace/>Zero or one.  STRING.  The value of the registry key identified in the KeyName class encoded per the .reg file format <xref target="KB310516" />.</t>
</list></t>

<t>The attributes of the Key class are:
<list style="hanging">
<t hangText="registryaction"><vspace />Optional.  ENUM.  The type of action taken on the registry key.  These values are maintained in the "Key-registryaction" IANA registry per <xref target="enum_value_registries" />.
<list style="numbers">
<t>add-key.  Registry key added.</t>
<t>add-value.  Value added to a registry key.</t>
<t>delete-key.  Registry key deleted.</t>
<t>delete-value.  Value deleted from a registry key.</t>
<t>modify-key.  Registry key modified.</t>
<t>modify-value.  Value modified in a registry key.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-registryaction"><vspace/>Optional.  STRING.  A means by which to extend the registryaction attribute.  See <xref target="extending_enums_private" />.</t>

<t hangText="observable-id"><vspace />Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list>
</t>
</section> 

</section> 

<section title="CertificateData Class" anchor="CertificateData">
<t>The CertificateData class describes X.509 certificates.</t>
<t>
<figure title="The CertificateData Class" anchor="figure_certificatedata_class">
<artwork><![CDATA[
+------------------------+
| CertificateData        |
+------------------------+
| ENUM restriction       |<>--{1..*}--[ Certificate    ]
| STRING ext-restriction |
| ID observable-id       |
+------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the CertificateData class are:

<list style="hanging">
<t hangText="Certificate"><vspace />One or more.  A description of an X.509 certificate or certificate chain.  See <xref target="Certificate" />.</t>
</list></t>

<t>The attributes of the CertificateData class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
<t hangText="observable-id"><vspace />Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list></t>


<section title="Certificate Class" anchor="Certificate">
<t>The Certificate class describes a given X.509 certificate or certificate chain.</t>
<t>
<figure title="The Certificate Class" anchor="figure_certificate_class">
<artwork><![CDATA[
+--------------------------+
| Certificate              |
+--------------------------+
| ID observable-id         |<>----------[ ds:X509Data    ]
|                          |<>--{0..*}--[ Description    ]
+--------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Certificate class are:

<list style="hanging">
<t hangText="ds:X509Data"><vspace />One.  A given X.509 certificate or chain.  See Section 4.4.4 of <xref target="W3C.XMLSIG" />.</t>

<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description explaining the context of this certificate.</t>
</list></t>

<t>The attributes of the Certificate class are:
<list style="hanging">
<t hangText="observable-id"><vspace />Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list></t>
</section> 
</section> 

<section title="FileData Class" anchor="FileData">
<t>The FileData class describes a file or set of files.</t>
<t>
<figure title="The FileData Class" anchor="figure_filedata_class">
<artwork><![CDATA[
+------------------------+
| FileData               |
+------------------------+
| ENUM restriction       |<>--{1..*}--[ File      ]
| STRING ext-restriction |
| ID observable-id       |
+------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the FileData class are:

<list style="hanging">
<t hangText="File"><vspace />One or more.  A description of a file.  See <xref target="File" />.</t>
</list></t>

<t>The attributes of the FileData class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
<t hangText="observable-id"><vspace />Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list></t>

<section title="File Class" anchor="File">
<t>The File class describes a file; its associated metadata; and cryptographic hashes and signatures applied to it.</t>
<t>
<figure title="The File Class" anchor="figure_file_class">
<artwork><![CDATA[
+-----------------------+
| File                  |
+-----------------------+
| ID observable-id      |<>--{0..1}--[ FileName           ]
|                       |<>--{0..1}--[ FileSize           ]
|                       |<>--{0..1}--[ FileType           ]
|                       |<>--{0..*}--[ URL                ]
|                       |<>--{0..1}--[ HashData           ]
|                       |<>--{0..1}--[ SignatureData      ]
|                       |<>--{0..1}--[ AssociatedSoftware ]
|                       |<>--{0..*}--[ FileProperties     ]
+-----------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the File class are:

<list style="hanging">
<t hangText="FileName"><vspace />Zero or one.  STRING.  The name of the file.</t>
<t hangText="FileSize"><vspace />Zero or one.  INTEGER.  The size of the file in bytes.</t>
<t hangText="FileType"><vspace />Zero or one.  STRING.  The type of file per the IANA "Media Types" registry <xref target="IANA.Media" />.  Valid values correspond to the text in the "Template" column (e.g., "application/pdf").</t>
<t hangText="URL"><vspace />Zero or more.  URL.  A URL reference to the file.</t>
<t hangText="HashData"><vspace />Zero or one.  Hash(es) associated with this file.  See <xref target="HashData" />.</t>
<t hangText="SignatureData"><vspace />Zero or one.  Signature(s) associated with this file.  See <xref target="SignatureData" />.</t>
<t hangText="AssociatedSoftware"><vspace />Zero or one.  SOFTWARE.  The software application or operating system to which this file belongs or by which it can be processed.</t>
<t hangText="FileProperties"><vspace/>Zero or more.  EXTENSION.  Mechanism by which to extend the data model to describe properties of the file.</t>
</list></t>

<t>The attributes of the File class are:
<list style="hanging">
<t hangText="observable-id"><vspace />Optional.  ID.  See <xref target="observableid_attribute" />.</t>
</list></t>
</section> 

</section> 

<section title="HashData Class" anchor="HashData">
<t>The HashData class describes different types of hashes on a given object (e.g., file, part of a file, email).</t>
<t>
<figure title="The HashData Class" anchor="figure_hashdata_class">
<artwork><![CDATA[
+--------------------------+
| HashData                 |
+--------------------------+
| ENUM scope               |<>--{0..1}--[ HashTargetID ]
|                          |<>--{0..*}--[ Hash         ]
|                          |<>--{0..*}--[ FuzzyHash    ]
+--------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the HashData class are:

<list style="hanging">
<t hangText="HashTargetID"><vspace />Zero or one.  STRING.  An identifier that references a subset of the object being hashed.  The semantics of this identifier are specified by the scope attribute.</t>
<t hangText="Hash"><vspace />Zero or more.  The hash of an object.  See <xref target="Hash" />.</t>
<t hangText="FuzzyHash"><vspace />Zero or more.  The fuzzy hash of an object.  See <xref target="FuzzyHash" />.</t>
</list></t>

<t>At least one instance of either Hash or FuzzyHash MUST be present.</t>

<t>The attribute of the HashData class is:
<list style="hanging">
<t hangText="scope"><vspace />Required.  ENUM.  Describes on which part of the object the hash should be applied.  These values are maintained in the "HashData-scope" IANA registry per <xref target="enum_value_registries" />.
<list style="numbers">
<t>file-contents.  A hash computed over the entire contents of a file.</t>
<t>file-pe-section.  A hash computed on a given section of a Windows Portable Executable (PE) file.  If set to this value, the HashTargetID class MUST identify the section being hashed.  A section is identified by an ordinal number (starting at 1) corresponding to the order in which the given section header was defined in the Section Table of the PE file header.</t>
<t>file-pe-iat.  A hash computed on the Import Address Table (IAT) of a PE file.  As IAT hashes are often tool dependent, if this value is set, the Application class of either the Hash or FuzzyHash classes MUST specify the tool used to generate the hash.</t>
<t>file-pe-resource. A hash computed on a given resource in a PE file. If set to this value, the HashTargetID class MUST identify the resource being hashed.  A resource is identified by an ordinal number (starting at 1) corresponding to the order in which the given resource is declared in the Resource Directory of the Data Dictionary in the PE file header.</t>
<t>file-pdf-object.  A hash computed on a given object in a Portable Document Format (PDF) file.  If set to this value, the HashTargetID class MUST identify the object being hashed.  This object is identified by its offset in the PDF file.</t>
<t>email-hash.  A hash computed over the headers and body of an email message.</t>
<t>email-headers-hash.  A hash computed over all of the headers of an email message.</t>
<t>email-body-hash.  A hash computed over the body of an email message.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<t hangText="ext-scope"><vspace/>Optional.  STRING.  A means by which to extend the scope attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>

<section title="Hash Class" anchor="Hash">
<t>The Hash class describes a cryptographic hash value; the algorithm and application used to generate it; and the canonicalization method applied to the object being hashed.</t>
<t>
<figure title="The Hash Class" anchor="figure_hash_class">
<artwork><![CDATA[
+----------------+
| Hash           |
+----------------+
|                |<>----------[ ds:DigestMethod            ]
|                |<>----------[ ds:DigestValue             ]
|                |<>--{0..1}--[ ds:CanonicalizationMethod  ]
|                |<>--{0..1}--[ Application                ]
+----------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Hash class are:

<list style="hanging">
<t hangText="ds:DigestMethod"><vspace />One.  The hash algorithm used to generate the hash.  See Section 4.3.3.5 of <xref target="W3C.XMLSIG" />.</t>
<t hangText="ds:DigestValue"><vspace />One.  The computed hash value.  See Section 4.3.3.6 of <xref target="W3C.XMLSIG" />.</t>
<t hangText="ds:CanonicalizationMethod"><vspace />Zero or one.  The canonicalization method used on the object being hashed.  See Section 4.3.1 of <xref target="W3C.XMLSIG" />.</t>

<t hangText="Application"><vspace />Zero or one.  SOFTWARE.  The application used to calculate the hash.</t>
</list></t>

<t>The HashData class has no attributes.</t>
</section> 

<section title="FuzzyHash Class" anchor="FuzzyHash">
<t>The FuzzyHash class describes a fuzzy hash and the application used to generate it.</t>
<t>
<figure title="The FuzzyHash Class" anchor="figure_fuzzyhash_class">
<artwork><![CDATA[
+--------------------------+
| FuzzyHash                |
+--------------------------+
|                          |<>--{1..*}--[ FuzzyHashValue ]
|                          |<>--{0..1}--[ Application    ]
|                          |<>--{0..*}--[ AdditionalData ]
+--------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the FuzzyHash class are:

<list style="hanging">
<t hangText="FuzzyHashValue"><vspace/>One or more.  EXTENSION.  The computed fuzzy hash value.</t>
<t hangText="Application"><vspace />Zero or one. SOFTWARE.  The application used to calculate the hash.</t>
<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  Mechanism by which to extend the data model.</t>
</list></t>

<t>The FuzzyData class has no attributes.</t>
</section> 

</section> 

<section title="SignatureData Class" anchor="SignatureData">
<t>The SignatureData class describes different types of digital signatures on an object.</t>
<t>
<figure title="The SignatureData Class" anchor="figure_signaturedata_class">
<artwork><![CDATA[
+--------------------------+
| SignatureData            |
+--------------------------+
|                          |<>--{1..*}--[ ds:Signature ]
+--------------------------+
]]></artwork>
</figure></t>

<t>The aggregate class of the SignatureData class is:

<list style="hanging">
<t hangText="Signature"><vspace />One or more.  A given signature. See Section 4.2 of <xref target="W3C.XMLSIG" />.
</t>
</list></t>

<t>The SignatureData class has no attributes.</t>

</section> 

<section title="IndicatorData Class" anchor="IndicatorData">
<t>The IndicatorData class describes indicators and metadata associated with them.</t>
<t>
<figure title="The IndicatorData Class" anchor="figure_indicatordata_class">
<artwork><![CDATA[
+--------------------------+
| IndicatorData            |
+--------------------------+
|                          |<>--{1..*}--[ Indicator      ]
+--------------------------+
]]></artwork>
</figure></t>

<t>The aggregate class of the IndicatorData class is:

<list style="hanging">
<t hangText="Indicator"><vspace />One or more.  A description of an indicator.  See <xref target="Indicator" />.</t>
</list></t>

<t>The IndicatorData class has no attributes.</t>
</section> 

<section title="Indicator Class" anchor="Indicator">
<t>The Indicator class describes an indicator.  An indicator consists of observable features and phenomenon that aid in the forensic or proactive detection of malicious activity and associated metadata. An indicator can be described outright by referencing or composing previously defined indicators or by referencing observables described in the incident report found in this document.</t>

<t>
<figure title="The Indicator Class" anchor="figure_indicator_class">
<artwork><![CDATA[
+------------------------+
| Indicator              |
+------------------------+
| ENUM restriction       |<>----------[ IndicatorID            ]
| STRING ext-restriction |<>--{0..*}--[ AlternativeIndicatorID ]
|                        |<>--{0..*}--[ Description            ]
|                        |<>--{0..1}--[ StartTime              ]
|                        |<>--{0..1}--[ EndTime                ]
|                        |<>--{0..1}--[ Confidence             ]
|                        |<>--{0..*}--[ Contact                ]
|                        |<>--{0..1}--[ Observable             ]
|                        |<>--{0..1}--[ ObservableReference    ]
|                        |<>--{0..1}--[ IndicatorExpression    ]
|                        |<>--{0..1}--[ IndicatorReference     ]
|                        |<>--{0..*}--[ NodeRole               ]
|                        |<>--{0..*}--[ AttackPhase            ]
|                        |<>--{0..*}--[ Reference              ]
|                        |<>--{0..*}--[ AdditionalData         ]
+------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Indicator class are:

<list style="hanging">
<t hangText="IndicatorID"><vspace />One.  An identifier for this indicator.  See <xref target="IndicatorID" />.</t>
<t hangText="AlternativeIndicatorID"><vspace />Zero or more. An alternative identifier for this indicator.  See <xref target="AlternativeIndicatorID" />.</t>
<t hangText="Description"><vspace />Zero or more. ML_STRING.  A free-form text description of the indicator.</t>
<t hangText="StartTime"><vspace />Zero or one. DATETIME.  A timestamp of the start of the time period during which this indicator is valid.</t>
<t hangText="EndTime"><vspace />Zero or one. DATETIME. A timestamp of the end of the time period during which this indicator is valid.</t>
<t hangText="Confidence"><vspace />Zero or one.  An estimate of the confidence in the quality of the indicator.  See <xref target="Confidence" />.</t>
<t hangText="Contact"><vspace />Zero or more.  Contact information for this indicator. See <xref target="Contact" />.</t>
<t hangText="Observable"><vspace />Zero or one.  An observable feature or phenomenon of this indicator.  See <xref target="Observable" />.</t>
<t hangText="ObservableReference"><vspace />Zero or one.  A reference to an observable feature or phenomenon defined elsewhere in the document.  See <xref target="ObservableReference" />.</t>
<t hangText="IndicatorExpression"><vspace />Zero or one.  A composition of observables.  See <xref target="IndicatorExpression" />.</t>
<t hangText="IndicatorReference"><vspace />Zero or one.  A reference to an indicator.  See <xref target="IndicatorReference" />.</t>
<t hangText="NodeRole"><vspace />Zero or more.  The role of the system in the attack should this indicator be matched to it.  See <xref target="NodeRole" />.</t>
<t hangText="AttackPhase"><vspace />Zero or more.  The phase in an attack life cycle during which this indicator might be seen.  See <xref target="AttackPhase" />.</t>
<t hangText="Reference"><vspace />Zero or more.  A reference to additional information relevant to this indicator.  See <xref target="Reference" />.</t>
<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  Mechanism by which to extend the data model.</t>
</list></t>

<t>The Indicator class MUST have exactly one instance of an Observable, IndicatorExpression, ObservableReference, or IndicatorReference class.</t>

<t>The StartTime and EndTime classes can be used to define an interval during which the indicator is valid.  If both classes are present, the indicator is consider valid only during the described interval.  If neither class is provided, the indicator is considered valid during any time interval.  If only a StartTime is provided, the indicator is valid anytime after this timestamp.  If only an EndTime is provided, the indicator is valid anytime prior to this timestamp.</t>

<t>The attributes of the Indicator class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<section title="IndicatorID Class" anchor="IndicatorID">
<t>The IndicatorID class identifies an indicator with a globally unique identifier.  The combination of the name and version attributes and the element content form this identifier.  Indicators generated by given CSIRT MUST NOT reuse the same value unless they are referencing the same indicator.</t>

<t>
<figure title="The IndicatorID Class" anchor="figure_indicatorid_class">
<artwork><![CDATA[
+------------------+
| IndicatorID      |
+------------------+
| ID               |
|                  |
| STRING name      |
| STRING version   |
+------------------+
]]></artwork>
</figure></t>

<t>The content of the class is of type ID and specifies an identifier for an indicator.</t>

<t>The attributes of the IndicatorID class are:
<list style="hanging">
<t hangText="name"><vspace/>Required.  STRING.  An identifier describing the CSIRT that created the indicator.  In order to have a globally unique CSIRT name, the fully qualified domain name associated with the CSIRT MUST be used.  This format is identical to the IncidentID@name attribute in <xref target="IncidentID" />.</t>

<t hangText="version"><vspace/>Required.  STRING.  A version number of an indicator.</t>
</list>
</t>
</section>

<section title="AlternativeIndicatorID Class" anchor="AlternativeIndicatorID">
<t>The AlternativeIndicatorID class lists alternative identifiers for an indicator.</t>

<t>
<figure title="The AlternativeIndicatorID Class" anchor="figure_AlternativeIndicatorID_class">
<artwork><![CDATA[
+-------------------------+
| AlternativeIndicatorID  |
+-------------------------+
| ENUM restriction        |<>--{1..*}--[ IndicatorReference ]
| STRING ext-restriction  |
+-------------------------+
]]></artwork></figure></t>
	
<t>The aggregate class of the AlternativeIndicatorID class is:
<list style="hanging">
<t hangText="IndicatorReference"><vspace/>One or more.  A reference to an indicator.  See <xref target="IndicatorReference" />.</t> 
</list></t>
	
<t>The attributes of the AlternativeIndicatorID class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
</list></t>
</section>

<section title="Observable Class" anchor="Observable">
<t>The Observable class describes a feature and phenomenon that can be observed or measured for the purposes of detecting malicious behavior.</t>
<t>
<figure title="The Observable Class" anchor="figure_observable_class">
<artwork><![CDATA[
+------------------------+
| Observable             |
+------------------------+
| ENUM restriction       |<>--{0..1}--[ System                      ] 
| STRING ext-restriction |<>--{0..1}--[ Address                     ]
|                        |<>--{0..1}--[ DomainData                  ]
|                        |<>--{0..1}--[ Service                     ]
|                        |<>--{0..1}--[ EmailData                   ]
|                        |<>--{0..1}--[ WindowsRegistryKeysModified ]
|                        |<>--{0..1}--[ FileData                    ]
|                        |<>--{0..1}--[ CertificateData             ]
|                        |<>--{0..1]--[ RegistryHandle              ]
|                        |<>--{0..1}--[ RecordData                  ]
|                        |<>--{0..1}--[ EventData                   ]
|                        |<>--{0..1}--[ Incident                    ]
|                        |<>--{0..1}--[ Expectation                 ]
|                        |<>--{0..1}--[ Reference                   ]
|                        |<>--{0..1}--[ Assessment                  ]
|                        |<>--{0..1}--[ DetectionPattern            ]
|                        |<>--{0..1}--[ HistoryItem                 ]
|                        |<>--{0..1}--[ BulkObservable              ]
|                        |<>--{0..*}--[ AdditionalData              ]
+------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the Observable class are:

<list style="hanging">
<t hangText="System"><vspace />Zero or one.  A System observable.  See <xref target="System" />.</t>
<t hangText="Address"><vspace />Zero or one.  An Address observable.  See <xref target="Address" />.</t>
<t hangText="DomainData"><vspace />Zero or one.  A DomainData observable.  See <xref target="DomainData" />.</t>
<t hangText="Service"><vspace />Zero or one.  A Service observable.  See <xref target="Service" />.</t>
<t hangText="EmailData"><vspace />Zero or one.  An EmailData observable.  See <xref target="EmailData" />.</t>
<t hangText="WindowsRegistryKeysModified"><vspace />Zero or one.  A WindowsRegistryKeysModified observable.  See <xref target="WindowsRegistryKeysModified" />.</t>
<t hangText="FileData"><vspace />Zero or one.  A FileData observable.  See <xref target="FileData" />.</t>
<t hangText="CertificateData"><vspace />Zero or one.  A CertificateData observable.  See <xref target="CertificateData" />.</t>
<t hangText="RegistryHandle"><vspace />Zero or one.  A RegistryHandle observable.  See <xref target="RegistryHandle" />.</t>
<t hangText="RecordData"><vspace />Zero or one.  A RecordData observable.  See <xref target="RecordData" />.</t>
<t hangText="EventData"><vspace />Zero or one.  An EventData observable.  See <xref target="EventData" />.</t>
<t hangText="Incident"><vspace />Zero or one.  An Incident observable.  See <xref target="Incident" />.</t>
<t hangText="Expectation"><vspace />Zero or one.  An Expectation observable.  See <xref target="Expectation" />.</t>
<t hangText="Reference"><vspace />Zero or one.  A Reference observable.  See <xref target="Reference" />.</t>
<t hangText="Assessment"><vspace />Zero or one.  An Assessment observable.  See <xref target="Assessment" />.</t>
<t hangText="DetectionPattern"><vspace />Zero or one.  A DetectionPattern observable.  See <xref target="DetectionPattern" />.</t>
<t hangText="HistoryItem"><vspace />Zero or one.  A HistoryItem observable.  See <xref target="HistoryItem" />.</t>
<t hangText="BulkObservable"><vspace />Zero or one.  A bulk list of observables.  See <xref target="BulkObservable" />.</t>
<t hangText="AdditionalData"><vspace />Zero or more.  EXTENSION.  Mechanism by which to extend the data model.</t>
</list>
</t>

<t>The Observable class MUST have exactly one of the possible child classes.</t>

<t>The attributes of the Observable class are:
<list style="hanging">
<t hangText="restriction"><vspace/>Optional.  ENUM.  See <xref target="restriction" />.</t>
<t hangText="ext-restriction"><vspace/>Optional.  STRING.  A means by which to extend the restriction attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<section title="BulkObservable Class" anchor="BulkObservable">
<t>The BulkObservable class allows the enumeration of a single type of observable without requiring each one to be encoded individually in multiple instances of the same class.</t>

<t>The type attribute describes the type of observable listed in the child BulkObservableList class.  The BulkObservableFormat class optionally provides additional metadata.
</t>
<t>
<figure title="The BulkObservable Class" anchor="figure_bulkobservable_class">
<artwork><![CDATA[
+---------------------------+
| BulkObservable            |
+---------------------------+
| ENUM type                 |<>--{0..1}--[ BulkObservableFormat ]
| STRING ext-type           |<>----------[ BulkObservableList   ]
|                           |<>--{0..*}--[ AdditionalData       ]
+---------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the BulkObservable class are:
<list style="hanging">
<t hangText="BulkObservableFormat"><vspace/>Zero or one.  Provides additional metadata about the observables enumerated in the BulkObservableList class.  See <xref target="BulkObservableFormat" />.</t>
<t hangText="BulkObservableList"><vspace/>One.  STRING.  A list of observables, one per line.  Each line is separated with either a LF character or CR and LF characters.  The type attribute specifies which observables will be listed.</t>
<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  Mechanism by which to extend the data model.</t>
</list></t>

<t>The attributes of the BulkObservable class are:
<list style="hanging">
<t hangText="type"><vspace />Optional.  ENUM.  The type of the observable listed in the child ObservableList class.  These values are maintained in the "BulkObservable-type" IANA registry per <xref target="enum_value_registries" />.
<list style="numbers">
<t>asn.  Autonomous System Number (per the Address@category attribute).</t>
<t>atm.  Asynchronous Transfer Mode (ATM) address (per the Address@category attribute).</t>
<t>e-mail.   Email address (per the Address@category attribute).</t>
<t>ipv4-addr.  IPv4 host address in dotted-decimal notation, e.g., 192.0.2.1 (per the Address@category attribute).</t>
<t>ipv4-net.  IPv4 network address in dotted-decimal notation, slash, significant bits, e.g., 192.0.2.0/24 (per the Address@category attribute).</t>
<t>ipv4-net-mask.  IPv4 network address in dotted-decimal notation, slash, network mask in dotted-decimal notation, i.e., 192.0.2.0/255.255.255.0 (per the Address@category attribute).</t>
<t>ipv6-addr.  IPv6 host address, e.g., 2001:DB8::3 (per the Address@category attribute).</t>
<t>ipv6-net.  IPv6 network address, slash, significant bits, e.g., 2001:DB8::/32 (per the Address@category attribute).</t>
<t>ipv6-net-mask.  IPv6 network address, slash, network mask (per the Address@category attribute).</t>
<t>mac.  Media Access Control (MAC) address, i.e., a:b:c:d:e:f (per the Address@category attribute).</t>
<t>site-uri.  A URL or URI for a resource (per the Address@category attribute).</t>				
<t>domain-name.  A fully qualified domain name or part of a name (e.g., fqdn.example.com, example.com).</t>


<t>domain-to-ipv4. A mapping of FQDN to IPv4 address specified as a comma-separated list (e.g., "fqdn.example.com, 192.0.2.1").</t>
<t>domain-to-ipv6. A mapping of FQDN to IPv6 address specified as a comma-separated list (e.g., "fqdn.example.com, 2001:DB8::3").</t> 
<t>domain-to-ipv4-timestamp. Same as domain-to-ipv4 but with a timestamp (in the DATETIME format) of the resolution (e.g., "fqdn.example.com, 192.0.2.1, 2015-06-11T00:38:31-06:00").</t>
<t>domain-to-ipv6-timestamp. Same as domain-to-ipv6 but with a timestamp (in
the DATETIME format) of the resolution (e.g., "fqdn.example.com, 2001:DB8::3,
2015-06-11T00:38:31-06:00").</t>
<t>ipv4-port. An IPv4 address, port, and protocol tuple (e.g., 192.0.2.1, 80, TCP).  The protocol name corresponds to the "Keyword" column in the "Assigned Internet Protocol Numbers" registry <xref target="IANA.Protocols" />.</t>
<t>ipv6-port. An IPv6 address, port, and protocol tuple (e.g., 2001:DB8::3, 80, TCP).  The protocol name corresponds to the "Keyword" column in the "Assigned Internet Protocol Numbers" registry <xref target="IANA.Protocols" />.</t>
<t>windows-reg-key.  A Microsoft Windows registry key.</t>
<t>file-hash.  A file hash.  The format of this hash is described in the Hash class that MUST be present in a sibling BulkObservableFormat class.</t>
<t>email-x-mailer. An X-Mailer field from an email.</t> 
<t>email-subject. An email subject line.</t>
<t>http-user-agent.  A User Agent field from an HTTP request header (e.g., "Mozilla/5.0 (Windows NT 6.3; WOW64; rv:38.0) Gecko/20100101 Firefox/38.0").</t>
<t>http-request-uri.  The Request URI from an HTTP request header.</t>

<t>mutex.  The name of a system mutex (mutual exclusion lock).</t>
<t>file-path.  A file path (e.g., "/tmp/local/file", "c:\windows\system32\file.sys").</t>
<t>user-name.  A username.</t>
<t>ext-value.  A value used to indicate that this attribute is extended and the actual value is provided using the corresponding ext-* attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>
<t hangText="ext-type"><vspace/>Optional.  STRING.  A means by which to extend the type attribute.  See <xref target="extending_enums_private" />.</t>
</list>
</t>

<section title="BulkObservableFormat Class" anchor="BulkObservableFormat">
<t>The ObservableFormat class specifies metadata about the format of an observable enumerated in a sibling BulkObservableList class.
</t>
<t>
<figure title="The BulkObservableFormat Class" anchor="figure_bulkobservableformat_class">
<artwork><![CDATA[
+---------------------------+
| BulkObservableFormat      |
+---------------------------+
|                           |<>--{0..1}--[ Hash             ]
|                           |<>--{0..*}--[ AdditionalData   ]
+---------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the BulkObservableFormat class are:
<list style="hanging">
<t hangText="Hash"><vspace/>Zero or one.  Describes the format of a hash.  See <xref target="Hash" />.</t>
<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  Mechanism by which to extend the data model.</t>
</list></t>

<t>The BulkObservableFormat class has no attributes.</t>

<t>Either Hash or AdditionalData MUST be present.</t>
</section> 

</section> 

</section> 

<section title="IndicatorExpression Class" anchor="IndicatorExpression">
<t>The IndicatorExpression describes an expression composed of observed phenomenon, features, or indicators.  Elements of the expression can be described directly, reference relevant data from other parts of a given IODEF document, or reference previously defined indicators.</t>

<t>All child classes of a given instance of IndicatorExpression form a boolean algebraic expression where the operator between them is determined by the operator attribute.</t>

<t>
<figure title="The IndicatorExpression Class" anchor="figure_indicatorexpression_class">
<artwork><![CDATA[
+--------------------------+
| IndicatorExpression      |
+--------------------------+
| ENUM operator            |<>--{0..*}--[ IndicatorExpression  ]
| STRING ext-operator      |<>--{0..*}--[ Observable           ]
|                          |<>--{0..*}--[ ObservableReference  ]
|                          |<>--{0..*}--[ IndicatorReference   ]
|                          |<>--{0..1}--[ Confidence           ]
|                          |<>--{0..*}--[ AdditionalData       ]
+--------------------------+
]]></artwork>
</figure></t>

<t>The aggregate classes of the IndicatorExpression class are:

<list style="hanging">
<t hangText="IndicatorExpression"><vspace />Zero or more.  An expression composed of other observables or indicators. See <xref target="IndicatorExpression" />.</t>
<t hangText="Observable"><vspace />Zero or more. A description of an observable.  See <xref target="Observable" />.</t>
<t hangText="ObservableReference"><vspace />Zero or more. A reference to an observable.  See <xref target="ObservableReference" />.</t>
<t hangText="IndicatorReference"><vspace />Zero or more. A reference to an indicator.  See <xref target="IndicatorReference" />.</t>
<t hangText="Confidence"><vspace />Zero or one.  An estimate of the confidence in the quality of the terms expressed in the expression.  See <xref target="Confidence" />.</t>
<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  Mechanism by which to extend the data model.</t>
</list></t>

<t>The attributes of the IndicatorExpression class are:
<list style="hanging">
<t hangText="operator"><vspace />Optional.  ENUM.  The operator to be applied between the child elements.  See <xref target="parsing_indicatorexpression" /> for parsing guidance.  The default value is "and".  These values are maintained in the "IndicatorExpression-operator" IANA registry per <xref target="enum_value_registries" />.
<list style="numbers">
<t>not.  negation operator.</t>
<t>and.  conjunction operator.</t>
<t>or.   disjunction operator.</t>
<t>xor.  exclusive disjunction operator.</t>
</list></t>

<t hangText="ext-operator"><vspace/>Optional.  STRING.  A means by which to extend the operator attribute.  See <xref target="extending_enums_private" />.</t>

</list></t> 
</section>

<section title="Expressions with IndicatorExpression" anchor="parsing_indicatorexpression">

<t>Boolean algebraic expressions can be used to specify relationships between observables and indicators.  These expressions are constructed through the use of the operator attribute and parent-child relationships in IndicatorExpressions.  These expressions should be parsed as follows:

<list style="numbers">
<t>The operator specified by the operator attribute is applied between each of the child elements of the immediate 
parent IndicatorExpression element.  If no operator attribute is specified, it should be assumed to be the conjunction operator (i.e., operator="and").</t>
<t>A nested IndicatorExpression element with a parent IndicatorExpression is the equivalent of a parentheses in the 
expression.</t>
</list>
</t>

<t>The following examples in Figures <xref target="figure_indicatorexpression_example1" format="counter"/> through <xref target="figure_indicatorexpression_example5" format="counter" /> illustrate these parsing rules:</t>
<t>
<figure title="Nested Elements in an IndicatorExpression without an Operator Attribute Specified" 
anchor="figure_indicatorexpression_example1">
<artwork><![CDATA[
1     : <IndicatorExpression>
2 [O1]:    <Observable>..</Observable>
3 [O2]:    <Observable>..</Observable>
4     : </IndicatorExpression>

Equivalent expression: (O1 AND O2)
]]></artwork></figure></t>

<t>
<figure title="Nested Elements in an IndicatorExpression with an Operator Attribute Specified" 
anchor="figure_indicatorexpression_example2">
<artwork><![CDATA[
1     : <IndicatorExpression operator="or">
2 [O1]:    <Observable>..</Observable>
3 [O2]:    <Observable>..</Observable>
4     : </IndicatorExpression>

Equivalent expression: (O1 OR O2)
]]></artwork></figure></t>


<t>
<figure title="Nested Elements with a Recursive IndicatorExpression with an Operator Attribute Specified" 
anchor="figure_indicatorexpression_example3">
<artwork><![CDATA[
1     : <IndicatorExpression operator="or">
2     :    <IndicatorExpression operator="or">
3 [O1]:      <Observable>..</Observable>
4 [O2]:      <Observable>..</Observable>
5     :    </IndicatorExpression>
6 [O3]:    <Observable>..</Observable>
7     : </IndicatorExpression>

Equivalent expression: ((O1 OR O2) OR O3)
]]></artwork></figure></t>

<t>
<figure title="A Recursive IndicatorExpression with an Operator Attribute Specified" 
anchor="figure_indicatorexpression_example4">
<artwork><![CDATA[

1     : <IndicatorExpression operator="not">
2     :    <IndicatorExpression operator="and">
3 [O1]:      <Observable>..</Observable>
4 [O2]:      <Observable>..</Observable>
5     :    </IndicatorExpression>
6     : </IndicatorExpression>

Equivalent expression: (NOT (O1 AND O2))
]]></artwork></figure></t>

<t>
<figure title="Varying Confidence on Particular Observables" 
anchor="figure_indicatorexpression_example5">
<artwork><![CDATA[
 1                          :    <IndicatorExpression operator="or">
 2                          :      <IndicatorExpression>
 3 [O1 with low confidence] :        <Observable>..</Observable>
 4                          :        <Confidence rating="low" />
 5                          :      </IndicatorExpression>
 6                          :      <IndicatorExpression>
 7 [O2 with high confidence]:        <Observable>..</Observable>
 8                          :        <Confidence rating="high" />
 9                          :      </IndicatorExpression>
10                          :    </IndicatorExpression>

Equivalent expression: ((O1) OR (O2))
]]></artwork></figure></t>


<t>Invalid algebraic expressions while valid XML MUST NOT be specified.</t>
</section> 

<section title="ObservableReference Class" anchor="ObservableReference">
<t>The ObservableReference describes a reference to an observable feature or phenomenon described elsewhere in the document.</t>

<t>The ObservableReference class has no content.</t>

<figure title="The ObservableReference Class" anchor="figure_observablereferece_class">
<artwork><![CDATA[
+-------------------------+
| ObservableReference     |
+-------------------------+
| IDREF uid-ref           |
+-------------------------+
]]></artwork>
</figure>

<t>The ObservableReference class has no content.</t>

<t>The attribute of the ObservableReference class is:
<list style="hanging">
<t hangText="uid-ref"><vspace/>Required.  IDREF.  An identifier that serves as a reference to a class in the IODEF document. The referenced class will have this identifier set in its  observable-id attribute.</t>
</list>
</t>
</section> 

<section title="IndicatorReference Class" anchor="IndicatorReference">
<t>The IndicatorReference describes a reference to an indicator.  This reference may be to an indicator described in this IODEF document or in a previously exchanged IODEF document.</t>

<t>The IndicatorReference class has no content.</t>

<figure title="The IndicatorReference Class" anchor="figure_indicatorreferece_class">
<artwork><![CDATA[
+--------------------------+
| IndicatorReference       |
+--------------------------+
| IDREF uid-ref            |
| STRING euid-ref          |
| STRING version           |
+--------------------------+
]]></artwork>
</figure>

<t>The attributes of the IndicatorReference class are:
<list style="hanging">
<t hangText="uid-ref"><vspace/>Optional.  IDREF.  An identifier that references an Indicator class in the IODEF document. The referenced Indicator class will have this identifier set in its IndicatorID class.</t>
<t hangText="euid-ref"><vspace/>Optional.  STRING.  An identifier that references an IndicatorID not in this IODEF document.</t>
<t hangText="version"><vspace/>Optional.  STRING.  A version number of an indicator.</t>
</list>
</t>
<t>Either the uid-ref or the euid-ref attribute MUST be set.</t>
</section>  

<section title="AttackPhase Class" anchor="AttackPhase">
<t>The AttackPhase class describes a particular phase of an attack life cycle. 
</t> 

<t>
<figure title="The AttackPhase Class" anchor="figure_AttackPhase_class">
<artwork><![CDATA[
+------------------------+
| AttackPhase            |
+------------------------+
|                        |<>--{0..*}--[ AttackPhaseID  ]
|                        |<>--{0..*}--[ URL            ]
|                        |<>--{0..*}--[ Description    ]
|                        |<>--{0..*}--[ AdditionalData ]
+------------------------+
]]></artwork></figure>
</t>

<t>The aggregate classes of the AttackPhase class are:
<list style="hanging">

<t hangText="AttackPhaseID"><vspace/>Zero or more.  STRING. An identifier for the phase of the attack.</t> 
<t hangText="URL"><vspace/>Zero or more.  URL.  A URL to a resource describing this phase of the attack.</t>
<t hangText="Description"><vspace/>Zero or more.  ML_STRING.  A free-form text description of this phase of the attack.</t> 
<t hangText="AdditionalData"><vspace/>Zero or more.  EXTENSION.  A mechanism by which to extend the data model.</t> 

</list></t>

<t>AttackPhase MUST have at least one instance of a child class.</t>

<t>The AttackPhase class has no attributes.</t>
</section>


</section>


</section> 

<section title="Processing Considerations" anchor="processing">
<t>
This section provides additional requirements and guidance on creating and processing IODEF documents.
</t>

<section title="Encoding" anchor="encoding">
<t>
Every IODEF document MUST begin with an XML declaration and MUST specify the XML version used.  The character encoding MUST also be explicitly specified.  UTF-8 <xref target="RFC3629" /> SHOULD be used unless UTF-16 <xref target="RFC2781" /> is necessary.  Encodings other than UTF-8 and UTF-16 SHOULD NOT be used.  The IODEF conforms to all XML data-encoding conventions and constraints.
</t>

<t>The XML declaration with UTF-8 character encoding will read as follows:
	<vspace blankLines='1'/>
	&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
</t>

<t>
Certain characters have special meaning in XML and MUST not appear in literal form.  Per Section 2.4 of <xref target="W3C.XML" />, these characters MUST be escaped with a numeric character or entity reference.
</t>

</section>  

<section title="IODEF Namespace" anchor="ns">
<t>
The IODEF schema declares a namespace of "urn:ietf:params:xml:ns:iodef-2.0" and registers it per <xref target="W3C.XMLNS" />.  Each IODEF
document MUST include a valid reference to the IODEF schema using the
"xsi:schemaLocation" attribute.  An example of such a declaration would
look as follows:<figure>
<artwork><![CDATA[
<IODEF-Document 
   version="2.00" lang="en-US"
   xmlns:iodef="urn:ietf:params:xml:ns:iodef-2.0"
   xsi:schemaLocation="urn:ietf:params:xmls:schema:iodef-2.0" ...>
]]></artwork>
</figure>
</t>
</section>

<section title="Validation" anchor="validation">
<t>
IODEF documents MUST be well-formed XML.  It is RECOMMENDED that recipients validate the document against the schema described in <xref target="schema" />.  However, mere conformance to this schema is not sufficient for a semantically valid IODEF document.  The text of <xref target="datamodel"/> describes further formatting and constraints, including some that cannot be conveniently encoded in the schema.  These MUST also be considered by an IODEF implementation.  Furthermore, the enumerated values present in this document are a static list that will be incomplete over time as select attributes can be extended by a corresponding IANA registry per <xref target="enum_value_registries" />.  Therefore, IODEF implementations SHOULD periodically update their schema and MAY need to update their parsing algorithms to incorporate newly registered values.
</t>

</section> 

<section title="Incompatibilities with v1" anchor="differencesfromv1">
<t>
The IODEF data model in this document makes a number of changes to <xref target="RFC5070" />.  These changes were largely additive -- classes and enumerated values were added.  However, some incompatibilities between <xref target="RFC5070" /> and this new specification were introduced.  These incompatibilities are as follows:

<list style="symbols">
<t>The IODEF-Document@version attribute is set to "2.0".</t>
<t>Attributes with enumerated values can now also be extended with IANA registries.</t>
<t>All iodef:MLStringType classes use xml:lang.  IODEF-Document also uses xml:lang.</t>
<t>The Service@ip_protocol attribute was renamed to @ip-protocol.</t>
<t>The Node/NodeName class was removed in favor of representing domain names with Node/DomainData/Name class.  The Node/DataTime class was also removed, so that the Node/DomainData/DateDomainWasChecked class can represent the time at which the name-to-address resolution occurred.</t>
<t>The Node/NodeRole class was moved to System/NodeRole.</t>
<t>The Reference class is now defined by <xref target="RFC7495" />.</t>
<t>The data previously represented in the Impact class is now in the SystemImpact and IncidentCategory classes.  The Impact class has been removed.</t>
<t>The semantics of Counter@type are now represented in Counter@unit.</t> 
<t>The IODEF-Document@formatid attribute has been renamed to @format-id.</t> 
<t>The Incident/ReportTime class is no longer required.  However, the
GenerationTime class is required.</t>
<t>The Fax class was removed and is now represented by a generic Telephone class.</t>
<t>The Telephone, Email, and PostalAddress classes were redefined from improved internationalization.</t>
<t>The "ipv6-net-mask" value was removed from the category attribute of Address.</t>
</list>

</t>
</section> 
</section>

<section title="Extending the IODEF" anchor="extending">

<t>In order to support the dynamic nature of security operations, the IODEF data model will need to continue to evolve.  This section discusses how new data elements can be incorporated into the IODEF.  There is support to add additional enumerated values and new classes.  Adding additional attributes to existing classes is not supported.</t>  

<t>These extension mechanisms are designed so that adding new data elements is possible without requiring modifications to this document.  Extensions can be implemented publicly or privately.  With proven value, well-documented extensions can be incorporated into future versions of the specification.</t>

<section title="Extending the Enumerated Values of Attributes" anchor="extending_enums">
<t>Additional enumerated values can be added to select attributes either through the use of specially marked attributes with the "ext-" prefix or through a set of corresponding IANA registries.  The former approach allows for the extension to remain private.  The latter approach is public.</t>

<section title="Private Extension of Enumerated Values" anchor="extending_enums_private">

<t>
The data model supports adding new enumerated values to an attribute without public registration.  For each attribute that supports this extension technique, there is a corresponding attribute in the same element whose name is identical but with a prefix of "ext-".  This special attribute is referred to as the extension attribute.  The attribute being extended is referred to as an extensible attribute.  For example, an extensible attribute named "foo" will have a corresponding extension attribute named "ext-foo".  An element may have many extensible attributes. 
</t>

<t>
In addition to a corresponding extension attribute, each extensible attribute has "ext-value" as one its possible enumerated values.  Selection of this particular value in an extensible attribute signals that the extension attribute contains data.  Otherwise, this "ext&nbhy;value" value has no meaning.
</t>

<t>
In order to add a new enumerated value to an extensible attribute, the value of this attribute MUST be set to "ext-value", and the new desired value MUST be set in the corresponding extension attribute.  For example, extending the type attribute of the SystemImpact class would look as follows: 

<figure><artwork><![CDATA[
 <SystemImpact type="ext-value" ext-type="new-attack-type">
]]></artwork></figure>
</t>
<t>
A given extension attribute MUST NOT be set unless the corresponding extensible attribute has been set to "ext-value".
</t>
</section>

<section title="Public Extension of Enumerated Values" anchor="extending_enums_public">
<t>
The data model also supports publicly extending select enumerated attributes.  A new entry can be added by registering a new entry in the appropriate IANA registry. <xref target="enum_value_registries" /> provides a mapping between the extensible attributes and their corresponding registry.  <xref target="validation" /> discusses the XML validation implications of this type of extension.  All extensible attributes that support private extensions also support public extensions.
</t>
</section> 

</section> 

<section title="Extending Classes" anchor="extending_classes">
<t>
Classes of the EXTENSION (iodef:ExtensionType) type can extend the data model.  They provide the ability to have new atomic or XML-encoded data elements in all of the top-level classes of the Incident class and in a few of the complex subordinate classes.  As there are multiple instances of the extensible classes in the data model, there is discretion on where to add a new data element.  It is RECOMMENDED that the extension be placed in the most closely related class to the new information.
</t>
<t>
Extensions using the atomic data types (i.e., all values of the dtype attributes other than "xml") MUST:
<list style="numbers">
<t>Set the element content to the desired value, and</t>
<t>Set the dtype attribute to correspond to the data type of the element content.
</t>
</list> 
</t>

<t>
The following guidelines exist for extensions using XML (i.e., dtype="xml"):
<list style="numbers">

<t>The element content of the extensible class MUST be set to the desired value, and the dtype attribute MUST be set to "xml".</t>

<t>The extension schema MUST declare a separate namespace.  It is RECOMMENDED that these extensions have the prefix "iodef-".  This recommendation makes readability of the document easier by allowing the reader to infer which namespaces relate to IODEF by inspection.</t>

<t>It is RECOMMENDED that extension schemas follow the naming convention of the IODEF data model.  This too improves the readability of extended IODEF documents.  The names of all elements SHOULD be capitalized.  For elements with composed names, a capital letter SHOULD be used for each word.  Attribute names SHOULD be in lowercase.  Attributes with composed names SHOULD be separated by a hyphen.</t>  

<t>Implementations that encounter an unrecognized element, attribute, or attribute value in a supported namespace SHOULD reject the document as a syntax error.</t>

<t>There are security and performance implications in requiring implementations to dynamically download schemas at runtime.  Therefore, implementations MUST NOT download schemas at runtime unless the appropriate precautions are taken.  Implementations also need to contend with the potential of significant network and processing issues.</t>

<t>Some adopters of the IODEF may have private schema definitions that are not publicly available.  Thus, implementations may encounter IODEF documents with references to private schemas that may not be resolvable.  Hence, IODEF document recipients MUST be prepared for a schema definition in an IODEF document never to resolve.</t>
</list>
</t>
 
<t>
The following schema and XML document excerpt provide a template for an extension schema and its use in the IODEF document.  
</t>
<t>
This example schema defines a namespace of "iodef-extension1" and a single element named "newdata".

<figure><artwork><![CDATA[
  <xs:schema
     targetNamespace="iodef-extension1.xsd"
     xmlns:iodef-extension1="iodef-extension1.xsd"
     xmlns:xs="http://www.w3.org/2001/XMLSchema">
     attributeFormDefault="unqualified"
     elementFormDefault="qualified">
   <xs:import
        namespace="urn:ietf:params:xml:ns:iodef-2.0"
        schemaLocation=" urn:ietf:params:xml:schema:iodef-2.0"/>

     <xs:element name="newdata" type="xs:string" />
  </xs:schema>
]]></artwork></figure>
</t>
<t>

The following XML excerpt demonstrates the use of the above schema as an extension to the IODEF.


<figure><artwork><![CDATA[
     <IODEF-Document 
          version="2.00" lang="en-US" 
          xmlns="urn:ietf:params:xml:ns:iodef-2.0" 
          xmlns:iodef=" urn:ietf:params:xml:ns:iodef-2.0" 
          xmlns:iodef-extension1="iodef-extension1.xsd" 
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
          xsi:schemaLocation="iodef-extension1.xsd">         
         <Incident purpose="reporting">
         ...
           <AdditionalData dtype="xml" meaning="xml">
             <iodef-extension1:newdata>
              Field that could not be represented elsewhere
             </iodef-extension1:newdata>
           </AdditionalData>
         </Incident>
   </IODEF-Document> 
]]></artwork></figure>
</t>
</section> 

<section title="Deconflicting Private Extensions"
         anchor="conflict_extension">
<t>To disambiguate which private extension is used in an IODEF document, the data model provides a means to identify the source of an extension.  Two attributes in the IODEF-Document class, private&nbhy;enum&nbhy;name and private-enum-id, are used to specify this attribution.  Only a single private extension can be identified in a given IODEF-Document.
</t>

<t>If an implementor has a single private extension, then only the private-enum-name attribute needs to be specified.  Multiple distinct private extensions or versioning of a single extension can be attributed by also setting the corresponding private-num-id attribute.</t>

<t>The following XML excerpt demonstrates the specification of a private extension from "example.com" with an identifier of "13".

<figure><artwork><![CDATA[
     <IODEF-Document 
          version="2.00" lang="en-US"
          private-enum-name="example.com"
          private-enum-id="13" ...> 
         ...
   </IODEF-Document>
]]></artwork></figure>
</t>
<t>If an unrecognized private extension is encountered in processing, the recipient MAY reject the entire document as a syntax error.</t>

</section> 

</section> 


<section title="Internationalization Issues" 
         anchor="internationalization">

<t>Internationalization and localization is of specific concern to the IODEF as it facilitates operational coordination with a diverse set of partners.  The IODEF implements internationalization by relying on XML constructs and through explicit design choices in the data model.
</t>

<t>
Since the IODEF is implemented as an XML schema, it supports different character encodings, such as UTF-8 and UTF-16, that are possible with XML.  Additionally, each IODEF document MUST specify the language in which its content is encoded.  The language can be specified with the attribute "xml:lang" (per Section 2.12 of <xref target="W3C.XML" />) in the top-level element (i.e., IODEF-Document) and lets all other elements inherit that definition.  All IODEF classes with a free-form text definition (i.e., all those defined with type iodef:MLStringType) can also specify a language different from the rest of the document.  
</t>

<t>
The data model supports multiple translations of free-form text.  All ML_STRING (iodef:MLStringType) classes have a one-to-many cardinality to their parent.  This allows the identical text translated into different languages to be encoded in different instances of the same class with a common parent.  This design also enables the creation of a single document containing all the translations.  The IODEF implementation SHOULD extract the appropriate language relevant to the recipient.
</t>

<t>Related instances of a given iodef:MLStringType class that are translations of each other are identified by a common identifier set in the translation-id attribute.  The example below shows three instances of a Description class expressed in three different languages.  The relationship between these three instances of the Description class is conveyed by the common value of "1" in the translation-id attribute.

<figure>
<artwork><![CDATA[
<IODEF-Document version="2.00" xml:lang="en" ...
  <Incident purpose="reporting">
    ...
    <Description translation-id="1"
                 xml:lang="en">English</Description>
    <Description translation-id="1" 
                 xml:lang="de">Englisch</Description>
    <Description translation-id="1" 
                 xml:lang="fr">Anglais</Description>  
]]></artwork></figure></t>

<t>
The IODEF balances internationalization support with the need for interoperability.  While the IODEF supports different languages, the data model also relies heavily on standardized enumerated attributes that can crudely approximate the contents of the document.  With this approach, a CSIRT should be able to make some sense of an IODEF document it receives even if the free-form text data elements are written in a language unfamiliar to the recipient.
</t>
</section>

<section title="Examples" anchor="examples">

<t>
This section provides examples of IODEF documents.  These examples do not represent the full capabilities of the data model or the only way to encode particular information.
</t>

<section title="Minimal Example">
<t>A document containing only the mandatory elements and attributes.</t>

<t>
<figure>
<artwork><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<!-- Minimum IODEF document -->
<IODEF-Document version="2.00" xml:lang="en"   
   xmlns="urn:ietf:params:xml:ns:iodef-2.0"   
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
   xsi:schemaLocation=
"http://www.iana.org/assignments/xml-registry/schema/
iodef-2.0.xsd">
  <Incident purpose="reporting" restriction="private">
    <IncidentID name="csirt.example.com">492382</IncidentID>  
    <GenerationTime>2015-07-18T09:00:00-05:00</GenerationTime>
    <Contact type="organization" role="creator">
      <Email>
        <EmailTo>contact@csirt.example.com</EmailTo>
      </Email>
    </Contact>
    <!-- Add more fields to make the document useful -->
  </Incident>
</IODEF-Document>
]]></artwork></figure></t>
</section> 

<section title="Indicators from a Campaign" anchor="example.indicators">
<t>An example of C2 domains from a given campaign.
</t>
<t><figure>
<artwork><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<!-- A list of C2 domains associated with a campaign -->
<IODEF-Document version="2.00" xml:lang="en"    
   xmlns="urn:ietf:params:xml:ns:iodef-2.0" 
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
   xsi:schemaLocation=
   "http://www.iana.org/assignments/xml-registry/schema/
    iodef-2.0.xsd">
  <Incident purpose="watch" restriction="green">
    <IncidentID name="csirt.example.com">897923</IncidentID>
      <RelatedActivity>
        <ThreatActor>
          <ThreatActorID>
          TA-12-AGGRESSIVE-BUTTERFLY
          </ThreatActorID>
          <Description>Aggressive Butterfly</Description>
        </ThreatActor>
        <Campaign>
          <CampaignID>C-2015-59405</CampaignID>
          <Description>Orange Giraffe</Description>
        </Campaign>
      </RelatedActivity>
      <GenerationTime>2015-10-02T11:18:00-05:00</GenerationTime>
      <Description>Summarizes the Indicators of Compromise 
        for the Orange Giraffe campaign of the Aggressive
        Butterfly crime gang.
      </Description>
      <Assessment>
        <BusinessImpact type="breach-proprietary"/>
      </Assessment>
      <Contact type="organization" role="creator">
        <ContactName>CSIRT for example.com</ContactName>
        <Email>
          <EmailTo>contact@csirt.example.com</EmailTo>
        </Email>
      </Contact>
      <IndicatorData>
        <Indicator>
          <IndicatorID name="csirt.example.com" version="1">
          G90823490
          </IndicatorID>
          <Description>C2 domains</Description>
          <StartTime>2014-12-02T11:18:00-05:00</StartTime>
          <Observable>
            <BulkObservable type="fqdn">
            <BulkObservableList>
              kj290023j09r34.example.com
              09ijk23jfj0k8.example.net
              klknjwfjiowjefr923.example.org
              oimireik79msd.example.org  
            </BulkObservableList>
          </BulkObservable>
        </Observable>
      </Indicator>
    </IndicatorData>
  </Incident>
</IODEF-Document>
]]></artwork></figure></t>
</section> 

</section>  
		
<section title="The IODEF Data Model (XML Schema)" anchor="schema">
<t>
<figure><artwork><![CDATA[
<?xml version="1.0"?>
<xs:schema xmlns="urn:ietf:params:xml:ns:iodef-2.0" 
           xmlns:iodef="urn:ietf:params:xml:ns:iodef-2.0" 
           xmlns:enum="urn:ietf:params:xml:ns:iodef-enum-1.0" 
           xmlns:sci="urn:ietf:params:xml:ns:iodef-sci-1.0" 
           xmlns:xs="http://www.w3.org/2001/XMLSchema" 
           xmlns:ds="http://www.w3.org/2000/09/xmldsig#" 
           targetNamespace="urn:ietf:params:xml:ns:iodef-2.0" 
           elementFormDefault="qualified" 
           attributeFormDefault="unqualified">
  <xs:import namespace="http://www.w3.org/2000/09/xmldsig#" 
             schemaLocation="http://www.w3.org/TR/2002/
REC-xmldsig-core-20020212/xmldsig-core-schema.xsd"/>
  <xs:import namespace="urn:ietf:params:xml:ns:iodef-enum-1.0" 
             schemaLocation="http://www.iana.org/assignments/
xml-registry/schema/iodef-enum-1.0.xsd"/>
  <xs:import namespace="urn:ietf:params:xml:ns:iodef-sci-1.0" 
             schemaLocation="http://www.iana.org/assignments/
xml-registry/schema/iodef-sci-1.0.xsd"/>
  <xs:import namespace="http://www.w3.org/XML/1998/namespace" 
             schemaLocation="http://www.w3c.org/2001/xml.xsd"/>
  <xs:annotation>
    <xs:documentation>
       Incident Object Description Exchange Format v2.0
    </xs:documentation>
  </xs:annotation>
  <!--
   ===================================================================
   == IODEF-Document class                                          ==
   ===================================================================
  -->
  <xs:element name="IODEF-Document">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Incident" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="version" type="xs:string" fixed="2.00"/>
      <xs:attribute ref="xml:lang"/>
      <xs:attribute name="format-id" type="xs:string" use="optional"/>
      <xs:attribute name="private-enum-name" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="private-enum-id" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <!--
   ===================================================================
   == Incident class                                                ==
   ===================================================================
  -->
  <xs:element name="Incident">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:IncidentID"/>
        <xs:element ref="iodef:AlternativeID" minOccurs="0"/>
        <xs:element ref="iodef:RelatedActivity" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:DetectTime" minOccurs="0"/>
        <xs:element ref="iodef:StartTime" minOccurs="0"/>
        <xs:element ref="iodef:EndTime" minOccurs="0"/>
        <xs:element ref="iodef:RecoveryTime" minOccurs="0"/>
        <xs:element ref="iodef:ReportTime" minOccurs="0"/>
        <xs:element ref="iodef:GenerationTime"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Discovery" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Assessment" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Method" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Contact" maxOccurs="unbounded"/>
        <xs:element ref="iodef:EventData" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:IndicatorData" minOccurs="0"/>
        <xs:element ref="iodef:History" minOccurs="0"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="purpose" 
                    type="incident-purpose-type" use="required"/>
      <xs:attribute name="ext-purpose" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="status" type="incident-status-type"/>
      <xs:attribute name="ext-status" 
                    type="xs:string" use="optional"/>
      <xs:attribute ref="xml:lang"/>
      <xs:attribute name="restriction" 
                    type="iodef:restriction-type" default="private"
                    use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="incident-purpose-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="traceback"/>
      <xs:enumeration value="mitigation"/>
      <xs:enumeration value="reporting"/>
      <xs:enumeration value="watch"/>
      <xs:enumeration value="other"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="incident-status-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="new"/>
      <xs:enumeration value="in-progress"/>
      <xs:enumeration value="forwarded"/>
      <xs:enumeration value="resolved"/>
      <xs:enumeration value="future"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <!--
   ===================================================================
   ==  IncidentID class                                             ==
   ===================================================================
  -->
  <xs:element name="IncidentID" type="iodef:IncidentIDType"/>
  <xs:complexType name="IncidentIDType">
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="name" type="xs:string" use="required"/>
        <xs:attribute name="instance" 
                      type="xs:string" use="optional"/>
        <xs:attribute name="restriction" 
                      type="iodef:restriction-type" use="optional"/>
        <xs:attribute name="ext-restriction" 
                      type="xs:string" use="optional"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <!--
   ==================================================================
   ==  AlternativeID class                                         ==
   ==================================================================
  -->
  <xs:element name="AlternativeID">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:IncidentID" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <!--
   ===================================================================
   ==  RelatedActivity class                                        ==
   ===================================================================
  -->
  <xs:element name="RelatedActivity">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:IncidentID" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:URL" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:ThreatActor" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Campaign" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:IndicatorID" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Confidence" minOccurs="0"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="ThreatActor">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:ThreatActorID" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:URL" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="ThreatActorID" type="xs:string"/>
  <xs:element name="Campaign">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:CampaignID" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:URL" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction" 
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="CampaignID" type="xs:string"/>
  <!--
   ===================================================================
   ==   Contact class                                               ==
   ===================================================================
  -->
  <xs:element name="Contact">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:ContactName" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:ContactTitle" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:RegistryHandle" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:PostalAddress" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Email" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Telephone" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Timezone" minOccurs="0"/>
        <xs:element ref="iodef:Contact" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="role" 
                    type="contact-role-type" use="required"/>
      <xs:attribute name="ext-role" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="type" 
                    type="contact-type-type" use="required"/>
      <xs:attribute name="ext-type" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="contact-role-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="creator"/>
      <xs:enumeration value="reporter"/>
      <xs:enumeration value="admin"/>
      <xs:enumeration value="tech"/>
      <xs:enumeration value="provider"/>
      <xs:enumeration value="user"/>
      <xs:enumeration value="billing"/>
      <xs:enumeration value="legal"/>
      <xs:enumeration value="abuse"/>
      <xs:enumeration value="irt"/>
      <xs:enumeration value="cc"/>
      <xs:enumeration value="cc-irt"/>
      <xs:enumeration value="leo"/>
      <xs:enumeration value="vendor"/>
      <xs:enumeration value="vendor-services"/>
      <xs:enumeration value="victim"/>
      <xs:enumeration value="victim-notified"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="contact-type-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="person"/>
      <xs:enumeration value="organization"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="ContactName" type="iodef:MLStringType"/>
  <xs:element name="ContactTitle" type="iodef:MLStringType"/>
  <xs:element name="RegistryHandle">
    <xs:complexType>
      <xs:simpleContent>
        <xs:extension base="xs:string">
          <xs:attribute name="registry" 
                        type="registryhandle-registry-type"/>
          <xs:attribute name="ext-registry" 
                        type="xs:string" use="optional"/>
        </xs:extension>
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="registryhandle-registry-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="internic"/>
      <xs:enumeration value="apnic"/>
      <xs:enumeration value="arin"/>
      <xs:enumeration value="lacnic"/>
      <xs:enumeration value="ripe"/>
      <xs:enumeration value="afrinic"/>
      <xs:enumeration value="local"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="PostalAddress">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:PAddress"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="type" 
                    type="postaladdress-type-type" use="optional"/>
      <xs:attribute name="ext-type" type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="PAddress" type="iodef:MLStringType"/>
  <xs:simpleType name="postaladdress-type-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="street"/>
      <xs:enumeration value="mailing"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="Telephone">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:TelephoneNumber"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="type" 
                    type="telephone-type-type" use="optional"/>
      <xs:attribute name="ext-type" type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="TelephoneNumber" type="xs:string"/>
  <xs:simpleType name="telephone-type-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="wired"/>
      <xs:enumeration value="mobile"/>
      <xs:enumeration value="fax"/>
      <xs:enumeration value="hotline"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="Email">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:EmailTo"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="type" 
                    type="email-type-type" use="optional"/>
      <xs:attribute name="ext-type" type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="email-type-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="direct"/>
      <xs:enumeration value="hotline"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <!--
   ===================================================================
   ==  Time-based classes                                           ==
   ===================================================================
  -->
  <xs:element name="DateTime" type="xs:dateTime"/>
  <xs:element name="ReportTime" type="xs:dateTime"/>
  <xs:element name="DetectTime" type="xs:dateTime"/>
  <xs:element name="StartTime" type="xs:dateTime"/>
  <xs:element name="EndTime" type="xs:dateTime"/>
  <xs:element name="RecoveryTime" type="xs:dateTime"/>
  <xs:element name="GenerationTime" type="xs:dateTime"/>
  <xs:element name="Timezone" type="iodef:TimezoneType"/>
  <!--
   ===================================================================
   ==  History class                                                ==
   ===================================================================
  -->
  <xs:element name="History">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:HistoryItem" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="HistoryItem">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:DateTime"/>
        <xs:element ref="iodef:IncidentID" minOccurs="0"/>
        <xs:element ref="iodef:Contact" minOccurs="0"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:DefinedCOA" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="action" 
                    type="iodef:action-type" use="required"/>
      <xs:attribute name="ext-action" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="DefinedCOA" type="xs:string"/>
  <!--
   ===================================================================
   ==  Expectation class                                            ==
   ===================================================================
  -->
  <xs:element name="Expectation">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:DefinedCOA" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:StartTime" minOccurs="0"/>
        <xs:element ref="iodef:EndTime" minOccurs="0"/>
        <xs:element ref="iodef:Contact" minOccurs="0"/>
      </xs:sequence>
      <xs:attribute name="action" 
                    type="iodef:action-type" default="other"/>
      <xs:attribute name="ext-action" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="severity" type="iodef:severity-type"/>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <!--
   ===================================================================
   ==  Discovery class                                              ==
   ===================================================================
  -->
  <xs:element name="Discovery">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Contact" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:DetectionPattern" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="source" 
                    type="discovery-source-type" use="optional" 
                    default="unknown"/>
      <xs:attribute name="ext-source" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="discovery-source-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="nidps"/>
      <xs:enumeration value="hips"/>
      <xs:enumeration value="siem"/>
      <xs:enumeration value="av"/>
      <xs:enumeration value="third-party-monitoring"/>
      <xs:enumeration value="incident"/>
      <xs:enumeration value="os-log"/>
      <xs:enumeration value="application-log"/>
      <xs:enumeration value="device-log"/>
      <xs:enumeration value="network-flow"/>
      <xs:enumeration value="passive-dns"/>
      <xs:enumeration value="investigation"/>
      <xs:enumeration value="audit"/>
      <xs:enumeration value="internal-notification"/>
      <xs:enumeration value="external-notification"/>
      <xs:enumeration value="leo"/>
      <xs:enumeration value="partner"/>
      <xs:enumeration value="actor"/>
      <xs:enumeration value="unknown"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="DetectionPattern">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Application"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element name="DetectionConfiguration" 
                    type="xs:string" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <!--
   ===================================================================
   ==  Method class                                                 ==
   ===================================================================
  -->
  <xs:element name="Method">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Reference" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="sci:AttackPattern" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="sci:Vulnerability" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="sci:Weakness" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <!--
   ===================================================================
   ==  Reference class                                              ==
   ===================================================================
  -->
  <xs:element name="Reference">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="enum:ReferenceName" minOccurs="0"/>
        <xs:element ref="iodef:URL" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <!--
   ===================================================================
   ==  Assessment class                                             ==
   ===================================================================
  -->
  <xs:element name="Assessment">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:IncidentCategory" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:choice maxOccurs="unbounded">
          <xs:element ref="iodef:SystemImpact"/>
          <xs:element ref="iodef:BusinessImpact"/>
          <xs:element ref="iodef:TimeImpact"/>
          <xs:element ref="iodef:MonetaryImpact"/>
          <xs:element ref="iodef:IntendedImpact"/>
        </xs:choice>
        <xs:element ref="iodef:Counter" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:MitigatingFactor" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Cause" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Confidence" minOccurs="0"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="occurrence">
        <xs:simpleType>
          <xs:restriction base="xs:NMTOKEN">
            <xs:enumeration value="actual"/>
            <xs:enumeration value="potential"/>
          </xs:restriction>
        </xs:simpleType>
      </xs:attribute>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="IncidentCategory" type="iodef:MLStringType"/>
  <xs:element name="BusinessImpact" type="iodef:BusinessImpactType"/>
  <xs:element name="IntendedImpact" type="iodef:BusinessImpactType"/>
  <xs:element name="MitigatingFactor" type="iodef:MLStringType"/>
  <xs:element name="Cause" type="iodef:MLStringType"/>
  <xs:element name="SystemImpact">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="severity" 
                    type="iodef:severity-type" use="optional"/>
      <xs:attribute name="completion" 
                    type="iodef:systemimpact-completion-type" 
                    use="optional"/>
      <xs:attribute name="type" 
                    type="systemimpact-type-type" 
                    use="optional" default="unknown"/>
      <xs:attribute name="ext-type" type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="systemimpact-completion-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="failed"/>
      <xs:enumeration value="succeeded"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="systemimpact-type-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="takeover-account"/>
      <xs:enumeration value="takeover-service"/>
      <xs:enumeration value="takeover-system"/>
      <xs:enumeration value="cps-manipulation"/>
      <xs:enumeration value="cps-damage"/>
      <xs:enumeration value="availability-data"/>
      <xs:enumeration value="availability-account"/>
      <xs:enumeration value="availability-service"/>
      <xs:enumeration value="availability-system"/>
      <xs:enumeration value="damaged-system"/>
      <xs:enumeration value="damaged-data"/>
      <xs:enumeration value="breach-proprietary"/>
      <xs:enumeration value="breach-privacy"/>
      <xs:enumeration value="breach-credential"/>
      <xs:enumeration value="breach-configuration"/>
      <xs:enumeration value="integrity-data"/>
      <xs:enumeration value="integrity-configuration"/>
      <xs:enumeration value="integrity-hardware"/>
      <xs:enumeration value="traffic-redirection"/>
      <xs:enumeration value="monitoring-traffic"/>
      <xs:enumeration value="monitoring-host"/>
      <xs:enumeration value="policy"/>
      <xs:enumeration value="unknown"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:complexType name="BusinessImpactType">
    <xs:sequence>
      <xs:element ref="iodef:Description" 
                  minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
    <xs:attribute name="severity" 
                  type="businessimpact-severity-type" use="optional"/>
    <xs:attribute name="ext-severity" 
                  type="xs:string" use="optional"/>
    <xs:attribute name="type" 
                  type="businessimpact-type-type" 
                  use="optional" default="unknown"/>
    <xs:attribute name="ext-type" type="xs:string" use="optional"/>
  </xs:complexType>
  <xs:simpleType name="businessimpact-severity-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="none"/>
      <xs:enumeration value="low"/>
      <xs:enumeration value="medium"/>
      <xs:enumeration value="high"/>
      <xs:enumeration value="unknown"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="businessimpact-type-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="breach-proprietary"/>
      <xs:enumeration value="breach-privacy"/>
      <xs:enumeration value="breach-credential"/>
      <xs:enumeration value="loss-of-integrity"/>
      <xs:enumeration value="loss-of-service"/>
      <xs:enumeration value="theft-financial"/>
      <xs:enumeration value="theft-service"/>
      <xs:enumeration value="degraded-reputation"/>
      <xs:enumeration value="asset-damage"/>
      <xs:enumeration value="asset-manipulation"/>
      <xs:enumeration value="legal"/>
      <xs:enumeration value="extortion"/>
      <xs:enumeration value="unknown"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="TimeImpact">
    <xs:complexType>
      <xs:simpleContent>
        <xs:extension base="iodef:PositiveFloatType">
          <xs:attribute name="severity" type="iodef:severity-type"/>
          <xs:attribute name="metric" 
                        type="timeimpact-metric-type" use="required"/>
          <xs:attribute name="ext-metric" 
                        type="xs:string" use="optional"/>
          <xs:attribute name="duration" type="iodef:duration-type"/>
          <xs:attribute name="ext-duration" 
                        type="xs:string" use="optional"/>
        </xs:extension>
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="timeimpact-metric-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="labor"/>
      <xs:enumeration value="elapsed"/>
      <xs:enumeration value="downtime"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="MonetaryImpact">
    <xs:complexType>
      <xs:simpleContent>
        <xs:extension base="iodef:PositiveFloatType">
          <xs:attribute name="severity" type="iodef:severity-type"/>
          <xs:attribute name="currency" type="xs:string"/>
        </xs:extension>
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>
  <xs:element name="Confidence">
    <xs:complexType>
      <xs:attribute name="rating" 
                    type="confidence-rating-type" use="required"/>
      <xs:attribute name="ext-rating" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="confidence-rating-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="low"/>
      <xs:enumeration value="medium"/>
      <xs:enumeration value="high"/>
      <xs:enumeration value="numeric"/>
      <xs:enumeration value="unknown"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <!--
   ===================================================================
   == EventData class                                               ==
   ===================================================================
  -->
  <xs:element name="EventData">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:DetectTime" minOccurs="0"/>
        <xs:element ref="iodef:StartTime" minOccurs="0"/>
        <xs:element ref="iodef:EndTime" minOccurs="0"/>
        <xs:element ref="iodef:RecoveryTime" minOccurs="0"/>
        <xs:element ref="iodef:ReportTime" minOccurs="0"/>
        <xs:element ref="iodef:Contact" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Discovery" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Assessment" minOccurs="0"/>
        <xs:element ref="iodef:Method" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Flow" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Expectation" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Record" minOccurs="0"/>
        <xs:element ref="iodef:EventData" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <!--
   ===================================================================
   ==  Flow class                                                   ==
   ===================================================================
  -->
  <xs:element name="Flow">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:System" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <!--
   ===================================================================
   ==  System class                                                 ==
   ===================================================================
  -->
  <xs:element name="System">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Node"/>
        <xs:element ref="iodef:NodeRole" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Service" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:OperatingSystem" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Counter" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element name="AssetID" 
                    type="xs:string" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="category" type="system-category-type"/>
      <xs:attribute name="ext-category" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="interface" type="xs:string"/>
      <xs:attribute name="spoofed" 
                    type="yes-no-unknown-type" default="unknown"/>
      <xs:attribute name="virtual" 
                    type="yes-no-unknown-type" use="optional" 
                    default="unknown"/>
      <xs:attribute name="ownership" type="system-ownership-type" 
                    use="optional"/>
      <xs:attribute name="ext-ownership" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="OperatingSystem" type="iodef:SoftwareType"/>
  <xs:simpleType name="system-category-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="source"/>
      <xs:enumeration value="target"/>
      <xs:enumeration value="intermediate"/>
      <xs:enumeration value="sensor"/>
      <xs:enumeration value="infrastructure"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="system-ownership-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="organization"/>
      <xs:enumeration value="personal"/>
      <xs:enumeration value="partner"/>
      <xs:enumeration value="customer"/>
      <xs:enumeration value="no-relationship"/>
      <xs:enumeration value="unknown"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <!--
   ==================================================================
   == Node class                                                   ==
   ==================================================================
  -->
  <xs:element name="Node">
    <xs:complexType>
      <xs:sequence>
        <xs:choice maxOccurs="unbounded">
          <xs:element ref="iodef:DomainData" 
                      minOccurs="0" maxOccurs="unbounded"/>
          <xs:element ref="iodef:Address" 
                      minOccurs="0" maxOccurs="unbounded"/>
        </xs:choice>
        <xs:element ref="iodef:PostalAddress" minOccurs="0"/>
        <xs:element ref="iodef:Location" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Counter" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="Address">
    <xs:complexType>
      <xs:simpleContent>
        <xs:extension base="xs:string">
          <xs:attribute name="category" 
                        type="address-category-type" 
                        default="ipv6-addr"/>
          <xs:attribute name="ext-category" 
                        type="xs:string" use="optional"/>
          <xs:attribute name="vlan-name" type="xs:string"/>
          <xs:attribute name="vlan-num" type="xs:integer"/>
          <xs:attribute name="observable-id" 
                        type="xs:ID" use="optional"/>
        </xs:extension>
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="address-category-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="asn"/>
      <xs:enumeration value="atm"/>
      <xs:enumeration value="e-mail"/>
      <xs:enumeration value="mac"/>
      <xs:enumeration value="ipv4-addr"/>
      <xs:enumeration value="ipv4-net"/>
      <xs:enumeration value="ipv4-net-masked"/>
      <xs:enumeration value="ipv4-net-mask"/>
      <xs:enumeration value="ipv6-addr"/>
      <xs:enumeration value="ipv6-net"/>
      <xs:enumeration value="ipv6-net-masked"/>
      <xs:enumeration value="site-uri"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="Location" type="iodef:MLStringType"/>
  <xs:element name="NodeRole">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="category" 
                    type="noderole-category-type" use="required"/>
      <xs:attribute name="ext-category" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="noderole-category-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="client"/>
      <xs:enumeration value="client-enterprise"/>
      <xs:enumeration value="client-partner"/>
      <xs:enumeration value="client-remote"/>
      <xs:enumeration value="client-kiosk"/>
      <xs:enumeration value="client-mobile"/>
      <xs:enumeration value="server-internal"/>
      <xs:enumeration value="server-public"/>
      <xs:enumeration value="www"/>
      <xs:enumeration value="mail"/>
      <xs:enumeration value="webmail"/>
      <xs:enumeration value="messaging"/>
      <xs:enumeration value="streaming"/>
      <xs:enumeration value="voice"/>
      <xs:enumeration value="file"/>
      <xs:enumeration value="ftp"/>
      <xs:enumeration value="p2p"/>
      <xs:enumeration value="name"/>
      <xs:enumeration value="directory"/>
      <xs:enumeration value="credential"/>
      <xs:enumeration value="print"/>
      <xs:enumeration value="application"/>
      <xs:enumeration value="database"/>
      <xs:enumeration value="backup"/>
      <xs:enumeration value="dhcp"/>
      <xs:enumeration value="assessment"/>
      <xs:enumeration value="source-control"/>
      <xs:enumeration value="config-management"/>
      <xs:enumeration value="monitoring"/>
      <xs:enumeration value="infra"/>
      <xs:enumeration value="infra-firewall"/>
      <xs:enumeration value="infra-router"/>
      <xs:enumeration value="infra-switch"/>
      <xs:enumeration value="camera"/>
      <xs:enumeration value="proxy"/>
      <xs:enumeration value="remote-access"/>
      <xs:enumeration value="log"/>
      <xs:enumeration value="virtualization"/>
      <xs:enumeration value="pos"/>
      <xs:enumeration value="scada"/>
      <xs:enumeration value="scada-supervisory"/>
      <xs:enumeration value="sinkhole"/>
      <xs:enumeration value="honeypot"/>
      <xs:enumeration value="anonymization"/>
      <xs:enumeration value="c2-server"/>
      <xs:enumeration value="malware-distribution"/>
      <xs:enumeration value="drop-server"/>
      <xs:enumeration value="hop-point"/>
      <xs:enumeration value="reflector"/>
      <xs:enumeration value="phishing-site"/>
      <xs:enumeration value="spear-phishing-site"/>
      <xs:enumeration value="recruiting-site"/>
      <xs:enumeration value="fraudulent-site"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <!--
   ===================================================================
   ==  Service class                                                ==
   ===================================================================
  -->
  <xs:element name="Service">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:ServiceName" minOccurs="0"/>
        <xs:element ref="iodef:Port" minOccurs="0"/>
        <xs:element ref="iodef:Portlist" minOccurs="0"/>
        <xs:element ref="iodef:ProtoType" minOccurs="0"/>
        <xs:element ref="iodef:ProtoCode" minOccurs="0"/>
        <xs:element ref="iodef:ProtoField" minOccurs="0"/>
        <xs:element ref="iodef:ApplicationHeader" minOccurs="0"/>
        <xs:element ref="iodef:EmailData" minOccurs="0"/>
        <xs:element ref="iodef:Application" minOccurs="0"/>
      </xs:sequence>
      <xs:attribute name="ip-protocol" 
                    type="xs:integer" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="Port" type="xs:integer"/>
  <xs:element name="Portlist" type="iodef:PortlistType"/>
  <xs:element name="ProtoType" type="xs:integer"/>
  <xs:element name="ProtoCode" type="xs:integer"/>
  <xs:element name="ProtoField" type="xs:integer"/>
  <xs:element name="ApplicationHeader">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:ApplicationHeaderField" 
                    maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="ApplicationHeaderField" 
              type="iodef:ExtensionType"/>
  <xs:element name="ServiceName">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:IANAService"
                    minOccurs="0"/>
        <xs:element ref="iodef:URL" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="IANAService" type="xs:string"/>
  <xs:element name="Application" type="iodef:SoftwareType"/>
  <!--
   ===================================================================
   ==  Counter class                                                ==
   ===================================================================
  -->
  <xs:element name="Counter">
    <xs:complexType>
      <xs:simpleContent>
        <xs:extension base="xs:float">
          <xs:attribute name="type" 
                        type="counter-type-type" use="required"/>
          <xs:attribute name="ext-type" 
                        type="xs:string" use="optional"/>
          <xs:attribute name="unit" 
                        type="counter-unit-type" use="required"/>
          <xs:attribute name="ext-unit" 
                        type="xs:string" use="optional"/>
          <xs:attribute name="meaning" 
                        type="xs:string" use="optional"/>
          <xs:attribute name="duration" type="iodef:duration-type"/>
          <xs:attribute name="ext-duration" 
                        type="xs:string" use="optional"/>
        </xs:extension>
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="counter-type-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="counter"/>
      <xs:enumeration value="rate"/>
      <xs:enumeration value="average"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="counter-unit-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="byte"/>
      <xs:enumeration value="mbit"/>
      <xs:enumeration value="packet"/>
      <xs:enumeration value="flow"/>
      <xs:enumeration value="session"/>
      <xs:enumeration value="event"/>
      <xs:enumeration value="alert"/>
      <xs:enumeration value="message"/>
      <xs:enumeration value="host"/>
      <xs:enumeration value="site"/>
      <xs:enumeration value="organization"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <!--
   ===================================================================
   ==  EmailData class                                              ==
   ===================================================================
  -->
  <xs:element name="EmailData">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:EmailTo" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:EmailFrom" minOccurs="0"/>
        <xs:element ref="iodef:EmailSubject" minOccurs="0"/>
        <xs:element ref="iodef:EmailX-Mailer" minOccurs="0"/>
        <xs:element ref="iodef:EmailHeaderField" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:EmailHeaders" minOccurs="0"/>
        <xs:element ref="iodef:EmailBody" minOccurs="0"/>
        <xs:element ref="iodef:EmailMessage" minOccurs="0"/>
        <xs:element ref="iodef:HashData" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="SignatureData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="EmailTo" type="xs:string"/>
  <xs:element name="EmailFrom" type="xs:string"/>
  <xs:element name="EmailSubject" type="xs:string"/>
  <xs:element name="EmailX-Mailer" type="xs:string"/>
  <xs:element name="EmailHeaderField" type="iodef:ExtensionType"/>
  <xs:element name="EmailHeaders" type="xs:string"/>
  <xs:element name="EmailBody" type="xs:string"/>
  <xs:element name="EmailMessage" type="xs:string"/>
  <!--
   ===================================================================
   ==   DomainData class                                            ==
   ===================================================================
  -->
  <xs:element name="DomainData">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Name"/>
        <xs:element ref="iodef:DateDomainWasChecked" 
                    minOccurs="0"/>
        <xs:element ref="iodef:RegistrationDate" 
                    minOccurs="0"/>
        <xs:element ref="iodef:ExpirationDate" 
                    minOccurs="0"/>
        <xs:element ref="iodef:RelatedDNS" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Nameservers" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:DomainContacts" 
                    minOccurs="0"/>
      </xs:sequence>
      <xs:attribute name="system-status" 
                    type="domaindata-system-status-type"/>
      <xs:attribute name="ext-system-status" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="domain-status" 
                    type="domaindata-domain-status-type"/>
      <xs:attribute name="ext-domain-status" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="Name" type="xs:string"/>
  <xs:element name="DateDomainWasChecked" type="xs:dateTime"/>
  <xs:element name="RegistrationDate" type="xs:dateTime"/>
  <xs:element name="ExpirationDate" type="xs:dateTime"/>
  <xs:simpleType name="domaindata-system-status-type">
    <xs:restriction base="xs:string">
      <xs:enumeration value="spoofed"/>
      <xs:enumeration value="fraudulent"/>
      <xs:enumeration value="innocent-hacked"/>
      <xs:enumeration value="innocent-hijacked"/>
      <xs:enumeration value="unknown"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="domaindata-domain-status-type">
    <xs:restriction base="xs:string">
      <xs:enumeration value="reservedDelegation"/>
      <xs:enumeration value="assignedAndActive"/>
      <xs:enumeration value="assignedAndInactive"/>
      <xs:enumeration value="assignedAndOnHold"/>
      <xs:enumeration value="revoked"/>
      <xs:enumeration value="transferPending"/>
      <xs:enumeration value="registryLock"/>
      <xs:enumeration value="registrarLock"/>
      <xs:enumeration value="other"/>
      <xs:enumeration value="unknown"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="RelatedDNS" type="iodef:ExtensionType"/>
  <xs:element name="Nameservers">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Server"/>
        <xs:element ref="iodef:Address" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="Server" type="xs:string"/>
  <xs:element name="DomainContacts">
    <xs:complexType>
      <xs:choice>
        <xs:element ref="iodef:SameDomainContact"/>
        <xs:element ref="iodef:Contact" 
                    minOccurs="1" maxOccurs="unbounded"/>
      </xs:choice>
    </xs:complexType>
  </xs:element>
  <xs:element name="SameDomainContact" type="xs:string"/>
  <!--
   ===================================================================
   ==  Record class                                                 ==
   ===================================================================
  -->
  <xs:element name="Record">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:RecordData" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="RecordData">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:DateTime" minOccurs="0"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Application" minOccurs="0"/>
        <xs:element ref="iodef:RecordPattern" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:RecordItem" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:URL" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:FileData" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:WindowsRegistryKeysModified" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:CertificateData" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="RecordPattern">
    <xs:complexType>
      <xs:simpleContent>
        <xs:extension base="xs:string">
          <xs:attribute name="type" 
                        type="recordpattern-type-type" 
                        use="required"/>
          <xs:attribute name="ext-type" 
                        type="xs:string" use="optional"/>
          <xs:attribute name="offset" 
                        type="xs:integer" use="optional"/>
          <xs:attribute name="offsetunit" 
                        type="recordpattern-offsetunit-type" 
                        use="optional" default="line"/>
          <xs:attribute name="ext-offsetunit" 
                        type="xs:string" use="optional"/>
          <xs:attribute name="instance" 
                        type="xs:integer" use="optional"/>
        </xs:extension>
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="recordpattern-type-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="regex"/>
      <xs:enumeration value="binary"/>
      <xs:enumeration value="xpath"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="recordpattern-offsetunit-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="line"/>
      <xs:enumeration value="byte"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="RecordItem" type="iodef:ExtensionType"/>
  <!--
   ===================================================================
   ==  WindowsRegistryKeysModified class                            ==
   ===================================================================
  -->
  <xs:element name="WindowsRegistryKeysModified">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Key" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="Key">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:KeyName"/>
        <xs:element ref="iodef:Value" minOccurs="0"/>
      </xs:sequence>
      <xs:attribute name="registryaction" 
                    type="key-registryaction-type"/>
      <xs:attribute name="ext-registryaction" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="KeyName" type="xs:string"/>
  <xs:element name="Value" type="xs:string"/>
  <xs:simpleType name="key-registryaction-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="add-key"/>
      <xs:enumeration value="add-value"/>
      <xs:enumeration value="delete-key"/>
      <xs:enumeration value="delete-value"/>
      <xs:enumeration value="modify-key"/>
      <xs:enumeration value="modify-value"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <!--
  ====================================================================
  ==  FileData class                                                ==
  ====================================================================
  -->
  <xs:element name="FileData">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:File" 
                    minOccurs="1" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction" 
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="File">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:FileName" minOccurs="0"/>
        <xs:element ref="iodef:FileSize" minOccurs="0"/>
        <xs:element ref="FileType" minOccurs="0"/>
        <xs:element ref="iodef:URL" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:HashData" minOccurs="0"/>
        <xs:element ref="iodef:SignatureData" minOccurs="0"/>
        <xs:element ref="iodef:AssociatedSoftware" minOccurs="0"/>
        <xs:element ref="iodef:FileProperties" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="FileName" type="xs:string"/>
  <xs:element name="FileSize" type="xs:integer"/>
  <xs:element name="FileType" type="xs:string"/>
  <xs:element name="AssociatedSoftware" type="iodef:SoftwareType"/>
  <xs:element name="FileProperties" type="iodef:ExtensionType"/>
  <!--
  ====================================================================
  ==  HashData class                                                ==
  ====================================================================
  -->
  <xs:element name="HashData">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:HashTargetID" minOccurs="0"/>
        <xs:element ref="iodef:Hash" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:FuzzyHash" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="scope" 
                    type="hashdata-scope-type" use="required"/>
      <xs:attribute name="ext-scope" type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="HashTargetID" type="xs:string"/>
  <xs:simpleType name="hashdata-scope-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="file-contents"/>
      <xs:enumeration value="file-pe-section"/>
      <xs:enumeration value="file-pe-iat"/>
      <xs:enumeration value="file-pe-resource"/>
      <xs:enumeration value="file-pdf-object"/>
      <xs:enumeration value="email-hash"/>
      <xs:enumeration value="email-headers-hash"/>
      <xs:enumeration value="email-body-hash"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="Hash">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="ds:DigestMethod"/>
        <xs:element ref="ds:DigestValue"/>
        <xs:element ref="ds:CanonicalizationMethod"
                    minOccurs="0"/>
        <xs:element ref="iodef:Application" minOccurs="0"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="FuzzyHash">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:FuzzyHashValue" 
                    maxOccurs="unbounded"/>
        <xs:element ref="iodef:Application" minOccurs="0"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="FuzzyHashValue" type="iodef:ExtensionType"/>
  <!--
   ===================================================================
   ==  SignatureData class                                          ==
   ===================================================================
  -->
  <xs:element name="SignatureData">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="ds:Signature" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <!--
   ===================================================================
   ==  CertificateData class                                        ==
   ===================================================================
  -->
  <xs:element name="CertificateData">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Certificate" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="Certificate">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="ds:X509Data"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
    </xs:complexType>
  </xs:element>
  <!--
   ===================================================================
   == IndicatorData class                                           ==
   ===================================================================
  -->
  <xs:element name="IndicatorData">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Indicator" 
                    minOccurs="1" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="Indicator">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:IndicatorID"/>
        <xs:element ref="iodef:AlternativeIndicatorID" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:StartTime" minOccurs="0"/>
        <xs:element ref="iodef:EndTime" minOccurs="0"/>
        <xs:element ref="iodef:Confidence" minOccurs="0"/>
        <xs:element ref="iodef:Contact" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:choice>
          <xs:element ref="iodef:Observable"/>
          <xs:element ref="iodef:ObservableReference"/>
          <xs:element ref="iodef:IndicatorExpression"/>
          <xs:element ref="iodef:IndicatorReference"/>
        </xs:choice>
        <xs:element ref="iodef:NodeRole" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AttackPhase" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Reference" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="IndicatorID">
    <xs:complexType>
      <xs:simpleContent>
        <xs:extension base="xs:ID">
          <xs:attribute name="name" type="xs:string" use="required"/>
          <xs:attribute name="version" 
                        type="xs:string" use="required"/>
        </xs:extension>
      </xs:simpleContent>
    </xs:complexType>
  </xs:element>
  <xs:element name="AlternativeIndicatorID">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:IndicatorID" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="Observable">
    <xs:complexType>
      <xs:choice>
        <xs:element ref="iodef:System" minOccurs="0"/>
        <xs:element ref="iodef:Address" minOccurs="0"/>
        <xs:element ref="iodef:DomainData" minOccurs="0"/>
        <xs:element ref="iodef:Service" minOccurs="0"/>
        <xs:element ref="iodef:EmailData" minOccurs="0"/>
        <xs:element ref="iodef:WindowsRegistryKeysModified" 
                         minOccurs="0"/>
        <xs:element ref="iodef:FileData" minOccurs="0"/>
        <xs:element ref="iodef:CertificateData" minOccurs="0"/>
        <xs:element ref="iodef:RegistryHandle" minOccurs="0"/>
        <xs:element ref="iodef:RecordData" minOccurs="0"/>
        <xs:element ref="iodef:EventData" minOccurs="0"/>
        <xs:element ref="iodef:Incident" minOccurs="0"/>
        <xs:element ref="iodef:Expectation" minOccurs="0"/>
        <xs:element ref="iodef:Reference" minOccurs="0"/>
        <xs:element ref="iodef:Assessment" minOccurs="0"/>
        <xs:element ref="iodef:DetectionPattern" minOccurs="0"/>
        <xs:element ref="iodef:HistoryItem" minOccurs="0"/>
        <xs:element ref="iodef:BulkObservable" minOccurs="0"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:choice>
      <xs:attribute name="restriction"
                    type="iodef:restriction-type" use="optional"/>
      <xs:attribute name="ext-restriction" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="BulkObservable">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:BulkObservableFormat" minOccurs="0"/>
        <xs:element name="BulkObservableList"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="type" 
                    type="bulkobservable-type-type" use="required"/>
      <xs:attribute name="ext-type" type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="bulkobservable-type-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="asn"/>
      <xs:enumeration value="atm"/>
      <xs:enumeration value="e-mail"/>
      <xs:enumeration value="ipv4-addr"/>
      <xs:enumeration value="ipv4-net"/>
      <xs:enumeration value="ipv4-net-mask"/>
      <xs:enumeration value="ipv6-addr"/>
      <xs:enumeration value="ipv6-net"/>
      <xs:enumeration value="ipv6-net-mask"/>
      <xs:enumeration value="mac"/>
      <xs:enumeration value="site-uri"/>
      <xs:enumeration value="domain-name"/>
      <xs:enumeration value="domain-to-ipv4"/>
      <xs:enumeration value="domain-to-ipv6"/>
      <xs:enumeration value="domain-to-ipv4-timestamp"/>
      <xs:enumeration value="domain-to-ipv6-timestamp"/>
      <xs:enumeration value="ipv4-port"/>
      <xs:enumeration value="ipv6-port"/>
      <xs:enumeration value="windows-reg-key"/>
      <xs:enumeration value="file-hash"/>
      <xs:enumeration value="email-x-mailer"/>
      <xs:enumeration value="email-subject"/>
      <xs:enumeration value="http-user-agent"/>
      <xs:enumeration value="http-request-uri"/>
      <xs:enumeration value="mutex"/>
      <xs:enumeration value="file-path"/>
      <xs:enumeration value="user-name"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="BulkObservableFormat">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:Hash" minOccurs="0"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="BulkObservableList" type="xs:string"/>
  <xs:element name="IndicatorExpression">
    <xs:complexType>
      <xs:sequence maxOccurs="unbounded">
        <xs:choice>
          <xs:element ref="iodef:IndicatorExpression"/>
          <xs:element ref="iodef:Observable"/>
          <xs:element ref="iodef:ObservableReference"/>
          <xs:element ref="iodef:IndicatorReference"/>
        </xs:choice>
        <xs:element ref="iodef:Confidence" minOccurs="0"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="operator" 
                    type="indicatorexpression-operator-type" 
                    use="optional" default="and"/>
      <xs:attribute name="ext-operator" 
                    type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="indicatorexpression-operator-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="not"/>
      <xs:enumeration value="and"/>
      <xs:enumeration value="or"/>
      <xs:enumeration value="xor"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:element name="ObservableReference">
    <xs:complexType>
      <xs:attribute name="uid-ref" type="xs:IDREF" use="required"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="IndicatorReference">
    <xs:complexType>
      <xs:attribute name="uid-ref" type="xs:IDREF" use="optional"/>
      <xs:attribute name="euid-ref" type="xs:string" use="optional"/>
      <xs:attribute name="version" type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:element name="AttackPhase">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="iodef:AttackPhaseID" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:URL" maxOccurs="unbounded"/>
        <xs:element ref="iodef:Description" 
                    minOccurs="0" maxOccurs="unbounded"/>
        <xs:element ref="iodef:AdditionalData" 
                    minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="AttackPhaseID" type="xs:string"/>
  <!--  
   ===================================================================
   == Miscellaneous classes                                         ==
   ===================================================================
  -->
  <xs:element name="AdditionalData" type="iodef:ExtensionType"/>
  <xs:element name="Description" type="iodef:MLStringType"/>
  <xs:element name="URL" type="xs:anyURI"/>
  <!--
   ===================================================================
   == IODEF data types                                              ==
   ===================================================================
  -->
  <xs:simpleType name="PositiveFloatType">
    <xs:restriction base="xs:float">
      <xs:minExclusive value="0"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:complexType name="MLStringType">
    <xs:simpleContent>
      <xs:extension base="xs:string">
        <xs:attribute name="translation-id" 
                      type="xs:string" use="optional"/>
        <xs:attribute ref="xml:lang"/>
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>
  <xs:simpleType name="PortlistType">
    <xs:restriction base="xs:string">
      <xs:pattern value="\d+(\-\d+)?(,\d+(\-\d+)?)*"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="TimezoneType">
    <xs:restriction base="xs:string">
      <xs:pattern 
       value="Z|[\+\-](0[0-9]|1[0-4]):[0-5][0-9]"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:complexType name="ExtensionType" mixed="true">
    <xs:sequence>
      <xs:any namespace="##any" processContents="lax" 
              minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>

    <xs:attribute name="name" type="xs:string" use="optional"/>
    <xs:attribute name="dtype" 
                  type="iodef:dtype-type" use="required"/>
    <xs:attribute name="ext-dtype" type="xs:string" use="optional"/>
    <xs:attribute name="meaning" type="xs:string" use="optional"/>
    <xs:attribute name="formatid" type="xs:string" use="optional"/>
    <xs:attribute name="restriction" 
                  type="iodef:restriction-type" use="optional"/>
    <xs:attribute name="ext-restriction" 
                  type="xs:string" use="optional"/>
    <xs:attribute name="observable-id" type="xs:ID" use="optional"/>
  </xs:complexType>
  <xs:complexType name="SoftwareType">
    <xs:sequence>
      <xs:element ref="iodef:SoftwareReference" minOccurs="0"/>
      <xs:element ref="iodef:URL" 
                  minOccurs="0" maxOccurs="unbounded"/>
      <xs:element ref="iodef:Description" 
                  minOccurs="0" maxOccurs="unbounded"/>
    </xs:sequence>
  </xs:complexType>
  <xs:element name="SoftwareReference">
    <xs:complexType>
      <xs:sequence>
        <xs:any namespace="##any" processContents="lax" 
                minOccurs="0" maxOccurs="unbounded"/>
      </xs:sequence>
      <xs:attribute name="spec-name" 
                    type="softwarereference-spec-name-type" 
                    use="required"/>
      <xs:attribute name="ext-spec-name" 
                    type="xs:string" use="optional"/>
      <xs:attribute name="dtype" 
                    type="softwarereference-dtype-type" 
                    use="optional"/>
      <xs:attribute name="ext-dtype" type="xs:string" use="optional"/>
    </xs:complexType>
  </xs:element>
  <xs:simpleType name="softwarereference-spec-name-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="custom"/>
      <xs:enumeration value="cpe"/>
      <xs:enumeration value="swid"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="softwarereference-dtype-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="bytes"/>
      <xs:enumeration value="integer"/>
      <xs:enumeration value="real"/>
      <xs:enumeration value="string"/>
      <xs:enumeration value="xml"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <!--
   ===================================================================
   == Global attribute type declarations                            ==
   ===================================================================
  -->
  <xs:simpleType name="yes-no-unknown-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="yes"/>
      <xs:enumeration value="no"/>
      <xs:enumeration value="unknown"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="restriction-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="default"/>
      <xs:enumeration value="public"/>
      <xs:enumeration value="partner"/>
      <xs:enumeration value="need-to-know"/>
      <xs:enumeration value="private"/>
      <xs:enumeration value="white"/>
      <xs:enumeration value="green"/>
      <xs:enumeration value="amber"/>
      <xs:enumeration value="red"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="severity-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="low"/>
      <xs:enumeration value="medium"/>
      <xs:enumeration value="high"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="duration-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="second"/>
      <xs:enumeration value="minute"/>
      <xs:enumeration value="hour"/>
      <xs:enumeration value="day"/>
      <xs:enumeration value="month"/>
      <xs:enumeration value="quarter"/>
      <xs:enumeration value="year"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="action-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="nothing"/>
      <xs:enumeration value="contact-source-site"/>
      <xs:enumeration value="contact-target-site"/>
      <xs:enumeration value="contact-sender"/>
      <xs:enumeration value="investigate"/>
      <xs:enumeration value="block-host"/>
      <xs:enumeration value="block-network"/>
      <xs:enumeration value="block-port"/>
      <xs:enumeration value="rate-limit-host"/>
      <xs:enumeration value="rate-limit-network"/>
      <xs:enumeration value="rate-limit-port"/>
      <xs:enumeration value="redirect-traffic"/>
      <xs:enumeration value="honeypot"/>
      <xs:enumeration value="upgrade-software"/>
      <xs:enumeration value="rebuild-asset"/>
      <xs:enumeration value="harden-asset"/>
      <xs:enumeration value="remediate-other"/>
      <xs:enumeration value="status-triage"/>
      <xs:enumeration value="status-new-info"/>
      <xs:enumeration value="watch-and-report"/>
      <xs:enumeration value="defined-coa"/>
      <xs:enumeration value="other"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
  <xs:simpleType name="dtype-type">
    <xs:restriction base="xs:NMTOKEN">
      <xs:enumeration value="boolean"/>
      <xs:enumeration value="byte"/>
      <xs:enumeration value="bytes"/>
      <xs:enumeration value="character"/>
      <xs:enumeration value="date-time"/>
      <xs:enumeration value="integer"/>
      <xs:enumeration value="ntpstamp"/>
      <xs:enumeration value="portlist"/>
      <xs:enumeration value="real"/>
      <xs:enumeration value="string"/>
      <xs:enumeration value="file"/>
      <xs:enumeration value="path"/>
      <xs:enumeration value="frame"/>
      <xs:enumeration value="packet"/>
      <xs:enumeration value="ipv4-packet"/>
      <xs:enumeration value="ipv6-packet"/>
      <xs:enumeration value="url"/>
      <xs:enumeration value="csv"/>
      <xs:enumeration value="winreg"/>
      <xs:enumeration value="xml"/>
      <xs:enumeration value="ext-value"/>
    </xs:restriction>
  </xs:simpleType>
</xs:schema>
]]></artwork></figure></t>
</section>  

<section title="Security Considerations" anchor="security_considerations">

<t>
The IODEF data model does not directly introduce security or privacy issues.  However, as the data encoded by the IODEF might be considered sensitive by the parties exchanging it or by those described by it, care needs to be taken to ensure appropriate handling during the document construction, exchange, processing, archiving, subsequent retrieval, and analysis.
</t>

<section title="Security" anchor="security_considerations_security">

<t>
The underlying messaging format and protocol used to exchange instances of the IODEF MUST provide appropriate guarantees of confidentiality, integrity, and authenticity.  The use of a standardized security protocol is encouraged.  The Real-time Inter-network Defense (RID) protocol <xref target="RFC6545" /> and its associated transport binding IODEF/RID over HTTP/TLS <xref target="RFC6546" /> provide such security.
</t>

<t>
An IODEF implementation may act on the data in the document.  These actions might be explicitly requested in the document or the result of analytical logic that triggered on data in the document.  For this reason, care must be taken by IODEF implementations to properly authenticate the sender and receiver of the document.  The sender needs confidence that sensitive information and timely requests for action are sent to the correct recipient.  The recipient may interpret the contents of the document differently based on who sent it or vary actions based on the sender.  While the sender of the document may explicitly convey confidence in the data in a granular way using the Confidence class, the recipient is free to ignore or refine this information to make its own assessment.  Ambiguous Confidence elements (where it is unclear to which of a set of other elements the Confidence element relates) in a document MUST be ignored by the recipient.</t>
<t>
Certain classes may require out-of-band coordination to agree upon their semantics (e.g., Confidence@rating="low" or DefinedCOA).  This coordination MUST occur prior to operational data exchange to prevent the incorrect interpretation of these select data elements.  When parsing these data elements, implementations should validate, when possible, that they conform to the agreed upon semantics.  These semantics may need to be periodically reevaluated. 
</t>

<t>
Executable content of various forms could be embedded into the IODEF document directly or through an extension.  Implementation MUST handle this content with care to prevent unintentional automated execution.  The following classes are explicitly intended to represent content that might be executable:

<list style="symbols">
<t>
All classes of type iodef:ExtensionType and the RecordPattern class can represent arbitrary binary strings such as legitimate software programs or malware.
</t>
<t>
The EmailMessage and EmailBody classes can represent email attachments that can contain arbitrary content.
</t>
<t>
The DetectionPattern class could specify a machine-readable configuration that directs the execution of the corresponding tool.
</t>
</list>
</t>

<t>
Per <xref target="validation" />, IODEF implementations will need to periodically consult the IANA registries specified in <xref target= "enum_value_registries"/> to discover newly registered enumerated attribute values.  These implementations MUST communicate with IANA in a way that ensures the integrity of the values and the authenticity of the source.  HTTPS over TLS <xref target="RFC2818" /><xref target="RFC5246" /> provides such security.
</t>

</section>

<section title="Privacy" anchor="security_considerations_privacy">
<t>
The IODEF contains numerous fields that are identifiers that could be linked to an individual or organization.  IODEF documents may contain sensitive information about these identified parties; repeated document exchanges about the same and related parties may enable the correlation of data about them.  Likewise, a party may report on another to a third party without their knowledge.
</t>

<t>
When creating an IODEF document, careful consideration must be given to what information is shared.  Personal identifiers and attributable sensitive information should only be shared when necessary.  
</t>
<t>
When exchanging documents, transport security MUST provide document-level confidentiality.  XML element-level confidentiality can also be provided by using <xref target="W3C.XMLENC" />.
</t>

<t>
In order to suggest data processing and handling guidelines of the encoded information, the IODEF allows a document sender to convey a privacy policy using the restriction attribute.  The various instances of this attribute allow different data elements of the document to be covered by dissimilar policies.  While flexible, it must be stressed that this approach only serves as a guideline from the sender, as the recipient is free to ignore it.
</t>

<t>
Although outside of the scope of an IODEF implementation, the contents of IODEF documents and any derived analysis should be archived with appropriate confidentiality controls.  Likewise, access to retrieve and analyze this data should be restricted to authorized users.
</t>
</section>

</section> 


<section title="IANA Considerations" anchor="iana_considerations">
<t>This document registers a namespace, an XML schema, and a number of registries that map to enumerated values defined in the data model.  It also defines an Expert Review process for IODEF-related XML registry entries.
</t>

<section title="Namespace and Schema" anchor="namespace_and_schema">

<t>This document uses URNs to describe an XML namespace and schema conforming to a registry mechanism described in <xref target="RFC3688" />.</t>

<t>Registration for the IODEF namespace:
<list style="symbols">
<t>URI: urn:ietf:params:xml:ns:iodef-2.0</t>
<t>Registrant Contact: See the author in the "Author's Address" section of this document.</t>
<t>XML: None. Namespace URIs do not represent an XML specification.</t>
</list>
</t>

<t>Registration for the IODEF XML schema:
<list style="symbols">
<t>URI: urn:ietf:params:xml:schema:iodef-2.0</t>
<t>Registrant Contact: See the first author of the "Author's Address" section of this document.</t>
<t>XML: See <xref target="schema" /> of this document.</t>
</list>
</t>
</section> 

<section title="Enumerated Value Registries" anchor="enum_value_registries">
<t>
This document creates 34 identically structured registries to be managed by IANA:

<list style="symbols">
<t>Name of the parent registry: "Incident Object Description Exchange Format v2 (IODEF)"</t>
<t>URL of the registry: &lt;http://www.iana.org/assignments/iodef2&gt;</t>
<t>Namespace format: A registry entry consists of:

<list style="symbols">
<t>Value. A value for a given IODEF attribute.  It MUST conform to the formatting specified by the IODEF ENUM data type which is implemented as an "xs:NMTOKEN" type per Section 3.3.4 of <xref target="W3C.SCHEMA.DTYPES" />.  The value SHOULD conform to the convention specified in <xref target="extending_classes" />.</t>
<t>Description. A short description of the enumerated value.</t>
<t>Reference. An optional list of URIs to further describe the value.</t>
</list>
</t>
<t>Allocation policy: Expert Review per <xref target="RFC5226" />.  This reviewer will ensure that the requested registry entry conforms to the prescribed formatting.  The reviewer will also ensure that the entry is an appropriate value for the attribute per the information model (<xref target="datamodel" />).</t>
</list>
</t>

<t>
The registries to be created are named in the "Registry Name" column of <xref target="registries" />.  Each registry is initially populated with values and descriptions that come from an attribute specified in the IODEF schema (<xref target="schema" />) whose description is found in a sub-section of the information model (<xref target="datamodel" />).   The initial values for the Value and Description fields of a given registry are listed in the "IV (Value)" and "IV (Desc.)" columns, respectively. The "IV (Value)" points to a given schema type per <xref target="schema" />.  Each enumerated value in the schema gets a corresponding entry in a given registry.  The "IV (Desc.)" points to a section in the text of this document that describes each enumerated value.  The initial value of the Reference field of every registry entry described below should be this document.
</t>
<?rfc compact='no'?>
<texttable anchor="registries" title="IANA Enumerated Value Registries">

<ttcol align="center">Registry Name</ttcol>
<ttcol align="center">IV (Value)</ttcol>
<ttcol align="center">IV &nbsp;&nbsp;(Desc.)&nbsp;</ttcol>

<c>Restriction</c>
<c>iodef-restriction-type</c>
<c><xref target="restriction" format="counter"/></c>

<c>Incident-purpose</c>
<c>incident-purpose-type</c>
<c><xref target="Incident" format="counter"/></c>

<c>Incident-status</c>
<c>incident-status-type</c>
<c><xref target="Incident" format="counter"/></c>

<c>Contact-role</c>
<c>contact-role-type</c>
<c><xref target="Contact" format="counter"/></c>

<c>Contact-type</c>
<c>contact-type-type</c>
<c><xref target="Contact" format="counter"/></c>

<c>RegistryHandle-registry</c>
<c>registryhandle-registry-type</c>
<c><xref target="RegistryHandle" format="counter"/></c>

<c>PostalAddress-type</c>
<c>postaladdress-type-type</c>
<c><xref target="postaladdress" format="counter"/></c>

<c>Telephone-type</c>
<c>telephone-type-type</c>
<c><xref target="telephone" format="counter"/></c>

<c>Email-type</c>
<c>email-type-type</c>
<c><xref target="email" format="counter"/></c>

<c>Expectation-action</c>
<c>action-type</c>
<c><xref target="Expectation" format="counter"/></c>

<c>Discovery-source</c>
<c>discovery-source-type</c>
<c><xref target="Discovery" format="counter"/></c>

<c>SystemImpact-type</c>
<c>systemimpact-type-type</c>
<c><xref target="SystemImpact" format="counter"/></c>

<c>BusinessImpact-severity</c>
<c>businessimpact-severity-type</c>
<c><xref target="BusinessImpact" format="counter"/></c>

<c>BusinessImpact-type</c>
<c>businessimpact-type-type</c>
<c><xref target="BusinessImpact" format="counter"/></c>

<c>TimeImpact-metric</c>
<c>timeimpact-metric-type</c>
<c><xref target="TimeImpact" format="counter"/></c>

<c>TimeImpact-duration</c>
<c>duration-type</c>
<c><xref target="TimeImpact" format="counter"/></c>

<c>Confidence-rating</c>
<c>confidence-rating-type</c>
<c><xref target="Confidence" format="counter"/></c>

<c>NodeRole-category</c>
<c>noderole-category-type</c>
<c><xref target="NodeRole" format="counter"/></c>

<c>System-category</c>
<c>system-category-type</c>
<c><xref target="System" format="counter"/></c>

<c>System-ownership</c>
<c>system-ownership-type</c>
<c><xref target="System" format="counter"/></c>

<c>Address-category</c>
<c>address-category-type</c>
<c><xref target="Address" format="counter"/></c>

<c>Counter-type</c>
<c>counter-type-type</c>
<c><xref target="Counter" format="counter"/></c>

<c>Counter-unit</c>
<c>counter-unit-type</c>
<c><xref target="Counter" format="counter"/></c>

<c>DomainData-system-status</c>
<c>domaindata-system-status-type</c>
<c><xref target="DomainData" format="counter"/></c>

<c>DomainData-domain-status</c>
<c>domaindata-domain-status-type</c>
<c><xref target="DomainData" format="counter"/></c>

<c>RecordPattern-type</c>
<c>recordpattern-type-type</c>
<c><xref target="RecordPattern" format="counter"/></c>

<c>RecordPattern-offsetunit</c>
<c>recordpattern-offsetunit-type</c>
<c><xref target="RecordPattern" format="counter"/></c>

<c>Key-registryaction</c>
<c>key-registryaction-type</c>
<c><xref target="Key" format="counter"/></c>

<c>HashData-scope</c>
<c>hashdata-scope-type</c>
<c><xref target="HashData" format="counter"/></c>

<c>BulkObservable-type</c>
<c>bulkobservable-type-type</c>
<c><xref target="BulkObservable" format="counter"/></c>

<c>IndicatorExpression-operator</c>
<c>indicatorexpression-operator-type</c>
<c><xref target="IndicatorExpression" format="counter"/></c>

<c>ExtensionType-dtype</c>
<c>dtype-type</c>
<c><xref target="dt_extension" format="counter"/></c>

<c>SoftwareReference-spec-id</c>
<c>softwarereference-spec-id-type</c>
<c><xref target="SoftwareReference" format="counter"/></c>

<c>SoftwareReference-dtype</c>
<c>softwarereference-dtype-type</c>
<c><xref target="SoftwareReference" format="counter"/></c>
</texttable>
<?rfc compact='yes'?>
</section> 

<section title="Expert Review of IODEF-Related XML Registry Entries" anchor="expert_review_iodef_registries">

<t>IODEF class extensions, per <xref target="extending_classes" />, could
register their namespaces and schemas with the IANA XML namespace ("ns" on
&lt;http://www.iana.org/assignments/xml-registry/&gt;) and schema registries
("schema" on &lt;http://www.iana.org/assignments/xml&nbhy;registry/&gt;) described in <xref target="RFC3688" />.  In addition to any reviews required by IANA, changes to the XML "schema" registry for schema names beginning with "urn:ietf:params:xml:schema:iodef" are subject to an additional IODEF Expert Review <xref target="RFC5226" /> to ensure compatibility with IODEF and other existing IODEF extensions.</t>

<t>The IODEF expert(s) for these reviews will be designated by the IETF Security Area Directors.</t>

<t>This document obsoletes <xref target="RFC6685" />.</t>
</section> 

</section>

</middle>
<back>

<references title="Normative References">

<reference anchor="W3C.XML" target="http://www.w3.org/TR/2008/REC-xml-20081126/">
<front>
<title>Extensible Markup Language (XML) 1.0 (Fifth Edition)</title>
<author initials='T.' surname='Bray' fullname='Tim Bray'>
    <organization />
</author>
<author initials='J.' surname='Paoli' fullname='Jean Paoli'>
    <organization />
</author>
<author initials='M.' surname='Sperberg-McQueen' fullname='Michael Sperberg-McQueen'>
    <organization />
</author>
<author initials='E.' surname='Maler' fullname='Eve Maler'>
    <organization />
</author>
<author initials='F.' surname='Yergeau' fullname='Fran??ois Yergeau'>
    <organization />
</author>
<date month='November' year='2008' />
</front>
<seriesInfo name='W3C Recommendation' value='REC-xml-20081126' />
</reference>

<reference anchor="W3C.SCHEMA" target="http://www.w3.org/TR/xmlschema-1/">
<front>
<title>XML Schema Part 1: Structures Second Edition</title>
<author initials='H.' surname='Thompson' fullname='Henry Thompson'>
    <organization />
</author>
<author initials='D.' surname='Beech' fullname='David Beech'>
    <organization />
</author>
<author initials='M.' surname='Maloney' fullname='Murray Maloney'>
    <organization />
</author>
<author initials='N.' surname='Mendelsohn' fullname='Noah Mendelsohn'>
    <organization />
</author>
<date month='October' year='2004' />
</front>
<seriesInfo name='W3C Recommendation' value='REC-xmlschema-1-20041028' />
</reference>

<reference anchor="W3C.SCHEMA.DTYPES" target="http://www.w3.org/TR/xmlschema-2/">
<front>
<title>XML Schema Part 2: Datatypes Second Edition</title>
<author initials='P.' surname='Biron' fullname='Paul V. Biron'>
    <organization />
</author>
<author initials='A.' surname='Malhotra' fullname='Ashok Malhotra'>
    <organization />
</author>
<date month='October' year='2004' />
</front>
<seriesInfo name='W3C Recommendation' value='REC-xmlschema-2-20041028' />
</reference>

<reference anchor="W3C.XMLNS" target="http://www.w3.org/TR/2009/REC-xml-names-20091208/">
<front>
<title>Namespaces in XML 1.0 (Third Edition)</title>
<author initials='T.' surname='Bray' fullname='Tim Bray'>
    <organization />
</author>
<author initials='D.' surname='Hollander' fullname='Dave Hollander'>
    <organization />
</author>
<author initials='A.' surname='Layman' fullname='Andrew Layman'>
    <organization />
</author>
<author initials='R.' surname='Tobin' fullname='Richard Tobin'>
    <organization />
</author>
<author initials='H.' surname='Thompson' fullname='Henry Thompson'>
    <organization />
</author>
<date month='December' year='2009' />
</front>
<seriesInfo name='W3C Recommendation' value='REC-xml-names-20091208' />
</reference>

<reference anchor="W3C.XPATH" target="https://www.w3.org/TR/xpath-3/">
<front>
<title>XML Path Language (XPath) 3.1</title>
<author initials='J.' surname='Robie' fullname='Jonathan Robie'>
    <organization />
</author>
<author initials='M.' surname='Dyck' fullname='Michael Dyck'>
    <organization />
</author>
<author initials='J.' surname='Spiegel' fullname='Josh Spiegel'>
    <organization />
</author>
<date month='December' year='2015' />
</front>
<seriesInfo name='W3C Candidate Recommendation' value='CR-xpath-31-20151217' />
</reference>

<reference anchor="W3C.XMLSIG" target="http://www.w3.org/TR/xmldsig-core/">
<front>
<title>XML Signature Syntax and Processing (Second Edition)</title>
<author initials='D.' surname='Eastlake' fullname='Donald Eastlake'>
    <organization />
</author>
<author initials='J.' surname='Reagle' fullname='Joseph Reagle'>
    <organization />
</author>
<author initials='D.' surname='Solo' fullname='David Solo'>
    <organization />
</author>
<author initials='F.' surname='Hirsch' fullname='Frederick Hirsch'>
    <organization />
</author>
<author initials='T.' surname='Roessler' fullname='Thomas Roessler'>
    <organization />
</author>
<date month='June' year='2008' />
</front>
<seriesInfo name='W3C Recommendation' value='REC-xmldsig-core-20080610' />
</reference>


<reference anchor="IEEE.POSIX">
<front>
	<title>Information Technology - Portable Operating System Interface
	(POSIX) Base Specifications, Issue 7</title>
	<author>
	<organization abbrev="IEEE">IEEE</organization>
	</author>
	<date month="September" year="2009" />
</front>
<seriesInfo name="IEEE Std" value="1003.1-2001" />
<seriesInfo name="DOI" value="10.1109/IEEESTD.2009.5393893"/>
</reference>

<?rfc include="reference.RFC.2119" ?>
<?rfc include="reference.RFC.5646" ?>
<?rfc include="reference.RFC.3986" ?>
<?rfc include="reference.RFC.4519" ?>
<?rfc include="reference.RFC.5322" ?>
<?rfc include="reference.RFC.6531" ?>
<?rfc include="reference.RFC.7495" ?>
<?rfc include="reference.RFC.7203" ?>

<reference anchor="ISO4217">
<front>
	<title>Codes for the representation of currencies</title>
	<author>
	<organization abbrev="ISO">International Organization for Standardization</organization>
	</author>
	<date year="2015" />
</front>
<seriesInfo name="ISO" value="4217:2015" />
</reference>

<?rfc include="reference.RFC.3688" ?>

<reference anchor="IANA.Ports" target="http://www.iana.org/assignments/service-names-port-numbers/">
<front>
	<title>Service Name and Transport Protocol Port Number Registry</title>
	<author>
	<organization>IANA</organization>
	</author>
	<date/>
</front>
</reference>

<reference anchor="IANA.Protocols" target="http://www.iana.org/assignments/protocol-numbers/">
<front>
	<title>Assigned Internet Protocol Numbers</title>
	<author>
	<organization>IANA</organization>
	</author>
	<date/>
</front>
</reference>

<?rfc include="reference.RFC.3629" ?>
<?rfc include="reference.RFC.2781" ?>

<reference anchor="IANA.Media" target="http://www.iana.org/assignments/media-types/">
<front>
	<title>Media Types</title>
	<author>
	<organization abbrev="IANA">IANA</organization>
	</author>
	<date/>
</front>
</reference>

<reference anchor="NIST.CPE" target="http://csrc.nist.gov/publications/nistir/ir7695/NISTIR-7695-CPE-Naming.pdf">
<front>
	<title>Common Platform Enumeration: Naming Specification Version 2.3</title>

<author initials='B.' surname='Cheikes' fullname='Brant A. Cheikes'>
    <organization />
</author>
<author initials='D.' surname='Waltermire' fullname='David Waltermire'>
    <organization />
</author>
<author initials='K.' surname='Scarfone' fullname='Karen Scarfone'>
    <organization />
</author>

	<date month="August" year="2011" />
</front>
<seriesInfo name="NIST Interagency Report" value="7695"/>
</reference>

<reference anchor="ISO19770">
<front>
	<title>Information technology -- Software asset management -- Part 2: Software identification tag</title>
	<author>
	<organization abbrev="ISO">International Organization for Standardization</organization>
	</author>
	<date month="October" year="2015" />
</front>
<seriesInfo name="ISO Standard" value="19770-2:2015" />
</reference>


<reference anchor="E.164">
<front>
	<title>The International Public Telecommunication Numbering Plan</title>
	<author>
	<organization abbrev="ITU-T">ITU Telecommunication Standardization Sector</organization>
	</author>
	<date month="November" year="2010" />
</front>
<seriesInfo name="ITU-T" value="Recommendation E.164" />
</reference>

<?rfc include="reference.RFC.5952" ?>
<?rfc include="reference.RFC.4291" ?>

</references>

<references title="Informative References">

<?rfc include="reference.RFC.5070" ?>
<?rfc include="reference.RFC.6685" ?>
<?rfc include="reference.RFC.6545" ?>
<?rfc include="reference.RFC.6546" ?>	
<?rfc include="reference.RFC.5901" ?>


<reference anchor="NIST800.61rev2" target="http://dx.doi.org/10.6028/NIST.SP.800-61r2">
<front>
<title>Computer Security Incident Handling Guide</title>
	<author>
	 <organization>National Institute of Standards and Technology</organization>
	</author>
	<date month="August" year="2012" />
</front>
<seriesInfo name="NIST Special Publication 800-61," value="Revision 2" />
</reference>

<?rfc include="reference.RFC.3982" ?>

<reference anchor="KB310516" target="https://support.microsoft.com/en-us/kb/310516">
<front>
<title>How to add, modify, or delete registry subkeys and values by using a .reg file</title>
	<author>
	  <organization>Microsoft Corporation</organization>
	</author>
	<date month="September" year="2013" />
</front>
</reference>

<?rfc include="reference.RFC.4180" ?>
<?rfc include="reference.RFC.5226" ?>

<reference anchor="W3C.XMLENC" target="https://www.w3.org/TR/xmlenc-core1/">
<front>
	<title>XML Encryption Syntax and Processing Version 1.1</title>
	<author initials='D.' surname='Eastlake' fullname='Donald Eastlake'>
    <organization />
</author>
<author initials='J.' surname='Reagle' fullname='Joseph Reagle'>
    <organization />
</author>
<author initials='D.' surname='Solo' fullname='David Solo'>
    <organization />
</author>
<author initials='F.' surname='Hirsch' fullname='Frederick Hirsch'>
    <organization />
</author>
<author initials='M.' surname='Nystrom' fullname='Magnus Nystrom'>
    <organization />
</author>
<author initials='T.' surname='Roessler' fullname='Thomas Roessler'>
    <organization />
</author>
<author initials='K.' surname='Yiu' fullname='Kelvin Yiu'>
    <organization />
</author>
	<date month="April" year="2013" />
</front>
<seriesInfo name="W3C Recommendation" value="REC-xmldsig-core1-20130411" />
</reference>

<?rfc include="reference.RFC.2818" ?>
<?rfc include="reference.RFC.5246" ?>


</references>

<section title="Acknowledgments" anchor="acknowledgments" numbered="no">

<t>
   Thanks to Paul Stoecker for his editorial leadership in the
   transition of an early draft to the current document.     
</t>
<t>
Thanks to Kathleen Moriarty, Brian Trammel, Alexey Melnikov, Takeshi
Takahashi, David Waltermire, and Sean Turner (as the MILE working group
chairs, secretary, and area directors) for providing feedback and coordination of this document.
</t>
<t>
Thanks to the following individuals (listed alphabetically) who provided feedback during the meetings, on the  mailing list, or through implementation experience: Jerome Athias, David Black, Eric Burger, Toma Cejka, Patrick Curry, John Field, Christopher Harrington, Chris Inacio, Panos Kampanakis, David Misell, Daisuke Miyamoto, Adam Montville, Robert Moskowitz, Lagadec Philippe, Tony Rutkowski, Mio Suzuki, and Nik Teague.
</t>
</section> 

</back>
</rfc>

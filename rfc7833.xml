<?xml version="1.0" encoding="US-ASCII"?>

<?rfc toc="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY rfc2119 SYSTEM "reference.RFC.2119.xml">
<!ENTITY rfc2865 SYSTEM "reference.RFC.2865.xml">
<!ENTITY rfc3553 SYSTEM "reference.RFC.3553.xml">
<!ENTITY rfc3575 SYSTEM "reference.RFC.3575.xml">
<!ENTITY rfc3579 SYSTEM "reference.RFC.3579.xml">
<!ENTITY rfc6733 SYSTEM "reference.RFC.6733.xml">
<!ENTITY rfc5226 SYSTEM "reference.RFC.5226.xml">
<!ENTITY rfc6614 SYSTEM "reference.RFC.6614.xml">
<!ENTITY rfc6929 SYSTEM "reference.RFC.6929.xml">
<!ENTITY rfc7055 SYSTEM "reference.RFC.7055.xml">
<!ENTITY rfc7499 SYSTEM "reference.RFC.7499.xml">
<!ENTITY rfc7542 SYSTEM "reference.RFC.7542.xml">
]>

<rfc category="std" number="7833" ipr="trust200902" submissionType="IETF"
     consensus="yes">

    <front>
        <title abbrev="SAML RADIUS">A RADIUS Attribute, Binding, Profiles,
        Name Identifier Format, and Confirmation Methods for the
        Security Assertion Markup Language (SAML)</title>

        <author initials="J." surname="Howlett" fullname="Josh Howlett">
          <organization>Jisc</organization>
          <address>
            <postal>
              <street>Lumen House, Library Avenue, Harwell</street>
              <city>Oxford</city>
              <code>OX11 0SG</code>
              <country>United Kingdom</country>
            </postal>
            <phone>+44 1235 822363</phone>
            <email>Josh.Howlett@ja.net</email>
          </address>
        </author>

        <author initials="S." surname="Hartman" fullname="Sam Hartman">
          <organization>Painless Security</organization>
          <address>
            <postal>
              <street> </street>
              <city> </city>
              <code> </code>
              <country> </country>
            </postal>
            <email>hartmans-ietf@mit.edu</email>
          </address>
        </author>

       <author fullname="Alejandro Perez-Mendez" initials="A." surname="Perez-Mendez" role="editor">
          <organization>University of Murcia</organization>
          <address>
            <postal>
              <street>Campus de Espinardo S/N, Faculty of Computer Science</street>
              <city>Murcia</city>
              <region></region>
              <code>30100</code>
              <country>Spain</country>
            </postal>
            <phone>+34 868 88 46 44</phone>
            <email>alex@um.es</email>
          </address>
        </author>

        <date month="May" year="2016" />

        <keyword>ABFAB</keyword>
        <keyword>AAA</keyword>
        <keyword>EAP</keyword>
        <keyword>RADIUS</keyword>
        <keyword>SAML</keyword>

        <abstract>
            <t>
                This document describes the use of the Security Assertion Markup Language (SAML)
                with RADIUS in the context of the Application Bridging for
                Federated Access Beyond web (ABFAB) architecture. It defines two RADIUS
                attributes, a SAML binding, a SAML name identifier format, two SAML profiles, and two
                SAML confirmation methods. The RADIUS attributes permit encapsulation of SAML Assertions and
                protocol messages within RADIUS, allowing SAML entities to communicate using the binding.
                The two profiles describe the application of this binding for ABFAB
                authentication and assertion Query/Request, enabling a Relying Party to
                request authentication of, or assertions for, users or machines (clients).
                These clients may be named using a Network Access Identifier (NAI) name identifier format. Finally,
                the subject confirmation methods allow requests and queries to be issued for
                a previously authenticated user or machine without needing to explicitly
                identify them as the subject. The use of the artifacts defined in this document
                is not exclusive to ABFAB. They can be applied in any
                Authentication, Authorization, and Accounting (AAA) scenario,
                such as network access control.
            </t>
        </abstract>
    </front>

    <middle>
        <section title="Introduction">
            <t>
                Within the ABFAB (Application Bridging for Federated Access Beyond web) architecture <xref target="RFC7831" />,
                it is often desirable to convey Security Assertion Markup Language
                (SAML) Assertions and protocol messages.
            </t>
            <t>
                SAML typically only considers the use of HTTP-based transports, known as bindings
                <xref target="OASIS.saml-bindings-2.0-os" />, which are primarily intended for use
                with the SAML V2.0 web browser
                single sign-on profile <xref target="OASIS.saml-profiles-2.0-os" />.
                However, the goal of ABFAB is to extend the applicability of federated identity
                beyond the web to other applications by building on the
Authentication, Authorization, and Accounting (AAA) framework.
                Consequently, there exists a requirement for SAML to integrate with the AAA
                framework and with protocols such as RADIUS
                <xref target="RFC2865"/> and Diameter <xref target="RFC6733"/>, in addition
                to HTTP.
            </t>
            <t>
                In summary, this document specifies:
            </t>
            <t>
                <list style="symbols">
                    <t>
                        Two RADIUS attributes to encapsulate SAML Assertions and protocol messages, respectively.
                    </t>
                    <t>
                        A SAML RADIUS binding that defines how SAML Assertions and protocol messages
                        can be transported by RADIUS within a SAML exchange.
                    </t>
                    <t>
                        A SAML name identifier format in the form of a Network Access Identifier.
                    </t>
                    <t>
                        A profile of the SAML Authentication Request Protocol that uses the SAML RADIUS binding
                        to effect SAML&nbhy;based authentication and authorization.
                    </t>
                    <t>
                        A profile of the SAML Assertion Query and Request Protocol that uses the SAML RADIUS binding
                        to effect the query and request of SAML Assertions.
                    </t>
                    <t>
                        Two SAML subject confirmation methods for indicating that a user or machine
                        client is the subject of an assertion.
                    </t>
                </list>
            </t>
            <t>
            This document adheres to the guidelines stipulated
            by <xref target="OASIS.saml-bindings-2.0-os" /> and
            <xref target="OASIS.saml-profiles-2.0-os" /> for defining new
            SAML bindings and profiles, respectively, and other
            conventions applied formally or otherwise within SAML. In
            particular, this document provides a "Required Information"
            section for the binding (<xref target="binding-req-info"/>)
            and profiles
            (Sections&nbsp;<xref target="auth-prof-req-info" format="counter"/>
            and <xref target="q-r-prof-req-info" format="counter"/>) that
            enumerate:
                <list style="symbols">
                    <t>
                        A URI that uniquely identifies the protocol binding or profile.
                    </t>
                    <t>
                        Postal or electronic contact information for the author.
                    </t>
                    <t>
                        A reference to previously defined bindings or profiles that the new
                        binding updates or obsoletes.
                    </t>
                    <t>
                        In the case of a profile, any SAML confirmation method identifiers
                        defined and/or utilized by the profile.
                    </t>
                </list>
            </t>

            <section anchor="terminology" title="Terminology">
            <t>
               This document uses terminology from a number of related
               standards that tend to adopt different terms for similar
               or identical concepts. In general, this document uses,
               when possible, the ABFAB term for the entity, as described
               in <xref target="RFC7831"/>. For reference, we include the
               following table, which maps the different terms into a
               single view.  (In this document, "NAS" refers to a network
               access server, and "AS" refers to an authentication server.)</t>

            <texttable anchor="table1" title="Terminology">
              <ttcol align='left'>Protocol</ttcol>  <ttcol align='left'>Client</ttcol> <ttcol align='left'>Relying Party</ttcol> <ttcol align='left'>Identity Provider</ttcol>
              <c>ABFAB</c>                    <c>Client</c>                  <c>Relying Party</c>            <c>Identity Provider</c>
              <c/><c/><c/><c/>
              <c>SAML</c>                     <c>Subject</c>                  <c>Service Provider</c>              <c>Identity Provider</c>
              <c></c>                     <c>Principal</c>                  <c>Requester</c>              <c>Responder</c>
              <c></c>                     <c></c>                  <c>Consumer</c>              <c>Issuer</c>
              <c/><c/><c/><c/>
              <c>RADIUS</c>                   <c>User</c>                   <c>NAS</c>                         <c>AS</c>
              <c></c>                         <c></c>                   <c>RADIUS client</c>                   <c>RADIUS server</c>
            </texttable>

            </section>

        </section>

        <section title="Conventions">
            <t>
                The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
                "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted
                as described in RFC 2119 <xref target="RFC2119" />.
            </t>
        </section>

        <section title="RADIUS SAML Attributes" anchor="SAML_RADIUS_attributes">
            <t>
                The SAML RADIUS binding defined in <xref
                target="SAML_RADIUS_binding" /> of this document
                uses two attributes to convey SAML Assertions and protocol messages
                <xref target="OASIS.saml-core-2.0-os" />.
                Owing to the typical size of these structures, these attributes use the
                "Long Extended Type" format <xref target="RFC6929" /> to encapsulate their data.
                RADIUS entities MUST NOT include both attributes in the same RADIUS message, as they
                represent exclusive alternatives to convey SAML information.
            </t>

            <section title="SAML-Assertion Attribute">
                <t>
                    This attribute is used to encode a SAML Assertion.
                    <xref target="fig-saml-assertion"/> represents the
                    format of this attribute.
                </t>

                <figure align="center" anchor="fig-saml-assertion" title="SAML-Assertion Format">

                    <artwork align="center"><![CDATA[
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type        |    Length     | Extended-Type |M|  Reserved   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Value...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                    ]]></artwork>
                </figure>

                <t>
                    Type
                    <list>
                        <t>
                            245
                        </t>
                    </list>
                </t>
                <t>
                    Length
                    <list>
                        <t>
                            >= 5
                        </t>
                    </list>
                </t>
                <t>
                    Extended-Type
                    <list>
                        <t>
                            1
                        </t>
                    </list>
                </t>
                <t>
                    M (More)
                    <list>
                        <t>
                            As described in <xref target="RFC6929" />.
                        </t>
                    </list>
                </t>
                <t>
                    Reserved
                    <list>
                        <t>
                            As described in <xref target="RFC6929" />.
                        </t>
                    </list>
                </t>
                <t>
                    Value
                    <list>
                        <t>
                            One or more octets encoding a SAML Assertion.
                        </t>
                    </list>
                </t>
            </section>

            <section title="SAML-Protocol Attribute">
                <t>
                    This attribute is used to encode a SAML protocol
                    message. <xref target="fig-saml-message"/> represents
                    the format of this attribute.
                </t>

                <figure align="center" anchor="fig-saml-message" title="SAML-Protocol Format">

                    <artwork align="center"><![CDATA[
                     1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type        |    Length     | Extended-Type |M|  Reserved   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Value...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                    ]]></artwork>
                </figure>
                <t>
                    Type
                    <list>
                        <t>
                            245
                        </t>
                    </list>
                </t>
                <t>
                    Length
                    <list>
                        <t>
                            >= 5
                        </t>
                    </list>
                </t>
                <t>
                    Extended-Type
                    <list>
                        <t>
                            2
                        </t>
                    </list>
                </t>
                <t>
                    M (More)
                    <list>
                        <t>
                            As described in <xref target="RFC6929" />.
                        </t>
                    </list>
                </t>
                <t>
                    Reserved
                    <list>
                        <t>
                            As described in <xref target="RFC6929" />.
                        </t>
                    </list>
                </t>
                <t>
                    Value
                    <list>
                        <t>
                            One or more octets encoding a SAML protocol message.
                        </t>
                    </list>
                </t>
            </section>


        </section>

        <section title="SAML RADIUS Binding" anchor="SAML_RADIUS_binding">
            <t>
                The SAML RADIUS binding defines how RADIUS <xref target="RFC2865"/> can be
                used to enable a RADIUS client and server to exchange SAML Assertions and
                protocol messages.
            </t>
            <section title="Required Information" anchor="binding-req-info">
                <t>
                    Identification: urn:ietf:params:abfab:bindings:radius
                </t>
                <t>
                    Contact information: iesg@ietf.org
                </t>
                <t>
                    Updates: None.
                </t>
            </section>
            <section title="Operation">
                <t>
                    In this specification, the Relying Party (RP) MUST trust
                    any statement in the SAML messages from the
                    Identity Provider (IdP) in the same way that it
                    trusts information contained in RADIUS attributes.
                    These entities MUST trust the RADIUS infrastructure to
                    provide integrity of the SAML messages.
                </t>
                <t>
                    Hence, it is REQUIRED that the RADIUS exchange be
                    protected using Transport Layer Security (TLS)
                    encryption for RADIUS <xref target="RFC6614" /> to
                    provide confidentiality and integrity protection,
                    unless alternative methods to ensure them are used,
                    such as IPsec tunnels or a sufficiently secure
                    internal network.
                </t>
                <t>
                    Implementations of this profile can take advantage of mechanisms
                    to permit the transport of longer SAML messages over RADIUS transports,
                    such as the support of fragmentation of RADIUS packets
                    <xref target="RFC7499" /> or larger packets for RADIUS
                    over TCP <xref target="RADIUS-Large-Pkts" />.
                </t>
                <t>
                    There are two system models for the use of SAML over RADIUS. The first is a
                    request-response model, using the RADIUS SAML&nbhy;Protocol attribute
                    defined in <xref target='SAML_RADIUS_attributes' /> to
                    encapsulate the SAML protocol messages.
                    <list style="numbers">
                        <t>
                            The RADIUS client, acting as an RP, transmits a SAML
                            request element within a RADIUS Access&nbhy;Request message. This
                            message MUST include a single instance of the RADIUS User&nbhy;Name
                            attribute whose value MUST conform to the Network Access Identifier
                            <xref target="RFC7542" /> scheme. The RP MUST NOT
                            include more than one SAML request element.
                        </t>
                        <t>
                            The RADIUS server, acting as an IdP, returns a SAML
                            protocol message within a RADIUS Access&nbhy;Accept or Access&nbhy;Reject
                            message. These messages necessarily conclude a
                            RADIUS exchange,
                            and therefore this is the only opportunity for the IdP
                            to send a response in the context of this exchange. The IdP
                            MUST NOT include more than one SAML response.
                            An IdP that refuses to perform a message exchange with the
                            RP can silently discard the SAML request (this could
                            subsequently be followed by a RADIUS Access&nbhy;Reject, as the same
                            conditions that cause the IdP to discard the SAML
                            request may also cause the RADIUS server to fail to authenticate).
                        </t>
                    </list>
                </t>
                <t>
                    The second system model permits a RADIUS server acting as an IdP
                    to use the RADIUS SAML&nbhy;Assertion attribute defined in
                    <xref target='SAML_RADIUS_attributes' /> to encapsulate
                    an unsolicited SAML Assertion. This attribute MUST be included
                    in a RADIUS Access&nbhy;Accept message. When included, the attribute MUST contain
                    a single SAML Assertion.
                </t>
                <t>
                    RADIUS servers MUST NOT include both the SAML&nbhy;Protocol and the SAML&nbhy;Assertion
                    attribute in the same RADIUS message. If an IdP is producing a
                    response to a SAML request, then the first system model is
                    used.  An IdP MAY ignore a SAML request and send an
                    unsolicited assertion using the second system model
                    (that is, using the RADIUS SAML&nbhy;Assertion attribute).
                </t>
                <t>
                    In either system model, IdPs SHOULD return a RADIUS State attribute
                    as part of the Access&nbhy;Accept message so that future SAML queries or requests
                    can be run against the same context of an authentication exchange.
                </t>
                <t>
                    This binding is intended to be composed with other uses of RADIUS, such as
                    network access. Therefore, other arbitrary RADIUS attributes MAY be used in
                    either the request or response.
                </t>
                <t>
                    In the case of a SAML processing error, the RADIUS
                    server MAY include a SAML response message with an
                    appropriate value for the &lt;samlp:Status&gt; element within
                    the Access&nbhy;Accept or Access&nbhy;Reject packet to notify the client.
                    Alternatively, the RADIUS server can respond without a SAML&nbhy;Protocol attribute.
                </t>
            </section>
            <section title="Processing of Names">
                <t>
                    SAML entities using profiles making use of this binding will typically possess
                    both the SAML and AAA names of their correspondents.
                    Frequently, these entities will need to apply policies using
                    these names -- for example, when deciding to release
                    attributes. Often, these policies will be
                    security-sensitive, and so it is important that policy is
                    applied on these names consistently.
                </t>
                <section title="AAA Names">
                    <t>
                        These rules relate to the processing of AAA names by SAML entities
                        using profiles making use of this binding.
                        <list style="symbols">
                            <t>
                                IdPs SHOULD apply policy based on the RP's identity
                                associated with the RADIUS Access&nbhy;Request.
                            </t>
                            <t>
                                RPs SHOULD apply policy based on the NAI realm
                                associated with the RADIUS Access&nbhy;Accept.
                            </t>
                        </list>
                    </t>
                </section>
                <section title="SAML Names">
                    <t>
                        These rules relate to the processing of SAML names by SAML entities
                        using profiles making use of this binding.
                    </t>
                    <t>
                        IdPs MAY apply policy based on the RP's SAML entityID.
                        In such cases, at least one of the following methods is required in order to establish a relationship between the SAML name and the AAA name of the RP:
                        <list style="symbols">
                            <t>
                                RADIUS client identity in trusted SAML metadata (as described in <xref target="SAML_metadata"/>).
                            </t>
                            <t>
                                RADIUS client identity in trusted digitally signed SAML request.
                            </t>
                        </list>
                    </t>
                    <t>
                        A digitally signed SAML request without the RADIUS client identity is not
                        sufficient, since a malicious RADIUS entity can observe a
                        SAML message and include it in a different RADIUS
                        message without the consent of the issuer of
                        that SAML message. If an IdP were to
                        process the SAML message without confirming
                        that it applied to the RADIUS message,
                        inappropriate policy would be used.
                    </t>
                    <t>
                        RPs MAY apply policy based on the SAML
                        issuer's entityID. In such cases, at least one of the
                        following methods is required in order to establish a
                        relationship between the SAML name and the AAA name of
                        the IdP:
                        <list style="symbols">
                            <t>
                                RADIUS realm in trusted SAML metadata (as described in <xref target="SAML_metadata"/>).
                            </t>
                            <t>
                            RADIUS realm in trusted digitally signed SAML response or assertion.
                            </t>
                        </list>
                    </t>

                    <t>
                     A digitally signed SAML response alone is not
                     sufficient, for the same reasons as those described
                     above for SAML requests.
                    </t>
                </section>
                <section title="Mapping of AAA Names in SAML Metadata" anchor="SAML_metadata">
                    <t>
                        This section defines extensions to the SAML metadata schema <xref target="OASIS.saml-metadata-2.0-os"/> that are required in order
                        to represent AAA names associated with a particular &lt;EntityDescriptor&gt; element.
                    </t>
                    <t>
                        In SAML metadata, a single entity may act in many different roles in the support of multiple profiles.
                        This document defines two new roles: RADIUS IdP and RADIUS RP, requiring the declaration of two new subtypes of
                        RoleDescriptorType: RADIUSIDPDescriptorType and RADIUSRPDescriptorType. These subtypes contain the additional
                        elements required to represent AAA names for IdP and RP entities, respectively.
                    </t>
                    <section title="RADIUSIDPDescriptorType">
                        <t>
                            The RADIUSIDPDescriptorType complex type extends RoleDescriptorType with elements common to IdPs that support RADIUS.
                            It contains the following additional elements:
                            <list style="hanging">
                                <t hangText="&lt;RADIUSIDPService&gt; [Zero or More]">
                                    Zero or more elements of type EndpointType that describe RADIUS endpoints that are associated with the entity.
                                </t>
                                <t hangText="&lt;RADIUSRealm&gt; [Zero or More]">
                                    Zero or more elements of type string that represent the acceptable values of the RADIUS realm
                                    associated with the entity, obtained
from the realm part of the RADIUS User-Name attribute.
                                </t>
                            </list>
                            The following schema fragment defines the RADIUSIDPDescriptorType complex type:
                            <figure anchor="RADIUSIDPDescriptorSchema" title="RADIUSIDPDescriptorType Schema">
                                <artwork><![CDATA[
        <complexType name="RADIUSIDPDescriptorType">
          <complexContent>
            <extension base="md:RoleDescriptorType">
              <sequence>
                <element ref="abfab:RADIUSIDPService"
                              minOccurs="0" maxOccurs="unbounded"/>
                <element ref="abfab:RADIUSRealm"
                              minOccurs="0" maxOccurs="unbounded"/>
              </sequence>
            </extension>
          </complexContent>
        </complexType>
        <element name="RADIUSIDPService" type="md:EndpointType"/>
        <element name="RADIUSRealm" type="string"/>
                                ]]></artwork>
                            </figure>
                        </t>
                    </section>

                    <section title="RADIUSRPDescriptorType">
                        <t>
                            The RADIUSRPDescriptorType complex type extends RoleDescriptorType with elements common to RPs that support RADIUS.
                            It contains the following additional elements:
                            <list style="hanging">
                                <t hangText="&lt;RADIUSRPService&gt; [Zero or More]">
                                    Zero or more elements of type EndpointType that describe RADIUS endpoints that are associated with the entity.
                                </t>
                                <t hangText="&lt;RADIUSNasIpAddress&gt; [Zero or More]">
                                    Zero or more elements of type string that represent the acceptable values of the
                                    RADIUS NAS&nbhy;IP&nbhy;Address or
NAS&nbhy;IPv6&nbhy;Address attributes associated with the entity.
                                </t>
                                <t hangText="&lt;RADIUSNasIdentifier&gt; [Zero or More]">
                                    Zero or more elements of type string that represent the acceptable values of the
                                    RADIUS NAS&nbhy;Identifier attribute associated with the entity.
                                </t>
                                <t hangText="&lt;RADIUSGssEapName&gt; [Zero or More]">
                                    Zero or more elements of type string that
                                    represent the acceptable values of the
                                    GSS&nbhy;API Mechanism for the Extensible
                                    Authentication Protocol (GSS&nbhy;EAP) acceptor name
                                    associated with the entity.

                            The format for this name is described in
Section&nbsp;3.1 of <xref target="RFC7055"/>,
                            while Section&nbsp;3.4 of <xref target="RFC7055"/>
                            describes how that name is decomposed and
                            transported using RADIUS attributes.
                                </t>
                            </list>
                            The following schema fragment defines the RADIUSRPDescriptorType complex type:
                            <figure anchor="RADIUSRPDescriptorSchema" title="RADIUSRPDescriptorType Schema">
                                <artwork><![CDATA[
    <complexType name="RADIUSRPDescriptorType">
      <complexContent>
        <extension base="md:RoleDescriptorType">
          <sequence>
            <element ref="md:RADIUSRPService"
                          minOccurs="0" maxOccurs="unbounded"/>
            <element ref="md:RADIUSNasIpAddress"
                          minOccurs="0" maxOccurs="unbounded"/>
            <element ref="md:RADIUSNasIdentifier"
                          minOccurs="0" maxOccurs="unbounded"/>
            <element ref="md:RADIUSGssEapName"
                          minOccurs="0" maxOccurs="unbounded"/>
          </sequence>
        </extension>
      </complexContent>
    </complexType>
    <element name="RADIUSRPService" type="md:EndpointType"/>
    <element name="RADIUSNasIpAddress" type="string"/>
    <element name="RADIUSNasIdentifier" type="string"/>
    <element name="RADIUSGssEapName" type="string"/>
                                ]]></artwork>
                            </figure>
                        </t>
                    </section>
                </section>
                <section title="Example of SAML Metadata That Includes AAA Names">
                    <t>
                     Figures <xref target="IDPmetadata" format="counter"/>
                     and <xref target="RPmetadata" format="counter"/>
                     illustrate examples of metadata that includes AAA names
                     for an IdP and an RP, respectively.
                     The IdP's SAML name is "https://IdentityProvider.com/", whereas its RADIUS realm is "idp.com".
                        The RP's SAML name is "https://RelyingParty.com/SAML", being its GSS-EAP acceptor name "nfs/fileserver.rp.com@RP.COM".

                        <figure anchor="IDPmetadata" title="Metadata for the IdP">
                            <artwork><![CDATA[
<EntityDescriptor
   xmlns="urn:oasis:names:tc:SAML:2.0:metadata"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:abfab="urn:ietf:params:xml:ns:abfab"
   entityID="https://IdentityProvider.com/SAML">
   <RoleDescriptor
      xsi:type="abfab:RADIUSIDPDescriptorType"
      protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol">
       <RADIUSRealm>idp.com</RADIUSRealm>
   </RoleDescriptor>
</EntityDescriptor>
]]></artwork></figure>

                        <figure anchor="RPmetadata" title="Metadata for the RP">
                            <artwork><![CDATA[
<EntityDescriptor 
   xmlns="urn:oasis:names:tc:SAML:2.0:metadata"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:abfab="urn:ietf:params:xml:ns:abfab"
   entityID="https://RelyingParty.com/SAML">
   <RoleDescriptor 
      xsi:type="abfab:RADIUSRPDescriptorType"
      protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol">
       <RADIUSGssEapName>nfs/fileserver.rp.com@RP.COM</RADIUSGssEapName>
   </RoleDescriptor>
</EntityDescriptor>
]]></artwork></figure>
                    </t>
                </section>
            </section>
            <section title="Use of XML Signatures">
                <t>
                    This binding calls for the use of SAML elements that support XML
                    signatures. To promote interoperability, implementations of this binding
                    MUST support a default configuration that does not require the use of XML
                    signatures. Implementations MAY choose to use XML signatures.
                </t>
            </section>
            <section title="Metadata Considerations">
                <t>
                    This binding, and the profiles, are mostly intended
to be used without metadata.
                    In this usage, RADIUS infrastructure is used to provide integrity and naming of the SAML messages and assertions.
                    RADIUS configuration is used to provide policy, including which attributes are
                    accepted from an RP and which attributes are sent by an IdP.
                </t>
                <t>
                    Nevertheless, if metadata is used, the roles described
                    in <xref target="SAML_metadata"/> MUST be present.
                </t>
            </section>
        </section>

        <section title="Network Access Identifier Name Identifier Format" anchor="NAI_name_id">
            <t>
                URI: urn:ietf:params:abfab:nameid-format:nai
            </t>
            <t>
                Indicates that the content of the element is in the form of a Network Access
                Identifier (NAI) using the syntax described by <xref target="RFC7542" />.
            </t>
        </section>

        <section title="RADIUS State Confirmation Method Identifiers" anchor="RADIUS_cm_methods">
            <t>
                URI: urn:ietf:params:abfab:cm:user
            </t>
            <t>
                URI: urn:ietf:params:abfab:cm:machine
            </t>
            <t>
                Indicates that the subject is the system entity
                (either the user or machine) authenticated by a previously transmitted RADIUS Access&nbhy;Accept
                message, as identified by the value of that RADIUS message's State attribute.
            </t>
        </section>
        <section title="ABFAB Authentication Profile" anchor="ABFAB_authentication_profile">
            <t>
                In the scenario supported by the ABFAB Authentication Profile, a client
                controlling a User Agent requests access to an RP. The RP
                uses RADIUS to authenticate the client. In particular, the RP,
                acting as a RADIUS client, attempts to validate the client's
                credentials against a RADIUS server acting as the client's IdP.
                If the IdP successfully authenticates the client, it produces
                an authentication assertion that is consumed by the RP. This assertion
                MAY include a name identifier that can be used between the
                RP and the IdP to refer to the client.
            </t>
            <section title="Required Information" anchor="auth-prof-req-info">
                <t>
                    Identification: urn:ietf:params:abfab:profiles:authentication
                </t>
                <t>
                    Contact information: iesg@ietf.org
                </t>
                <t>
                    SAML confirmation method identifiers: The SAML V2.0 "RADIUS State"
                    confirmation method identifiers -- either
                    urn:ietf:params:abfab:cm:user or
                    urn:ietf:params:abfab:cm:machine -- are used by this
                    profile.
                </t>
                <t>
                    Updates: None.
                </t>
            </section>

            <section title="Profile Overview">
                <t>
                To implement this scenario, this profile of the SAML
                Authentication Request Protocol MUST be used in conjunction
                with the SAML RADIUS binding defined in
                <xref target="SAML_RADIUS_binding" />.
                </t>

                <t>
                This profile is based on the SAML V2.0 web browser
                single sign-on profile
                <xref target="OASIS.saml-profiles-2.0-os" />. There are
                some important differences; specifically:

                    <list style="hanging">
                        <t hangText="Authentication:">
                        This profile does not require the use of any
                        particular authentication method. The ABFAB
                        architecture does require the use of
                        the Extensible Authentication Protocol (EAP)
                        <xref target="RFC3579"/>, but this specification
                        may be used in other non-ABFAB scenarios.
                        </t>

                        <t hangText="Bindings:">
                            This profile does not use HTTP-based bindings. Instead, all
                            SAML protocol messages are transported using the SAML RADIUS binding
                            defined in <xref target="SAML_RADIUS_binding" />. This is intended to
                            reduce the number of bindings that implementations must support to be
                            interoperable.
                        </t>

                        <t hangText="Requests:">
                            The profile does not permit the RP to name the
                            &lt;saml:Subject&gt; of the &lt;samlp:AuthnRequest&gt;. This is intended
                            to simplify implementation and interoperability.
                        </t>

                        <t hangText="Responses:">
                            The profile only permits the IdP to return a single
                            SAML message or assertion that MUST contain exactly one authentication statement. Other
                            statements may be included within this assertion at the discretion of
                            the IdP. This is intended to simplify implementation and
                            interoperability.
                        </t>
                    </list></t>

                 <t><xref target="AAP_swimlane" /> below illustrates the
                 flow of messages within this profile.</t>

                    <figure anchor="AAP_swimlane" title="Flow of Messages"> <artwork><![CDATA[
    Client            Relying Party             Identity Provider
      |                     |                           |
      |         (1)         |                           |
      | - - - - - - - - - > |                           |
      |                     |                           |
      |                     |            (2)            |
      |                     | - - - - - - - - - - - - > |
      |                     |                           |
      |              (3)    |                           |
      | < - - - - - - - - - |- - - - - - - - - - - - - >|
      |                     |                           |
      |                     |            (4)            |
      |                     | < - - - - - - - - - - - - |
      |                     |                           |
      |         (5)         |                           |
      | < - - - - - - - - - |                           |
      |                     |                           |
      V                     V                           V
                        ]]> </artwork></figure>

       <t>The following steps are described by the profile.
       Within an individual step, there may be one or more actual message
       exchanges.

                    <list style="numbers">
                        <t>
                            Client request to RP (<xref target="AAP_UA2RP" />):
                            In step 1, the client, via a User Agent, makes a request for a
                            secured resource at the RP. The RP determines
                            that no security context for the client exists and initiates
                            the authentication process.
                        </t>

                        <t>
                            RP issues &lt;samlp:AuthnRequest&gt; to IdP
                            (<xref target="RP2IDP" />). In step 2, the RP may optionally
                            issue a &lt;samlp:AuthnRequest&gt; message to be delivered to the IdP
                            using the SAML&nbhy;Protocol RADIUS attribute.
                        </t>

                        <t>
                            IdP identifies client (<xref target="IDP2P" />). In step
                            3, the client is authenticated and identified by the IdP,
                            while honoring any requirements imposed by the RP
in the &lt;samlp:AuthnRequest&gt; message if provided.
                        </t>

                        <t>
                            IdP issues &lt;samlp:Response&gt; to RP
                            (<xref target="IDP2RP" />). In step 4, the IdP issues a
                            &lt;samlp:Response&gt; message to the RP using the SAML RADIUS
                            binding. The response either indicates an error or includes a SAML
                            authentication statement in exactly one SAML Assertion.
                            If the RP did not send a &lt;samlp:AuthnRequest&gt;, the IdP
                            issues an unsolicited &lt;samlp:Assertion&gt;, as described in
                            <xref target="unsolicited"/>.

                        </t>

                        <t>
                            RP grants or denies access to client (<xref target="RP2P" />).
                            In step 5, having received the response from the IdP,
                            the RP can respond to the client with its own error,
                            or can establish its own security context for the client and return the
                            requested resource.
                        </t>
                    </list>
                </t>
            </section>

            <section title="Profile Description">
                <t>
                   The ABFAB Authentication Profile is a profile of the SAML
                   V2.0 Authentication Request Protocol
                   <xref target="OASIS.saml-core-2.0-os" />.
                   Where both specifications conflict, the ABFAB
                   Authentication Profile takes precedence.
                </t>
                    <section title="Client Request to Relying Party" anchor="AAP_UA2RP">
                        <t>
                            The profile is initiated by an arbitrary client
                            request to the RP. There are no restrictions on
                            the form of the request. 
The RP is free to use any means it wishes to associate the subsequent
                            interactions with the original request. The RP, acting as a RADIUS client,
                            attempts to authenticate the client.
                        </t>
                    </section>
                    <section title="Relying Party Issues &lt;samlp:AuthnRequest&gt; to Identity Provider" anchor="RP2IDP">
                        <t>
                            The RP uses RADIUS to communicate with the client's
                            IdP. The RP MAY include a
                            &lt;samlp:AuthnRequest&gt; within this RADIUS Access&nbhy;Request message using
                            the SAML&nbhy;Protocol RADIUS attribute. The
"next hop" destination MAY be the IdP
                            or, alternatively, an intermediate RADIUS proxy.
                        </t>
                        <t>
                            Profile-specific rules for the contents of the &lt;samlp:AuthnRequest&gt;
                            element are given in <xref target="AAP_ARP_Usage" />.
                        </t>
                    </section>

                    <section title="Identity Provider Identifies Client" anchor="IDP2P">
                        <t>
                            The IdP MUST establish the identity of the client using
                            a RADIUS authentication method, or else it will return an error. If the ForceAuthn
                            attribute in the &lt;samlp:AuthnRequest&gt; element (if sent by the RP)
                            is present and true, the IdP MUST freshly establish this
                            identity rather than relying on any existing session state it may have
                            with the client (for example, TLS state that may be used for session
                            resumption). Otherwise, and in all other respects, the IdP
                            may use any method to authenticate the client, subject to the
                            constraints called out in the &lt;samlp:AuthnRequest&gt; message.
                        </t>
                    </section>

                    <section title="Identity Provider Issues &lt;samlp:Response&gt; to Relying Party" anchor="IDP2RP">
                        <t>
                            The IdP MUST conclude the authentication in a manner
                            consistent with the RADIUS authentication result. The IdP MAY issue a
                            &lt;samlp:Response&gt; message to the RP that is consistent with the
                            authentication result, as described in
                            <xref target="OASIS.saml-core-2.0-os" />. This SAML response is delivered to the RP
                            using the SAML RADIUS binding described in <xref target="SAML_RADIUS_binding"/>.
                        </t>
                        <t>
                            Profile-specific rules regarding the contents of the
                            &lt;samlp:Response&gt; element are given in <xref target="AAP_ARP_Response" />.
                        </t>
                    </section>

                    <section title="Relying Party Grants or Denies Access to Client" anchor="RP2P">
                        <t>
                            If a &lt;samlp:Response&gt; message is issued by the IdP, the RP MUST process that message and any enclosed assertion
                            elements as described in <xref target="OASIS.saml-core-2.0-os" />. Any
                            subsequent use of the assertion elements is at the
                            discretion of the RP, subject to any restrictions
                            contained within the assertions themselves or from any previously established
                            out-of-band policy that governs the interaction between the IdP
                            and the RP.
                        </t>
                </section>
            </section>

            <section title="Use of Authentication Request Protocol">
                <t>
                    This profile is based on the Authentication Request Protocol defined in
                    <xref target="OASIS.saml-core-2.0-os" />. In the nomenclature of actors
                    enumerated in Section&nbsp;3.4 of that document, the RP is the requester, the User Agent
                    is the attesting entity, and the client is the subject.
                </t>

                <section title="&lt;samlp:AuthnRequest&gt; Usage" anchor="AAP_ARP_Usage">
                    <t>
                        The RP MUST NOT include a &lt;saml:Subject&gt; element in
                        the request. The authenticated RADIUS identity identifies the client
                        to the IdP.
                    </t>
                    <t>
                        An RP MAY include any message content
described in Section&nbsp;3.4.1 of <xref target="OASIS.saml-core-2.0-os" />.
All processing rules are as defined in <xref target="OASIS.saml-core-2.0-os" />.
                    </t>
                    <t>
                            If the RP wishes to permit the IdP to establish
                        a new identifier for the client if none exists, it MUST include a
                        &lt;saml:NameIDPolicy&gt; element with the AllowCreate attribute set
                            to "true". Otherwise, only a client for whom the IdP
                        has previously established an identifier usable by the RP
                        can be authenticated successfully.
                    </t>
                    <t>
                        The &lt;samlp:AuthnRequest&gt; message MAY be signed. Authentication
                        and integrity are also provided by the SAML RADIUS binding.
                    </t>
                </section>
                <section title="&lt;samlp:Response&gt; Message Usage" anchor="AAP_ARP_Response">
                    <t>
                        If the IdP cannot or will not satisfy
                        the request, it MUST respond with a
                        &lt;samlp:Response&gt; message containing an
                        appropriate error status code or codes
                        and/or respond with a RADIUS Access&nbhy;Reject
                        message.
                    </t>
                    <t>
                        If the IdP wishes to return an error, it MUST NOT include
                        any assertions in the &lt;samlp:Response&gt; message. Otherwise, if the
                        request is successful (or if the response is not associated with a
                        request), the &lt;samlp:Response&gt; element is subject to the following constraints:
                        <list style="symbols">
                            <t>
                                It MAY be signed.
                            </t>
                            <t>
                                It MUST contain exactly one assertion. The
                                &lt;saml:Subject&gt; element of this assertion MUST refer to the
                                authenticated RADIUS user.
                            </t>
                            <t>
                                The assertion MUST contain a
                                &lt;saml:AuthnStatement&gt;. Also,
                                the assertion MUST contain a
                                &lt;saml:Subject&gt; element with at least one
                                &lt;saml:SubjectConfirmation&gt; element
                                containing a
                                &lt;saml:ConfirmationMethod&gt; element of
                                urn:ietf:params:abfab:cm:user or
                                urn:ietf:params:abfab:cm:machine that reflects
                                the authentication of the client to the
                                IdP. Since the
                                &lt;samlp:Response&gt; message is in response
                                to a &lt;samlp:AuthnRequest&gt;,
                                the InResponseTo attribute (in both the
                                &lt;saml:SubjectConfirmationData&gt;
                                and &lt;saml:Response&gt; elements)
                                MUST match the request's ID.
                                The &lt;saml:Subject&gt; element MAY use the
                                NAI name identifier format described
                                in <xref target="NAI_name_id"/> to establish
                                an identifier between the RP and
                                the IdP.
                            </t>
                            <t>
                                Other conditions MAY be included as requested by the RP
                                or at the discretion of the IdP. The IdP
                                is NOT obligated to honor the requested set of conditions in the
                                &lt;samlp:AuthnRequest&gt;, if any.
                            </t>
                        </list>
                    </t>
                </section>

                <section title="&lt;samlp:Response&gt; Message Processing Rules">
                    <t>
                        The RP MUST do the following:
                        <list style="symbols">
                            <t>
                                Assume that the client's identifier implied by a SAML &lt;Subject&gt; element, if present, takes
                                precedence over an identifier implied by the RADIUS User-Name attribute.
                            </t>
                            <t>
                                Verify that the InResponseTo attribute in the "RADIUS State"
                                &lt;saml:SubjectConfirmationData&gt; equals the ID
                                of its original &lt;samlp:AuthnRequest&gt; message, unless the
                                response is unsolicited, in which case the attribute MUST NOT be present.
                            </t>
                            <t>
                                If a &lt;saml:AuthnStatement&gt; used to establish a security
                                context for the client contains a SessionNotOnOrAfter attribute,
                                the security context SHOULD be discarded once this time is reached,
                                unless the RP reestablishes the client's identity
                                by repeating the use of this profile.
                            </t>
                            <t>
                                Verify that any assertions relied upon are valid according to
                                processing rules specified in <xref target="OASIS.saml-core-2.0-os" />.
                            </t>
                            <t>
                                Any assertion that is not valid or whose
subject confirmation requirements cannot be met MUST be discarded and
MUST&nbsp;NOT be used to establish a security context for the client.
                            </t>
                        </list>
                    </t>
                </section>
                <section title="Unsolicited Responses" anchor="unsolicited">
                    <t>
                        An IdP MAY initiate this profile by delivering an unsolicited assertion
                        to an RP. This MUST NOT contain any &lt;saml:SubjectConfirmationData&gt; elements containing an InResponseTo attribute.
                    </t>
                </section>
                <section title="Use of the SAML RADIUS Binding">
                    <t>
                        It is RECOMMENDED that the RADIUS exchange be protected using TLS encryption for RADIUS
                        <xref target="RFC6614" /> to provide confidentiality and integrity protection.
                    </t>
                </section>
                <section title="Use of XML Signatures">
                    <t>
                        This profile calls for the use of SAML elements that support XML signatures. To promote interoperability,
                        implementations of this profile MUST NOT require the use of XML signatures. Implementations
                        MAY choose to use XML signatures.
                    </t>
                </section>
                <section title="Metadata Considerations">
                    <t>
                        There are no metadata considerations particular to this profile,
                        aside from those applying to the use of the RADIUS binding.
                    </t>
                </section>
            </section>
        </section>

        <section title="ABFAB Assertion Query/Request Profile" anchor="ABFAB_query_profile">
            <t>
                This profile builds on the SAML V2.0 Assertion Query/Request Profile defined by
                <xref target="OASIS.saml-profiles-2.0-os" />. That profile describes the use of the
                Assertion Query and Request Protocol defined by
Section&nbsp;3.3 of <xref target="OASIS.saml-core-2.0-os" />
                with synchronous bindings, such as the SOAP binding defined in <xref target="OASIS.saml-bindings-2.0-os" />.
            </t>
            <t>
                Although the SAML V2.0 Assertion Query/Request Profile is independent of the underlying binding,
                it is nonetheless useful to describe the use of the SAML RADIUS binding defined in
                <xref target="SAML_RADIUS_binding"/> of this document, in the interest of
                promoting interoperable implementations, particularly as the SAML V2.0 Assertion Query/Request Profile
                is most frequently discussed and implemented in the context of the SOAP binding.
            </t>
            <section title="Required Information" anchor="q-r-prof-req-info">
                <t>
                    Identification: urn:ietf:params:abfab:profiles:query
                </t>
                <t>
                    Contact information: iesg@ietf.org
                </t>
                <t>
                    Description: Given below.
                </t>
                <t>
                    Updates: None.
                </t>
            </section>

            <section title="Profile Overview">
                <t>As with the SAML V2.0 Assertion Query/Request Profile
                  defined by <xref target="OASIS.saml-profiles-2.0-os" />,
                  the message exchange and basic processing rules that
                  govern this profile are largely defined by
                  Section&nbsp;3.3 of <xref target="OASIS.saml-core-2.0-os"/>,
                  which defines the messages to be exchanged, in combination
                  with the binding used to exchange the messages. The
                  SAML RADIUS binding described in this document
                  defines the binding of the message exchange to RADIUS.
                  Unless specifically noted here, all requirements defined
                  in those specifications apply.</t>

                  <t><xref target="AAQRP_swimlane" /> below illustrates
                  the basic template for the Query/Request Profile.</t>

                    <figure anchor="AAQRP_swimlane" title="Basic Template for
                    Query/Request Profile"><artwork><![CDATA[
  Relying Party                                   Identity Provider
 (SAML requester)                                 (SAML responder)
       |                                                 |
       |                       (1)                       |
       | - - - - - - - - - - - - - - - - - - - - - - - > |
       |                                                 |
       |                       (2)                       |
       | < - - - - - - - - - - - - - - - - - - - - - - - |
       |                                                 |
       V                                                 V
                        ]]></artwork></figure>

                    <t>The following steps are described by the profile:</t>

                    <t><list style="numbers">
                        <t>
                        Query/Request issued by RP: In step 1,
                        an RP initiates the profile by sending an
                        &lt;AssertionIDRequest&gt;, &lt;SubjectQuery&gt;,
                        &lt;AuthnQuery&gt;, &lt;AttributeQuery&gt;, or
                        &lt;AuthzDecisionQuery&gt; message to a SAML authority.
                        </t>

                        <t>
                        &lt;Response&gt; issued by SAML authority: In step 2,
                        the responding SAML authority (after processing the
                        query or request) issues a &lt;Response&gt; message
                        to the RP.
                        </t>
                    </list>
                </t>
            </section>

            <section title="Profile Description">
                <section title="Differences from the SAML V2.0 Assertion Query/Request Profile">
                    <t>
                     This profile is identical to the SAML V2.0 Assertion
                     Query/Request Profile, with the following exceptions:
                        <list style="symbols">
                            <t>
                                When processing the SAML request, the IdP MUST give
                                precedence to the client's identifier implied
                                by the RADIUS State attribute, if present,
                                over the identifier implied by the SAML request's &lt;Subject&gt;, if any.
                            </t>
                            <t>
                                In respect to Sections 6.3.1 and 6.5 of <xref target="OASIS.saml-profiles-2.0-os" />,
                                this profile does not consider the use of metadata
                                (as in <xref target="OASIS.saml-metadata-2.0-os" />). See <xref target="AAQRP_MC" />.
                            </t>
                            <t>
                                In respect to Sections 6.3.2, 6.4.1, and 6.4.2 of <xref target="OASIS.saml-profiles-2.0-os" />, this profile additionally stipulates that implementations
                                of this profile MUST NOT require the use of XML signatures. See <xref target="AAQRP_XS" />.
                            </t>
                        </list>
                    </t>
                </section>

                <section title="Use of the SAML RADIUS Binding">
                    <t>
                        The RADIUS Access-Request sent by the RP:
                        <list style="symbols">
                            <t>
                                MUST include an instance of the RADIUS Service-Type attribute, having
                                a value of Authorize-Only.
                            </t>
                            <t>
                                SHOULD include the RADIUS State attribute, where this Query/&wj;Request
                                pertains to a previously authenticated client.
                            </t>
                        </list>
                    </t>
                    <t>
                        When processing the SAML request, the IdP MUST give
                        precedence to the client's identifier implied by the RADIUS State attribute over
                        the identifier implied by the SAML request's &lt;Subject&gt;, if any.
                    </t>
                    <t>
                        It is RECOMMENDED that the RADIUS exchange be protected using TLS encryption for RADIUS
                        <xref target="RFC6614" /> to provide confidentiality and integrity protection.
                    </t>
                </section>
                <section title="Use of XML Signatures" anchor="AAQRP_XS">
                    <t>
                        This profile calls for the use of SAML elements that support XML signatures. To promote interoperability,
                        implementations of this profile MUST NOT require the use of XML signatures. Implementations
                        MAY choose to use XML signatures.
                    </t>
                </section>
                <section title="Metadata Considerations" anchor="AAQRP_MC">
                    <t>
                        There are no metadata considerations particular to this profile,
                        aside from those applying to the use of the RADIUS binding.
                    </t>
                </section>
            </section>
        </section>

        <section title="Privacy Considerations">
            <t>
                The profiles defined in this document allow an RP to request specific
                information about the client and allow an IdP to disclose information
                about that client. In this sense, IdPs MUST
                apply policy to decide what information is released to a particular RP.
                Moreover, the identity of the client is typically hidden from the RP unless
                provided by the IdP. Conversely, the RP
                does typically know the realm of the IdP, as it is required to route
                the RADIUS packets to the right destination.
            </t>
            <t> The kind of information that is released by the IdP can include generic attributes such as affiliation shared
                by many clients. But even these generic attributes can help to
                identify a specific client.  Other kinds of attributes may also provide an RP
                with the ability to link the same client between different sessions. Finally, other kinds of attributes might provide
                a group of RPs with the ability to link the client between them or with personally identifiable information about the
                client.
            </t>
            <t>
                These profiles do not directly provide a client with a
                mechanism to express preferences about what information
                is released. That information can be expressed
                out of band, for example, as part of the enrollment process.
            </t>
            <t>
                The RP may disclose privacy-sensitive information
                about itself as part of the request, although this is unlikely in typical
                deployments.
            </t>
            <t>
                If RADIUS proxies are used and encryption is not used, the attributes disclosed by the
                IdP are visible to the proxies.  This is a significant
                privacy exposure in some deployments.  Ongoing work is exploring
                mechanisms for creating TLS connections directly between the RADIUS client and
                the RADIUS server to reduce this exposure.  If proxies are used, the
                impact of exposing SAML Assertions to the proxies needs to be
                carefully considered.
            </t>
            <t>
                The use of TLS to provide confidentiality for the RADIUS
                exchange is strongly encouraged.  Without this, passive eavesdroppers can
                observe the assertions.
            </t>
        </section>

        <section title="Security Considerations">
            <t>
                In this specification, the RP MUST trust any statement in the SAML messages from the
                IdP in the same way that it trusts information contained in RADIUS attributes.
                These entities MUST trust the RADIUS infrastructure to provide integrity of the SAML
                messages.
            </t>
            <t>
                Furthermore, the RP MUST apply policy and filter the information based on
                what information the IdP is permitted to assert and on what trust is reasonable to place in
                proxies between them.
            </t>
            <t>
                XML signatures and encryption are provided as an OPTIONAL mechanism for end-to-end security.
                These mechanisms can protect SAML messages from being modified by proxies in the RADIUS
                infrastructure.  These mechanisms are not mandatory to implement.  It is believed that ongoing work to
                provide direct TLS connections between a RADIUS client and RADIUS server will provide similar assurances but better deployability.
                XML security is appropriate for deployments where end-to-end security is required but proxies cannot be removed or where SAML
                messages need to be verified at a later time or by parties not involved in the authentication exchange.
            </t>
        </section>

        <section title="IANA Considerations">
            <section title="RADIUS Attributes">
                <t>
                    The Attribute Types and Attribute Values defined in this document
                    have been registered by the Internet Assigned Numbers Authority (IANA) from
                    the RADIUS namespaces as described in the "IANA Considerations" section of <xref target="RFC3575"/>,
                    in accordance with BCP 26 <xref target="RFC5226"/>.
                    For RADIUS packets, attributes, and registries created by
                    this document, IANA has placed them at
                    &lt;http://www.iana.org/assignments/radius-types&gt;.
                </t>
                <t>
                    In particular, this document defines two new RADIUS attributes, entitled "SAML&nbhy;Assertion" and "SAML&nbhy;Protocol"
                    (see <xref target="SAML_RADIUS_attributes"/>), with assigned values of
                    245.1 and 245.2 from the long extended space <xref target="RFC6929"/>:
                </t>

                <figure align="left">
                    <artwork align="center"><![CDATA[
Type  Ext. Type  Name            Length  Meaning
----  ---------  --------------  ------  ------------------------
245   1          SAML-Assertion  >=5     Encodes a SAML Assertion
245   2          SAML-Protocol   >=5     Encodes a SAML protocol
                                           message]]></artwork> </figure>

            </section>
            <section title="ABFAB Parameters" anchor="ABFAB_PARAMS">
                <t>
                    A new top-level registry has been created, entitled
                    "Application Bridging for Federated Access Beyond Web (ABFAB) Parameters".
                </t>
                <t>
                    In this top-level registry, a sub-registry entitled
                    "ABFAB URN Parameters" has been created.  Registration
                    in this registry is via IETF&nbsp;Review or
                    Expert&nbsp;Review procedures <xref target="RFC5226" />.
                </t>
                <t>
                    This paragraph gives guidance to designated experts.  Registrations in this
                    registry are generally only expected as part of protocols published as RFCs
                    on the IETF stream; other URIs are expected to be better choices for non-IETF work.
                    Expert review is permitted mainly to allow early registration related to
                    specifications under development when the community believes they have reached sufficient
                    maturity.  The expert SHOULD evaluate the maturity and stability of such an IETF-stream
                    specification.  Experts SHOULD review anything not from the IETF stream for consistency
                    and consensus with current practice.  Today, such requests would not typically be approved.
                </t>
                <t>
                    If a parameter named "paramname" is registered in this registry, then its URN will be
                    "urn:ietf:params:abfab:paramname".  The initial registrations are as follows:
                </t>
                <texttable title="ABFAB Parameters">
                    <ttcol>Parameter</ttcol>        <ttcol>Reference</ttcol>
                    <c>bindings:radius</c>          <c><xref target="SAML_RADIUS_binding" /></c>
                    <c>nameid-format:nai</c>        <c><xref target="NAI_name_id" /></c>
                    <c>profiles:authentication</c>  <c><xref target="ABFAB_authentication_profile" /></c>
                    <c>profiles:query</c>           <c><xref target="ABFAB_query_profile" /></c>
                    <c>cm:user</c>                  <c><xref target="RADIUS_cm_methods" /></c>
                    <c>cm:machine</c>               <c><xref target="RADIUS_cm_methods" /></c>
                </texttable>
            </section>

            <section title="Registration of the ABFAB URN Namespace">
                <t>
                  IANA has registered the "abfab" URN sub-namespace in the IETF
                  URN sub-namespace for protocol parameters defined in <xref target="RFC3553" />.
                </t>
                <t>
                  Registry Name: abfab
                </t>
                <t>
                  Specification: RFC 7833 (this document)
                </t>
                <t>
                  Repository: ABFAB URN Parameters
                  (<xref target="ABFAB_PARAMS"/>)
                </t>

                <t>
                  Index Value: Sub-parameters MUST be specified in UTF-8,
                  using standard URI encoding where necessary.
                </t>
            </section>
        </section>
    </middle>

    <back>

        <references title="Normative References">
            &rfc2119;
            &rfc2865;
            &rfc3579;
            &rfc6614;
            &rfc6929;
            &rfc3575;
            &rfc7542;

<reference anchor="OASIS.saml-bindings-2.0-os" target="http://docs.oasis-open.org/security/saml/v2.0/saml-bindings-2.0-os.pdf">
    <front>
        <title>Bindings for the OASIS Security Assertion Markup Language
            (SAML) V2.0</title>
        <author fullname="Scott Cantor" initials="S." surname="Cantor">
            <organization>Internet2</organization>
            <address><email>cantor.2@osu.edu</email></address>
        </author>
        <author fullname="Frederick Hirsch" initials="F." surname="Hirsch">
            <organization>Nokia</organization>
            <address><email>Frederick.Hirsch@nokia.com</email></address>
        </author>
        <author fullname="John Kemp" initials="J." surname="Kemp">
            <organization>Nokia</organization>
            <address><email>John.Kemp@nokia.com</email></address>
        </author>
        <author fullname="Rob Philpott" initials="R." surname="Philpott">
            <organization>RSA Security</organization>
            <address><email>rphilpott@rsasecurity.com</email></address>
        </author>
        <author fullname="Eve Maler" initials="E." surname="Maler">
            <organization>Sun Microsystems</organization>
            <address><email>eve.maler@sun.com</email></address>
        </author>
        <date year="2005" month="March"/>
    </front>
    <seriesInfo name="OASIS Standard" value="saml-bindings-2.0-os"/>
</reference>

<reference target="http://docs.oasis&nbhy;open.org/security/saml/v2.0/saml-core-2.0-os.pdf" anchor="OASIS.saml-core-2.0-os">
  <front><title>Assertions and Protocols for the OASIS Security Assertion
  Markup Language (SAML) V2.0</title>
  <author fullname="Scott Cantor" initials="S." surname="Cantor">
    <organization>Internet2</organization>
    <address><email>cantor.2@osu.edu</email></address></author>
  <author fullname="John Kemp" initials="J."
    surname="Kemp"><organization>Nokia</organization>
    <address><email>John.Kemp@nokia.com</email></address></author>
  <author fullname="Rob Philpott" initials="R." surname="Philpott">
    <organization>RSA Security</organization>
    <address><email>rphilpott@rsasecurity.com</email></address></author>
  <author fullname="Eve Maler" initials="E." surname="Maler">
    <organization>Sun Microsystems</organization>
    <address><email>eve.maler@sun.com</email></address></author>
  <date year="2005" month="March"/></front>
  <seriesInfo name="OASIS Standard" value="saml-core-2.0-os"/>
</reference>

<reference target="http://docs.oasis&nbhy;open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf" anchor="OASIS.saml-profiles-2.0-os"><front>
  <title>Profiles for the OASIS Security Assertion Markup Language
  (SAML) V2.0</title>
  <author fullname="John Hughes" initials="J." surname="Hughes">
    <organization>Altos Origin</organization>
    <address><email/></address></author>
  <author fullname="Scott Cantor" initials="S." surname="Cantor">
    <organization>Internet2</organization>
    <address><email>cantor.2@osu.edu</email></address></author>
  <author fullname="Jeff Hodges" initials="J." surname="Hodges">
    <organization>NeuStar</organization>
    <address><email>Jeff.Hodges@neustar.biz</email></address></author>
  <author fullname="Frederick Hirsch" initials="F." surname="Hirsch">
    <organization>Nokia</organization>
    <address><email>Frederick.Hirsch@nokia.com</email></address></author>
  <author fullname="Prateek Mishra" initials="P." surname="Mishra">
    <organization>Principal Identity</organization>
    <address><email>pmishra@principalidentity.com</email></address></author>
  <author fullname="Rob Philpott" initials="R." surname="Philpott">
    <organization>RSA Security</organization>
    <address><email>rphilpott@rsasecurity.com</email></address></author>
  <author fullname="Eve Maler" initials="E." surname="Maler">
    <organization>Sun Microsystems</organization>
    <address><email>eve.maler@sun.com</email></address></author>
  <date year="2005" month="March"/></front>
  <seriesInfo name="OASIS Standard"
            value="OASIS.saml-profiles-2.0-os"/>
</reference>

<reference target="http://docs.oasis&nbhy;open.org/security/saml/v2.0/saml-metadata-2.0-os.pdf"
           anchor="OASIS.saml-metadata-2.0-os">
  <front><title>Metadata for the OASIS Security Assertion Markup Language
  (SAML) V2.0</title>
  <author fullname="Scott Cantor" initials="S." surname="Cantor">
    <organization>Internet2</organization>
    <address><email>cantor.2@osu.edu</email></address></author>
  <author fullname="Jahan Moreh" initials="J." surname="Moreh">
    <organization>Sigaba</organization>
    <address><email>jmoreh@sigaba.com</email></address></author>
  <author fullname="Rob Philpott" initials="R." surname="Philpott">
    <organization>RSA Security</organization>
    <address><email>rphilpott@rsasecurity.com</email></address></author>
  <author fullname="Eve Maler" initials="E." surname="Maler">
    <organization>Sun Microsystems</organization>
    <address><email>eve.maler@sun.com</email></address></author>
  <date year="2005" month="March"/></front>
  <seriesInfo name="OASIS Standard" value="saml-metadata-2.0-os"/></reference>
</references>

        <references title="Informative References">
            &rfc3553;
            &rfc6733;
            &rfc5226;
            &rfc7055;
            &rfc7499;

<!-- draft-ietf-abfab-arch (RFC 7831)-->
<reference anchor='RFC7831' target="http://www.rfc-editor.org/info/rfc7831">
<front>
<title>Application Bridging for Federated Access Beyond Web (ABFAB) Architecture</title>
<author initials='J' surname='Howlett' fullname='Josh Howlett'>
    <organization />
</author>
<author initials='S' surname='Hartman' fullname='Sam Hartman'>
    <organization />
</author>
<author initials='H' surname='Tschofenig' fullname='Hannes Tschofenig'>
    <organization />
</author>
<author initials='J' surname='Schaad' fullname='Jim Schaad'>
    <organization />
</author>
<date month='May' year='2016' />
</front>
<seriesInfo name='RFC' value='7831' />
<seriesInfo name="DOI" value="10.17487/RFC7831"/>
</reference>

<!-- draft-ietf-radext-bigger-packets ("Approved-announcement to be
        sent:Point Raised") -->
<reference anchor='RADIUS-Large-Pkts'>
<front>
<title>Larger Packets for RADIUS over TCP</title>
<author initials='S' surname='Hartman' fullname='Sam Hartman'>
    <organization />
</author>
<date month='April' year='2016' />
</front>
<seriesInfo name='Work in Progress,' value='draft-ietf-radext-bigger-packets-07' />
</reference>

<reference anchor="W3C.REC-xmlschema-1"
 target="http://www.w3.org/TR/xmlschema-1/">
  <front>
    <title>XML Schema Part 1: Structures Second Edition</title>
    <author initials="H." surname="Thompson" fullname="Henry S. Thompson">
      <organization>University of Edinburgh</organization>
    </author>
    <author initials="D." surname="Beech" fullname="David Beech">
      <organization>Oracle Corporation</organization>
    </author>
    <author initials="M." surname="Maloney" fullname="Murray Maloney">
      <organization>Commerce One</organization>
    </author>
    <author initials="N." surname="Mendelsohn" fullname="Noah Mendelsohn">
      <organization>Lotus Development Corporation</organization>
    </author>
    <date year="2004" month="October" day="28"/>
  </front>
  <seriesInfo name="W3C" value="REC-xmlschema-1"/>
</reference>

        </references>

        <section title="XML Schema">
        <t>The following schema formally defines the "urn:ietf:params:xml:ns:abfab"
        namespace used in this document, in conformance with <xref target="W3C.REC-xmlschema-1"/>.
        Although XML validation is optional, the schema that follows is the normative
        definition of the constructs it defines. Where the schema differs from any
        prose in this specification, the schema takes precedence.</t>

        <figure><artwork> <![CDATA[
        <schema
          targetNamespace="urn:ietf:params:xml:ns:abfab"
          xmlns="http://www.w3.org/2001/XMLSchema"
          xmlns:md="urn:oasis:names:tc:SAML:2.0:metadata"
          xmlns:abfab="urn:ietf:params:xml:ns:abfab"
          elementFormDefault="unqualified"
          attributeFormDefault="unqualified"
          blockDefault="substitution"
          version="1.0">

          <import namespace="urn:oasis:names:tc:SAML:2.0:metadata"/>

          <complexType name="RADIUSIDPDescriptorType">
            <complexContent>
              <extension base="md:RoleDescriptorType">
                <sequence>
                  <element ref="abfab:RADIUSIDPService"
                                minOccurs="0" maxOccurs="unbounded"/>
                  <element ref="abfab:RADIUSRealm"
                                minOccurs="0" maxOccurs="unbounded"/>
                </sequence>
              </extension>
            </complexContent>
          </complexType>
          <element name="RADIUSIDPService" type="md:EndpointType"/>
          <element name="RADIUSRealm" type="string"/>

          <complexType name="RADIUSRPDescriptorType">
            <complexContent>
              <extension base="md:RoleDescriptorType">
                <sequence>
                  <element ref="md:RADIUSRPService"
                                minOccurs="0" maxOccurs="unbounded"/>
                  <element ref="md:RADIUSNasIpAddress"
                                minOccurs="0" maxOccurs="unbounded"/>
                  <element ref="md:RADIUSNasIdentifier"
                                minOccurs="0" maxOccurs="unbounded"/>
                  <element ref="md:RADIUSGssEapName"
                                minOccurs="0" maxOccurs="unbounded"/>
                </sequence>
              </extension>
            </complexContent>
          </complexType>
          <element name="RADIUSRPService" type="md:EndpointType"/>
          <element name="RADIUSNasIpAddress" type="string"/>
          <element name="RADIUSNasIdentifier" type="string"/>
          <element name="RADIUSGssEapName" type="string"/>

        </schema>]]>
        </artwork></figure>

        </section>

        <section title="Acknowledgments" numbered="no">
            <t>
                The authors would like to acknowledge the OASIS Security
                Services (SAML) Technical Committee, and Scott Cantor
                in particular, for their help with the SAML&nbhy;related
                material.
            </t>
            <t>
                The authors would also like to acknowledge the collaboration
                of Jim Schaad, Leif Johansson, Klaas Wierenga,
                Stephen Farrell, Gabriel Lopez&nbhy;Millan, and
                Rafa Marin&nbhy;Lopez, who have provided valuable
                comments on this document.
            </t>

        </section>
    </back>
</rfc>

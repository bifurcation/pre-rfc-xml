<?xml version="1.0" encoding="US-ASCII"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>

<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="no" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>

<rfc number="8158" 
     category="std" 
     submissionType="IETF"
     consensus="yes"
     ipr="trust200902">

  <front>
    
    <title abbrev="IPFIX IEs for NAT Logging">IP Flow Information Export
    (IPFIX) Information Elements for&nbsp;Logging&nbsp;NAT&nbsp;Events</title>

    <author fullname="Senthil Sivakumar" initials="S." surname="Sivakumar">
      <organization>Cisco Systems</organization>

      <address>
        <postal>
          <street>7100-8 Kit Creek Road</street>

          <city>Research Triangle Park</city>

          <region>NC</region>

          <code>27709</code>

          <country>United States of America</country>
        </postal>

        <phone>+1 919 392 5158</phone>

        <email>ssenthil@cisco.com</email>

      </address>
    </author>

    <author fullname="Reinaldo Penno" initials="R." surname="Penno">
      <organization>Cisco Systems</organization>

      <address>
        <postal>
          <street>170 W Tasman Drive</street>

          <city>San Jose</city>

          <region>CA</region>

          <code>95035</code>

          <country>United States of America</country>
        </postal>

        <phone></phone>

        <email>repenno@cisco.com</email>

      </address>
    </author>

    <date month="December" year="2017" />

    <area>General</area>

    <workgroup>Behave</workgroup>

    <keyword>template</keyword>

    <abstract>
      <t>Network operators require NAT devices to log events like creation and deletion of
   translations and information about the resources that the NAT device is managing.  In many cases, the
   logs are essential to identify an attacker or a host
   that was used to launch malicious attacks and for various other
   purposes of accounting.  Since there is no standard way of logging
   this information, different NAT devices use proprietary formats;
   hence, it is difficult to expect consistent behavior.  This lack of 
   standardization makes it difficult to write the Collector applications
   that would receive this data and process it to present useful
   information.  This document describes the formats for logging NAT events.
   </t>
  </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>The IP Flow Information Export (IPFIX) Protocol <xref target="RFC7011"/> defines a generic push mechanism for exporting information
        and events. The IPFIX Information Model <xref target="IPFIX-IANA"/>
	defines a set of standard Information Elements (IEs)
        that can be carried by the IPFIX protocol. 

        This document details the IPFIX IEs that MUST be logged by a NAT
        device that supports NAT logging using IPFIX and all the optional fields.  The fields specified in this
        document are gleaned from <xref target="RFC4787"/> and <xref target="RFC5382"/>. </t>

      <t>
      This document and <xref target="NAT-LOG"/> are written in order to standardize
      the events and parameters to be recorded using IPFIX <xref target="RFC7011"/> 
      and SYSLOG <xref target="RFC5424"/>, respectively.
      This document uses IPFIX as the encoding mechanism to describe the
      logging of NAT events.  However, the information that is logged
      should be the same irrespective of what kind of encoding scheme is
      used.  IPFIX is chosen because it is an IETF standard that meets all
      the needs for a reliable logging mechanism.  IPFIX provides the
      flexibility to the logging device to define the datasets that it is
      logging.  The IEs specified for logging must be the same irrespective
      of the encoding mechanism used. </t>

      <section title="Terminology">
      <t>The term "NAT device" in this document refers to any
      NAT44 or NAT64 device. The term "Collector"
      refers to any device that receives binary data from a NAT device and
      converts it into meaningful information. This document uses the term
      "session" as defined in <xref target="RFC2663"/>, and the
      term "Binding Information Base" (BIB) as defined in <xref target="RFC6146"></xref>. The 
      term "Information Element" or "IE" is defined in 
      <xref target="RFC7011"/>. The term "Carrier-Grade NAT" refers to a large-scale NAT device 
      as described in <xref target="RFC6888"/></t>

      <t> The IPFIX IEs that are NAT specific are created with
          NAT terminology. In order to avoid creating duplicates, IEs
          are reused if they convey the same meaning. 
          This document uses the term "timestamp" for the IE, which
          defines the time when an event is logged; this is the same as the IPFIX 
          term "observationTimeMilliseconds" as described in <xref target="IPFIX-IANA"/>.
 Since
          observationTimeMilliseconds is not self-explanatory for NAT implementors,
          the term "timeStamp" is used. Event templates,
          which refer to IPFIX Template Records, as well as log events, 
          which refer to IPFIX Flow Records, are also used in this document. </t>

      </section>

      <section title="Requirements Language">
        <t>
    The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
    NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
    "MAY", and "OPTIONAL" in this document are to be interpreted as
    described in BCP&nbsp;14 <xref target="RFC2119"/> <xref target="RFC8174"/> 
    when, and only when, they appear in all capitals, as shown here.
        </t>
      </section>
    </section>

    <section title="Scope">
      <t>This document provides the information model to be used for logging
      the NAT events, including Carrier-Grade NAT (CGN) events. 
      <xref target="RFC7011"/> provides guidance on the 
      choices of the transport protocols used for IPFIX and their effects. This document does not provide 
      guidance on transport protocols like TCP, UDP, or
      Stream Control Transmission Protocol (SCTP), which are to be used to log NAT events.
      The logs SHOULD be reliably sent to the Collector to ensure that the log events are not lost.
      The choice of the actual transport protocol is beyond the scope of this document.</t>

      <t>This document uses the allocated IPFIX IEs in the IANA "IPFIX Information Elements" registry <xref target="IPFIX-IANA"/> and registers some new ones.</t> 

      <t>This document assumes that the NAT device will use the existing
      IPFIX framework to send the log events to
      the Collector. This would mean that the NAT device will specify the template
      that it is going to use for each of the events. 
      The templates can be of varying length, and there could be multiple
      templates that a NAT device could use to log the events. </t>

      <t>The implementation details of the Collector application are beyond the
      scope of this document.</t>

      <t>The optimization of logging the NAT events is left to the
      implementation and is beyond the scope of this document.</t>
    </section>
    <section title="Deployment">
    <t>NAT logging based on IPFIX uses binary encoding; hence, it is very efficient.
    IPFIX-based logging is recommended for environments where a high volume of logging is
    required, for example, where per-flow logging is needed or in case of Carrier-Grade NAT.
    However, IPFIX-based logging requires a Collector that processes the binary
    data and requires a network management application that converts this binary
    data to a human-readable format.</t>

    <t> A Collector may receive NAT events from multiple CGN devices. The Collector
   distinguishes between the devices using the source IP address, source port,
   and Observation Domain ID in the IPFIX header. The Collector can decide to 
   store the information based on the administrative policies that are in line with the 
   operator and the local jurisdiction. The retention policy is not dictated by the 
   Exporter and is left to the policies that are defined at the Collector.</t>

    <t> A Collector may have scale issues if it is overloaded by a large number of simultaneous events.
    An appropriate throttling mechanism may be used to handle the oversubscription. </t>

    <t> The logs that are exported can be used for a variety of reasons. An example use case is to do 
    accounting based on when the users logged on and off. The translation will be installed
    when the user logs on and removed when the user logs off. These events create log records.
    Another use case is to identify an attacker or a host in a provider network. The network
    administrators can use these logs to identify the usage patterns, the need for additional 
    IP addresses, and etc. The deployment of NAT logging is not limited to just these cases. </t>


    </section>

    <section title="Event-Based Logging">

  <t>An event in a NAT device can be viewed as a state transition because it
   relates to the management of NAT resources. The creation and deletion of NAT
      sessions and bindings are examples of events, as they result in 
      resources (addresses and ports) being allocated or freed. The events can
      happen through the processing of data packets flowing through the
      NAT device, through an external entity installing policies on the NAT
      router, or as a result of an asynchronous event like a timer. 
      The list of events is provided in <xref target="event_id_table"/>. Each of these
      events SHOULD be logged, unless this is administratively prohibited. A
      NAT device MAY log these events to multiple Collectors if redundancy is
      required. The network administrator will specify the Collectors to which
      the log records are to be sent. It is necessary to preserve the list of Collectors
      and its associated information like the IPv4/IPv6 address, port, and protocol 
      across reboots so that the configuration information is not lost when the device is 
      restarted.
      The NAT device implementing the IPFIX logging MUST follow the IPFIX
      specification in <xref target="RFC7011"/>.
      </t>

      <section anchor="Logging" title="Logging Destination Information">
         <t> Logging destination information in a NAT event is discussed in 
             <xref target="RFC6302"></xref> and
             <xref target="RFC6888"></xref>.
             Logging destination information increases the size of each record and 
             increases the need for storage considerably. It increases the number of log events 
             generated because when the same user connects to a different destination, 
             it results in a log record per destination address. Logging the source and
             destination addresses results in loss of privacy. Logging of destination 
	     addresses and ports, pre- or post-NAT, SHOULD NOT be done <xref target="RFC6888"/>. 
             However, this document provides the necessary fields to log the destination information
             in cases where they must be logged. 
         </t>
      </section> 
      <section title="Information Elements">
        <t>The templates could contain a subset of the IEs shown in <xref target="Template_table"/>, depending upon the event being logged.
        For example, a NAT44 session creation template record will contain:</t>

        <t>{sourceIPv4Address, postNATSourceIPv4Address,
        destinationIPv4Address, postNATDestinationIPv4Address,
        sourceTransportPort, postNAPTSourceTransportPort,
        destinationTransportPort, postNAPTDestinationTransportPort,
        internalAddressRealm, natEvent, timeStamp}</t>

        <t>An example of the actual event data record is shown below in a
        human-readable form:</t>

        <t>{192.0.2.1, 203.0.113.100, 192.0.2.104, 192.0.2.104, 14800,
        1024, 80, 80, 0, 1, 09:20:10:789}</t>

        <t>A single NAT device could be exporting multiple templates, and the
        Collector MUST support receiving multiple templates from the same
        source.
        <vspace blankLines='50' />
        </t>

        <t>The following table includes all the IEs that a NAT device would
   need to export the events.  The formats of the IEs and the IPFIX IDs
   are listed.  Detailed descriptions of the fields natInstanceID, internalAddressRealm, 
   externalAddressRealm, natQuotaExceededEvent, and natThresholdEvent are included in the IANA 
   Considerations section.
</t>

<?rfc compact="no"?>
        <texttable anchor="Template_table" title="NAT IE List">
          <ttcol align="left">Field Name</ttcol>

          <ttcol align="center">Size (bits)</ttcol>

          <ttcol align="center">IANA IPFIX ID</ttcol>

          <ttcol align="left" width="40%">Description</ttcol>

          <c>timeStamp</c>

          <c>64</c>

          <c>323</c>

          <c>System Time when the event occurred</c>

          <c>natInstanceID</c>

          <c>32</c>

          <c>463</c>

          <c>NAT Instance Identifier</c>

          <c>vlanId</c>

          <c>16</c>

          <c>58</c>

          <c>VLAN ID in case of overlapping networks</c>

          <c>ingressVRFID</c>

          <c>32</c>

          <c>234</c>

          <c>VRF ID in case of overlapping networks</c>

          <c>sourceIPv4Address</c>

          <c>32</c>

          <c>8</c>
          
          <c>Source IPv4 Address</c>

          <c>postNATSourceIPv4Address</c>

          <c>32</c>

          <c>225</c>

          <c>Translated Source IPv4 Address</c>

          <c>protocolIdentifier</c>

          <c>8</c>

          <c>4</c>

          <c>Transport protocol</c>

          <c>sourceTransportPort</c>

          <c>16</c>

          <c>7</c>

          <c>Source Port</c>

          <c>postNAPTSourceTransportPort</c>

          <c>16</c>

          <c>227</c>

          <c>Translated Source port</c>

          <c>destinationIPv4Address</c>

          <c>32</c>

          <c>12</c>

          <c>Destination IPv4 Address</c>

          <c>postNATDestinationIPv4Address</c>

          <c>32</c>

          <c>226</c>

          <c>Translated IPv4 destination address</c>

          <c>destinationTransportPort</c>

          <c>16</c>

          <c>11</c>

          <c>Destination port</c>

          <c>postNAPTDestinationTransportPort</c>

          <c>16</c>

          <c>228</c>

          <c>Translated Destination port</c>

          <c>sourceIPv6Address</c>

          <c>128</c>

          <c>27</c>

          <c>Source IPv6 address</c>

          <c>destinationIPv6Address</c>

          <c>128</c>

           <c>28</c>

          <c>Destination IPv6 address</c>

          <c>postNATSourceIPv6Address</c>

          <c>128</c>

         <c>281</c>

          <c>Translated source IPv6 address</c>

          <c>postNATDestinationIPv6Address</c>

          <c>128</c>

          <c>282</c>

          <c>Translated Destination IPv6 address</c>

          <c>internalAddressRealm</c>

          <c>(*)</c>

          <c>464</c>

          <c>Source Address Realm</c>

          <c>externalAddressRealm</c>

          <c>(*)</c>

          <c>465</c>

          <c>Destination Address Realm</c>

          <c>natEvent</c>

          <c>8</c>

          <c>230</c>

          <c>Type of Event</c>

          <c>portRangeStart</c>

          <c>16</c>

          <c>361</c>

          <c>Allocated port block start</c>

          <c>portRangeEnd</c>

          <c>16</c>

          <c>362</c>

          <c>Allocated Port block end</c>

          <c>natPoolId</c>

          <c>32</c>

          <c>283</c>
          
          <c>NAT pool Identifier</c>

          <c>natQuotaExceededEvent</c>

          <c>32</c>

          <c>466</c>
          
          <c>Limit event identifier</c>
          
          <c>natThresholdEvent</c>

          <c>32</c>

          <c>467</c>
          
          <c>Threshold event identifier</c>

	  <c>maxSessionEntries</c>
	  
	  <c>32</c>

	  <c>471</c>

	  <c>Maximum session entries </c>

	  <c>maxBIBEntries</c>

	  <c>32</c>

	  <c>472</c>

	  <c>Maximum bind entries </c>

	  <c>maxEntriesPerUser</c>

	  <c>32</c>

	  <c>473</c>

	  <c>Maximum entries per-user </c>

	  <c>maxSubscribers</c>

	  <c>32</c>

	  <c>474</c>

	  <c>Maximum subscribers</c>

	  <c>maxFragmentsPendingReassembly</c>

	  <c>32</c>

	  <c>475</c>

	  <c>Maximum fragments for ressembly</c>

	  <c>addressPoolHighThreshold</c>

	  <c>32</c>

	  <c>476</c>

	  <c>High threshold for address pool</c>

	  <c>addressPoolLowThreshold</c>

	  <c>32</c>

	  <c>477</c>

	  <c>Low threshold for address pool</c>

	  <c>addressPortMappingHighThreshold</c>

	  <c>32</c>

	  <c>478</c>

	  <c>High threshold for address/port mapping</c>

	  <c>addressPortMappingLowThreshold</c>

	  <c>32</c>

	  <c>479</c>

	  <c>Low threshold for address/port mapping</c>

	  <c>addressPortMappingPerUserHighThreshold</c>

	  <c>32</c>

	  <c>480</c>

	  <c>High threshold for per-user address/port mapping</c>

	  <c>globalAddressMappingHighThreshold</c>

	  <c>32</c>

	  <c>481</c>

	  <c>High threshold for global address mapping</c>
	  <postamble>Note: (*) indicates octetArray</postamble>
                  </texttable>
<?rfc compact="yes"?>
      </section>

      <section title="Definition of NAT Events" anchor="Definition_of_NAT_Events">
        <t>The following is the complete list of NAT events and the proposed event
        type values. The natEvent IE is defined in the "IPFIX Information Elements" registry <xref target="IPFIX-IANA"/>;.
        The list can be expanded in the future as necessary. The data
        record will have the corresponding natEvent value to indicate the
        event that is being logged. </t> 
        
        <t>Note that the first two events are marked "Historic" and are listed here for the sole purpose of completeness.  Any compliant implementation
   SHOULD NOT use the events that are marked "Historic".
These values
   were defined prior to the existence of this document and outside the
   IETF.  These events are not standalone and require more
   information to be conveyed to qualify the event.  For example, the NAT
   translation create event does not specify if it is NAT44 or NAT64.
   As a result, the Behave working group decided to have an explicit
   definition for each one of the unique events. </t>

        <texttable anchor="event_id_table" title="NAT Event ID">
          <ttcol align="left">Value</ttcol>

          <ttcol align="left">Event Name</ttcol>

	  <c>0</c>
	  <c>Reserved</c>

	  <c>1</c>
          <c>NAT translation create (Historic)</c>

          <c>2</c>
          <c> NAT translation delete (Historic) </c>
          
          <c>3</c>
          <c>NAT Addresses exhausted</c>

          <c>4</c>
          <c>NAT44 session create</c>

          <c>5</c>
          <c>NAT44 session delete</c>

          <c>6</c>
          <c>NAT64 session create</c>

          <c>7</c>
          <c>NAT64 session delete</c>

          <c>8</c>
          <c>NAT44 BIB create</c>

          <c>9</c>
          <c>NAT44 BIB delete</c>


          <c>10</c>
          <c>NAT64 BIB create</c>

          <c>11</c>
          <c>NAT64 BIB delete</c>

          <c>12</c>
          <c>NAT ports exhausted</c>

          <c>13</c>
          <c>Quota Exceeded</c>

          <c>14</c>
          <c>Address binding create</c>

          <c>15</c> 
          <c>Address binding delete</c>

          <c>16</c>
          <c>Port block allocation</c>

          <c>17</c>
          <c>Port block de-allocation</c>

          <c>18</c> 
          <c>Threshold Reached</c>

          </texttable>
      </section>
      <section title='Quota Exceeded Event Types'>
        <t> The Quota Exceeded event is a natEvent IE described in <xref target="event_id_table"/>.
            The Quota Exceeded events are generated when the hard limits set by the administrator
            have been reached or exceeded. 
            The following table shows the sub-event types for the Quota Exceeded event.
            The events that can be reported are the maximum session entries 
            limit reached, maximum BIB entries limit reached, maximum (session/BIB) entries per
            user limit reached, maximum active hosts or subscribers limit reached, 
            and maximum Fragments pending reassembly limit reached. </t>

        <texttable anchor="limid_id_table" title="Quota Exceeded Event">
          <ttcol align="left">Value</ttcol>

          <ttcol align="left">Quota Exceeded Event Name</ttcol>

          <c>0</c>
	  <c>Reserved</c>
	  
          <c>1</c>
          <c>Maximum session entries </c>

          <c>2</c>
         <c>Maximum BIB entries </c>

          <c>3</c>
          <c>Maximum entries per user</c>

          <c>4</c>
          <c> Maximum active hosts or subscribers </c> 
          
          <c>5</c>
          <c> Maximum fragments pending reassembly </c> 

         </texttable>
      </section>
      <section title="Threshold Reached Event Types">
        <t> The following table shows the sub-event types for the Threshold Reached event. The      
            administrator can configure the thresholds, and whenever the threshold is reached or 
            exceeded, the corresponding events are generated. The main
	    difference between the
            Quota Exceeded and Threshold Reached events is that, once the Quota Exceeded
            events are hit, the packets are dropped or mappings will not be created, whereas 
            the Threshold Reached events will provide the operator a chance to take action before 
            the traffic disruptions can happen. A NAT device can choose to implement one or the 
            other, or both.
        </t>
       
        <t> The address pool high threshold event will be reported when the address pool reaches 
            a high-water mark as defined by the operator. This will serve as
	    an indication that either 
            the operator might have to add more addresses to the pool or the
            subsequent users may be denied NAT translation mappings. </t>
        <t> The address pool low threshold event will be reported when the address pool reaches 
            a low-water mark as defined by the operator. This will serve as an indication that 
            the operator can reclaim some of the global IPv4 addresses in the pool. 
        </t>
        <t> The address and port mapping high threshold event is generated when the number of ports
            in the configured address pool has reached a configured threshold. </t>
        <t> The per-user address and port mapping high threshold is generated when a single user 
            utilizes more address and port mapping than a configured threshold. We don't track the 
            low threshold for per-user address and port mappings because, as the ports are freed, 
            the address will become available. The address pool low threshold event will then be triggered
            so that the global IPv4 address can be reclaimed. </t>
        <t> The global address mapping high threshold event is generated when 
            the maximum number of mappings per user is reached for a NAT device doing paired-address pooling.
        </t>


        <texttable anchor="threshold_id_table" title="Threshold Event">
          <ttcol align="left">Value</ttcol>

          <ttcol align="left">Threshold Exceeded Event Name</ttcol>

          <c>0</c>
	  <c>Reserved</c>

          <c>1</c>
          <c> Address pool high threshold event</c>

          <c>2</c>
          <c> Address pool low threshold event </c>

          <c>3</c>
         <c> Address and port mapping high threshold event </c>

          <c>4</c>
          <c> Address and port mapping per user high threshold event </c>

          <c>5</c>
          <c> Global address mapping high threshold event </c>

         </texttable>
      </section>

      <section title="Templates for NAT Events">
        <t>The following is the template of events that will be logged.
         The events below are identified at the time of this writing, but
        the set of events is extensible. A NAT device that implements 
        a given NAT event MUST support the mandatory IEs in the templates. 
        Depending on the implementation and
        configuration, various IEs that are not mandatory can be included or ignored.</t>

        <section title="NAT44 Session Create and Delete Events">
          <t>These events will be generated when a NAT44 session is created or
          deleted. The template will be the same; the natEvent will indicate
          whether it is a create or a delete event. The following is a
          template of the event.</t>

          <t> The destination address and port information is optional as required
          by <xref target="RFC6888"></xref>. However, when the destination information
          is suppressed, the session log event contains the same information as the 
          BIB event. In such cases, the NAT device SHOULD NOT send both BIB and session
          events. 
          </t>



          <texttable anchor="event_template_table"
                     title="NAT44 Session Delete/Create Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>sourceIPv4Address</c>

            <c>32</c>

            <c>Yes</c>

            <c>postNATSourceIPv4Address</c>

            <c>32</c>

            <c>Yes</c>

            <c>protocolIdentifier</c>

            <c>8</c>

            <c>Yes</c>

            <c>sourceTransportPort</c>

            <c>16</c>

            <c>Yes</c>

            <c>postNAPTSourceTransportPort</c>

            <c>16</c>

            <c>Yes</c>

            <c>destinationIPv4Address</c>

            <c>32</c>

            <c>No</c>

            <c>postNATDestinationIPv4Address</c>

            <c>32</c>

            <c>No</c>

            <c>destinationTransportPort</c>

            <c>16</c>

            <c>No</c>

            <c>postNAPTDestinationTransportPort</c>

            <c>16</c>

            <c>No</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

            <c>vlanID/ingressVRFID</c>

            <c>16/32</c>

            <c>No</c>

            <c>internalAddressRealm</c>

            <c>octetArray</c>

            <c>No</c>

            <c>externalAddressRealm</c>

            <c>octetArray</c>

            <c>No</c>

          </texttable>
        </section>

        <section title="NAT64 Session Create and Delete Events">
          <t>These events will be generated when a NAT64 session is created or deleted. The
          following is a template of the event.</t>

          <texttable anchor="nat64_session_event_template_table"
                     title="NAT64 Session Create/Delete Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>
            <c>sourceIPv6Address</c>

            <c>128</c>

            <c>Yes</c>

            <c>postNATSourceIPv4Address</c>

            <c>32</c>

            <c>Yes</c>

            <c>protocolIdentifier</c>

            <c>8</c>

            <c>Yes</c>

            <c>sourceTransportPort</c>

            <c>16</c>

            <c>Yes</c>

            <c>postNAPTSourceTransportPort</c>

            <c>16</c>

            <c>Yes</c>

            <c>destinationIPv6Address</c>

            <c>128</c>

            <c>No</c>

            <c>postNATDestinationIPv4Address</c>

            <c>32</c>

            <c>No</c>

            <c>destinationTransportPort</c>

            <c>16</c>

            <c>No</c>

            <c>postNAPTDestinationTransportPort</c>

            <c>16</c>

            <c>No</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

            <c>vlanID/ingressVRFID</c>

            <c>16/32</c>

            <c>No</c>

            <c>internalAddressRealm</c>

            <c>octetArray</c>

            <c>No</c>

            <c>externalAddressRealm</c>

            <c>octetArray</c>

            <c>No</c>

          </texttable>
        </section>

        <section title="NAT44 BIB Create and Delete Events">
          <t>These events will be generated when a NAT44 Bind entry is created or deleted.
          The following is a template of the event.</t>

          <texttable anchor="nat44_bib_event_template_table"
                     title="NAT44 BIB Create/Delete Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>sourceIPv4Address</c>

            <c>32</c>

            <c>Yes</c>

            <c>postNATSourceIPv4Address</c>

            <c>32</c>

            <c>Yes</c>

            <c>protocolIdentifier</c>

            <c>8</c>

            <c>No</c>

            <c>sourceTransportPort</c>

            <c>16</c>

            <c>No</c>

            <c>postNAPTSourceTransportPort</c>

            <c>16</c>

            <c>No</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

            <c>vlanID/ingressVRFID</c>

            <c>16/32</c>

            <c>No</c>

            <c>internalAddressRealm</c>

            <c>octetArray</c>

            <c>No</c>

            <c>externalAddressRealm</c>

            <c>octetArray</c>

            <c>No</c>
          </texttable>
        </section>

        <section title="NAT64 BIB Create and Delete Events">
          <t>These events will be generated when a NAT64 Bind entry is created or deleted.
          The following is a template of the event.</t>

          <texttable anchor="nat64_bib_event_template_table"
                     title="NAT64 BIB Create/Delete Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>
            <c>sourceIPv6Address</c>

            <c>128</c>

            <c>Yes</c>

            <c>postNATSourceIPv4Address</c>

            <c>32</c>

            <c>Yes</c>

            <c>protocolIdentifier</c>

            <c>8</c>

            <c>No</c>

            <c>sourceTransportPort</c>

            <c>16</c>

            <c>No</c>

            <c>postNAPTSourceTransportPort</c>

            <c>16</c>

            <c>No</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

            <c>vlanID/ingressVRFID</c>

            <c>16/32</c>

            <c>No</c>

            <c>internalAddressRealm</c>

            <c>octetArray</c>

            <c>No</c>

            <c>externalAddressRealm</c>

            <c>octetArray</c>

            <c>No</c>

          </texttable>
        </section>

        <section title="Addresses Exhausted Event">
          <t>This event will be generated when a NAT device runs out of global
          IPv4 addresses in a given pool of addresses. Typically, this event would mean that the
          NAT device
          won't be able to create any new translations until some
          addresses/ports are freed. This event SHOULD be rate-limited, as many packets hitting the 
          device at the same time will trigger a burst of addresses exhausted events. </t>

          <t> The following is a template of the event.</t> 

          <texttable anchor="nat_adress_exhaust_template_table"
                     title="Addresses Exhausted Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>natPoolID</c>

            <c>32</c>

            <c>Yes</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

          </texttable>
        </section>

        <section title="Ports Exhausted Event">
          <t>This event will be generated when a NAT device runs out of ports
          for a global IPv4 address. Port exhaustion shall be reported per
          protocol (UDP, TCP, etc.). This event SHOULD be rate-limited, as many packets hitting the 
         device at the same time will trigger a burst of port exhausted events. </t>
          
          <t>The following is a template of the event. </t>

          <texttable anchor="nat_ports_exhaust_template_table"
                     title="Ports Exhausted Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>postNATSourceIPv4Address</c>

            <c>32</c>

            <c>Yes</c>

            <c>protocolIdentifier</c>

            <c>8</c>

            <c>Yes</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

          </texttable>
        </section>

        <section title="Quota Exceeded Events">
          <t>This event will be generated when a NAT device cannot allocate
          resources as a result of an administratively defined policy. The
          Quota Exceeded event templates are described below.</t>


          <section title="Maximum Session Entries Exceeded">
          <t> The maximum session entries exceeded event is generated when the administratively
          configured NAT session limit is reached. The following is the template of 
          the event. </t>
          <texttable anchor="nat_session_entries_exceeded_template_table"
                     title="Session Entries Exceeded Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>natQuotaExceededEvent</c>

            <c>32</c>

            <c>Yes</c>

            <c>maxSessionEntries</c>

            <c>32</c>

            <c>Yes</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

          </texttable>
          </section>

          <section title="Maximum BIB Entries Exceeded">
          <t> The maximum BIB entries exceeded event is generated when the administratively
          configured BIB entry limit is reached. The following is the template of 
          the event. </t>
          <texttable anchor="nat_bib_entries_exceeded_template_table"
                     title="BIB Entries Exceeded Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>natQuotaExceededEvent</c>

            <c>32</c>

            <c>Yes</c>

            <c>maxBIBEntries</c>

            <c>32</c>

            <c>Yes</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

          </texttable>
          </section>

          <section title="Maximum Entries per User Exceeded">
          <t> This event is generated when a single user 
          reaches the administratively configured NAT translation limit. The following is the template of 
          the event. </t>
          <texttable anchor="nat_per_user_entries_exceeded_template_table"
                     title="Per-User Entries Exceeded Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>natQuotaExceededEvent</c>

            <c>32</c>

            <c>Yes</c>

            <c>maxEntriesPerUser</c>

            <c>32</c>

            <c>Yes</c>

            <c>sourceIPv4Address</c>

            <c>32</c>

            <c>Yes for NAT44</c>

            <c>sourceIPv6Address</c>

            <c>128</c>

            <c>Yes for NAT64</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

            <c>vlanID/ingressVRFID</c>

            <c>16/32</c>

            <c>No</c>


          </texttable>


          </section>

          <section title="Maximum Active Hosts or Subscribers Exceeded">
          <t> This event is generated when the number of allowed hosts or subscribers 
          reaches the administratively configured limit. The following is the template of 
          the event. </t>
          <texttable anchor="nat_max_sub_entries_exceeded_template_table"
                     title="Maximum Hosts/Subscribers Exceeded Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>natQuotaExceededEvent</c>

            <c>32</c>

            <c>Yes</c>

            <c>maxSubscribers</c>

            <c>32</c>

            <c>Yes</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

          </texttable>
          </section>

          <section title="Maximum Fragments Pending Reassembly Exceeded">
          <t> This event is generated when the number of fragments pending reassembly reaches 
          the administratively configured limit. Note that in the case of NAT64, when this condition is detected 
          in the IPv6-to-IPv4 direction, the IPv6 source address is mandatory in the template.
          Similarly, when this condition is detected in IPv4-to-IPv6 direction, the source IPv4 address
          is mandatory in the template below.
          The following is the template of the event. </t>
          <texttable anchor="nat_max_frag_reassembly_exceeded_template_table"
                     title="Maximum Fragments Pending Reassembly Exceeded Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>natQuotaExceededEvent</c>

            <c>32</c>

            <c>Yes</c>

            <c>maxFragmentsPendingReassembly</c>

            <c>32</c>

            <c>Yes</c>

            <c>sourceIPv4Address</c>

            <c>32</c>

            <c>Yes for NAT44 </c>

            <c>sourceIPv6Address</c>

            <c>128</c>

            <c>Yes for NAT64 </c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

            <c>vlanID/ingressVRFID</c>

            <c>16/32</c>

            <c>No</c>

            <c>internalAddressRealm</c>

            <c>octetArray</c>

            <c>No</c>


          </texttable>
          </section>

        </section>
        <section title="Threshold Reached Events">
          <t>This event will be generated when a NAT device reaches an 
          operator-configured threshold when allocating 
          resources. The Threshold Reached events are described in the section above.
          The following is a template of the individual events.</t>

          <section title="Address Pool High or Low Threshold Reached">
          <t> This event is generated when the high or low threshold is reached for 
              the address pool. The template is the same for both high and low threshold
              events </t>
          <texttable anchor="nat_threshold_addrpool_template_table"
                     title="Address Pool High/Low Threshold Reached Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center" width="20%">Size (bits)</ttcol>

            <ttcol align="center" width="20%">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>natThresholdEvent</c>

            <c>32</c>

            <c>Yes</c>

            <c>natPoolID</c>

            <c>32</c>

            <c>Yes</c>

            <c>addressPoolHighThreshold/&nbsp;addressPoolLowThreshold</c>

            <c>32</c>

            <c>Yes</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

          </texttable>
          </section>

        <section title="Address and Port Mapping High Threshold Reached">
          <t> This event is generated when the high threshold is reached for 
              the address pool and ports. </t>

          <texttable anchor="nat_threshold_addrport_template_table"
                     title="Address Port High Threshold Reached Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center" width="20%">Size (bits)</ttcol>

            <ttcol align="center" width="20%">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>natThresholdEvent</c>

            <c>32</c>

            <c>Yes</c>

            <c>addressPortMappingHighThreshold/&nbsp;addressPortMappingLowThreshold</c>

            <c>32</c>

            <c>Yes</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

          </texttable>
        </section>

        <section title="Address and Port Mapping per User High Threshold Reached">
          <t> This event is generated when the high threshold is reached for 
              the per-user address pool and ports. </t>

          <texttable anchor="nat_per_user_threshold_addrport_template_table"
                     title="Address and Port Mapping per User High Threshold Reached Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center" width="20%">Size (bits)</ttcol>

            <ttcol align="center" width="20%">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>natThresholdEvent</c>

            <c>32</c>

            <c>Yes</c>

            <c>addressPortMappingHighThreshold/&nbsp;addressPortMappingLowThreshold</c>

            <c>32</c>

            <c>Yes</c>

            <c>sourceIPv4Address</c>

            <c>32</c>

            <c>Yes for NAT44</c>

            <c>sourceIPv6Address</c>

            <c>128</c>

            <c>Yes for NAT64</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

            <c>vlanID/ingressVRFID</c>

            <c>16/32</c>

            <c>No</c>

          </texttable>
        </section>

        <section title="Global Address Mapping High Threshold Reached">
          <t> This event is generated when the high threshold is reached for 
              the per-user address pool and ports. This is generated 
              only by NAT devices that use a paired-address-pooling behavior.</t> 

          <texttable anchor="nat_global_addr_map_threshold_addrport_template_table"
                     title="Global Address Mapping High Threshold Reached Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>natThresholdEvent</c>

            <c>32</c>

            <c>Yes</c>

            <c>globalAddressMappingHighThreshold</c>

            <c>32</c>

            <c>Yes</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

            <c>vlanID/ingressVRFID</c>

            <c>16/32</c>

            <c>No</c>
          </texttable>
        </section>


        </section>
        <section title="Address Binding Create and Delete Events">
          <t>These events will be generated when a NAT device binds a local address 
              with a global address and when the global address is freed.
             A NAT device will generate the binding events when it receives the first packet of the first flow from a 
             host in the private realm. </t>

          <texttable anchor="address_binding_template_table"
                     title="NAT Address Binding Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>

            <c>sourceIPv4Address</c>

            <c>32</c>

            <c>Yes for NAT44</c>

            <c>sourceIPv6Address</c>

            <c>128</c>

            <c>Yes for NAT64</c>

           <c>postNATSourceIPv4Address</c>

           <c>32</c>

           <c>Yes</c>

           <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>

          </texttable>
        </section>

        <section title="Port Block Allocation and De-allocation">
          <t>This event will be generated when a NAT device allocates/de-allocates ports 
             in a bulk fashion, as opposed to allocating a port on a per-flow basis. </t>
             <t> portRangeStart represents the starting value of the range. </t>
             <t> portRangeEnd represents the ending value of the range. </t>
             <t> NAT devices would do this in order to reduce logs
             and to potentially limit the number of connections a subscriber is allowed to use. In the 
             following Port Block allocation template, the portRangeStart and portRangeEnd MUST be
            specified.  </t>

             <t> It is up to the implementation to choose to consolidate log records in case two 
                 consecutive port ranges for the same user are allocated or freed. 
             </t>

             <texttable anchor="nat_bulk_port_allocation_template_table"
                     title="NAT Port Block Allocation Event Template">
            <ttcol align="left">Field Name</ttcol>

            <ttcol align="center">Size (bits)</ttcol>

            <ttcol align="center">Mandatory</ttcol>

            <c>timeStamp</c>

            <c>64</c>

            <c>Yes</c>

            <c>natEvent</c>

            <c>8</c>

            <c>Yes</c>
 
            <c>sourceIPv4Address</c>

            <c>32</c>

            <c>Yes for NAT44</c>

            <c>sourceIPv6Address</c>

            <c>128</c>

            <c>Yes for NAT64</c>

           <c>postNATSourceIPv4Address</c>

           <c>32</c>
           
           <c>Yes</c>

            <c>portRangeStart</c>

            <c>16</c>

            <c>Yes</c>

            <c>portRangeEnd</c>

            <c>16</c>

            <c>No</c>

            <c>natInstanceID</c>

            <c>32</c>

            <c>No</c>
           
           </texttable>
        </section>

      </section>

    </section>

    <section anchor="Management" title="Management Considerations">
      <t>This section considers requirements for management of the log system
   to support logging of the events described above.  It first covers
   requirements applicable to log management in general.  Any additional
   standardization required to fulfill these requirements is out of scope
   of the present document. Some management considerations are covered in 
   <xref target="NAT-LOG"/>. This document covers the additional
   considerations. </t>


      <section title="Ability to Collect Events from Multiple NAT Devices">
      <t>
       An IPFIX Collector MUST be able to collect events from multiple NAT devices and  
       decipher events based on the Observation Domain ID in the IPFIX header.
      </t>
      </section>

      <section title="Ability to Suppress Events">
      <t>
       The exhaustion events can be overwhelming during traffic bursts; hence, they SHOULD be handled
       by the NAT devices to rate-limit them before sending them to the Collectors. For example, when the 
       port exhaustion happens during bursty conditions, instead of sending a port exhaustion event 
       for every packet, the exhaustion events SHOULD be rate-limited by the NAT device.
      </t>
      </section>
    
    </section>

    <section anchor="IANA" title="IANA Considerations"> 
    <section title="Information Elements">
    <t>IANA has registered the following IEs in the "IPFIX Information
        Elements" registry at <xref target="IPFIX-IANA"/>.</t>


    <section title="natInstanceID">
    <t>ElementID: 463 </t>
    <t>Name: natInstanceID </t>
    <t>Description: This Information Element uniquely identifies an Instance of the NAT that runs on a 
       NAT middlebox function
       after the packet passes the Observation Point. natInstanceID is defined
       in <xref target="RFC7659"/>.</t>  
    <t>Abstract Data Type: unsigned32 </t>   
    <t>Data Type Semantics: identifier </t>    
    <t>Reference: See <xref target="RFC791"/> for the definition of the IPv4 source address field.  
        See <xref target="RFC3022"/> for the definition of NAT.  See
	<xref target="RFC3234"/>
        for the definition of middleboxes. </t>
    </section>

    <section title="internalAddressRealm">
    <t>ElementID: 464</t>
    <t>Name: internalAddressRealm </t>
    <t>Description: This Information Element represents the internal address realm where the packet
       is originated from or destined to. By definition, a NAT mapping can be created
       from two address realms, one from internal and one from external. Realms are 
       implementation dependent and can represent a Virtual Routing and
       Forwarding (VRF) ID, a VLAN ID, or some unique
       identifier. Realms are optional and, when left unspecified, would mean that the 
       external and internal realms are the same.  </t>  
        <t>Abstract Data Type: octetArray</t>
        <t>Data Type Semantics: identifier</t>  
        <t>Reference: See <xref target="RFC791"/> for the definition of the IPv4 source address field.  
        See <xref target="RFC3022"/> for the definition of NAT.  See
	<xref target="RFC3234"/>
        for the definition of middleboxes.</t>
    </section>

    <section title="externalAddressRealm">
    <t>ElementID: 465</t>  
    <t>Name: externalAddressRealm </t>
    <t> Description: This Information Element represents the external address realm where the packet
       is originated from or destined to. The detailed definition is in the internal
       address realm as specified above.</t>
   
      <t>Abstract Data Type: octetArray </t>    
      <t>Data Type Semantics: identifier </t>    
      <t> Reference: See <xref target="RFC791"/> for the definition of the IPv4 source address field.  
        See <xref target="RFC3022"/> for the definition of NAT.  See
	<xref target="RFC3234"/>
        for the definition of middleboxes. </t>
    </section>

    <section title="natQuotaExceededEvent">
    <t>ElementID: 466</t>
    <t>Name: natQuotaExceededEvent </t>
    <t>Description: This Information Element identifies the type of a NAT Quota
   Exceeded event. Values for this Information Element are listed in the
   "NAT Quota Exceeded Event Type" registry, see <xref target="IPFIX-IANA"/>.
   Initial values in the registry are defined by the table below.  New
   assignments of values will be administered by IANA and are subject to
   Expert Review <xref target="RFC8126"/>. Experts need to check definitions
   of new values for completeness, accuracy, and redundancy.
   </t>

<figure align="center">
<artwork align="center"><![CDATA[
   +--------+---------------------------------------+
   | Value  | Quota Exceeded Event Name             |
   +--------+---------------------------------------+
   | 0      | Reserved                              |
   | 1      | Maximum session entries               |
   | 2      | Maximum BIB entries                   |
   | 3      | Maximum entries per user              |
   | 4      | Maximum active hosts or subscribers   |
   | 5      | Maximum fragments pending reassembly  |
   +--------+---------------------------------------+
]]></artwork>
<postamble>Note: This is the same as Table 3.</postamble>
</figure>

    <t>Abstract Data Type: unsigned32 </t>
    <t>Data Type Semantics: identifier </t>
    <t> Reference: See <xref target="RFC791"/> for the definition of the IPv4 source address field.  
        See <xref target="RFC3022"/> for the definition of NAT.  See <xref target="RFC3234"/>
        for the definition of middleboxes.</t>
    </section>

    <section title="natThresholdEvent">
      <t>ElementID: 467</t>
      <t>Name: natThresholdEvent </t>
      <t>Description: 
      This Information Element identifies a type of a NAT Threshold
         event.  Values for this Information Element are listed in the
         "NAT Threshold Event Type" registry, see <xref target="IPFIX-IANA"/>.
         Initial values in the registry are defined by the table below. New
	 assignments of values will be administered by IANA and are subject to
	 Expert Review <xref target="RFC8126"/>. Experts need to check
	 definitions of new values for completeness, accuracy, and redundancy.
      </t>


      <figure align="center">
        <artwork align="center"><![CDATA[

+--------+---------------------------------------------------------+
| Value  | Threshold Exceeded Event Name                           |
+--------+---------------------------------------------------------+
| 0      | Reserved                                                |
| 1      | Address pool high threshold event                       |
| 2      | Address pool low threshold event                        |
| 3      | Address and port mapping high threshold event           |
| 4      | Address and port mapping per user high threshold event  |
| 5      | Global address mapping high threshold event             |
+--------+---------------------------------------------------------+
            ]]></artwork>

        <postamble>Note: This is the same as Table 4.</postamble>
      </figure>

       <t>Abstract Data Type: unsigned32 </t>   
       <t>Data Type Semantics: identifier </t>     
        <t>Reference: See <xref target="RFC791"/> for the definition of the IPv4 source address field.  
        See <xref target="RFC3022"/> for the definition of NAT.  See
	<xref target="RFC3234"/>
        for the definition of middleboxes.</t>
     </section>

    <section title="natEvent"> 
   
    <t>
    The original definition of this Information Element specified only three
   values: 1, 2, and 3.  This definition has been replaced by a registry, to which
   new values can be added.  The semantics of the three originally
   defined values remain unchanged.  IANA maintains the "NAT Event Type (Value 230)" registry for
   values of this Information Element at <xref target="IPFIX-IANA"/>.</t>

    <t>ElementID: 230</t>
    <t>Name: natEvent </t>

   <t>Description: This Information Element identifies a NAT event.  This
   IE identifies the type of a NAT event.  

Examples of NAT events include, but are not limited to, NAT translation
create, NAT translation delete, Threshold Reached, or Threshold Exceeded, etc.

   Values for this Information Element are listed in the
   "NAT Event Type" registry, see <xref target="IPFIX-IANA"/>.
   The NAT event values in the registry are defined by <xref
   target="event_id_table"/> in <xref target="Definition_of_NAT_Events"/>.
   New assignments of values will be administered by IANA and are subject to
   Expert Review <xref target="RFC8126"/>. Experts need to check definitions
   of new values for completeness, accuracy, and redundancy.
   </t>  

   <t>Abstract Data Type: unsigned8 </t>

   <t>Data Type Semantics: identifier </t>
   <t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See
   <xref target="RFC3234"/> for the definition of middleboxes. See RFC 8158 for the definitions of values 4-16.</t>
    </section>

<section title="maxSessionEntries">
<t>ElementID: 471</t>
<t>Name: maxSessionEntries</t>
<t>Description: This element represents the maximum session entries that can
be created by the NAT device.</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See
<xref target="RFC3234"/> for the definition of middleboxes.</t>
</section>

<section title="maxBIBEntries">
<t>ElementID: 472</t>
<t>Name: maxBIBEntries</t>
<t>Description: This element represents the maximum BIB entries that can be
created by the NAT device.</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See
<xref target="RFC3234"/> for the definition of middleboxes.</t>
</section>

<section title="maxEntriesPerUser">
<t>ElementID: 473</t>
<t>Name: maxEntriesPerUser</t>
<t>Description: This element represents the maximum NAT entries that can be
created per user by the NAT device.</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See
<xref target="RFC3234"/> for the definition of middleboxes.</t>
</section>

<section title="maxSubscribers">
<t>ElementID: 474</t>
<t>Name: maxSubscribers</t>
<t>Description: This element represents the maximum subscribers or maximum
hosts that are allowed by the NAT device.</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See
<xref target="RFC3234"/> for the definition of middleboxes.</t>
</section>

<section title="maxFragmentsPendingReassembly">
<t>ElementID: 475</t>
<t>Name: maxFragmentsPendingReassembly</t>
<t>Description: This element represents the maximum fragments that the NAT
device can store for reassembling the packet.</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See <xref target="RFC3234"/> for the
definition of middleboxes.</t>
</section>

<section title="addressPoolHighThreshold">
<t>ElementID: 476</t>
<t>Name: addressPoolHighThreshold</t>
<t>Description: This element represents the high threshold value of the number
of public IP addresses in the address pool.</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See
<xref target="RFC3234"/> for the definition of middleboxes.</t>
</section>

<section title="addressPoolLowThreshold">
<t>ElementID: 477</t>
<t>Name: addressPoolLowThreshold</t>
<t>Description: This element represents the low threshold value of the number
of public IP addresses in the address pool.</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See
<xref target="RFC3234"/> for the definition of middleboxes.</t>
</section>

<section title="addressPortMappingHighThreshold">
<t>ElementID: 478</t>
<t>Name: addressPortMappingHighThreshold</t>
<t>Description: This element represents the high threshold value of the number
of address and port mappings.</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See
<xref target="RFC3234"/> for the
definition of middleboxes.</t>
</section>

<section title="addressPortMappingLowThreshold">
<t>ElementID: 479</t>
<t>Name: addressPortMappingLowThreshold</t>
<t>Description: This element represents the low threshold value of the number
of address and port mappings.</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See
<xref target="RFC3234"/> for the
definition of middleboxes.</t>
</section>

<section title="addressPortMappingPerUserHighThreshold">
<t>ElementID: 480</t>
<t>Name: addressPortMappingPerUserHighThreshold</t>
<t>Description: This element represents the high threshold value of the number
of address and port mappings that a single user is allowed to create on a NAT device.</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See
<xref target="RFC3234"/> for the definition of middleboxes.</t>
</section>

<section title="globalAddressMappingHighThreshold">
<t>ElementID: 481</t>
<t>Name: globalAddressMappingHighThreshold</t>
<t>Description: This element represents the high threshold value of the number
of address and port mappings that a single user is allowed to create on a NAT
device in a paired address pooling behavior.</t>
<t>Abstract Data Type: unsigned32</t>
<t>Data Type Semantics: identifier</t>
<t>Reference: See <xref target="RFC3022"/> for the definition of NAT.  See
<xref target="RFC3234"/> for the
definition of middleboxes. See <xref target="RFC4787"/> for the definition of paired address
pooling behavior.</t>
</section>
    </section>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t> The security considerations listed in detail for IPFIX in 
          <xref target="RFC7011"></xref> apply to this document as well.
          As described in <xref target="RFC7011"></xref>, the messages exchanged between the 
          NAT device and the Collector MUST be protected to provide confidentiality, integrity,
          and authenticity. Without those characteristics, the messages are subject to various 
          kinds of attacks. These attacks are described in great detail in 
          <xref target="RFC7011"></xref>. </t> 
       <t> This document re-emphasizes the use of Transport Layer Security
       (TLS) or Datagram Transport Layer Security (DTLS) for exchanging the log messages
           between the NAT device and the Collector. The log events sent in cleartext 
           can result in confidential data being exposed to attackers, who could then 
           spoof log events based on the information in cleartext messages. Hence, 
           the log events SHOULD NOT be sent in cleartext. </t>
       <t> The logging of NAT events can result in privacy concerns as a result of exporting information
           such as the source address and port information. The logging of destination information can also 
           cause privacy concerns, but it has been well documented in <xref target="RFC6888"/>. A NAT device
           can choose to operate in various logging modes if it wants to avoid logging of private information. 
           The Collector that receives the information can also choose to mask the private information but
           generate reports based on abstract data. It is outside the scope of this document to address the 
           implementation of logging modes for privacy considerations. 
        </t>
    </section>
  </middle>

  <back>

    <references title="Normative References">
      <?rfc include="reference.RFC.2119.xml"?>
      <?rfc include="reference.RFC.4787.xml"?>
      <?rfc include="reference.RFC.5382.xml"?>
      <?rfc include="reference.RFC.6146.xml"?>
      <?rfc include="reference.RFC.6302.xml"?>
      <?rfc include="reference.RFC.6888.xml"?>
      <?rfc include="reference.RFC.7011.xml"?>
      <?rfc include="reference.RFC.7659.xml"?>
      <?rfc include="reference.RFC.8174.xml"?>
      
    </references>

    <references title="Informative References">

      <reference anchor="IPFIX-IANA"
                 target="http://www.iana.org/assignments/ipfix">
        <front>
          <title>IPFIX Information Elements</title>
          <author>
            <organization>IANA</organization>
          </author>
          <date/>
        </front>
      </reference>  

<reference anchor='NAT-LOG'>
<front>
<title>Syslog Format for NAT Logging</title>

<author initials='Z' surname='Chen' fullname='Zhonghua Chen'>
    <organization />
</author>

<author initials='C' surname='Zhou' fullname='Cathy Zhou'>
    <organization />
</author>

<author initials='T' surname='Tsou' fullname='Tina Tsou'>
    <organization />
</author>

<author initials='T' surname='Taylor' fullname='Tom Taylor' role="editor">
    <organization />
</author>

<date month='January' year='2014' />

</front>

<seriesInfo name='Work in Progress,' value='draft-ietf-behave-syslog-nat-logging-06' />

</reference>

<reference  anchor='RFC791' target='https://www.rfc-editor.org/info/rfc791'>
<front>
<title>Internet Protocol</title>
<author initials='J.' surname='Postel' fullname='J. Postel'><organization /></author>
<date year='1981' month='September' />
</front>
<seriesInfo name='STD' value='5'/>
<seriesInfo name='RFC' value='791'/>
<seriesInfo name='DOI' value='10.17487/RFC0791'/>
</reference>

      <?rfc include="reference.RFC.2663.xml"?>
      <?rfc include="reference.RFC.3022.xml"?>
      <?rfc include="reference.RFC.3234.xml"?>
      <?rfc include="reference.RFC.5424.xml"?>
      <?rfc include="reference.RFC.8126.xml"?>
    </references>


<section title="Acknowledgements" anchor="Acknowledgements" numbered="no">
<t>Thanks to Dan Wing, Selvi Shanmugam, Mohamed Boucadir, Jacni Qin,
Ramji Vaithianathan, Simon Perreault, Jean-Francois Tremblay, Paul Aitken,
Julia Renouard, Spencer Dawkins, and Brian Trammell for their review and comments.</t>
</section>
  </back>
</rfc>

<?xml version="1.0" encoding="US-ASCII"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "reference.RFC.2119.xml">
<!ENTITY RFC5286 SYSTEM "reference.RFC.5286.xml">
<!ENTITY RFC4203 SYSTEM "reference.RFC.4203.xml">
<!ENTITY RFC5307 SYSTEM "reference.RFC.5307.xml">
<!ENTITY LFA-APPLICABILITY SYSTEM "reference.RFC.6571.xml">
<!ENTITY REMOTE-LFA SYSTEM "reference.RFC.7490.xml">
<!ENTITY RFC6987 SYSTEM "reference.RFC.6987.xml">
<!ENTITY RFC5340 SYSTEM "reference.RFC.5340.xml">
<!ENTITY RFC5305 SYSTEM "reference.RFC.5305.xml">
<!ENTITY RFC3630 SYSTEM "reference.RFC.3630.xml">
<!ENTITY RFC7777 SYSTEM "reference.RFC.7777.xml">
]>

<?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>

<?rfc toc="yes"?>
<?rfc tocdepth="3"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>

<rfc category="std" number="7916" ipr="trust200902"
     submissionType="IETF" consensus="yes">

  <front>
    <title abbrev="LFA Manageability">Operational Management of Loop-Free Alternates</title>

    <author fullname="Stephane Litkowski" initials="S" surname="Litkowski" role="editor">
      <organization>Orange</organization>
      <address>
        <email>stephane.litkowski@orange.com</email>
      </address>
    </author>

    <author fullname="Bruno Decraene" initials="B" surname="Decraene">
      <organization>Orange</organization>
      <address>
        <email>bruno.decraene@orange.com</email>
      </address>
    </author>

    <author fullname="Clarence Filsfils" initials="C" surname="Filsfils">
      <organization>Cisco Systems</organization>
      <address>
        <email>cfilsfil@cisco.com</email>
      </address>
    </author>

    <author fullname="Kamran Raza" initials="K" surname="Raza">
      <organization>Cisco Systems</organization>
      <address>
        <email>skraza@cisco.com</email>
      </address>
    </author>

    <author fullname="Martin Horneffer" initials="M" surname="Horneffer">
      <organization>Deutsche Telekom</organization>
      <address>
        <email>Martin.Horneffer@telekom.de</email>
      </address>
    </author>

    <author fullname="Pushpasis Sarkar" initials="P" surname="Sarkar">
      <organization>Individual Contributor</organization>
      <address>
        <email>pushpasis.ietf@gmail.com</email>
      </address>
    </author>

    <date month="July" year="2016"/>

<keyword>IGP</keyword>
<keyword>LFA</keyword>
<keyword>policy</keyword>
<keyword>FRR</keyword>
<keyword>fast reroute</keyword>
<keyword>network planning</keyword>

    <abstract>
      <t>Loop-Free Alternates (LFAs), as defined in RFC 5286, constitute an
      IP Fast Reroute (IP FRR) mechanism enabling traffic protection for IP
      traffic (and, by extension, MPLS LDP traffic). Following early
      deployment experiences, this document provides operational
      feedback on LFAs, highlights some limitations, and proposes a set of
      refinements to address those limitations. It also proposes required
      management specifications.</t>

      <t>This proposal is also applicable to remote-LFA solutions.</t>
    </abstract>
        
  </front>

  <middle>
        
    <section anchor="intro" title="Introduction">

      <t>Following the first deployments of Loop-Free Alternates (LFAs), this
      document provides feedback to the community about the management of LFAs.
          <list style="symbols">
<t><xref target="outcomes-alternate"/> provides real use cases illustrating
some limitations and suboptimal behavior.</t>

<t><xref target="outcomes-coverage-monitoring"/> provides requirements for LFA
simulations.</t>

<t><xref target="outcomes-lfa-activation"/> proposes requirements for
activation granularity and policy-based selection of the alternate.</t>

<t><xref target="configuration"/> expresses requirements for the operational
management of LFAs and, in particular, a policy framework to manage
alternates.</t>

<t><xref target="operational"/> details some operational considerations of
LFAs, such as IS-IS overload bit management and troubleshooting
information.</t>

</list>
      </t>

      <section title="Requirements Language">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <xref
      target="RFC2119"/>.</t>
      </section>
    </section>

<section anchor="definition" title="Definitions">
        <t>
        <list style="symbols">
        <t>Per-prefix LFA computation: Evaluation for the best
        alternate is done for each destination prefix, as opposed to
        the "per&nbhy;next&nbhy;hop" simplification technique proposed in
        Section&nbsp;3.8 of <xref target="RFC5286"/>.</t>

        <t>PE router: Provider Edge router. These routers connect customers
        to each other.</t>

        <t>P router: Provider router. These routers are core routers without
        customer connections. They provide transit between PE routers, and
        they form the core network.</t>

        <t>Core network: subset of the network composed of P routers and links
        between them.</t>

        <t>Core link: network link part of the core network, i.e., a
        link between P routers.</t>

        <t>Link-protecting LFA: alternate providing protection against link
        failure.</t>

        <t>Node-protecting LFA: alternate providing protection against node
        failure.</t>

        <t>Connected alternate: alternate adjacent (at the IGP level) to
        the Point of Local Repair (PLR) (i.e., an IGP neighbor).</t>

        <t>Remote alternate: alternate that does not share an IGP
        adjacency with the PLR.</t>

        </list>
        </t>
        </section>
    <section anchor="outcomes-alternate"
             title="Operational Issues with Default LFA Tiebreakers">
      <t><xref target="RFC5286"/> introduces the notion of tiebreakers when
      selecting the LFA among multiple candidate alternate
      next&nbsp;hops. When multiple LFAs exist, <xref target="RFC5286"/>
      has favored the selection of the LFA that provides the best coverage
      against the failure cases. While this is indeed a goal, it is one
      among multiple goals, and in some deployments this leads to the
      selection of a suboptimal LFA. The following sections detail real
      use cases related to such limitations.</t>

      <t> Note that the use case for LFA computation per destination
      (per&nbhy;prefix LFA) is assumed throughout this analysis.
      We also assume in the network figures that all IP prefixes are
      advertised with zero&nbsp;cost.</t>


      <section anchor="outcomes-alternate-case1"
         title="Case 1: PE Router Protecting against Failures within Core Network">
        <figure anchor="fig1">
          <artwork><![CDATA[
      P1 --------- P2 ---------- P3 --------- P4
      |      1           100           1       |
      |                                        |
      | 100                                    | 100
      |                                        |
      |      1           100           1       |  1     5k
      P5 --------- P6 ---------- P7 --------- P8 --- P9 -- PE1
      | |         | |            |             |
    5k| |5k     5k| |5k          | 5k          | 5k
      | |         | |            |             |
      | +-- PE4 --+ |            +---- PE2 ----+
      |             |                   |
      +---- PE5 ----+                   | 5k
                                        |
                                       PE3

      Px routers are P routers using n * 10 Gbps links.
      PEs are connected using links with lower bandwidth.
      ]]></artwork></figure>

        <t>In <xref target="fig1"/>, let us consider the traffic flowing
        from PE1 to PE4. The nominal path is P9-P8-P7-P6-PE4. Let us now
        consider the failure of link P7-P8. As the P4 primary path to PE4
        is P8-P7-P6-PE4, P4 is not an LFA for P8 (because P4 will loop
        traffic back to P8), and the only available LFA is PE2.</t>

        <t>When the core link P8-P7 fails, P8 switches all traffic destined to
        PE4/PE5 towards the node PE2. Hence, a PE node and PE links are used
        to protect against the failure of a core link. Typically, PE links
        have less capacity than core links, and congestion may occur on
        PE2 links. Note that although PE2 is not directly affected by
        the failure, its links become congested, and its traffic will
        suffer from the congestion.</t>

        <t>In summary, in the case of P8-P7 link failure, the impact on
        customer traffic is: <list style="symbols">

            <t>From PE2's point of view: <list style="symbols">
                <t>without LFA: no impact.</t>

                <t>with LFA: traffic is partially dropped (but
                possibly prioritized by a QoS mechanism). It must be
                highlighted that in such a situation, traffic not
                affected by the failure may be affected by the
                congestion.</t>
              </list></t>

            <t>From P8's point of view: <list style="symbols">
                <t>without LFA: traffic is totally dropped until
                convergence occurs.</t>

                <t>with LFA: traffic is partially dropped (but
                possibly prioritized by a QoS mechanism).</t>
              </list></t>
          </list></t>
                  <t>Besides the congestion aspects of using a PE router as
                  an alternate to protect against a core failure, a service
                  provider may consider this to be a bad routing design
                  and would want to prevent it.</t>
      </section>

      <section anchor="outcomes-alternate-case2"
               title="Case 2: PE Router Chosen to Protect against Core Failures while P&nbsp;Router LFA Exists">
        <figure anchor="fig2">
          <artwork><![CDATA[
       P1 --------- P2 ------------ P3 ------- P4
       |      1           100       |     1    |
       |                            |          |
       | 100                        | 30       | 30
       |                            |          |
       |     1         50       50  |    10    |   1    5k
       P5 --------- P6 --- P10 ---- P7 ------- P8 --- P9 -- PE1
       | |         | |        \                |
     5k| |5k     5k| |5k       \ 5k            | 5k
       | |         | |          \              |
       | +-- PE4 --+ |           +---- PE2 ----+
       |             |                  |
       +---- PE5 ----+                  | 5k
                                        |
                                       PE3

          Px routers are P routers meshed with n * 10 Gbps links.
          PEs are meshed using links with lower bandwidth.
]]></artwork> </figure>

        <t>In <xref target="fig2"/>, let us consider the traffic coming
        from PE1 to PE4. The nominal path is P9-P8-P7-P10-P6-PE4. Let us
        now consider the failure of the link P7-P8. For P8, P4 is a
        link-protecting LFA and PE2 is a node-protecting LFA. PE2 is
        chosen as the best LFA, due to the better type of protection that
        it provides. Just as in case&nbsp;1, this may lead to congestion
        on PE2 links upon LFA activation.</t>

      </section>

      <section anchor="outcomes-alternate-case3"
               title="Case 3: Suboptimal P Router Alternate Choice">
        <figure anchor="fig3">
          <artwork><![CDATA[
                          +--- PE3 ---+
                         /             \
                   1000 /               \ 1000
                       /                 \
               +----- P1 ---------------- P2 ----+
               |      |        500        |      |
               | 10   |                   |      | 10
               |      |                   |      |
               R5     | 10                | 10   R7
               |      |                   |      |
               | 10   |                   |      | 10
               |      |        500        |      |
               +---- P3 ----------------- P4 ----+
                       \                 /
                   1000 \               / 1000
                         \             /
                          +--- PE1 ---+

                Px routers are P routers.
                P1-P2 and P3-P4 links are 1 Gbps links.
                All other inter-Px links are 10 Gbps links.
]]></artwork> </figure>

        <t>In <xref target="fig3"/>, let us consider the failure of
        link P1-P3. For destination PE3, P3 has two possible alternates:
           <list style="symbols">
            <t>P4, which is node-protecting</t>

            <t>R5, which is link-protecting</t>
          </list> P4 is chosen as the best LFA, due to the better type of
        protection that it provides. However, for bandwidth capacity reasons,
        it may&nbsp;not be desirable to use P4. A service provider may
        prefer to use high&nbhy;bandwidth links as the preferred LFA. In
        this example, preferring the shortest path over the type of
        protection may achieve the expected behavior, but in cases where
        metrics do not reflect the bandwidth, this technique would not
        work and some other criteria would need to be involved when
        selecting the best LFA.</t>
      </section>

                <section anchor="outcomes-alternate-case4"
               title="Case 4: No-Transit LFA Computing Node">
        <figure anchor="fig4">
          <artwork><![CDATA[
                            P1       P2
                            |   \  /   |
                         50 | 50 \/ 50 | 50
                            |    /\    |
                            PE1-+  +-- PE2
                             \        /
                           45 \      / 45
                               -PE3-
                      (No-transit condition set)
]]></artwork> </figure>

                <t>The IS-IS and OSPF protocols define some way to prevent a
                router from being used for transit.</t>

                <t>The IS-IS overload bit is defined in <xref
                target="ISO10589"/>, and the OSPF R-bit is defined in <xref
                target="RFC5340"/>. Also, the OSPF stub router is defined in
                <xref target="RFC6987"/> as a method to prevent transit on a
                node by advertising MaxLinkMetric on all non&nbhy;stub
                links.</t>

        <t>In <xref target="fig4"/>, PE3 has its no-transit condition set
        (permanently, for design reasons) and wants to protect traffic
        using an LFA for destination PE2.</t>

                <t>On PE3, the loop-free condition is not satisfied: 100 !&lt;
                45 + 45. PE1 is thus not considered as an LFA. 
                However, thanks to the no&nbhy;transit condition on PE3,
                we know that PE1 will not loop the traffic back to PE3.
                So, PE1 is an LFA to reach PE2.</t>

                <t>In the case of a no-transit condition set on a node,
                LFA behavior must be clarified.</t>
      </section>
    </section>

        <section anchor="outcomes-coverage-monitoring"
               title="Need for Coverage Monitoring">
        <t>
        As per <xref target="RFC6571"/>, LFA coverage depends strongly on
        the network topology that is in use. Even if the remote-LFA mechanism
        <xref target="RFC7490"/> significantly extends the coverage of
        the basic LFA specification, there are still some cases where
        protection would not be available. As network topologies are
        constantly evolving (network extension, additional capacity,
        latency optimization, etc.), the protection coverage may change.
        Fast Reroute (FRR) functionality may be critical for some
        services supported by the network; a service provider must
        always know what type of protection coverage is currently
        available on the network. Moreover, predicting protection
        coverage in the event of network topology changes is mandatory.</t>

        <t>Today, network simulation tools associated with "what&nbsp;if"
        scenarios are often used by service providers for the overall
        network design (capacity, path optimization, etc.).
        Sections&nbsp;<xref target="oper-lfa-information" format="counter"/>,
        <xref target="oper-lfa-alert" format="counter"/>, and
        <xref target="oper-lfa-simu" format="counter"/> of this document
        propose the addition of LFA information into such tools and within
        routers, so that a service provider may be able to:

        <list style="symbols">
        <t>evaluate protection coverage after a topology change.</t>
        <t>adjust the topology change to cover the primary need (e.g., latency
        optimization, bandwidth increase) as well as LFA protection.</t>
        <t>constantly monitor the LFA coverage in the live network and
        receive alerts.</t>
        </list>
        </t>
        <t>
        Documentation of LFA selection algorithms by implementers (default
        and tuning options) is important in order to make it possible for
        third&nbhy;party modules to model these policy-based LFA selection
        algorithms.
        </t>
        </section>
        <section anchor="outcomes-lfa-activation"
               title="Need for LFA Activation Granularity">
        <t>
        As in all FRR mechanisms, an LFA installs backup paths in the
        Forwarding Information Base (FIB). Depending on the hardware used
        by a service provider, FIB resources may be critical. Activating
        LFAs by default on all available components (IGP topologies,
        interfaces, address families, etc.) may lead to a waste of FIB
        resources, as generally only a few destinations in a network
        should be protected (e.g., loopback addresses supporting MPLS
        services) compared to the number of destinations in the
        Routing Information Base (RIB).
        </t>
        <t>
        Moreover, a service provider may implement multiple different FRR
        mechanisms in its networks for different applications
        (e.g., Maximally Redundant Trees (MRTs), TE FRR). In this
        scenario, an implementation MAY allow the computation of
        alternates for a specific destination even if the destination is
        already protected by another mechanism. This will provide
        redundancy and permit the operator to select the best option for
        FRR, using a policy language.
        </t>
        <t>
        <xref target="configuration"/> provides some implementation guidelines.
        </t>
        </section>
    <section anchor="configuration" title="Configuration Requirements">
      <t>Controlling the selection of the best alternate and the granularity
      of LFA activation is a requirement for service providers. This
      section defines configuration requirements for LFAs.</t>

      <section anchor="config-activation" title="LFA Enabling/Disabling Scope">
        <t>The granularity of LFA activation SHOULD be controlled (as
        alternate next&nbsp;hops consume memory in the forwarding plane).</t>

        <t>An implementation of an LFA SHOULD allow its activation, with the
        following granularities: <list style="symbols">

            <t>Per routing context: Virtual Routing and Forwarding (VRF),
            virtual/logical router, global routing table, etc.</t>

            <t>Per interface.</t>

            <t>Per protocol instance, topology, area.</t>

            <t>Per prefix: Prefix protection SHOULD have a higher
            priority compared to interface protection. This means that if a
            specific prefix must be protected due to a configuration request,
            an LFA MUST be computed and installed for that prefix even if the
            primary outgoing interface is not configured for protection.</t>
          </list>
                </t>
                <t>An implementation of an LFA MAY allow its activation, with
                the following criteria: <list style="symbols">

            <t>Per address family: IPv4 unicast, IPv6 unicast.</t>

            <t>Per MPLS control plane: For MPLS control planes that inherit
            routing decisions from the IGP routing protocol, the MPLS
            data&nbsp;plane may be protected by an LFA. The
            implementation may allow an operator to control this
            inheritance of protection from the IP prefix to the MPLS label
            bound to this prefix. The inheritance of protection will
            concern IP-to-MPLS, MPLS-to-MPLS, and MPLS-to-IP entries.
            As an example, LDP and Segment Routing extensions
            <xref target="SEG-RTG-ARCH"/> for IS&nbhy;IS and OSPF are
            control-plane eligible for this inheritance of protection.</t>
          </list>
                </t>
      </section>

      <section anchor="config-policy" title="Policy-Based LFA Selection">
        <t>When multiple alternates exist, the LFA selection algorithm is
        based on tiebreakers. Current tiebreakers do not provide sufficient
        control regarding how the best alternate is chosen. This document
        proposes an enhanced tiebreaker allowing service providers to
        manage all specific cases:</t>

        <t><list style="numbers">
            <t>An LFA implementation SHOULD support policy-based decisions
            for determining the best LFA.</t>

            <t>Policy-based decisions SHOULD be based on multiple criteria,
            with each criterion having a level of preference.</t>

            <t>If the defined policy does not allow the determination of a
            unique best LFA, an implementation SHOULD pick only one based on
            its own decision. For load-balancing purposes, an
            implementation SHOULD also support the election of multiple
            LFAs.</t>

            <t>The policy SHOULD be applicable to a protected interface or
            a specific set of destinations. In the case of applicability
            to the protected interface, all destinations primarily routed
            on that interface SHOULD use the policy for that interface.</t>
        
            <t>The choice of whether or not to dynamically re&nbhy;evaluate
            policy (in the event of a policy change) is left to the
            implementation. If a dynamic approach is chosen, the
            implementation SHOULD recompute the best LFAs and reinstall
            them in the FIB without service disruption. If a
            non&nbhy;dynamic approach is chosen, the policy would be
            taken into account upon the next IGP event. In this case,
            the implementation SHOULD support a command to manually force
            the recomputation/reinstallation of LFAs.</t>
          </list></t>

                  <section anchor="config-policy-enhanced-detail-linktunnel"
                   title="Connected versus Remote Alternates">
            <t>In addition to connected LFAs, tunnels (e.g., IP, LDP,
            RSVP&nbhy;TE, Segment Routing) to distant routers may be
            used to complement LFA coverage (tunnel tail used as virtual
            neighbor). When a router has multiple alternate candidates for a
            specific destination, it may have connected alternates and
            remote alternates (reachable via a tunnel). Connected
            alternates may not always provide an optimal routing path,
            and it may be preferable to select a remote alternate over a
            connected alternate. Some uses of tunnels to extend
            LFA <xref target="RFC5286"/> coverage are described
            in <xref target="RFC7490"/> and <xref target="TI-LFA"/>.
            <xref target="RFC7490"/> and <xref target="TI-LFA"/> present
            some use cases for LDP tunnels and Segment Routing tunnels,
            respectively.

            This document considers any type of tunneling techniques to reach
            remote alternates (IP, Generic Routing Encapsulation (GRE),
            LDP, RSVP-TE, the Layer 2 Tunneling Protocol (L2TP),
            Segment Routing, etc.) and does not restrict the remote
            alternates to the uses presented in these other documents.</t>

            <t>In <xref target="fig1"/>, there is no P router alternate
            for P8 to reach PE4 or PE5, so P8 is using PE2 as an alternate;
            this may generate congestion when FRR is activated. Instead, we
            could have a remote alternate for P8 to protect traffic to PE4
            and PE5. For example, a tunnel from P8 to P3 (following the
            shortest path) can be set up, and P8 would be able to use P3 as
            a remote alternate to protect traffic to PE4 and PE5. In this
            scenario, traffic will not use a PE link during FRR activation.</t>

            <t>When selecting the best alternate, the selection algorithm
            MUST consider all available alternates (connected or tunnel). 
            For example, with remote LFAs, computation of PQ sets
            <xref target="RFC7490"/> SHOULD be performed before the
            selection of the best alternate.</t>

          </section>
        
        <section anchor="config-policy-mandatory" title="Mandatory Criteria">
          <t>An LFA implementation MUST support the following criteria:
            <list style="symbols">
              <t>Non-candidate link: A link marked as "non&nbhy;candidate"
              will never be used as an LFA.</t>

              <t>A primary next hop being protected by another primary
              next hop of the same prefix (ECMP case).</t>

              <t>Type of protection provided by the alternate: link
              protection or node protection. In the case of preference for
              node protection, an implementation SHOULD support fallback
              to link protection if node protection is not available.</t>

              <t>Shortest path: lowest IGP metric used to reach the
              destination.</t>

              <t>Shared Risk Link Groups (SRLGs) (as defined in
              Section&nbsp;3 of <xref target="RFC5286"/>; see also <xref
              target="config-policy-mandatory-detail-srlg"/> for more
              details).</t>

            </list></t>
        </section>

        <section anchor="config-policy-enhanced" title="Additional Criteria">
          <t>An LFA implementation SHOULD support the following criteria:

           <list style="symbols">
              <t>A downstream alternate: Preference for a downstream path
              over a non&nbhy;downstream path SHOULD be configurable.</t>
        
              <t>Link coloring with "include", "exclude", and preference-based
              systems (see <xref
              target="config-policy-enhanced-detail-linkcolor"/>).</t>

              <t>Link bandwidth (see <xref
              target="config-policy-enhanced-detail-bw"/>).</t>

              <t>Alternate preference / node coloring (see <xref
             target="config-policy-enhanced-detail-neighbor-preference"/>).</t>
            </list></t>
        </section>

        <section anchor="config-policy-path-attributes" title="Evaluation of Criteria">
           <section anchor="config-policy-mandatory-detail-srlg" title="SRLGs">
            <t>
            Section 3 of <xref target="RFC5286"/> proposes the reuse of
            GMPLS IGP extensions to encode SRLGs <xref target="RFC5307"/>
            <xref target="RFC4203"/>. Section&nbsp;3 of
            <xref target="RFC5286"/> also describes the algorithm to
            compute SRLG protection.
            </t>
            <t>
            When SRLG protection is computed, an implementation SHOULD allow
            the following:

          <list style="symbols">
          <t>Exclusion of alternates in violation of SRLGs.</t>

          <t>Maintenance of a preference system between alternates based on
          SRLG violations. How the preference system is implemented is out
          of scope for this document, but here are two examples:

            <list style="symbols">
            <t>Preference based on the number of violations. In this case,
            more violations = less preferred.</t>

            <t>Preference based on violation cost. In this case, each SRLG
            violation has an associated cost. The lower violation costs are
            preferred.</t>
            </list> </t>
          </list>
          </t>

            <t>
            When applying SRLG criteria, the SRLG violation check SHOULD be
            performed on sources to alternates as well as alternates to
            destination paths, based on the SRLG set of the primary path. In
            the case of remote LFAs, PQ-to-destination path attributes would
            be retrieved from the Shortest Path Tree (SPT) rooted at the PQ.
            </t>
            </section>

          <section anchor="config-policy-enhanced-detail-linkcolor"
                   title="Link Coloring">
            <t>Link coloring is a powerful system to control the choice of
            alternates. Link colors are markers that will allow the encoding
            of properties of a particular link. Protecting interfaces are
            tagged with colors. Protected interfaces are configured to
            include some colors with a preference level and exclude others.</t>

            <t>Link color information SHOULD be signaled in the IGP, and
            administrative&nbhy;group IGP extensions
            <xref target="RFC5305"/> <xref target="RFC3630"/> that are
            already standardized, implemented, and widely used SHOULD be
            used for encoding and signaling link colors.</t>

            <figure anchor="fig5">
                <artwork><![CDATA[
                                 PE2 
                                 |  +---- P4
                                 | /
                        PE1 ---- P1 --------- P2
                                 |     10 Gbps
                          1 Gbps | 
                                 |
                                 P3
]]></artwork> </figure>

            <t>In the example in <xref target="fig5"/>, the P1 router is
            connected to three P routers and two PEs.  P1 is configured
            to protect the P1-P4 link. We assume that, given the topology,
            all neighbors are candidate LFAs. We would like to enforce a
            policy in the network where only a core router may protect
            against the failure of a core link and where high&nbhy;capacity
            links are preferred.</t>

            <t>In this example, we can use the proposed link coloring by:</t>

            <t><list style="symbols">
                <t>Marking the PE links with the color RED.</t>

                <t>Marking the 10 Gbps core link with the color BLUE.</t>

                <t>Marking the 1 Gbps core link with the color YELLOW.</t>

                <t>Configuring the protected interface P1-&gt;P4 as follows:
                    <list style="symbols">
                    <t>Include BLUE, preference 200.</t>

                    <t>Include YELLOW, preference 100.</t>

                    <t>Exclude RED.</t>
                  </list></t>
              </list></t>

            <t>Using this, PE links will never be used to protect against
            P1-P4 link failure, and the 10&nbsp;Gbps link will be preferred.</t>

            <t>The main advantage of this solution is that it can easily
            be duplicated on other interfaces and other nodes without
            change. A service provider has only to define the color system
            (associate a color with a level of significance), as it is done
            already for TE affinities or BGP communities.</t>

            <t>An implementation of link coloring: <list style="symbols">
                <t>SHOULD support multiple "include" and "exclude" colors on a
                single protected interface.</t>

                <t>SHOULD provide a level of preference between included
                colors.</t>

                <t>SHOULD support the configuration of multiple colors on a
                single protecting interface.</t>
              </list></t>
          </section>

          <section anchor="config-policy-enhanced-detail-bw" title="Bandwidth">
                  <t>
            As mentioned in previous sections, not taking into account the
            bandwidth of an alternate could lead to congestion during FRR
            activation. We propose that the bandwidth criteria be based on
            the link speed information, for the following reasons: 

            <list style="symbols">
            <t>If a router S has a set of X destinations primarily forwarded to
            N, using per-prefix LFAs may lead to having a subset of X protected
            by a neighbor N1, another subset by N2, another subset by Nx,
            etc.</t>

            <t>
            S is not aware of traffic flows to each destination, so in the
            case of FRR activation, S is not able to evaluate how much
            traffic will be sent to N1, N2, Nx, etc.</t>
            </list>

            Based on this, it is not useful to gather available bandwidth on
            alternate paths, as the router does not know how much bandwidth it
            requires for protection. The proposed link speed approach
            provides a good approximation at low cost, as information is
            easily available.

            </t>
            <t>
            The bandwidth criteria of the policy framework SHOULD work in at
            least the following two ways:
            <list style="symbols">
            <t>Prune: Exclude an LFA if the link speed to reach it is
            lower than the link speed of the primary next-hop interface.</t>

            <t>Prefer: Prefer an LFA based on its bandwidth to reach it
            compared to the link speed of the primary next-hop interface.</t>

            </list>
                   </t>
                   </section>
          

          <section anchor="config-policy-enhanced-detail-neighbor-preference"
          title="Alternate Preference / Node Coloring">
            <t>Rather than tagging interfaces on each node (using link colors)
            to identify the types of alternate nodes (as an example),
            it would be helpful if routers could be identified in the IGP.
            This would allow grouped processing on multiple nodes.

            As an implementation needs to exclude some specific alternates
            (see <xref target="config-policy-enhanced"/>),
            an implementation SHOULD be able to:
            
           <list style="symbols">
           <t>give preference to a specific alternate.</t>
           <t>give preference to a group of alternates.</t>
           <t>exclude a specific alternate.</t>
           <t>exclude a group of alternates.</t>
           </list>
           </t>

            <t>A specific alternate may be identified by its interface, IP
            address, or router ID, and a group of alternates may be
            identified by a marker (tag) advertised in IGP. The IGP
            encoding and signaling for marking groups of alternates
            SHOULD be done according to <xref target="RFC7917"/> and
            <xref target="RFC7777"/>. Using a tag/marker is referred to
            as "node coloring", as compared to the link coloring option
            presented in
            <xref target="config-policy-enhanced-detail-linkcolor"/>.</t>

            <t>Consider the following network:
              <figure anchor="fig6">
                <artwork><![CDATA[
                               PE3
                               |
                               |
                               PE2 
                               |   +---- P4
                               |  /
                      PE1 ---- P1 -------- P2
                               |    10 Gbps
                        1 Gbps |
                               |
                               P3
        ]]> </artwork> </figure>

        In the example above, each node is configured with a
        specific tag flooded through the IGP. 
              <list
                style="symbols">
                <t>PE1,PE3: 200 (non-candidate).</t>

                <t>PE2: 100 (edge/core).</t>

                <t>P1,P2,P3: 50 (core).</t>
              </list> 
              A simple policy could be configured on P1 to choose the
            best alternate for P1-&gt;P4 based on the function or role
            of the router, as&nbsp;follows: <list style="symbols">
                <t>criterion 1 -&gt; alternate preference: exclude
                tags&nbsp;100 and 200.</t>
                <t>criterion 2 -&gt; bandwidth.</t>
              </list></t>
          </section>
                </section>
          
                <section anchor="config-policy-attributes" title="Retrieving Alternate Path Attributes">
                    
        <section anchor="config-policy-attributes-path" title="Alternate Path">
            <t> 
            The alternate path is composed of two distinct parts:
            PLR to alternate and alternate to destination.
            </t>

            <figure anchor="fig7">
            <artwork><![CDATA[
                          N1 -- R1 ---- R2
                         /50     \       \
                        /         R3 --- R4
                       /                   \
                       S -------- E ------- D
                       \\                  //
                        \\                //
                         N2 ---- PQ ---- R5
            ]]></artwork> </figure>

            <t>
            In <xref target="fig7"/>, we consider a primary path from S to D,
            with S using E as the primary next&nbsp;hop. All metrics are
            1, except that {S,N1} = 50. Two alternate paths are available:

            <list style="symbols">
            <t>{S,N1,R1,R2|R3,R4,D}, where N1 is a connected alternate. This
            consists of two sub-paths: 
            <list style="symbols">
            <t>{S,N1}: path from the PLR to the alternate.</t>
            <t>{N1,R1,R2|R3,R4,D}: path from the alternate to the
            destination.</t>
            </list>
            </t>

            <t>{S,N2,PQ,R5,D}, where the PQ is a remote alternate. Again,
            the path consists of two sub-paths:
            <list style="symbols">
            <t>{S,N2,PQ}: path from the PLR to the alternate.</t>
            <t>{PQ,R5,D}: path from the alternate to the destination.</t>
            </list>
            </t>        
            </list>
            As displayed in <xref target="fig7"/>, some parts of the
            alternate path may fan out to multiple paths due to ECMP.
            </t>
            </section>

            <section anchor="config-policy-attributes-path-attr" title="Alternate Path Attributes">
            <t>
            Some criteria listed in the previous sections require the
            retrieval of some characteristics of the alternate path (SRLG,
            bandwidth, color, tag, etc.). We call these characteristics "path
            attributes". A path attribute can record a list of node properties
            (e.g., node tag) or link properties (e.g., link color).
            </t>
            <t>
            This document defines two types of path attributes:
            <list style="symbols">
            <t>Cumulative attribute: When a path attribute is cumulative, the
            implementation SHOULD record the value of the attribute on each
            element (link and node) along the alternate path. SRLG, link
            color, and node color are cumulative attributes.</t>

            <t>Unitary attribute: When a path attribute is unitary, the
            implementation SHOULD record the value of the attribute only on
            the first element along the alternate path (first node, or first
            link). Bandwidth is a unitary attribute.</t>

            </list>
            </t>

            <figure anchor="fig8">
            <artwork><![CDATA[
                          N1 -- R1 ---- R2
                         /               \
                        / 50              R4
                       /                   \
                       S -------- E ------- D
            ]]></artwork> </figure>

            <t>
            In <xref target="fig8"/>, N1 is a connected alternate
            to reach D from S. We consider that all links have a RED color
            except {R1,R2}, which is BLUE. We consider all links to be
            10&nbsp;Gbps except {N1,R1}, which is 2.5&nbsp;Gbps.

            The bandwidth attribute collected for the alternate path will be
            10&nbsp;Gbps. As the attribute is unitary, only the link speed of the
            first link {S,N1} is recorded.

            The link color attribute collected for the alternate path will be
            {RED,RED,BLUE,RED,RED}. &nbsp;As the attribute is cumulative,
            the value of the attribute on each link along the path is recorded.

            </t>
            </section>
            
             <section anchor="config-policy-attributes-lfa" title="Connected Alternate">
             <t>For an alternate path using a connected alternate:
             <list style="symbols">
             <t>Attributes from the PLR to the alternate are retrieved from
             the interface connected to the alternate. If the alternate is
             connected through multiple interfaces, the evaluation of
             attributes SHOULD be done once per interface (each interface is
             considered as a separate alternate) and once per ECMP group of
             interfaces (Layer&nbsp;3 bundle). 
            </t>
             <t>Path attributes from the alternate to the destination are
             retrieved from the SPT rooted at the alternate. As the
             alternate is a connected alternate, the SPT has already
             been computed to find the alternate, so there is no need for
             additional computation.</t>

             </list>
             </t>

                <figure anchor="fig9">
                <artwork><![CDATA[
                          N1 -- R1 ---- R2
                       50//50             \
                        //                 \
                     i1//i2                 \
                      S -------- E -------- D
                ]]></artwork> </figure>                

                <t>
                In <xref target="fig9"/>, we consider a primary path
                from S to D, with S using E as the primary next&nbsp;hop.
                All metrics are considered as 1 except {S,N1} links,
                which are using a metric of 50.

                We consider the following SRLGs on links:
                <list style="symbols">
                <t>{S,N1} using i1: SRLG1,SRLG10.</t>
                <t>{S,N1} using i2: SRLG2,SRLG20.</t>
                <t>{N1,R1}: SRLG3.</t>
                <t>{R1,R2}: SRLG4.</t>
                <t>{R2,D}: SRLG5.</t>
                <t>{S,E}: SRLG10.</t>
                <t>{E,D}: SRLG6.</t>
                </list>
                S is connected to the alternate using two interfaces:
                i1 and i2. 
                </t>
                <t>
                If i1 and i2 are not part of an ECMP group, the evaluation of
                attributes is done once per interface, and each interface is
                considered as a separate alternate path.
                Two alternate paths will be available with the associated SRLG
                attributes:

                <list style="symbols">
                <t>Alternate path #1: {S,N1 using if1,R1,R2,D}:
                SRLG1,SRLG10,SRLG3,SRLG4,SRLG5.</t>

                <t>Alternate path #2: {S,N1 using if2,R1,R2,D}:
                SRLG2,SRLG20,SRLG3,SRLG4,SRLG5.</t>

                </list>
                Alternate path #1 is sharing risks with the primary path
                and may be pruned, or its preference may be revoked, per
                user&nbhy;defined policy.
                </t>
                <t>
                If i1 and i2 are part of an ECMP group, the evaluation of
                attributes is done once per ECMP group, and the implementation
                considers a single alternate path
                {S,N1 using if1|if2,R1,R2,D} with the following
                SRLG attributes: SRLG1,SRLG10,SRLG2,SRLG20,SRLG3,SRLG4,SRLG5.
                The alternate path is sharing risks with the primary path
                and may be pruned, or its preference may be revoked, per
                user&nbhy;defined policy.
                </t>
             </section>
            <section anchor="config-policy-attributes-rlfa" title="Remote Alternate">
             <t>For alternate path using a remote alternate (tunnel):
             <list style="symbols">
             <t>Attributes on the path from the PLR to the alternate are
             retrieved using the PLR's primary SPT (when using a
             PQ&nbsp;node from the P&nbhy;space) or the immediate
             neighbor's SPT (when using a PQ from the extended
             P&nbhy;space). These are then combined with the attributes
             of the link(s) to reach the immediate neighbor.  In both
             cases, no additional SPT is required.
            </t>
             <t>Attributes from the remote alternate to the destination
             path may be retrieved from the SPT rooted at the remote alternate.
             An additional forward SPT is required for each remote
             alternate (PQ&nbsp;node), as indicated in Section&nbsp;2.3.2 of
             <xref target="REMOTE-LFA-NODE"/>. In some remote-alternate
             scenarios, like <xref target="TI-LFA"/>,
             alternate-to-destination path attributes may be obtained
             using a different technique.
            </t>
             </list>
             The number of remote alternates may be very high.  In the case
             of remote LFAs, simulations of real-world network topologies
             have shown that as many as hundreds of PQs are possible. The
             computational overhead of collecting all path attributes of
             all such PQs to destination paths could grow beyond
             reasonable levels.
             </t>

             <t>To handle this situation, implementations need to limit the
             number of remote alternates to be evaluated to a finite number
             before collecting alternate path attributes and running the
             policy evaluation. Section&nbsp;2.3.3 of
             <xref target="REMOTE-LFA-NODE"/> provides a way to
             reduce the number of PQs to be evaluated.</t>

            <t>Some other remote alternate techniques using static or dynamic
            tunnels may not require this pruning.</t>

             <figure anchor="fig10">
             <artwork><![CDATA[
               Link            Remote              Remote
               alternate       alternate           alternate
              -------------  ------------------   -------------
Alternates    |  LFA      |  |   rLFA (PQs)   |   |  Static/  |
              |           |  |                |   |  Dynamic  |
sources       |           |  |                |   |  tunnels  |
              -------------  ------------------   -------------
                   |                   |                  |
                   |                   |                  |
                   |        --------------------------    |
                   |        |  Prune some alternates |    |
                   |        | (sorting strategy)     |    |
                   |        --------------------------    |
                   |                   |                  |
                   |                   |                  |
               ------------------------------------------------
               |          Collect alternate attributes        |
               ------------------------------------------------
                                       |
                                       |
                            -------------------------
                            |    Evaluate policy    |
                            -------------------------
                                       |
                                       |
                                Best alternates
              ]]></artwork> </figure>
             </section>

             <section anchor="config-policy-attributes-ecmp-collection"
             title="Collecting Attributes in the Case of Multiple Paths">
             <t>
             As described in <xref target="config-policy-attributes"/>, there
             may be some situations where an alternate path or part of an
             alternate path fans out to multiple paths (e.g., ECMP).
             When collecting path attributes in such a case, an
             implementation SHOULD consider the union of attributes of
             each sub-path.</t>

            <t>
            In <xref target="fig7"/>
            (in <xref target="config-policy-attributes-path"/>),
            S has two alternate paths to reach&nbsp;D. Each alternate path
            fans out to multiple paths due to ECMP.

            Consider the following link color attributes: all links
            are RED except {R1,R3}, which is BLUE. The user wants to use
            an alternate path with only RED links. The first alternate path
            {S,N1,R1,R2|R3,R4,D} does not fit the constraint, as
            {R1,R3} is BLUE. 

            The second alternate path {S,N2,PQ,R5,D} fits the constraint and
            will be preferred, as it uses only RED links. 
            </t>
             </section>
            </section>
           
            <section anchor="config-policy-mandatory-detail-ecmp" title="ECMP LFAs">
            <figure anchor="fig11">
            <artwork><![CDATA[
                                  10
                             PE2 - PE3
                              |     |
                           50 |  5  | 50
                              P1----P2
                              \\    //
                           50  \\  // 50
                                PE1

              Links between P1 and PE1 are L1 and L2.
              Links between P2 and PE1 are L3 and L4.
                ]]></artwork> </figure>

            <t>
            In <xref target="fig11"/>, the primary path from PE1 to PE2 is
            through P1, using ECMP on two parallel links -- L1 and L2.
            In the case of standard ECMP behavior, if L1 is failing, the
            post&nbhy;convergence next hop would become L2 and ECMP
            would no longer be in use. If an LFA is activated, as
            stated in Section&nbsp;3.4 of <xref target="RFC5286"/>,
            "alternate next&nbhy;hops may themselves also be primary
            next-hops, but need not be" and "alternate next-hops should
            maximize the coverage of the failure cases."

            In this scenario, there is no alternate providing node
            protection, so PE1 will prefer L2 as the alternate to protect L1;
            this makes sense compared to post&nbhy;convergence behavior.
            </t>
            
            <t>
            Consider a different scenario, again referring to
            <xref target="fig11"/>, where L1 and L2 are configured as a
            Layer&nbsp;3 bundle using a local feature and
            L3&wj;/L4 comprise a second Layer&nbsp;3 bundle. Layer&nbsp;3
            bundles are configured as if a link in the bundle is failing;
            the traffic must be rerouted out of the bundle. Layer&nbsp;3
            bundles are generally introduced to increase bandwidth
            between nodes. In a nominal situation, ECMP is still
            available from PE1 to PE2, but if L1 is failing, the
            post&nbhy;convergence next hop would become the ECMP on L3 and
            L4. In this case, LFA behavior SHOULD be adapted in order to
            reflect the bandwidth requirement.
            </t>
            
            <t>We would expect the following FIB entry on PE1:</t>

            <figure anchor="fig12">
            <artwork><![CDATA[
                On PE1: PE2 +--> ECMP -> L1
                             |     |
                             |     +----> L2
                             |
                             +--> LFA (ECMP) -> L3
                                   |
                                   +----------> L4
            ]]></artwork> </figure>

            <t>
            If L1 or L2 is failing, traffic must be switched on the LFA ECMP
            bundle rather than using the other primary next hop.</t>

            <t>
            As mentioned in Section&nbsp;3.4 of <xref target="RFC5286"/>,
            protecting a link within an ECMP by another primary
            next hop is not a MUST. Moreover, as already discussed in
            this document, maximizing coverage against the failure cases
            may not be the right approach, and a policy-based choice of
            an alternate may be preferred.</t>
            <t>
            An implementation SHOULD allow setting a preference to protect a
            primary next hop with another primary next hop. An
            implementation SHOULD also allow setting a preference to
            protect a primary next hop with a NON&nbhy;primary next hop. An
            implementation SHOULD allow the use of an ECMP bundle as an LFA.
            </t>
            </section>
           
      </section>
    </section>

    <section anchor="operational" title="Operational Aspects">
      <section anchor="oper-lfa-ISIS-overload"
               title="No-Transit Condition on LFA Computing Node">
           <t>In Section&nbsp;3.5 of <xref target="RFC5286"/>, the setting
           of the no-transit condition (through the IS-IS overload bit
           or the OSPF R-bit) in an LFA computation is only taken into account
           for the case where a neighbor has the no-transit condition set.

           </t>
           <t>In addition to Inequality 1 (Loop-Free Criterion)
           (Distance_opt(N,&nbsp;D)&nbsp;&lt;&nbsp;Distance_opt(N, S) +
           Distance_opt(S, D)) <xref target="RFC5286"/>, the IS-IS
           overload bit or the OSPF R-bit of the LFA calculating neighbor
           (S) SHOULD be taken into account. Indeed, if it has the IS-IS
           overload bit set or the OSPF R-bit clear, no neighbor will loop
           traffic back to itself.</t>

           <t>An OSPF router acting as a stub router <xref target="RFC6987"/>
           SHOULD behave as if the R-bit was clear regarding the LFA
           computation.</t>
        
           </section>

      <section anchor="oper-lfa-manualtrigger"
               title="Manual Triggering of FRR">
        <t>Service providers often perform manual link shutdown (using a
        router's command-line interface (CLI)) to perform network
        changes&wj;/tests. A manual link shutdown may be done at multiple
        levels: physical interface, logical interface, IGP interface,
        Bidirectional Forwarding Detection (BFD) session, etc.  In
        particular, testing or troubleshooting FRR requires that manual
        shutdown be performed on the remote end of the link, as a local
        shutdown would not generally trigger FRR.</t>

        <t>
        To permit such a situation, an implementation SHOULD support
        triggering/activating LFA FRR for a given link when a manual
        shutdown is done on a component that currently supports FRR
        activation.</t>

        <t>
        An implementation MAY also support FRR activation for a
        specific interface or a specific prefix on a primary next-hop
        interface and revert without any action on any running
        component of the node (links or protocols). In this use case,
        the FRR activation time needs to be controlled by a timer
        in case the operator forgot to revert the traffic to the
        primary path. When the timer expires, the traffic is
        automatically reverted to the primary path. This will simplify
        the testing of the FRR path; traffic can then be reverted back
        to the primary path without causing a global network convergence.</t>
                <t>
                For example:
                <list style="symbols">
                <t>If an implementation supports FRR activation upon a BFD
                session&nbhy;down event, that implementation SHOULD support
                FRR activation when a manual shutdown is done on the BFD
                session. But if an implementation does not support FRR
                activation upon a BFD session-down event, there is no need
                for that implementation to support FRR activation upon
                manual shutdown of a BFD session.</t>

                <t>If an implementation supports FRR activation upon a
                physical link&nbhy;down event (e.g., Rx laser "off" detection,
                error threshold raised), that implementation SHOULD support FRR
                activation when a manual shutdown of a physical interface is
                done. But if an implementation does not support FRR activation
                upon a physical link-down event, there is no need for that
                implementation to support FRR activation upon manual
                shutdown of a physical link.</t>

                <t>A CLI command may allow switching from the primary path
                to the FRR path to test the FRR path for a specific interface
                or prefix. There is no impact on the control plane; only the
                data plane of the local node may be changed. A similar
                command may allow switching traffic back from the FRR path
                to the primary path.</t>
                </list>
                </t>
                
      </section>

      <section anchor="oper-lfa-information"
               title="Required Local Information">
        <t>The introduction of LFAs in a network requires some
        enhancements to standard routing information provided by
        implementations. Moreover, due to "non&nbhy;100%" coverage,
        coverage information is also required.</t>

        <t>Hence, an implementation: <list style="symbols">
            <t>MUST be able to display, for every prefix, the primary
            next hop as well as the alternate next-hop information.</t>

            <t>MUST provide coverage information per LFA activation domain
            (area, level, topology, instance, virtual router,
            address family, etc.).</t>

            <t>MUST provide the number of protected prefixes as well as
            non&nbhy;protected prefixes globally.</t>

            <t>SHOULD provide the number of protected prefixes as well as
            non&nbhy;protected prefixes per link.</t>

            <t>MAY provide the number of protected prefixes as well as
            non&nbhy;protected prefixes per priority if the implementation
            supports prefix-priority insertion in the RIB/FIB.</t>

            <t>SHOULD provide a reason for choosing an alternate (policy and
            criteria) and for excluding an alternate.</t>

            <t>SHOULD provide the list of non&nbhy;protected prefixes and
            the reason why they are not protected (e.g., no protection
            required, no alternate available).</t>
          </list></t>
      </section>

      <section anchor="oper-lfa-alert" title="Coverage Monitoring">
        <t>It is pretty easy to evaluate the coverage of a network in a
        nominal situation, but topology changes may change the level of
        coverage. In some situations, the network may no longer be able
        to provide the required level of protection. Hence, it becomes
        very important for service providers to receive alerts regarding
        changes in coverage.</t>

        <t>An implementation SHOULD: <list style="symbols">
            <t>provide an alert system if total coverage (for a node) is
            below a defined threshold or when coverage returns to normal.</t>

            <t>provide an alert system if coverage for a specific link is
            below a defined threshold or when coverage returns to normal.</t>
          </list></t>

        <t>An implementation MAY: <list style="symbols">
            <t>trigger an alert if a specific destination is not
            protected anymore or when protection comes back up for this
            destination.</t>
          </list></t>

        <t>Although the procedures for providing alerts are beyond the scope
        of this document, we recommend that implementations consider
        standard and well-used mechanisms like syslog or SNMP traps.</t>
      </section>

      <section anchor="oper-lfa-simu" title="LFAs and Network Planning">
          <t>
          The operator may choose to run simulations in order to ensure
          a certain type of full coverage for the whole network or a
          given subset of the network. This is particularly likely if he
          operates the network in the sense of the third backbone
          profile described in Section&nbsp;4 of <xref target="RFC6571"/>;
          that is, he seeks to design and engineer the network topology
          in such a way that a certain level of coverage is always achieved.
          Obviously, a complete and exact simulation of the IP FRR
          coverage can only be achieved if the behavior is deterministic
          and the algorithm used is available to the simulation tool.
          Thus, an implementation SHOULD:

                <list style="symbols">
         <t>Behave deterministically in its LFA selection process.
         That is, in the same topology and with the same policy
         configuration, the implementation MUST always choose the same
         alternate for a given prefix.</t>

         <t>Document its behavior. The implementation SHOULD provide enough
         documentation regarding its behavior to allow an implementer
         of a simulation tool to foresee the exact choice of the
         LFA implementation for every prefix in a given topology. This
         SHOULD take into account all possible policy configuration options.
         One possible way to document this behavior is to disclose the
         algorithm used to choose alternates.</t>
                </list>
                </t>
                </section>
    </section>

    <section anchor="Security" title="Security Considerations">
        <t>The policy mechanism introduced in this document allows the
        tuning of the selection of the alternate.  This is not seen as a
        security threat, because:
        <list style="symbols">
        <t>all candidates are already eligible as per <xref target="RFC5286"/>
        and considered usable.</t>
        <t>the policy is based on information from the router's own
        configuration and from the IGP, both of which are considered
        trusted.</t>
        </list>
      Hence, this document does not introduce any new security
      considerations as compared to <xref target="RFC5286"/>.
      </t>

      <t>
      As noted above, the policy mechanism introduced in this document
      allows the tuning of the selection of the best alternate but does not
      change the list of alternates that are eligible. As described in
      Section&nbsp;7 of <xref target="RFC5286"/>,
      this best alternate "can be used anyway when a different
      topological change occurs, and hence this can't be viewed as a
      new security threat."
      </t>
    </section>

  </middle>

  <back>
   <references title="Normative References">
    <reference anchor="ISO10589">
    <front>
    <title>Intermediate System to Intermediate System intra-domain routeing
    information exchange protocol for use in conjunction with the protocol for
    providing the connectionless-mode network service (ISO 8473)</title>
    <author>
    <organization>International Organization for Standardization</organization>
    </author>
    <date month="" year="2002" />
    </front>
    <seriesInfo name="ISO" value="Standard 10589" />
    </reference>

    &RFC2119;
    &RFC4203;
    &RFC5286; 
    &RFC5307;
    &RFC5340;
    &RFC6987;
    &LFA-APPLICABILITY;
    &REMOTE-LFA;

<!-- (RFC 7917) -->
<reference anchor='RFC7917' target="http://www.rfc-editor.org/info/rfc7917">
<front>
<title>Advertising Node Administrative Tags in IS-IS</title>
<author initials='P' surname='Sarkar' fullname='P. Sarkar' role="editor">
    <organization />
</author>
<author initials='H' surname='Gredler' fullname='Hannes Gredler'>
    <organization />
</author>
<author initials='S' surname='Hegde' fullname='Shraddha Hegde'>
    <organization />
</author>
<author initials='S' surname='Litkowski' fullname='Stephane Litkowski'>
    <organization />
</author>
<author initials='B' surname='Decraene' fullname='Bruno Decraene'>
    <organization />
</author>
<date month='July' year='2016' />
</front>
<seriesInfo name='RFC' value='7917' />
<seriesInfo name='DOI' value='10.17487/RFC7917' />
</reference>

      &RFC7777;   <!-- draft-ietf-ospf-node-admin-tag; PUBed March 2016) -->
      &RFC5305;
      &RFC3630;
    </references>

    <references title="Informative References">

<!-- draft-francois-segment-routing-ti-lfa (Expired) -->
<reference anchor='TI-LFA'>
<front>
<title>Topology Independent Fast Reroute using Segment Routing</title>
<author initials='P' surname='Francois' fullname='Pierre Francois'>
    <organization />
</author>
<author initials='C' surname='Filsfils' fullname='Clarence Filsfils'>
    <organization />
</author>
<author initials='A' surname='Bashandy' fullname='Ahmed Bashandy'>
    <organization />
</author>
<author initials='B' surname='Decraene' fullname='Bruno Decraene'>
    <organization />
</author>
<author initials='S' surname='Litkowski' fullname='Stephane Litkowski'>
    <organization />
</author>
<date month='November' year='2013' />
</front>
<seriesInfo name='Work in Progress,' value='draft-francois-segment-routing-ti-lfa-00' />
</reference>

<!-- draft-ietf-rtgwg-rlfa-node-protection (Expired) -->
<reference anchor='REMOTE-LFA-NODE'>
<front>
<title>Remote-LFA Node Protection and Manageability</title>
<author initials='P' surname='Sarkar' fullname='Pushpasis Sarkar' role="editor">
    <organization />
</author>
<author initials='S' surname='Hegde' fullname='Shraddha Hegde'>
    <organization />
</author>
<author initials='C' surname='Bowers' fullname='Chris Bowers'>
    <organization />
</author>
<author initials='H' surname='Gredler' fullname='Hannes Gredler'>
    <organization />
</author>
<author initials='S' surname='Litkowski' fullname='Stephane Litkowski'>
    <organization />
</author>
<date month='December' year='2015' />
</front>
<seriesInfo name='Work in Progress,' value='draft-ietf-rtgwg-rlfa-node-protection-05' />
</reference>

<!-- draft-ietf-spring-segment-routing (I-D Exists) -->
<reference anchor='SEG-RTG-ARCH'>
<front>
<title>Segment Routing Architecture</title>
<author initials='C' surname='Filsfils' fullname='Clarence Filsfils' role="editor">
    <organization />
</author>
<author initials='S' surname='Previdi' fullname='Stefano Previdi' role="editor">
    <organization />
</author>
<author initials='B' surname='Decraene' fullname='Bruno Decraene'>
    <organization />
</author>
<author initials='S' surname='Litkowski' fullname='Stephane Litkowski'>
    <organization />
</author>
<author initials='R' surname='Shakir' fullname='Rob Shakir'>
    <organization />
</author>
<date month='July' year='2016' />
</front>
<seriesInfo name='Work in Progress,' value='draft-ietf-spring-segment-routing-09' />
</reference>

    </references>

   <section anchor="Contributors" title="Contributors" numbered="no">
   <t>
   Significant contributions were made by Pierre Francois, Hannes Gredler,
   Chris Bowers, Jeff Tantsura, Uma Chunduri, Acee Lindem, and Mustapha
   Aissaoui, whom the authors would like to acknowledge.
   </t>
        </section>

  </back>
</rfc>

<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY rfc2119 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2629.xml">
]>
<rfc number="7458"
     category="info"
     submissionType="IETF"
     consensus="yes"
     ipr="trust200902">

  <?rfc toc="yes"?>
  <?rfc compact="yes" ?>
  <?rfc symrefs="yes" ?>
  <?rfc sortrefs="yes"?>
  <?rfc subcompact="no"?>
  <?rfc rfcedstyle="yes"?>

  <front>
    <title abbrev="EAP Attributes for Wi-Fi - EPC Integration">Extensible
    Authentication Protocol (EAP) Attributes for Wi-Fi Integration with the Evolved Packet Core</title>



    <author fullname="Ravi Valmikam" initials="R" surname="Valmikam">
      <organization>Unaffiliated</organization>

      <address>
        <postal>
          <street></street>

          <city></city>

          <region></region>

          <code></code>

          <country>United States</country>
        </postal>

        <email>valmikam@gmail.com</email>
      </address>
    </author>

    <author fullname="Rajeev Koodli" initials="R" surname="Koodli">
      <organization>Intel</organization>

      <address>
        <postal>
          <street></street>

          <city></city>

          <region></region>

          <code></code>

          <country>United States</country>
        </postal>

        <email>rajeev.koodli@intel.com</email>
      </address>
    </author>

    <date month="February" year="2015" />

    <area>Internet</area>

    <workgroup>Netext</workgroup>
	

    <keyword>Mobile Networks</keyword>
    <keyword>3GPP</keyword>
    <keyword>EAP</keyword>
    <keyword>EPC</keyword>
    <keyword>Handover</keyword>
    <keyword>Identity</keyword>
    <keyword>APN</keyword>

    <abstract>
      <t>With Wi-Fi emerging as a crucial access network for mobile service
      providers, it has become important to provide functions commonly
      available in 3G and 4G networks in Wi-Fi access networks as
      well. Such functions include Access Point Name (APN) Selection,
      multiple Packet Data Network (PDN) connections, and seamless
      mobility between Wi-Fi and 3G/4G networks.</t> 

 <t> The EAP Authentication and Key Agreement (EAP-AKA), and EAP-AKA',
 protocol is required for mobile devices to access the mobile Evolved
 Packet Core (EPC) via Wi-Fi networks. This document defines a few new
 EAP attributes to enable the
 above-mentioned functions in such networks. The attributes are
 exchanged between a client (such as a Mobile Node (MN)) and its
 network counterpart (such as an Authentication, Authorization, and
 Accounting (AAA) server) in the service provider's
 infrastructure. </t> </abstract>

  </front>

  <middle>
    <section anchor="sec:intro" title="Introduction">
      <t> Wi-Fi has emerged as a "trusted" access technology for mobile
      service providers; see <xref target="EPC2"></xref> for reference
      to the 3rd Generation Partnership Project (3GPP) description of "trusted" access. Advances in IEEE 802.11u <xref
      target="IEEE802.11u"></xref> and "HotSpot 2.0" <xref
      target="hs20"></xref> have enabled seamless roaming, in which a
      Mobile Node can select and connect to a Wi-Fi access network
      just as it would roam into a cellular network. It has thus
      become important to provide certain functions in Wi-Fi that are
      commonly supported in licensed-spectrum networks such as 3G and
      4G networks. This document specifies a few new EAP attributes for an
      MN to interact with the network to support some of
      these functions (see below). 
These new attributes serve as a trigger for Proxy Mobile IPv6 network
nodes to undertake the relevant mobility operations. For instance, when the MN
requests a new IP session (i.e., a new APN in 3GPP) and the network agrees, the
corresponding attribute (defined below) acts as a
trigger for the Mobile Anchor Gateway (MAG) to initiate a new mobility session
with the Local Mobility Anchor (LMA). This document refers to <xref
target="RFC6459"></xref> for the basic definitions of mobile network
terminology (such as APN) used here. 
 </t> 

      <t>The 3GPP networks
      support many functions that are not commonly implemented in a
      Wi-Fi network. This document defines EAP attributes that enable
      the following functions in Wi-Fi access networks using
      EAP-AKA <xref
      target="RFC4187"></xref> and EAP-AKA' <xref target="RFC5448"></xref>:</t> 




      <t><list style="hanging">
          <t>o APN Selection</t>

          <t>o Multiple APN Connectivity</t>

          <t>o Wi-Fi to 3G/4G (Universal Terrestrial Radio Access Network
	  (UTRAN) / Evolved UTRAN (E-UTRAN)) mobility</t>
        </list></t>


      <t> The attributes defined here are exchanged between the MN and the EAP server, typically realized as part of the AAA
      server infrastructure in a service provider's infrastructure. In
      particular, the Wi-Fi access network simply conveys the
      attributes to the service provider's core network where the EAP
      processing takes place <xref target="EPC"></xref>. Since these
      attributes share the same IANA registry, the methods are
      applicable to EAP-AKA, EAP-AKA', EAP Subscriber Identity Modules (EAP-SIM) <xref
      target="RFC4186"></xref>, and with appropriate extensions, are
      possibly applicable for other EAP methods as well. In addition
      to the trusted Wi-Fi access networks, the attributes are
      applicable to any trusted "non-3GPP" access network that uses
      the EAP methods and provides connectivity to the mobile EPC,
      which provides connectivity for 3G, 4G, and other non-3GPP
      access networks <xref target="EPC2"></xref>.</t>



      <section title="APN Selection">
        <t>The 3GPP networks support the concept of an APN.
        This is defined in <xref target="GPRS"></xref>. Each APN is an
        independent IP network with its own set of IP services. When the MN
        attaches to the network, it may select a specific APN to receive
        desired services. For example, to receive generic Internet services,
        a user device may select APN "Internet"; and to receive IP Multimedia
	Subsystems (IMS) voice
        services, it may select APN "IMSvoice".</t>

        <t>In a Wi-Fi access scenario, an MN needs a way of sending
	the desired APN name to the network. This document specifies a
	new attribute to propagate the APN information via EAP. The
	agreed APN is necessary for the Proxy Mobile IPv6 MAG to
	initiate a new session with the LMA. </t> 

      </section>

      <section title="Multiple APN Connectivity"> <t>As an extension of APN
Selection, an MN may choose to connect to multiple IP networks simultaneously.
3GPP provides this feature via
  additional Packet Data Protocol (PDP) contexts or additional Packet
Data Network (PDN)
  connections and defines the corresponding set of signaling
  procedures. In a trusted Wi-Fi network, an MN
connects to the first APN via DHCPv4 or IPv6 Router Solicitation. This document
specifies an attribute that indicates the MN's capability to support multiple
APN connectivity. The specific connectivity types are also necessary for the
Proxy Mobile IPv6 signaling. </t> </section>


      <section title="Wi-Fi to E-UTRAN Mobility"> <t>When operating in
      a multiaccess network, an MN may want to gracefully handover
      its IP attachment from one access network to another. For
      instance, an MN connected to a 3GPP E-UTRAN network may choose
      to move its connectivity to a trusted Wi-Fi network. 
Alternatively, the MN may choose to connect using both access technologies
simultaneously and maintain two independent IP attachments. To implement these
scenarios, the MN needs a way to correlate the UTRAN/E-UTRAN session with the
new Wi-Fi session. This document specifies an attribute to propagate E-UTRAN
session identification to the network via EAP. This helps the network to
correlate the sessions between the two Radio Access Network (RAN) technologies and
thus helps the overall handover process.</t> </section>

    </section>

    <section anchor="sec:requirements"
             title="Terminology">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <xref target="RFC2119"/>.</t>
    </section>

    <section anchor="sec:proto-overview" title="Protocol Overview">
      <section title="Brief Introduction to EAP">
        <t>EAP is defined as a generic protocol in <xref
        target="RFC3748"></xref>. EAP, combined with one of the payload
        protocols such as EAP-AKA' <xref target="RFC5448"></xref> can
        accomplish several things in a network:</t>

        <t><list style="symbols">
            <t>Establish the identity of the user (MN) to the network.</t>

            <t>Authenticate the user during the first attach with the help of
            an authentication center that securely maintains the user
            credentials. This process is called "EAP Authentication".</t>

            <t>Re-authenticate the user periodically, but without the overhead
            of a round-trip to the authentication center. This process is called
            "EAP Fast Re-Authentication".</t>
          </list>This document makes use of the EAP Authentication
	  procedure. The use of the EAP Fast Re-Authentication procedure is for further
	  study. Both the EAP Authentication and EAP Fast Re-Authentication
        procedures are specified for trusted access network use in 3GPP<xref
        target="TS-33.402"></xref>.</t>
      </section>

      <section title="IEEE 802.11 Authentication Using EAP over 802.1X">
        <t>In a Wi-Fi network, EAP is carried over the IEEE 802.1X
        Authentication protocol. The IEEE 802.1X Authentication is a
        transparent, payload-unaware mechanism to carry the authentication
        messages between the MN and the Wi-Fi network elements.</t>

        <t>EAP, on the other hand, has multiple purposes. Apart from
	its core functions of communicating an MN's credentials to the
	network and proving the MN's identity, it also allows the MN
	to send arbitrary information elements to help establish the
	MN's IP session in the network. <xref target="eap-flow" /> shows an
	example of end-to-end EAP flow in the context of an IEEE 802.11
	Wi-Fi network. We first define the terminology:</t> 



		        <t><list style="symbols"> <t>MN: Mobile Node</t>

 <t>WAN: Wi-Fi Access Node, typically consisting of Wi-Fi Access Point
and Wi-Fi Controller. The CAPWAP <xref target="RFC5415" /> protocol allows these functions
to be realized in separate physical nodes or in a single node. In a Proxy
Mobile IPv6 (PMIPv6) <xref target="RFC5213"/> network, the MAG
functionality is located in the WAN, either in the Wi-Fi Access
Point or in the Wi-Fi Controller.</t>

<t> AAA: The infrastructure node supporting the AAA server with the
EAP methods (AKA, AKA', EAP-SIM). The endpoints of the EAP method are
the MN and the AAA server. </t>



 <t>IPCN: IP Core Network. This includes the PMIPv6 LMA function. </t>

 </list></t>



        <t>
<figure anchor="eap-flow" title="Example EAP Deployment">
<artwork>
<![CDATA[
 MN                        WAN                        AAA         IPCN
                          (MAG)                                   (LMA)        
 1)|<----------Beacon--------|                         |             |
 2)|<----------Probe-------->|                         |             |
   |                         |                         |             |
   |              802.11 Auth|                         |             |
 3)|<----------------------->|                         |             |
   |                         |                         |             |
   |       802.11 Association|                         |             |
 4)|<----------------------->|                         |             |
   |                         |                         |             |
 5)|<----EAP Req/Identity----|                         |             |
   |                         |                         |             |
 6)|----EAP Resp/Identity----|->--EAP Resp/Identity--->|             |
   |                         |                         |             |
 7)|<-EAP Req/AKA-Challenge<-|--EAP Req/AKA-Challenge--|             |
   |                         |                         |             |
 8)|-EAP Resp/AKA-Challenge--|>EAP Resp/AKA-Challenge->|             |
   |                         |                         |             |
 9)|<-----EAP Success------<-|------EAP Success--------|             |
   |                         |                         |             |
10)|<====== 802.11 Data ====>|<========== 802.11 Data ====Tunnel to=>|
   |                         |                         | core network|
   |                         |                         |             |
 ]]></artwork>
          </figure></t>

 
			

        <t><list style="numbers">
            <t>An MN detects a beacon from a WAP in the vicinity.</t>

            <t>The MN probes the WAP to determine suitability to attach (Verify
            Service Set Identifier (SSID) list, authentication type, and so on).</t>

            <t>The MN initiates the IEEE 802.11 Authentication with the Wi-Fi
            network. In Wi-Fi Protected Access (WPA) / WPA2 mode, this is an open authentication without
            any security credential verification.</t>

            <t>The MN initiates 802.11 Association with the Wi-Fi network.</t>

            <t>The Wi-Fi network initiates 802.1X/EAP Authentication procedures by
            sending EAP Request/Identity.</t>

            <t>The MN responds with its permanent or temporary identity.</t>

            <t>The Wi-Fi network challenges the MN to prove its identity by
            sending EAP Request/AKA-Challenge.</t>

            <t>The MN calculates the security digest and responds with EAP
            Response/AKA-Challenge.</t>

            <t>If the authentication is successful, the Wi-Fi network responds to the MN
            with EAP Success.</t>

            <t>An end-to-end data path is available for the MN to start IP layer communication (DHCPv4, IPv6 Router Solicitation, and so on).</t>
          </list></t>
      </section>
    </section>

    <section title="New EAP Attributes">
      <t>The following subsections define the new EAP attributes and their usage.</t>

 <section anchor="sec:apn-sel" title="APN Selection"> <t>In a Wi-Fi network, an
MN includes the AT_VIRTUAL_NETWORK_ID attribute in the
EAP-Response/AKA-Challenge to indicate the desired APN identity for the first
PDN connection.</t>

 <t>If the MN does not include the AT_VIRTUAL_NETWORK_ID attribute in the
EAP-Response/AKA-Challenge, the network may select an APN by other means. This
selection mechanism is outside the scope of this document.</t>

		<t>An MN includes the AT_VIRTUAL_NETWORK_REQ attribute to indicate single or multiple PDN capability. In addition, a Sub type in the attribute indicates IPv4, IPv6, or dual IPv4v6 PDN connectivity. </t>
		
      </section>


    <section anchor="sec:con-type" title="Connectivity Type">
    <t> An MN indicates its preference for connectivity using
    the AT_CONNECTIVITY_TYPE attribute in the
    EAP-Response/AKA-Challenge message. The preference indicates
    whether the MN wishes connectivity to the Evolved Packet Core
    (the so-called "EPC PDN connectivity") or Internet Offload (termed as
    "Non-Seamless Wireless Offload").</t>

    <t> The network makes its decision and replies with the same
    attribute in the EAP Success message. </t>
      </section>


      <section anchor="sec:epc-mob" title="Wi-Fi to UTRAN/E-UTRAN Mobility">
        <t>When a multiaccess MN enters a Wi-Fi network, the
	following parameters are applicable in the
	EAP-Response/AKA-Challenge for IP session continuity from
	UTRAN/E-UTRAN. </t> 

 <t><list style="symbols"> <t>AT_HANDOVER_INDICATION: This attribute indicates
to the network that the MN intends to continue the IP session from
UTRAN/E-UTRAN. If a previous session can be located, the network will honor this
request by connecting the Wi-Fi access to the existing IP session.</t>

 <t>AT_HANDOVER_SESSION_ID: An MN MAY use this attribute to identify the
session on UTRAN/E-UTRAN. If used, this attribute contains Packet
Temporary Mobile Subscriber Identity (P-TMSI) if the previous session was on
UTRAN; if the previous session
was on E-UTRAN, it contains Mobile Temporary Mobile Subscriber Identity (M-TMSI). This attribute helps the network correlate the Wi-Fi session to
an existing UTRAN/E-UTRAN session.</t> </list></t>

      </section>

  
	<section anchor="sec:serial-id" title="MN Serial ID">

		<t> The MN_SERIAL_ID attribute defines an MN's serial
		number, including International Mobile Equipment
		Identity (IMEI) and International Mobile Equipment
		Identity Software Version (IMEISV). The IMEI (or
		IMEISV) is used for ensuring a legitimate (and not a
		stolen) device is in use. As with the others, this
		attribute is exchanged with the service provider's AAA
		server. The MN_SERIAL_ID MUST NOT be propagated
		further by the AAA server to any other node. </t> 
	</section>
	
</section>

    <section anchor="sec:attr-extensions" title="Attribute Extensions">
		<t> The format for the new attributes follows that in 
			<xref target="RFC4187"></xref>. Note that the Length field 
			value is inclusive of the first two bytes.</t>
      <section anchor="sec:attr-vnid" title="AT_VIRTUAL_NETWORK_ID">


        <t>The AT_VIRTUAL_NETWORK_ID attribute identifies the virtual IP
        network to which the MN intends to attach. The implementation of the
        virtual network on the core network side is technology specific. For
        instance, in a 3GPP network, the virtual network is implemented based
        on the 3GPP APN primitive.</t>

        <t>This attribute SHOULD be included in the
	EAP-Response/AKA-Challenge message. </t> 

        <t><figure anchor="attr-vnid-fig"
            title="AT_VIRTUAL_NETWORK_ID EAP Attribute">
            <artwork><![CDATA[   0                   1                   2                   3    
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |AT_VIRTUAL     | Length        | Virtual Network Id            |
   |  _NETWORK_ID  |               |                               | 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                  Virtual Network Id                           |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure></t>

        <t>Virtual Network Id:</t>

        <t>An arbitrary octet string that identifies a virtual network in the
        access technology to which the MN is attaching. For instance, in 3GPP E-UTRAN,
        this could be an APN. See <xref target="TS-23.003"></xref> for encoding
	    of the field.</t>
      </section>



      <section anchor="sec:attr-vnreq" title="AT_VIRTUAL_NETWORK_REQ">
        <t>When an MN intends to connect an APN, it SHOULD use
        this attribute to indicate different capabilities to the
	network. In turn, the network provides what is supported.</t>

        <t>From the MN, this attribute can be included only in
	EAP-Response/Identity. From the network, it SHOULD be included in the
	EAP Request/AKA-Challenge message. In the MN-to-network direction, the
	Type field (below) indicates the MN's request. In the 
	network-to-MN direction, the Type field indicates the network's 
	willingness to support the request; a present Type field value 
	indicates the network support for that Type. </t> 

        <t><figure anchor="attr-vnreq-fig"
            title="AT_VIRTUAL_NETWORK_REQ EAP Attribute">
            <artwork><![CDATA[   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |AT_VIRTUAL_    |     Length    |  Virt-Net-Req | Virt-Net-Req  |
   |NETWORK_REQ    |               |     Type      |   Sub type    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure></t>

        <t>Virt-Net-Req Type:</t>

        <t>Type can have one of the following values:</t>

        <t><list style="symbols">
            <t>0: Reserved</t>

            <t>1: Single PDN connection</t>

            <t>2: Multiple PDN connection. Can request Non-Seamless
	    Wi-Fi Offload or EPC connectivity (see the Connectivity Type
	    attribute below) </t>

	</list></t>

        <t>Virt-Net-Req Sub type:</t>

        <t>Sub type can have one of the following values:</t>

        <t><list style="symbols">

	  <t>0: Reserved</t>

	  <t>1: PDN Type: IPv4 </t>

	  <t>2: PDN Type: IPv6 </t>

	  <t>3: PDN Type: IPv4v6 </t>
	</list></t>
      </section>


      <section anchor="sec:attr-contype" title="AT_CONNECTIVITY_TYPE">
        <t>An MN uses this
	attribute to indicate whether it wishes the connectivity type
	to be Non-Seamless WLAN Offload or EPC. This attribute is
	applicable for multiple PDN connections only. </t>
        <t>From the MN, this attribute can be included only in
	EAP-Response/Identity.  From the network, it SHOULD be included in the
	EAP Request/AKA-Challenge message. </t>

        <t><figure anchor="attr-contype-fig"
            title="AT_CONNECTIVITY_TYPE EAP Attribute">
            <artwork><![CDATA[   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |AT_CONNECTIVITY|     Length    | Connectivity  | Reserved      |
   |_TYPE          |               | Type          |               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
          </figure></t>

        <t>Connectivity Type:</t>

        <t>Connectivity Type can have one of the following values:</t>

        <t><list style="symbols">
            <t>0: Reserved</t>

            <t>1: Non-Seamless WLAN Offload (NSWO)</t>

            <t>2: EPC PDN connectivity</t>
          </list></t>
      </section>


    <section anchor="sec:attr-hi" title="AT_HANDOVER_INDICATION">
      <t>This attribute indicates an MN's handover intention of an existing IP
      attachment.</t>

      <t>This attribute SHOULD be included in the
	EAP-Response/AKA-Challenge message.</t>

      <t><figure anchor="attr-hi-fig"
          title="AT_HANDOVER_INDICATION EAP Attribute">
          <artwork><![CDATA[   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |AT_HANDOVER_IND|     Length    | Handover      |   Pad         | 
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure></t>

      <t>Handover Type:</t>

      <t><list style="symbols">
          <t>0 - The MN has no intention of handing over an existing IP session,
          i.e., the MN is requesting an independent IP session with the Wi-Fi
          network without disrupting the IP session with the UTRAN/E-UTRAN. In
          this case, no Session Id (<xref target="sec:attr-sessid"></xref>) is 
          included.</t>

          <t>1 - The MN intends to handover an existing IP session. In this case,
          MN MAY include a Session Id (<xref target="sec:attr-sessid"></xref>) to
          correlate this Wi-Fi session with a UTRAN/E-UTRAN session.</t>
        </list></t>

      <t></t>
    </section>

    <section anchor="sec:attr-sessid" title="AT_HANDOVER_SESSION_ID">
      <t>When an MN intends to handover an earlier IP session to the current
      access network, it may propagate a session identity that can help identify the
      previous session from UTRAN/E-UTRAN that the MN intends to handover. This
      attribute is defined as a generic octet string. The MN MAY include an
      E-UTRAN Globally Unique Temporary User Equipment Identity (GUTI)
      if the previous session was an E-UTRAN session. If the previous session
      was a UTRAN session, the MN MAY include a UTRAN Global Radio Network
      Controller (RNC) ID (Mobile Country Code (MCC), Mobile Network Code (MNC), RNC
      ID) and P-TMSI concatenated as an octet string.</t>



      <t>This attribute SHOULD be included in the
	EAP-Response/AKA-Challenge message.</t> 

      <t><figure anchor="attr-sessionid-fig"
          title="AT_HANDOVER_SESSION_ID EAP Attribute">
          <artwork><![CDATA[0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|AT_HANDOVER_   |   Length      |  Access       |  Reserved     |
|  SESSION_ID   |               |  Technology   |               | 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           Session Id                          |
|                              ...                              |
|                              ...                              |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure></t>

      <t>Access Technology:</t>

      <t>This field represents the RAN technology from which the MN is
      undergoing a handover.</t>

      <t><list style="symbols">
          <t>0: Reserved</t>

          <t>1: UTRAN</t>

          <t>2: E-UTRAN</t>
        </list></t>

      <t>Session Id:</t>

      <t>An octet string of variable length that identifies the session in the source
      access technology. As defined at the beginning of this section, the
      actual value is RAN technology dependent. For E-UTRAN, the value is GUTI.
      For UTRAN, the value is Global RNC ID (6 bytes) followed by P-TMSI (4
      bytes). See <xref target="TS-23.003"></xref> for encoding
	    of the field.</t>
    </section>

 <section anchor="sec:imei" title="AT_MN_SERIAL_ID">
<t> This attribute defines the MN's machine serial number. Examples
are IMEI and IMEISV. </t>

<t>A network that requires the machine serial number for authorization
purposes MUST send a request for the attribute in an
EAP-Request/AKA-Challenge message. If the attribute is present, the MN
SHOULD include the attribute in the EAP-Response/AKA-Challenge message.
If the MN sends the attribute, it MUST be contained within an
AT_ENCR_DATA attribute. An MN MUST NOT provide the attribute unless it
receives the request from a network authenticated via EAP/AKA.</t>
  
 
     <t><figure anchor="attr-imei-fig"
          title="AT_MN_SERIAL_ID EAP Attribute">
 
          <artwork><![CDATA[
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|AT_MN_         |   Length      |  Serial ID    |  Reserved     |
|  SERIAL_ID    |               |    Type       |               | 
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           MN Serial Id                        |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
]]></artwork>
        </figure></t>


 <t>Serial ID Type:</t>

      <t>This field identifies the type of the MN Identifier.</t>

      <t><list style="symbols">
          <t>0: Reserved</t>

          <t>1: IMEI</t>

          <t>2: IMEISV</t>
        </list></t>

      <t>MN Serial Id:</t>

      <t>An arbitrary octet string that identifies the MN's machine
      serial number. The actual value is device specific. 
	  See <xref target="TS-23.003"></xref> for encoding of the
      field. When sent by the network in the EAP-Request/AKA-Challenge
      message, this field is not present, which serves as an indication
      for the MN to provide the attribute in the
      EAP-Response/AKA-Challenge message.  </t>

<t>An AT_MN_SERIAL_ID attribute MUST only be used with methods that can
provide mutual (network and device) authentication, such as AKA, AKA',
and EAP-SIM.</t>

    </section>


  </section>

<section title="Security Considerations">
<t>This document defines new EAP attributes to extend the capability of
   the EAP-AKA protocol as specified in Section 8.2 of <xref target="RFC4187"/>.  The
   attributes are passed between an MN and a AAA server in provider-
   controlled, trusted Wi-Fi networks, where the Wi-Fi access network is
   a relay between the MN and the AAA server.  The document does not
   specify any new messages or options to the EAP-AKA protocol.</t>

<t>The attributes defined here are fields that are used in existing 3G
   and 4G networks, where they are exchanged (in protocols specific to
   3G and 4G networks) subsequent to the mobile network authentication
   (e.g., using the UMTS-AKA mechanism).
   For the operator-controlled Wi-Fi access that is
   connected to the same core infrastructure as the 3G and 4G access, a
   similar model is followed here with the EAP-AKA (or EAP-AKA', EAP-SIM) authentication.  


In doing so, processing these attributes,
   security-wise, is no worse than that in existing 3G and 4G mobile
   networks.</t>

<t>The attributes inherit the security protection (integrity, replay,
   and confidentiality) provided by the parameters in the AKA(') or SIM
   methods; see Section 12.6 in <xref target="RFC4187"/>.  Furthermore, RFC 4187
   requires attributes exchanged in EAP-Request/AKA-Identity or EAP-
   Response/AKA-Identity to be integrity-protected with AT_CHECKCODE;
   see Section 8.2 in <xref target="RFC4187"/>.  This requirement applies to the
   AT_CONNECTIVITY_TYPE and AT_VIRTUAL_NETWORK_REQ attributes defined in
   this document.</t>

<t>The AT_MN_SERIAL_ID attribute MUST have confidentiality protection
   provided by the AKA(') or EAP-SIM methods beyond the secure transport
   (such as private leased lines, VPN, etc.) deployed by the provider of
   the trusted Wi-Fi service.</t>

<t>Use of identifiers such as IMEI could have privacy implications,
   wherein devices can be profiled and tracked.  With additional
   information, this could also lead to profiling of user's network
   access patterns.  Implementers should consult <xref target="hotos-2011"/>,
   and the references therein, for a broader discussion and possible mitigation
   methods on the subject.</t>
</section>

    <section title="IANA Considerations">
      <t>This document defines the following new skippable EAP-AKA
      attributes. These attributes have been assigned from the "EAP-AKA
      and EAP-SIM Parameters" registry at
     &lt;https://www.iana.org/assignments/eapsimaka-numbers&gt;.</t>

      <t><list style="symbols">
          <t>AT_VIRTUAL_NETWORK_ID (<xref target = "sec:attr-vnid" ></xref>): 145</t>

          <t>AT_VIRTUAL_NETWORK_REQ (<xref target = "sec:attr-vnreq" ></xref>): 146</t>

          <t>AT_CONNECTIVITY_TYPE (<xref target = "sec:attr-contype" 
	  ></xref>): 147</t>

	  <t>AT_HANDOVER_INDICATION (<xref target = "sec:attr-hi"
	  ></xref>): 148</t>

	  <t> AT_HANDOVER_SESSION_ID (<xref target = "sec:attr-sessid"
	  ></xref>): 149</t>

	  <t>AT_MN_SERIAL_ID (<xref target= "sec:imei"></xref>): 150</t>

        </list></t>
		
		<t>A new IANA registry titled "Trusted
		Non-3GPP Access EAP Parameters" has been created. The range for both Types and
		Sub types in
		the registry is 0 - 127, with 0 (zero) being a
		reserved value. IANA has made
		assignments in a monotonically increasing order in
		increments of 1, starting from 1. New assignments in
		this registry are made with the Specification Required
		policy <xref target="RFC5226"></xref>.</t> 

		<t>The IANA Designated Expert should review the
		requirements for new assignments based on factors
		including, but not limited to, the source of request
		(e.g., standards bodies), deployment needs (e.g.,
		industry consortium, operator community), and
		experimental needs (e.g., academia, industrial
		labs). A document outlining the purpose of new
		assignments should accompany the request. Such a
		document could be a standards document or a research
		project description. The Designated Expert should
		consider that there is sufficient evidence of
		potential usage both on the endpoints (e.g., Mobile
		Devices, etc.) and the infrastructure (e.g., AAA
		servers, gateways, etc.)  </t>


		<t>The following fields have been assigned:</t>
		
        <t><list style="symbols"> <t>Virt-Net-Req Type (<xref target ="sec:attr-vnreq"
></xref>): 1</t>

 <t>Virt-Net-Req Sub type (<xref target = "sec:attr-vnreq" ></xref>): 2</t>

 <t>Connectivity Type (<xref target = "sec:attr-contype" ></xref>): 3</t>

 <t> Access Technology (<xref target = "sec:attr-sessid" ></xref>): 4</t>

 <t>Serial ID Type (<xref target= "sec:imei"></xref>): 5</t>

 </list></t>

		
    </section>
 </middle>

  <back>
	


	<references title="Normative References">

    <reference  anchor='RFC2119' target='http://www.rfc-editor.org/info/rfc2119'>
    <front>
    <title>Key words for use in RFCs to Indicate Requirement Levels</title>
    <author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
    <date year='1997' month='March' />
    </front>
    <seriesInfo name='BCP' value='14'/>
    <seriesInfo name='RFC' value='2119'/>
    <format type='ASCII' octets='4723'/>
    </reference>

		<reference anchor="RFC4187" target="http://www.rfc-editor.org/info/rfc4187">
	        <front>
	          <title>Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)</title>

	          <author initials="J." surname="Arkko">
	            <organization />
	          </author>

	          <author initials="H." surname="Haverinen">
	            <organization />
	          </author>

	          <date month="January" year="2006" />
	        </front>

	        <seriesInfo name="" value="RFC4187" />
	      </reference>

    <reference  anchor='RFC6459' target='http://www.rfc-editor.org/info/rfc6459'>
    <front>
    <title>IPv6 in 3rd Generation Partnership Project (3GPP) Evolved Packet System (EPS)</title>
    <author initials='J.' surname='Korhonen' fullname='J. Korhonen' role='editor'><organization /></author>
    <author initials='J.' surname='Soininen' fullname='J. Soininen'><organization /></author>
    <author initials='B.' surname='Patil' fullname='B. Patil'><organization /></author>
    <author initials='T.' surname='Savolainen' fullname='T. Savolainen'><organization /></author>
    <author initials='G.' surname='Bajko' fullname='G. Bajko'><organization /></author>
    <author initials='K.' surname='Iisakkila' fullname='K. Iisakkila'><organization /></author>
    <date year='2012' month='January' />
    </front>
    <seriesInfo name='RFC' value='6459'/>
    <format type='ASCII' octets='84769'/>
    </reference>

    <reference  anchor='RFC5226' target='http://www.rfc-editor.org/info/rfc5226'>
    <front>
    <title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
    <author initials='T.' surname='Narten' fullname='T. Narten'><organization /></author>
    <author initials='H.' surname='Alvestrand' fullname='H. Alvestrand'><organization /></author>
    <date year='2008' month='May' />
    </front>
    <seriesInfo name='BCP' value='26'/>
    <seriesInfo name='RFC' value='5226'/>
    <format type='ASCII' octets='66160'/>
    </reference>	
 </references>		
		
		
    <references title="Informative References">
     

	 
  	  <reference anchor="IEEE802.11u"
         target="http://standards.ieee.org/findstds/standard/802.11u-2011.html">
          <front>
            <title>IEEE Standard for Information
	    Technology-Telecommunications and information exchange
	    between systems-Local and Metropolitan networks-specific
	    requirements-Part II: Wireless LAN Medium Access Control
	    (MAC) and Physical Layer (PHY) specifications: Amendment
	    9: Interworking with External Networks</title> 

            <author>
              <organization>IEEE</organization>
            </author>

            <date month="February" year="2011" />
          </front>

          <seriesInfo name="IEEE Std" value="802.11u-2011" />
        </reference>
	 
    	  <reference anchor="hs20"
target="https://www.wi-fi.org/hotspot-20-release-2-technical-specification-package-v100">
            <front>
              <title>Hotspot 2.0 (Release 2) Technical Specification Package v1.0.0</title>

              <author>
                <organization />
              </author>

              <date month="" year="" />
            </front>

          
          </reference>
	 
	 
	  <reference anchor="GPRS"
                 target="http://www.3gpp.org/ftp/Specs/html-info/23060.htm">
        <front>
          <title>General Packet Radio Service (GPRS); Service description, Stage 2</title>
          <author>
            <organization>3GPP</organization>
          </author>

          <date month="December" year="2006" />
		</front>
 <seriesInfo name="TS" value="23.060" />
      </reference>

      <reference anchor="EPC"
                 target="http://www.3gpp.org/ftp/Specs/html-info/23401.htm">
        <front>
          <title>General Packet Radio Service (GPRS); enhancements for Evolved
          Universal Terrestrial Radio Access Network (E-UTRAN) access</title>
          <author>
            <organization>3GPP</organization>
          </author>

          <date month="December" year="2009" />
		</front>
           <seriesInfo name="TS 23.401" value="8.8.0" />
      </reference>

 <reference anchor="EPC2"
                 target="http://www.3gpp.org/ftp/Specs/html-info/23402.htm">
        <front>
          <title>Architecture enhancements for non-3GPP accesses</title>
          <author>
            <organization>3GPP</organization>
          </author>

          <date month="December" year="2009" />
		</front>
		 <seriesInfo name="TS 23.402" value="8.8.0" />
      </reference>

      <reference anchor="TS-33.402"
                 target="http://www.3gpp.org/ftp/Specs/html-info/33402.htm">
        <front>
          <title>3GPP System Architecture Evolution (SAE); Security aspects of
          non-3GPP accesses</title>

          <author>
            <organization>3GPP</organization>
          </author>

          <date month="December" year="2009" />
        </front>

        <seriesInfo name="TS 33.402" value="8.6.0" />
      </reference>

      <reference anchor="TS-23.003"
                 target="http://www.3gpp.org/ftp/Specs/html-info/23003.htm">
        <front>
          <title>Numbering, addressing and
			  identification</title>

          <author>
            <organization>3GPP</organization>
          </author>

          <date month="March" year="2014" />
        </front>

        <seriesInfo name="TS 23.003" value="12.2.0" />
      </reference>

<reference anchor="hotos-2011"
                 target="https://www.usenix.org/legacy/events/hotos11/tech/">
        <front>
          <title>Privacy Revelations for Web and Mobile Apps</title>

          <author initials="D" surname="Wetherall, et al.">
            <organization />
          </author>

          <date month="May" year="2011" />
        </front>

        <seriesInfo name="Proceedings of the Hot Topics in Operating
			  Systems" value="(HotOS)" />
      </reference>

      <reference anchor="RFC3748" target="http://www.rfc-editor.org/info/rfc3748.txt">
        <front>
          <title>Extensible Authentication Protocol (EAP)</title>

          <author initials="B." surname="Aboba">
            <organization />
          </author>

          <author initials="L." surname="Blunk">
            <organization />
          </author>

          <author initials="J." surname="Vollbrecht">
            <organization />
          </author>

          <author initials="J." surname="Carlson">
            <organization />
          </author>

          <author initials="H." surname="Levkowetz" role="editor">
            <organization />
          </author>

          <date month="June" year="2004" />
        </front>

        <seriesInfo name="" value="RFC3748" />
      </reference>

    <reference  anchor='RFC5448' target='http://www.rfc-editor.org/info/rfc5448'>
    <front>
    <title>Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA&#039;)</title>
    <author initials='J.' surname='Arkko' fullname='J. Arkko'><organization /></author>
    <author initials='V.' surname='Lehtovirta' fullname='V. Lehtovirta'><organization /></author>
    <author initials='P.' surname='Eronen' fullname='P. Eronen'><organization /></author>
    <date year='2009' month='May' />
    </front>
    <seriesInfo name='RFC' value='5448'/>
    <format type='ASCII' octets='60641'/>
    </reference>

    <reference  anchor='RFC5213' target='http://www.rfc-editor.org/info/rfc5213'>
    <front>
    <title>Proxy Mobile IPv6</title>
    <author initials='S.' surname='Gundavelli' fullname='S. Gundavelli' role='editor'><organization /></author>
    <author initials='K.' surname='Leung' fullname='K. Leung'><organization /></author>
    <author initials='V.' surname='Devarapalli' fullname='V. Devarapalli'><organization /></author>
    <author initials='K.' surname='Chowdhury' fullname='K. Chowdhury'><organization /></author>
    <author initials='B.' surname='Patil' fullname='B. Patil'><organization /></author>
    <date year='2008' month='August' />
    </front>
    <seriesInfo name='RFC' value='5213'/>
    <format type='ASCII' octets='226902'/>
    </reference>

    <reference  anchor='RFC4186' target='http://www.rfc-editor.org/info/rfc4186'>
    <front>
    <title>Extensible Authentication Protocol Method for Global System for Mobile Communications (GSM) Subscriber Identity Modules (EAP-SIM)</title>
    <author initials='H.' surname='Haverinen' fullname='H. Haverinen' role='editor'><organization /></author>
    <author initials='J.' surname='Salowey' fullname='J. Salowey' role='editor'><organization /></author>
    <date year='2006' month='January' />
    </front>
    <seriesInfo name='RFC' value='4186'/>
    <format type='ASCII' octets='220807'/>
    </reference>      

      <reference anchor="RFC5415" target="http://www.rfc-editor.org/info/rfc5415.txt">
        <front>
          <title>Control And Provisioning of Wireless Access Points (CAPWAP)
          Protocol Specification</title>

          <author initials="P." surname="Calhoun">
            <organization />
          </author>

          <author initials="M." surname="Montemurro">
            <organization />
          </author>

          <author initials="D." surname="Stanley">
            <organization />
          </author>

          <date month="January" year="2009" />
        </front>

        <seriesInfo name="" value="RFC5415" />
      </reference>

    </references>

    <section title="Acknowledgments" anchor="ack_1">
<t>Thanks to Sebastian Speicher for the review and suggesting
   improvements. Thanks to Mark Grayson for proposing the MN Serial ID
   attribute, and thanks to Brian Haberman for suggesting a new
   registry.</t>

    </section>
  </back>
</rfc>


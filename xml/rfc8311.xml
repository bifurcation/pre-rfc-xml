<?xml version="1.0" encoding="US-ASCII"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [

]>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>

<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>

<rfc category="std" number="8311" submissionType="IETF" consensus="yes"
     ipr="pre5378Trust200902" updates="3168, 4341, 4342, 5622, 6679">

  <front>


    <title abbrev="ECN Experimentation">Relaxing Restrictions on Explicit
    Congestion Notification (ECN) Experimentation</title>


    <author fullname="David Black" initials="D.L." surname="Black">
      <organization>Dell EMC</organization>
      <address>
        <postal>
          <street>176 South Street</street>
          <city>Hopkinton</city>
          <region>MA</region>
          <code>01748</code>
          <country>United States of America</country>
        </postal>
        <phone/>
        <email>david.black@dell.com</email>
      </address>
    </author>

    <date month="January" year="2018"/>


    <area>Transport</area>

    <workgroup>Transport Area Working Group</workgroup>

    <keyword>ECN</keyword>


    <abstract>
      <t>This memo updates RFC 3168, which specifies Explicit Congestion
      Notification (ECN) as an alternative to packet drops for indicating
      network congestion to endpoints. It relaxes restrictions in RFC 3168
      that hinder experimentation towards benefits beyond just removal of
      loss. This memo summarizes the anticipated areas of experimentation and
      updates RFC 3168 to enable experimentation in these areas. An
      Experimental RFC in the IETF document stream is required to take
      advantage of any of these enabling updates. In addition, this memo makes
      related updates to the ECN specifications for RTP in RFC 6679 and for
      the Datagram Congestion Control Protocol (DCCP) in RFCs 4341, 4342, and 5622. This memo also records the
      conclusion of the ECN nonce experiment in RFC 3540 and provides the
      rationale for reclassification of RFC 3540 from Experimental to Historic; this
      reclassification enables new experimental use of the ECT(1)
      codepoint.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>This memo updates <xref target="RFC3168">RFC 3168</xref>, which
      specifies Explicit Congestion Notification (ECN) as an alternative to
      packet drops for indicating network congestion to endpoints. It relaxes
      restrictions in RFC 3168 that hinder experimentation towards benefits
      beyond just removal of loss. This memo summarizes the proposed areas of
      experimentation and updates RFC 3168 to enable experimentation in these
      areas. An Experimental RFC in the IETF document stream <xref
      target="RFC4844"/> is required to take advantage of any of these
      enabling updates. Putting all of these updates into a single document
      enables experimentation to proceed without requiring a standards process
      exception for each Experimental RFC that needs changes to RFC 3168, a
      Proposed Standard RFC.</t>

      <t>There is no need for this memo to update RFC 3168 to simplify
      standardization of protocols and mechanisms that are documented in
      Standards Track RFCs, as any Standards Track RFC can update RFC 3168
      directly without either relying on updates in this memo or using a
      standards process exception.</t>

      <t>In addition, this memo makes related updates to the ECN specification
      for RTP <xref target="RFC6679"/> and for three DCCP profiles (<xref
      target="RFC4341"/>, <xref target="RFC4342"/>, and <xref
      target="RFC5622"/>) for the same reason. Each experiment is still
      required to be documented in one or more separate RFCs, but use of
      Experimental RFCs for this purpose does not require a process exception
      to modify any of these Proposed Standard RFCs when the modification
      falls within the bounds established by this memo (RFC 5622 is an
      Experimental RFC; it is modified by this memo for consistency with
      modifications to the other two DCCP RFCs).</t>

      <t>Some of the anticipated experimentation includes use of the ECT(1)
      codepoint that was dedicated to the ECN nonce experiment in <xref
      target="RFC3540">RFC 3540</xref>. This memo records the conclusion of
      the ECN nonce experiment and provides the explanation for
      reclassification of RFC 3540 from Experimental to Historic in order to enable new
      experimental use of the ECT(1) codepoint.</t>

      <section title="ECN Terminology">
        <t>
        <list style="hanging" hangIndent="3">
        <t hangText="ECT: ECN-Capable Transport."> One of the two codepoints, ECT(0) or
        ECT(1), in the ECN field <xref target="RFC3168"/> of the IP header (v4
        or v6). An ECN-capable sender sets one of these to indicate that both
        transport endpoints support ECN.</t>

         <t hangText="Not-ECT:"> The ECN codepoint set by senders that indicates that the
        transport is not ECN capable.</t>

        <t hangText="CE: Congestion Experienced."> The ECN codepoint that an intermediate
        node sets to indicate congestion. A node sets an increasing proportion
        of ECT packets to Congestion Experienced (CE) as the level of congestion increases.</t></list></t>
      </section>

      <section title="Requirements Language">
        <t> The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
      NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
      "MAY", and "OPTIONAL" in this document are to be interpreted as
      described in BCP 14 <xref target="RFC2119" /> <xref target="RFC8174" /> when, and only when, they
      appear in all capitals, as shown here.</t>
      </section>
    </section>

    <section anchor="ECNExpBackground" title="ECN Experimentation: Overview">
      <t>Three areas of ECN experimentation are covered by this memo; the
      cited documents should be consulted for the detailed goals and
      rationale of each proposed experiment:<list style="hanging">
          <t hangText="Congestion Response Differences:">An ECN congestion
          indication communicates a higher likelihood than a dropped packet
          that a short queue exists at the network bottleneck node <xref
          target="TCP-ABE"/>. This difference
          suggests that for congestion indicated by ECN, a different sender
          congestion response (e.g., sender backs off by a smaller amount) may
          be appropriate by comparison to the sender response to congestion
          indicated by loss. Two examples of proposed sender congestion
          response changes are described in <xref
          target="TCP-ABE"/> and <xref
          target="ECN-L4S"/> -- the proposal in the latter
          document couples the sender congestion response change to Congestion
          Marking Differences functionality (see next paragraph). These
          changes are at variance with the requirement in RFC 3168 that a sender's
          congestion control response to ECN congestion indications be the
          same as to drops. IETF approval, e.g., via an Experimental RFC in
          the IETF document stream, is required for any sender congestion
          response used in this area of experimentation. See Section <xref
          format="counter" target="CRDifferences"/> for further
          discussion.</t>

          <t hangText="Congestion Marking Differences:">Congestion marking at
          network nodes can be configured to maintain very shallow queues in
          conjunction with a different sender response to congestion
          indications (CE marks), e.g., as proposed in <xref
          target="ECN-L4S"/>. The traffic involved needs to
          be identified by the senders to the network nodes in order to avoid
          damage to other network traffic whose senders do not expect the more
          frequent congestion marking used to maintain very shallow queues.
          Use of different ECN codepoints, specifically ECT(0) and ECT(1), is
          a promising means of traffic identification for this purpose, but
          that technique is at variance with the requirement in RFC 3168 that
          traffic marked as ECT(0) not receive
          different treatment in the network by comparison to traffic marked as ECT(1). IETF approval, e.g., via an
          Experimental RFC in the IETF document stream, is required for any
          differences in congestion marking or sender congestion response used
          in this area of experimentation. See Section <xref format="counter"
          target="CMDifferences"/> for further discussion.</t>

          <t hangText="TCP Control Packets and Retransmissions:">RFC 3168
          limits the use of ECN with TCP to data packets, excluding
          retransmissions. With the successful deployment of ECN in large
          portions of the Internet, there is interest in extending the
          benefits of ECN to TCP control packets (e.g., SYNs) and
          retransmitted packets, e.g., as proposed in <xref
          target="ECN-TCP"/>. This is at variance
          with RFC 3168's prohibition of ECN for TCP control packets
          and retransmitted packets. See Section <xref format="counter"
          target="TCPControl"/> for further discussion.</t>
        </list>The scope of this memo is limited to these three areas of
      experimentation. This memo expresses no view on the likely outcomes of
      the proposed experiments and does not specify the experiments in detail.
      Additional experiments in these areas are possible, e.g., on use of ECN
      to support deployment of a protocol similar to <xref
      target="RFC8257">Data Center TCP (DCTCP)</xref> beyond DCTCP's current
      applicability that is limited to data center environments. The purpose
      of this memo is to remove constraints in Standards Track RFCs that stand
      in the way of these areas of experimentation.</t>

      <section anchor="ECC" title="Effective Congestion Control is Required">
        <t>Congestion control remains an important aspect of the Internet
        architecture <xref target="RFC2914"/>. Any Experimental RFC in the
        IETF document stream that takes advantage of this memo's updates to
        any RFC is required to discuss the congestion control implications of
        the experiment(s) in order to provide assurance that deployment of the
        experiment(s) does not pose a congestion-based threat to the operation
        of the Internet.</t>
      </section>

      <section title="Network Considerations for ECN Experimentation">
        <t>ECN functionality <xref target="RFC3168"/> is becoming widely
        deployed in the Internet and is being designed into additional
        protocols such as Transparent Interconnection of Lots of Links (TRILL) <xref target="ECN-TRILL"/>.
        ECN experiments are expected to coexist with deployed ECN
        functionality, with the responsibility for that coexistence falling
        primarily upon designers of experimental changes to ECN. In addition,
        protocol designers and implementers, as well as network operators, may
        desire to anticipate and/or support ECN experiments. The following
        guidelines will help avoid conflicts with the areas of ECN
        experimentation enabled by this memo:<list style="numbers">
            <t>Forwarding behavior as described in RFC 3168 remains the preferred approach
            for routers that are not involved in ECN experiments, in
            particular continuing to treat the ECT(0) and ECT(1) codepoints as
            equivalent, as specified in Section <xref format="counter"
            target="CMDifferences"/> below.</t>

            <t>Network nodes that forward packets SHOULD NOT assume that the
            ECN CE codepoint indicates that the packet would have been dropped
            if ECN were not in use. This is because Congestion Response
            Differences experiments employ different congestion responses to
            dropped packets by comparison to receipt of CE-marked packets (see
            Section <xref format="counter" target="CRDifferences"/> below), so
            CE-marked packets SHOULD NOT be arbitrarily dropped. A
            corresponding difference in congestion responses already occurs
            when the ECN field is used for Pre&nbhy;Congestion Notification (PCN)
            <xref target="RFC6660"/>.</t>

            <t>A network node MUST NOT originate traffic marked with ECT(1)
            unless the network node is participating in a Congestion Marking
            Differences experiment that uses ECT(1), as specified in Section
            <xref format="counter" target="CMDifferences"/> below.</t>

          </list>Some ECN experiments use ECN with packets where ECN has not
        been used previously, specifically TCP control packets and
        retransmissions; see Section <xref format="counter"
        target="TCPControl"/> below.  The new middlebox behavior requirements in that section are of particular importance. In general, any system or protocol that
        inspects or monitors network traffic SHOULD be prepared to encounter
        ECN usage on packets and traffic that currently do not use ECN.</t>

        <t>ECN field handling requirements for tunnel encapsulation and
        decapsulation are specified in <xref target="RFC6040"/>, which is in
        the process of being updated by <xref
        target="ECN-SHIM"/>. Related guidance for
        encapsulations whose outer headers are not IP headers can be found in
        <xref target="ECN-ENCAP"/>. These
        requirements and guidance apply to all traffic, including traffic that
        is part of any ECN experiment.</t>
      </section>

      <section title="Operational and Management Considerations">
        <t>Changes in network traffic behavior that result from ECN
        experimentation are likely to impact network operations and
        management. Designers of ECN experiments are expected to anticipate
        possible impacts and consider how they may be dealt with. Specific
        topics to consider include possible network management changes or
        extensions, monitoring of the experimental deployment, collection of
        data for evaluation of the experiment, and possible interactions with
        other protocols, particularly protocols that encapsulate network
        traffic.</t>

        <t>For further discussion, see <xref target="RFC5706"/>; the questions
        in Appendix A of RFC 5706 provide a concise survey of some important
        aspects to consider.</t>
      </section>
    </section>

    <section anchor="ECNNonce" title="ECN Nonce and RFC 3540">
      <t>As specified in RFC 3168, ECN uses two ECN-Capable Transport (ECT)
      codepoints, ECT(0) and ECT(1), to indicate that a packet supports ECN.
      RFC 3168 assigned the second codepoint, ECT(1), to support ECN nonce
      functionality that discourages receivers from exploiting ECN to improve
      their throughput at the expense of other network users. That ECN nonce
      functionality is fully specified in <xref
      target="RFC3540">RFC 3540</xref>.  This section explains why RFC 3540 has
      been reclassified from Experimental to Historic and makes associated updates to RFC
      3168.</t>

      <t>While the ECN nonce works as specified, and has been deployed in
      limited environments, widespread usage in the Internet has not
      materialized. A study of the ECN behavior of the top one million web
      servers using 2014 data <xref target="Trammell15"/> found that after ECN
      was negotiated, none of the 581,711 IPv4 servers tested were using both
      ECT codepoints, which would have been a possible sign of ECN nonce
      usage. Of the 17,028 IPv6 servers tested, four set both ECT(0) and ECT(1)
      on data packets. This might have been evidence of use of the ECN nonce
      by these four servers, but it might equally have been due to erroneous
      re-marking of the ECN field by a middlebox or router.</t>

      <t>With the emergence of new experimental functionality that depends on
      use of the ECT(1) codepoint for other purposes, continuing to reserve
      that codepoint for the ECN nonce experiment is no longer justified. In
      addition, other approaches to discouraging receivers from exploiting ECN
      have emerged; see Appendix B.1 of <xref
      target="ECN-L4S"/>. Therefore, in support of ECN
      experimentation with the ECT(1) codepoint, this memo:<list
          style="symbols">
          <t>Declares that the ECN nonce experiment <xref target="RFC3540"/>
          has concluded and notes the absence of widespread deployment.</t>

          <t>Updates <xref target="RFC3168">RFC 3168</xref> to remove
          discussion of the ECN nonce and use of ECT(1) for that nonce.</t>
        </list>The four primary updates to RFC 3168 that remove discussion of
      the ECN nonce and use of ECT(1) for that nonce are as follows:<list style="numbers">
          <t>The removal of the paragraph in Section 5 that immediately follows Figure
          1; this paragraph discusses the ECN nonce as the motivation for two
          ECT codepoints.</t>

          <t>The removal of Section 11.2, "A Discussion of the ECN nonce", in its
          entirety.</t>

          <t>The removal of the last paragraph of Section 12, which states that ECT(1)
          may be used as part of the implementation of the ECN nonce.</t>

          <t>The removal of the first two paragraphs of Section 20.2, which discuss
          the ECN nonce and alternatives. No changes are made to the rest of
          Section 20.2, which discusses alternative uses for the fourth ECN
          codepoint.</t>
        </list>In addition, other less-substantive changes to RFC 3168 are
      required to remove all other mentions of the ECN nonce and to remove
      implications that ECT(1) is intended for use by the ECN nonce; these
      specific text updates are omitted for brevity.</t>
    </section>

    <section title="Updates to RFC 3168">
      <t>The following subsections specify updates to RFC 3168 to enable the
      three areas of experimentation summarized in Section <xref
      format="counter" target="ECNExpBackground"/>.</t>

      <section anchor="CRDifferences" title="Congestion Response Differences">
        <t>RFC 3168 specifies that senders respond identically to packet drops
        and ECN congestion indications. ECN congestion indications are
        predominately originated by Active Queue Management (AQM) mechanisms
        in intermediate buffers. AQM mechanisms are usually configured to
        maintain shorter queue lengths than non-AQM-based mechanisms,
        particularly non-AQM drop-based mechanisms such as tail-drop, as AQM
        mechanisms indicate congestion before the queue overflows. While the
        occurrence of loss does not easily enable the receiver to determine if
        AQM is used, the receipt of an ECN CE mark
        conveys a strong likelihood that AQM was used to manage the bottleneck
        queue. Hence, an ECN congestion indication communicates a higher
        likelihood than a dropped packet that a short queue exists at the
        network bottleneck node <xref
        target="TCP-ABE"/>. This difference
        suggests that for congestion indicated by ECN, a different sender
        congestion response (e.g., sender backs off by a smaller amount) may
        be appropriate by comparison to the sender response to congestion
        indicated by loss. However, Section 5 of RFC 3168 specifies that:</t>

        <t><list style="empty">
            <t>Upon the receipt by an ECN-Capable transport of a single CE
            packet, the congestion control algorithms followed at the
            end-systems MUST be essentially the same as the congestion control
            response to a *single* dropped packet.</t>

          </list>This memo updates this text from RFC 3168 to allow the congestion
        control response (including the TCP Sender's congestion control
        response) to a CE-marked packet to differ from the response to a
        dropped packet, provided that the changes from RFC 3168 are documented
        in an Experimental RFC in the IETF document stream. The specific
        change to RFC 3168 is to insert the words "unless otherwise specified
        by an Experimental RFC in the IETF document stream" at the end of the
        sentence quoted above.</t>

        <t><xref target="RFC4774">RFC 4774</xref> quotes the above text from
        RFC 3168 as background, but it does not impose requirements based on that
        text. Therefore, no update to RFC 4774 is required to enable this area
        of experimentation.</t>

        <t>Section 6.1.2 of RFC 3168 specifies that:<list style="empty">
            <t>If the sender receives an ECN-Echo (ECE) ACK packet (that is,
            an ACK packet with the ECN-Echo flag set in the TCP header), then
            the sender knows that congestion was encountered in the network on
            the path from the sender to the receiver. The indication of
            congestion should be treated just as a congestion loss in non&nbhy;ECN&nbhy;Capable
            TCP. That is, the TCP source halves the congestion
            window "cwnd" and reduces the slow start threshold "ssthresh".</t>
          </list></t>

        <t>This memo also updates this text from RFC 3168 to allow the congestion
        control response (including the TCP Sender's congestion control
        response) to a CE-marked packet to differ from the response to a
        dropped packet, provided that the changes from RFC 3168 are documented
        in an Experimental RFC in the IETF document stream. The specific
        change to RFC 3168 is to insert the words "Unless otherwise specified
        by an Experimental RFC in the IETF document stream" at the beginning
        of the second sentence quoted above.</t>
      </section>

      <section anchor="CMDifferences" title="Congestion Marking Differences">
        <t>Taken to its limit, an AQM algorithm that uses ECN congestion
        indications can be configured to maintain very shallow queues, thereby
        reducing network latency by comparison to maintaining a larger queue.
        Significantly more aggressive sender responses to ECN are needed to
        make effective use of such very shallow queues; <xref
        target="RFC8257">"Datacenter TCP (DCTCP)"</xref> provides an
        example. In this case, separate network node treatments are essential,
        both to prevent the aggressive low-latency traffic from starving
        conventional traffic (if present) and to prevent any conventional
        traffic disruption to any lower-latency service that uses the very
        shallow queues. Use of different ECN codepoints is a promising means
        of identifying these two classes of traffic to network nodes;
        hence, this area of experimentation is based on the use of the ECT(1)
        codepoint to request ECN congestion marking behavior in the network
        that differs from ECT(0). It is essential that any such change in ECN
        congestion marking behavior be counterbalanced by use of a different
        IETF-approved congestion response to CE marks at the sender, e.g., as
        proposed in <xref target="ECN-L4S"/>.</t>

        <t>Section 5 of RFC 3168 specifies that "Routers treat the ECT(0) and ECT(1) codepoints as equivalent."</t>

        <t>This memo updates RFC 3168 to allow routers to treat the
        ECT(0) and ECT(1) codepoints differently, provided that the changes
        from RFC 3168 are documented in an Experimental RFC in the IETF
        document stream. The specific change to RFC 3168 is to insert the
        words "unless otherwise specified by an Experimental RFC in the IETF
        document stream" at the end of the above sentence.</t>

        <t>When an AQM is configured to use ECN congestion indications to
        maintain a very shallow queue, congestion indications are marked on
        packets that would not have been dropped if ECN was not in use.
        Section 5 of RFC 3168 specifies that:<list style="empty">
            <t>For a router, the CE codepoint of an ECN-Capable packet SHOULD
            only be set if the router would otherwise have dropped the packet
            as an indication of congestion to the end nodes. When the router's
            buffer is not yet full and the router is prepared to drop a packet
            to inform end nodes of incipient congestion, the router should
            first check to see if the ECT codepoint is set in that packet's IP
            header. If so, then instead of dropping the packet, the router MAY
            instead set the CE codepoint in the IP header.</t>
          </list></t>

        <t>This memo updates RFC 3168 to allow congestion indications that are
        not equivalent to drops, provided that the changes from RFC 3168 are
        documented in an Experimental RFC in the IETF document stream. The
        specific change is to change "For a router" to "Unless otherwise
        specified by an Experimental RFC in the IETF document stream" at the
        beginning of the first sentence of the above paragraph.</t>

        <t>A larger update to RFC 3168 is necessary to enable sender usage of
        ECT(1) to request network congestion marking behavior that maintains
        very shallow queues at network nodes. When using loss as a congestion
        signal, the number of signals provided should be reduced to a minimum;
        hence, only the presence or absence of congestion is communicated. In
        contrast, ECN can provide a richer signal, e.g., to indicate the
        current level of congestion, without the disadvantage of a larger
        number of packet losses. A proposed experiment in this area, Low
        Latency Low Loss Scalable throughput <xref
        target="ECN-L4S">(L4S)</xref>, significantly
        increases the CE marking probability for traffic marked as ECT(1) in a
        fashion that would interact badly with existing sender congestion
        response functionality because that functionality assumes that the
        network marks ECT packets as frequently as it would drop Not-ECT
        packets. If network traffic that uses such a conventional sender
        congestion response were to encounter L4S's increased marking
        probability (and hence rate) at a network bottleneck queue, the
        resulting traffic throughput is likely to be much less than intended
        for the level of congestion at the bottleneck queue.</t>

        <t>This memo updates RFC 3168 to remove that interaction for ECT(1).
        The specific update to Section 5 of RFC 3168 is to replace the
        following two paragraphs:<list>
            <t>Senders are free to use either the ECT(0) or the ECT(1)
            codepoint to indicate ECT, on a packet-by-packet basis.</t>

            <t>The use of both the two codepoints for ECT, ECT(0) and ECT(1),
            is motivated primarily by the desire to allow mechanisms for the
            data sender to verify that network elements are not erasing the CE
            codepoint, and that data receivers are properly reporting to the
            sender the receipt of packets with the CE codepoint set, as
            required by the transport protocol. Guidelines for the senders and
            receivers to differentiate between the ECT(0) and ECT(1)
            codepoints will be addressed in separate documents, for each
            transport protocol. In particular, this document does not address
            mechanisms for TCP end-nodes to differentiate between the ECT(0)
            and ECT(1) codepoints. Protocols and senders that only require a
            single ECT codepoint SHOULD use ECT(0).</t>
          </list>with this paragraph:<list>
            <t>Protocols and senders MUST use the ECT(0) codepoint to indicate
            ECT unless otherwise specified by an Experimental RFC in the IETF
            document stream. Protocols and senders MUST NOT use the ECT(1)
            codepoint to indicate ECT unless otherwise specified by an
            Experimental RFC in the IETF document stream. Guidelines for
            senders and receivers to differentiate between the ECT(0) and
            ECT(1) codepoints will be addressed in separate documents, for
            each transport protocol. In particular, this document does not
            address mechanisms for TCP end-nodes to differentiate between the
            ECT(0) and ECT(1) codepoints.</t>
          </list></t>

        <t>Congestion Marking Differences experiments SHOULD modify the
        network behavior for traffic marked as ECT(1) rather than ECT(0)
        if network behavior for only one ECT codepoint is modified.
        Congestion Marking Differences experiments MUST NOT modify the network
        behavior for traffic marked as ECT(0) in a fashion that requires changes
        to the sender congestion response to obtain desired network behavior. If a
        Congestion Marking Differences experiment modifies the network
        behavior for traffic marked as ECT(1), e.g., CE-marking behavior, in a
        fashion that requires changes to the sender congestion response to obtain
        desired network behavior, then the Experimental RFC in the IETF
        document stream for that experiment MUST specify:<list style="symbols">
            <t>The sender congestion response to CE marking in the network,
            and</t>

            <t>Router behavior changes, or the absence thereof, in forwarding
            CE-marked packets that are part of the experiment.</t>
          </list></t>

        <t>In addition, this memo updates RFC 3168 to remove discussion of the
        ECN nonce, as noted in Section <xref format="counter"
        target="ECNNonce"/> above.</t>
      </section>

      <section anchor="TCPControl"
               title="TCP Control Packets and Retransmissions">
        <t>With the successful use of ECN for traffic in large portions of the
        Internet, there is interest in extending the benefits of ECN to TCP
        control packets (e.g., SYNs) and retransmitted packets, e.g., as
        proposed by <xref
        target="ECN-TCP">ECN++</xref>.</t>

        <t>RFC 3168 prohibits use of ECN for TCP control packets and
        retransmitted packets in a number of places:<list style="symbols">
            <t>Section 5.2: "To ensure the reliable delivery of the congestion indication
            of the CE codepoint, an ECT codepoint MUST NOT be set in a packet
            unless the loss of that packet in the network would be detected by
            the end nodes and interpreted as an indication of congestion."</t>

            <t>Section 6.1.1: "A host MUST NOT set ECT on SYN or SYN-ACK packets"</t>

            <t>Section 6.1.4: "...pure acknowledgement packets (e.g., packets that do not
            contain any accompanying data) MUST be sent with the not-ECT
            codepoint."</t>

            <t>Section 6.1.5: "This document specifies ECN-capable TCP implementations MUST
            NOT set either ECT codepoint (ECT(0) or ECT(1)) in the IP header
            for retransmitted data packets, and that the TCP data receiver
            SHOULD ignore the ECN field on arriving data packets that are
            outside of the receiver's current window."</t>

            <t>Section 6.1.6: "...the TCP data sender MUST NOT set either an ECT codepoint or
            the CWR bit on window probe packets.</t>
          </list></t>

        <t>This memo updates RFC 3168 to allow the use of ECT codepoints on
        SYN and SYN-ACK packets, pure acknowledgement packets, window probe
        packets, and retransmissions of packets that were originally sent with
        an ECT codepoint, provided that the changes from RFC 3168 are
        documented in an Experimental RFC in the IETF document stream. The
        specific change to RFC 3168 is to insert the words "unless otherwise
        specified by an Experimental RFC in the IETF document stream" at the
        end of each sentence quoted above.</t>

        <t>In addition, beyond requiring TCP senders not to set ECT on TCP
        control packets and retransmitted packets, RFC 3168 is silent on
        whether it is appropriate for a network element, e.g., a firewall, to
        discard such a packet as invalid. For this area of ECN experimentation
        to be useful, middleboxes ought not to do that; therefore, RFC 3168 is
        updated by adding the following text to the end of Section 6.1.1.1 on
        Middlebox Issues:</t>

        <t><list>
            <t>Unless otherwise specified by an Experimental RFC in the IETF
            document stream, middleboxes SHOULD NOT discard TCP control
            packets and retransmitted TCP packets solely because the ECN field
            in the IP header does not contain Not-ECT. An exception to this
            requirement occurs in responding to an attack that uses ECN
            codepoints other than Not-ECT. For example, as part of the
            response, it may be appropriate to drop ECT-marked TCP SYN packets
            with higher probability than TCP SYN packets marked with Not-ECT.
            Any such exceptional discarding of TCP control packets and
            retransmitted TCP packets in response to an attack MUST NOT be
            done routinely in the absence of an attack and SHOULD only be done
            if it is determined that the use of ECN is contributing to the
            attack.</t>
          </list></t>
      </section>
    </section>

    <section title="ECN for RTP Updates to RFC 6679">
      <t><xref target="RFC6679">RFC 6679</xref> specifies use of ECN for RTP
      traffic; it allows use of both the ECT(0) and ECT(1) codepoints and
      provides the following guidance on use of these codepoints in Section
      7.3.1:</t>
          <t><list><t>
          The sender SHOULD mark packets as ECT(0) unless the receiver
          expresses a preference for ECT(1) or for a random ECT value using
          the "ect" parameter in the "a=ecn-capable-rtp:" attribute.</t></list></t>
     
      <t>The Congestion Marking Differences area of experimentation increases
      the potential consequences of using ECT(1) instead of ECT(0); hence,
      the above guidance is updated by adding the following two sentences:</t>

      <t><list>
          <t>Random ECT values MUST NOT be used, as that may expose RTP to
          differences in network treatment of traffic marked with ECT(1) and
          ECT(0) and differences in associated endpoint congestion responses.
          In addition, ECT(0) MUST be used unless otherwise specified in an
          Experimental RFC in the IETF document stream.</t>
        </list>Section 7.3.3 of RFC 6679 specifies RTP's response to receipt
      of CE&nbhy;marked packets as being identical to the response to dropped
      packets:</t>

      <t><list>
          <t>The reception of RTP packets with ECN-CE marks in the IP header
          is a notification that congestion is being experienced. The default
          reaction on the reception of these ECN-CE-marked packets MUST be to
          provide the congestion control algorithm with a congestion
          notification that triggers the algorithm to react as if packet loss
          had occurred. There should be no difference in congestion response
          if ECN-CE marks or packet drops are detected.</t>

        </list>In support of Congestion Response Differences experimentation,
      this memo updates this text in a fashion similar to RFC 3168 to allow
      the RTP congestion control response to a CE-marked packet to differ from
      the response to a dropped packet, provided that the changes from RFC
      6679 are documented in an Experimental RFC in the IETF document stream.
      The specific change to RFC 6679 is to insert the words "Unless otherwise
      specified by an Experimental RFC in the IETF document stream" and
      reformat the last two sentences to be subject to that condition;
      that is:</t>

      <t><list>
          <t>The reception of RTP packets with ECN-CE marks in the IP header
          is a notification that congestion is being experienced. Unless
          otherwise specified by an Experimental RFC in the IETF document
          stream: <list style="symbols">
              <t>The default reaction on the reception of these ECN-CE-marked
              packets MUST be to provide the congestion control algorithm with
              a congestion notification that triggers the algorithm to react
              as if packet loss had occurred.</t>

              <t>There should be no difference in congestion response if
              ECN-CE marks or packet drops are detected.</t>
            </list></t>
        </list>The second sentence of the immediately following paragraph in
      Section 7.3.3 of RFC 6679 requires a related update:</t>

      <t><list> 
          <t>Other reactions to ECN-CE may be specified in the future,
          following IETF Review. Detailed designs of such alternative reactions
          MUST be specified in a Standards Track RFC and be reviewed to ensure
          they are safe for deployment under any restrictions specified.</t>
        </list>The update is to change "Standards Track RFC" to "Standards
      Track RFC or Experimental RFC in the IETF document stream" for
      consistency with the first update.</t>

    </section>

    <section title="ECN for DCCP Updates to RFCs 4341, 4342, and 5622">

      <t>The specifications of the three DCCP Congestion Control IDs (CCIDs),
      <xref target="RFC4341">2</xref>, <xref target="RFC4342">3</xref>, and
      <xref target="RFC5622">4</xref>, contain broadly the same wording as
      follows:
      <list><t>
          each DCCP-Data and DCCP-DataAck packet is sent as ECN Capable
          with either the ECT(0) or the ECT(1) codepoint set.</t>
        </list>This memo updates these sentences in each of the three RFCs as
      follows:<list>
          <t>each DCCP-Data and DCCP-DataAck packet is sent as ECN Capable.
          Unless otherwise specified by an Experimental RFC in the IETF
          document stream, such DCCP senders MUST set the ECT(0)
          codepoint.</t>
        </list>

      In support of Congestion Marking Differences experimentation
      (as noted in Section 3), this memo also updates all three of these RFCs
      to remove discussion of the ECN nonce. The specific text updates are
      omitted for brevity.</t>
    </section>

    <section anchor="IANA" title="IANA Considerations">
      <t>To reflect the reclassification of RFC 3540 as Historic, IANA 
      has updated the "Transmission Control Protocol (TCP) Header Flags"
      registry
      &lt;https://www.iana.org/assignments/tcp-header-flags&gt;
      to remove the registration of bit 7 as the NS (Nonce Sum) bit and add an
      annotation to the registry to state that bit 7 was used by Historic RFC
      3540 as the NS (Nonce Sum) bit but is now Reserved.</t>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t>As a process memo that only relaxes restrictions on experimentation,
      there are no protocol security considerations, as security
      considerations for any experiments that take advantage of the relaxed
      restrictions are discussed in the documents that propose the
      experiments.</t>

      <t>However, effective congestion control is crucial to the continued
      operation of the Internet; hence, this memo places the responsibility
      for not breaking Internet congestion control on the experiments and the
      experimenters who propose them. This responsibility includes the
      requirement to discuss congestion control implications in an Experimental RFC in the IETF document stream for each experiment, as stated in
      Section <xref format="counter" target="ECC"/>; review of that discussion
      by the IETF community and the IESG prior to RFC publication is intended
      to provide assurance that each experiment does not break Internet
      congestion control.</t>

      <t>See Appendix C.1 of <xref target="ECN-L4S"/> for
      discussion of alternatives to the ECN nonce.</t>
    </section>
  </middle>


  <back>

    <references title="Normative References">
      <?rfc include="reference.RFC.2119" ?>

      <?rfc include="reference.RFC.2914" ?>

      <?rfc include="reference.RFC.3168" ?>

      <?rfc include="reference.RFC.3540" ?>

      <?rfc include="reference.RFC.4341" ?>

      <?rfc include="reference.RFC.4342" ?>

      <?rfc include="reference.RFC.5622" ?>

      <?rfc include="reference.RFC.6679" ?>

      <?rfc include="reference.RFC.8174" ?>
    </references>

    <references title="Informative References">

<!--draft-ietf-tcpm-alternativebackoff-ecn-05; Active, I-D exists-->
<reference anchor='TCP-ABE'>
<front>
<title>TCP Alternative Backoff with ECN (ABE)</title>
<author initials='N' surname='Khademi' fullname='Naeem Khademi'>
    <organization />
</author>
<author initials='M' surname='Welzl' fullname='Michael Welzl'>
    <organization />
</author>
<author initials='G' surname='Armitage' fullname='Grenville Armitage'>
    <organization />
</author>
<author initials='G' surname='Fairhurst' fullname='Gorry Fairhurst'>
    <organization />
</author>
<date month='December' year='2017' />
</front>
<seriesInfo name='Work in Progress,' value='draft-ietf-tcpm-alternativebackoff-ecn-05' />
</reference>

<!--draft-khademi-tsvwg-ecn-response-01; Expired -->
<reference anchor='ECN-EXPERIMENT'>
<front>
<title>Updating the Explicit Congestion Notification (ECN) Specification to Allow IETF Experimentation</title>
<author initials='N' surname='Khademi' fullname='Naeem Khademi'>
    <organization />
</author>
<author initials='M' surname='Welzl' fullname='Michael Welzl'>
    <organization />
</author>
<author initials='G' surname='Armitage' fullname='Grenville Armitage'>
    <organization />
</author>
<author initials='G' surname='Fairhurst' fullname='Gorry Fairhurst'>
    <organization />
</author>
<date month='July' year='2016' />
</front>
<seriesInfo name='Work in Progress,' value='draft-khademi-tsvwg-ecn-response-01' />
</reference>

<!--draft-ietf-tsvwg-ecn-l4s-id-01; Active, I-D exists-->
<reference anchor='ECN-L4S'>
<front>
<title>Identifying Modified Explicit Congestion Notification (ECN) Semantics for Ultra-Low Queuing Delay</title>
<author initials='K' surname='Schepper' fullname='Koen Schepper'>
    <organization />
</author>
<author initials='B' surname='Briscoe' fullname='Bob Briscoe'>
    <organization />
</author>
<date month='October' year='2017' />
</front>
<seriesInfo name='Work in Progress,' value='draft-ietf-tsvwg-ecn-l4s-id-01' />
</reference>


<!--draft-bagnulo-tcpm-generalized-ecn-04 replaced by draft-ietf-tcpm-generalized-ecn-02; Active, I-D exists-->
<reference anchor='ECN-TCP'>
<front>
<title>ECN++: Adding Explicit Congestion Notification (ECN) to TCP Control Packets</title>
<author initials='M' surname='Bagnulo' fullname='Marcelo Bagnulo'>
    <organization />
</author>
<author initials='B' surname='Briscoe' fullname='Bob Briscoe'>
    <organization />
</author>
<date month='October' year='2017' />
</front>
<seriesInfo name='Work in Progress,' value='draft-ietf-tcpm-generalized-ecn-02' />
</reference>

<!--draft-ietf-trill-ecn-support-04; Active, I-D exists-->
<reference anchor='ECN-TRILL'>
<front>
<title>TRILL: ECN (Explicit Congestion Notification) Support</title>
<author initials='D' surname='Eastlake' fullname='Donald Eastlake'>
    <organization />
</author>
<author initials='B' surname='Briscoe' fullname='Bob Briscoe'>
    <organization />
</author>
<date month='November' year='2017' />
</front>
<seriesInfo name='Work in Progress,' value='draft-ietf-trill-ecn-support-04' />
</reference>


<!--draft-ietf-tsvwg-ecn-encap-guidelines-09; Active, I-D exists-->
<reference anchor='ECN-ENCAP'>
<front>
<title>Guidelines for Adding Congestion Notification to Protocols that Encapsulate IP</title>
<author initials='B' surname='Briscoe' fullname='Bob Briscoe'>
    <organization />
</author>
<author initials='J' surname='Kaippallimalil' fullname='John Kaippallimalil'>
    <organization />
</author>
<author initials='P' surname='Thaler' fullname='Patricia Thaler'>
    <organization />
</author>
<date month='July' year='2017' />
</front>
<seriesInfo name='Work in Progress,' value='draft-ietf-tsvwg-ecn-encap-guidelines-09' />
</reference>

<!--draft-ietf-tsvwg-rfc6040update-shim-05; Active, I-D exists-->
<reference anchor='ECN-SHIM'>
<front>
<title>Propagating Explicit Congestion Notification Across IP Tunnel Headers Separated by a Shim</title>
<author initials='B' surname='Briscoe' fullname='Bob Briscoe'>
    <organization />
</author>
<date month='November' year='2017' />
</front>
<seriesInfo name='Work in Progress,' value='draft-ietf-tsvwg-rfc6040update-shim-05' />
</reference>

      <?rfc include="reference.RFC.4774" ?>

      <?rfc include="reference.RFC.4844"?>

      <?rfc include="reference.RFC.5706"?>

      <?rfc include="reference.RFC.6040"?>

      <?rfc include="reference.RFC.6660"?>

      <?rfc include="reference.RFC.8257"?>

      <reference anchor="Trammell15" target="https://doi.org/10.1007/978-3-319-15509-8_15">
        <front>
          <title>Enabling Internet-Wide Deployment of Explicit Congestion
          Notification</title>
          <author initials="B." surname="Trammell">
            <organization/>
          </author>
          <author initials="M." surname="Kuehlewind">
            <organization/>
          </author>
          <author initials="D." surname="Boppart">
            <organization/>
          </author>
          <author initials="I." surname="Learmonth">
            <organization/>
          </author>
          <author initials="G." surname="Fairhurst">
            <organization/>
          </author>
          <author initials="R." surname="Scheffenegger">
            <organization/>
          </author>
          <date month="March" year="2015"/>
        </front>
        <seriesInfo name="In Conference Proceedings of Passive and Active Measurement (PAM)," value="pp. 193-205" />
      </reference>
    </references>
  <section anchor="Acknowledgements" title="Acknowledgements" numbered='no'>
      <t>The content of this specification, including the specific portions of RFC
      3168 that are updated, draws heavily from <xref
      target="ECN-EXPERIMENT"/>, whose authors are gratefully
      acknowledged. The authors of the documents describing the
      experiments have motivated the production of this memo -- their interest
      in innovation is welcome and heartily acknowledged. Colin Perkins
      suggested updating RFC 6679 on RTP and provided guidance on where to
      make the updates.</t>

      <t>This specification improved as a result of comments from a number of
      reviewers, including Ben Campbell, Brian Carpenter, Benoit Claise,
      Spencer Dawkins, Gorry Fairhurst, Sue Hares, Ingemar Johansson, Naeem
      Khademi, Mirja Kuehlewind, Karen Nielsen, Hilarie Orman, Eric Rescorla,
      Adam Roach, and Michael Welzl. Bob Briscoe's thorough review of multiple
      draft versions of this memo resulted in numerous improvements including
      addition of the updates to the DCCP RFCs.</t>
    </section>
  </back>
</rfc>

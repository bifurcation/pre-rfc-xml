<?xml version="1.0" encoding="US-ASCII"?>

<?rfc rfcedstyle="yes" ?>
<?rfc toc="yes" ?>
<?rfc subcompact="no" ?>
<?rfc sortrefs="yes" ?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd">


<rfc number="4980" category="info">


<!------------------------------------------------>
<!--  Front Section				-->
<!------------------------------------------------>

<front>

<title abbrev="Analysis of Multihoming in NEMO">
	Analysis of Multihoming in Network Mobility Support
</title>


<!-- AUTHORS -->
<author initials="C.W." surname="Ng" fullname="Chan-Wah Ng">
	<organization abbrev="Panasonic Singapore Labs">
		Panasonic Singapore Laboratories Pte Ltd
	</organization>
	<address>
 		<postal>
			<street>Blk 1022 Tai Seng Ave #06-3530</street>
			<street>Tai Seng Industrial Estate</street>
			<city>Singapore</city>
			<code>534415</code>
			<country>SG</country>
		</postal>
		<phone>+65 65505420</phone>
		<email>chanwah.ng@sg.panasonic.com</email>
	</address>
</author>

<author initials="T." surname="Ernst" fullname="Thierry Ernst">
	<organization abbrev="INRIA">
		INRIA	
	</organization>
	<address>
		<postal>
			<street>INRIA Rocquencourt</street>
			<street>Domaine de Voluceau B.P. 105</street>
			<code>78153</code><city>Le Chesnay</city>
			<country>France</country>
		</postal>
		<phone>+33-1-39-63-59-30</phone>
		<facsimile>+33-1-39-63-54-91</facsimile>
		<email>thierry.ernst@inria.fr</email>
		<uri>http://www.nautilus6.org/~thierry</uri>
	</address>
</author>

<author initials="E.K." surname="Paik" fullname="Eun Kyoung Paik">
	<organization abbrev="KT">
			KT	
	</organization>
	<address>
		<postal>
			<street>Portable Internet Team, Convergence Lab., KT </street>
			<street>17 Woomyeon-dong, Seocho-gu</street>
			<city>Seoul</city>
			<code>137-792</code>
			<country>Korea</country>
		</postal>
		<phone>+82-2-526-5233</phone>
		<facsimile>+82-2-526-5200</facsimile>
		<email>euna@kt.co.kr</email>
		<uri>http://mmlab.snu.ac.kr/~eun/</uri>
	</address>
</author>

<author initials="M.B." surname="Bagnulo" fullname="Marcelo Bagnulo">
	<organization abbrev="UC3M">
		Universidad Carlos III de Madrid
	</organization>
	<address>
 		<postal>
			<street>Av. Universidad, 30</street>
			<city>Leganes, Madrid</city>
			<code>28911</code>
			<country>Spain</country>
		</postal>
		<phone>+34 91624 8837</phone>
		<email>marcelo@it.uc3m.es</email>
	</address>
</author>

<date month="August" year="2007" />
<area>Internet</area>
<workgroup>NEMO Working Group</workgroup>


<abstract>

<t>

This document is an analysis of multihoming in the context of network
mobility (NEMO) in IPv6. As there are many situations in which mobile networks
may be multihomed, a taxonomy is proposed to classify the possible
configurations. The possible deployment scenarios of multihomed mobile
networks are described together with the associated issues when
network mobility is supported by RFC 3963 (NEMO Basic Support). Recommendations 
are offered on how to address these issues.  


</t>
</abstract>

</front>


<!------------------------------------------------>
<!--  Middle Section				-->
<!------------------------------------------------>

<middle>

<!------------------------------------------------>
<!--  SECTION 1: INTRODUCTION			-->
<!------------------------------------------------>

<section anchor="sec:intro"
	title="Introduction">

<t>
The design goals and objectives of Network Mobility (NEMO) Support in IPv6 are
identified in <xref target="RFC4886"/>, while the
terminology is described in <xref target="RFC3753"/> and <xref
target="RFC4885"/>. NEMO Basic Support (RFC 3963) <xref
target="RFC3963"/> is the solution proposed by the NEMO Working Group
to provide continuous Internet connectivity to nodes located in an IPv6
mobile network, e.g., like in an in-vehicle embedded IP network.
The NEMO Basic Support solution does so by setting
up bi-directional tunnels between the mobile routers (MRs) connecting
the mobile network (NEMO) to the Internet and their respective home agents
(HAs), much like how this is done in Mobile IPv6 <xref target="RFC3775"/>,
the solution for host mobility support. NEMO Basic Support is
transparent to nodes located behind the MR (i.e., the mobile
network nodes, or MNNs), and as such, does not require MNNs to take any
action in the mobility management.

</t><t>
However, mobile networks are typically connected by means of wireless and thus
less reliable links; there could also be many nodes behind the
MR. A loss of connectivity or a failure to connect to the Internet
has thus a more significant impact than for a single mobile node.
Scenarios illustrated in <xref
target="I-D.ietf-monami6-multihoming-motivation-scenario"/> demonstrate that
providing a permanent access to mobile networks typically require the
use of several interfaces and technologies.  For example, this
<!-- cwng@20070820: added -->is
particularly useful for Intelligent Transport Systems (ITS)
applications since vehicles are moving across distant geographical
locations.  Access would be provided through different access
technologies (e.g., Wimax, Wifi, 3G) and through different access operators.
<!-- cwng@20070820: remove -- OLD TEXT 
such as vehicles
typically require the use of several interfaces and technologies since
the mobile network may be moving in distant geographical locations
where different access technologies are provided and governed by
distinct access control policies.
-->

</t><t>

As specified in Section 5 of the NEMO Basic Support Requirements <xref
target="RFC4886"/> (R.12), the NEMO WG must ensure
that NEMO Basic Support does not prevent mobile networks to be
multihomed, i.e., when there is more than one point of attachment
between the mobile network and the Internet (see definitions in <xref
target="RFC4885"/>). This arises either:

<list style="symbols">

  <t>when an MR has multiple egress interfaces, or
  </t><t>the mobile network has multiple MRs, or
  </t><t>the mobile network is associated with multiple HAs, or
  </t><t>multiple global prefixes are available in the mobile network.
  </t>
</list>
</t><t>
Using NEMO Basic Support, this
would translate into having multiple bi-directional tunnels between
the MR(s) and the corresponding HA(s), and may result in multiple
Mobile Network Prefixes (MNPs) available
<?rfc needLines="10" ?>
to the MNNs.  However, NEMO Basic Support does not
specify any particular mechanism to manage multiple bi-directional
tunnels.  The objectives of this memo are thus multifold:

<list style="symbols">

<t>
to determine all the potential multihomed configurations
for a NEMO, and then to identify which of these may be
useful in a real-life scenario;

</t><t>

to capture issues that may prevent some multihomed configurations to
be supported under the operation of NEMO Basic Support.  It does not
necessarily mean that the ones not supported will not work with NEMO
Basic Support, as it may be up to the implementors to make it work
(hopefully this memo will be helpful to these implementors);

</t><t> 
to decide which issues are worth solving and to determine which WG is
the most appropriate to address these;

</t><t>
to identify potential solutions to the previously identified issues.

</t>
</list>

</t><t>

In order to reach these objectives, a taxonomy for classifying 
the possible multihomed
configurations is described in <xref
target="sec:classification"/>. Deployment scenarios, their benefits,
and requirements to meet these benefits are illustrated in <xref
target="sec:scenario-requirement"/>. Following this, the
related issues are studied in <xref target="sec:problem"/>.
The issues are then summarized in a matrix for each of the deployment
scenario, and recommendations are made on which of the issues
should be worked on and where in <xref target="sec:matrix"/>.
This memo concludes with an evaluation of NEMO Basic Support for multihomed
configurations.  Alternative classifications are outlined in the
Appendix.

</t><t> 
The readers should note that this document considers multihoming only
from the point of view of an IPv6 environment.  In order to understand
this memo, the reader is expected to be familiar with the above cited
documents, i.e., with the NEMO terminology as defined in <xref
target="RFC3753"/> (Section 3) and <xref
target="RFC4885"/>, Motivations and Scenarios for
Multihoming <xref
target="I-D.ietf-monami6-multihoming-motivation-scenario"/>, Goals and
Requirements of Network Mobility Support <xref
target="RFC4886"/>, and the NEMO Basic Support
specification <xref target="RFC3963"/>.  Goals and benefits of
multihoming as discussed in <xref
target="I-D.ietf-monami6-multihoming-motivation-scenario"/>, are
applicable to fixed nodes, mobile nodes, fixed networks, and mobile
networks.
</t>


</section> <!-- Intro.Organization -->



<!------------------------------------------------>
<!--  SECTION 2: CLASSIFICATIONS		-->
<!------------------------------------------------>

<section anchor="sec:classification"
	title="Classification">

<t>
As there are several configurations in which mobile networks are
multihomed, there is a need to classify them into a clearly defined
taxonomy.  This can be done in various ways.  A Configuration-Oriented
taxonomy is described in this section. Two other taxonomies,
namely, the Ownership-Oriented Approach and the Problem-Oriented
Approach, are outlined in <xref target="sec:alt-class.ownership"/>
and <xref target="sec:alt-class.problem"/>.
</t>

<?rfc needLines="5" ?>
<t>
Multihomed configurations can be classified depending on how many
MRs are present, how many egress interfaces, Care-of Address (CoA), and Home
Addresses (HoA) the MRs have, how many prefixes (MNPs) are
available to the mobile network nodes, etc. We use
three key parameters to differentiate the multihomed
configurations.  Using these parameters, each
configuration is referred by the 3-tuple (x,y,z), where 'x', 'y', 'z' are defined
as follows:

<!-- Explain 'x' -->

<list style="symbols">

<t>
'x' indicates the number of MRs where:

  <list style="hanging">

  <t hangText="x=1">
  implies that a mobile network has only a single MR, presumably
  multihomed.
  </t>

  <t hangText="x=n">
  implies that a mobile network has more than one MR.
   </t>

</list>
<!-- vspace blankLines='1'/ -->
</t>

<!-- Explain 'y' -->

<t>
'y' indicates the number of HAs associated with the entire mobile network,
where:

<list style="hanging">

<t hangText="y=1">
implies that a single HA is assigned to the mobile network.
</t>

<t hangText="y=n">

implies that multiple HAs are assigned to the mobile network.


</t>

</list>
<!-- vspace blankLines='1'/ -->
</t>

<!-- Explain 'z' -->

<t>
'z' indicates the number of MNPs available within the NEMO, where:

<list style="hanging">
<t hangText="z=1">
implies that a single MNP is available in the NEMO.

</t>

<t hangText="z=N">
implies that multiple MNPs are available in the NEMO.

</t>
</list>
<!-- vspace blankLines='1'/ -->
</t>

</list> <!-- outer list -->
</t><t>

It can be seen that the above three parameters are fairly orthogonal
with one another.  Thus, different values of 'x', 'y', and 'z' result
in different combinations of the 3-tuple (x,y,z).

</t><t>

  As will be described in the sub-sections below, a total of 8 possible
  configurations can be identified.
  One thing the reader has to keep in mind is that in each of the
  following 8 cases, the MR may be multihomed if either (i)
  multiple prefixes are available (on the home link, or
  on the foreign link), or (ii) the MR is
  equipped with multiple interfaces. In such a case, the MR would have
  multiple (HoA,CoA) pairs. Issues
  pertaining to a multihomed MR are also addressed in
  <xref target="I-D.multihoming-mip6"></xref>.

  In addition, the readers should also keep in mind that when "MNP(s) is/are
  available in the NEMO", the MNP(s) may either be explicitly announced
  by the MR via router advertisement, or made available through Dynamic
  Host Configuration Protocol (DHCP) <xref target="RFC3315" />.
</t>


<!------------------------------------------------>
<!-- SECTION 2.1: (1,1,1)			-->
<!------------------------------------------------>

<section anchor="sec:class.(1,1,1)"
	title="(1,1,1): Single MR, Single HA, Single MNP">

<t>
The (1,1,1) configuration has only one MR, it is associated with a
single HA, and a single MNP is available in the NEMO. The MR and the
AR are connected to the Internet via a single Access Router (AR). To fall into a
multihomed configuration, at least one of the following conditions
must hold:
</t>
<list style="symbols">
<t>The MR has multiple interfaces and thus it has multiple CoAs;</t>

<t>Multiple global prefixes are available on the foreign link, 
and thus it has multiple CoAs; or</t>

<t>Multiple global prefixes are available on the home link, 
and thus the MR has more than one path to reach the HA.
</t>

</list>

<t>
Note that the case where multiple prefixes are available on 
the foreign link does not have any bearing on the MNPs.
MNPs are independent of prefixes available on the link where 
the MR is attached to, thus prefixes available on the foreign link 
are not announced on the NEMO link.   For the case where multiple
prefixes are available on the home link, these are only announced 
on the NEMO link if the MR is configured to do so.  In the present (1,1,1) configuration,
only one MNP is announced.
</t>

<t>
A bi-directional tunnel would then be established between each
(HoA,CoA) pair.

</t><t>
Regarding MNNs, they are (usually) not multihomed since they would
configure a single global address from the single MNP available on the
link they are attached to.
</t>

<figure anchor="fig:(1,1,1)"
	title="(1,1,1): 1 MR, 1 HA, 1 MNP">
<artwork><![CDATA[
                                _____
                _    p      _  |     |
               |_|-|<-_  |-|_|-|     |-|        _
                _  |-|_|=|     |_____| |  _  |-|_|
               |_|-|     |             |-|_|-|
                                             |
               MNNs   MR   AR  Internet   AR    HA
]]></artwork>
</figure>

</section> <!-- (1,1,1) -->

<!------------------------------------------------>
<!--  SECTION 2.2: (1,1,N)			-->
<!------------------------------------------------>

<section anchor="sec:class.(1,1,n)"
	title="(1,1,n): Single MR, Single HA, Multiple MNPs">

<t>
The (1,1,n) configuration has only one MR, it is associated with a
single HA, and two or more MNPs are available in the NEMO.

<?rfc needLines="8" ?>
</t><t>The MR may itself be multihomed, as detailed in <xref
target="sec:class.(1,1,1)"/>. In such a case, a bi-directional tunnel
would be established between each (HoA,CoA) pair.

</t><t>
Regarding MNNs, they are multihomed because several MNPs are available
on the link they are attached to. The MNNs would then configure a
global address from each MNP available on the link.
</t>

<!-- vspace blankLines='5'/ -->
<figure anchor="fig:(1,1,n)"
	title="(1,1,n): 1 MR, 1 HA, multiple MNPs">
<artwork><![CDATA[
                                _____
                _   p1,p2   _  |     |
               |_|-|<-_  |-|_|-|     |-|        _
                _  |-|_|=|     |_____| |  _  |-|_|
               |_|-|     |             |-|_|-|
                                             |
               MNNs   MR   AR  Internet   AR    HA
]]></artwork>
</figure>

</section> <!-- (1,1,N) -->


<!------------------------------------------------>
<!--  SECTION 2.3: (1,N,1)			-->
<!------------------------------------------------>

<section anchor="sec:class.(1,n,1)"
	title="(1,n,1): Single MR, Multiple HAs, Single MNP">

<t>

The (1,n,1) configuration has only one MR and a single MNP is
available in the NEMO.  The MR, however, is associated with multiple
HAs.

<!-- 070202 Removed "possibly one HA per HoA, or one HA per egress
interface.-->

</t><t>
The NEMO is multihomed since it has multiple HAs, but in addition, the
conditions detailed in <xref target="sec:class.(1,1,1)"/> may also
hold for the MR. A bi-directional tunnel would then be established
between each (HoA,CoA) pair.

</t><t>
Regarding MNNs, they are (usually) not multihomed since they would
configure a single global address from the single MNP available on the
link they are attached to.
</t>

<!-- vspace blankLines='5'/ -->
<figure anchor="fig:(1,n,1)"
	title="(1,n,1): 1 MR, multiple HAs, 1 MNP">
<artwork><![CDATA[
                                       AR    HA2
                                        _  |
                                     |-|_|-|  _
                              _____  |     |-|_|
              _    p      _  |     |-|
             |_|-|<-_  |-|_|-|     |
              _  |-|_|=|     |_____|-|        _
             |_|-|     |             |  _  |-|_|
                                     |-|_|-|
                                           |
             MNNs  MR    AR  Internet  AR    HA1
]]></artwork>
</figure>

</section> <!-- (1,N,1) -->


<!------------------------------------------------>
<!--  SECTION 2.4: (1,N,N)			-->
<!------------------------------------------------>

<section anchor="class.(1,n,n)"
	title="(1,n,n): Single MR, Multiple HAs, Multiple MNPs">

<t>

The (1,n,n) configuration has only one MR.  However, the MR is
associated with multiple HAs and more than one MNP is available in the
NEMO.

<!-- 070202 Removed ", possibly one per Home Address (or one HA per
egress interface),"-->

</t><t>
The MR is multihomed since it has multiple HAs, but in addition, the
conditions detailed in <xref target="sec:class.(1,1,1)"/> may also
hold. A bi-directional tunnel would then be established between each 
(HoA,CoA) pair.

</t><t>
Regarding MNNs, they are multihomed because several MNPs are available
on the link they are attached to. The MNNs would then configure a
global address with each MNP available on the link.

</t>

<figure anchor="fig:(1,n,n)"
	title="(1,n,n): 1 MR, multiple HAs, multiple MNPs">
<artwork><![CDATA[
                                      AR    HA2
                                       _  |  _
                             _____  |-|_|-|-|_|
             _   p1,p2   _  |     |-|     |
            |_|-|<-_  |-|_|-|     |          _
             _  |-|_|=|     |_____|-|  _  |-|_|
            |_|-|     |             |-|_|-|
                                    |     |
            MNNs  MR    AR  Internet  AR    HA1
]]></artwork>
</figure>

</section> <!-- (1,N,N) -->

<!------------------------------------------------>
<!--  SECTION 2.5: (N,1,1)			-->
<!------------------------------------------------>

<section anchor="sec:class.(n,1,1)"
	title="(n,1,1): Multiple MRs, Single HA, Single MNP">

<t>
The (n,1,1) configuration has more than one MR advertising global
routes.  However, the MR(s) are associated with a single HA, and
there is a single MNP available in the NEMO.
<!-- [rfced] Please clarify the sentence above.  "and therefore in a
single..."?  "and there is a single..."?  -->
<!-- cwng@20070820: "in" -> "is", changed  -->
</t><t>
The NEMO is multihomed since it has multiple MRs, but in addition the
conditions detailed in <xref target="sec:class.(1,1,1)"/> may also
hold for each MR. A bi-directional tunnel would then be established
between each (HoA,CoA) pair.

</t><t>
Regarding MNNs, they are (usually) not multihomed since they would
configure a single global address from the single MNP available on the
link they are attached to.
</t>

<figure anchor="fig:(n,1,1)"
	title="(n,1,1): Multiple MRs, 1 HA, 1 MNP">
<artwork><![CDATA[
                     MR2
                   p<-_  |
                _  |-|_|-|  _____
               |_|-|     |-|     |
                _  |       |     |-|        _
               |_|-|  _  |-|_____| |  _  |-|_|
                   |-|_|-|         |-|_|-|
                   p<-   |               |
               MNNs  MR1   Internet   AR    HA
]]></artwork>
</figure>

</section> <!-- (N,1,1) -->

<!------------------------------------------------>
<!--  SECTION 2.6: (n,1,n)			-->
<!------------------------------------------------>

<section anchor="sec:class.(n,1,n)"
	title="(n,1,n): Multiple MRs, Single HA, Multiple MNPs">

<t>
The (n,1,n) configuration has more than one MR; multiple global
routes are advertised by the MRs and multiple MNPs are available
within the NEMO.

</t><t>
The NEMO is multihomed since it has multiple MRs, but in addition, the
conditions detailed in <xref target="sec:class.(1,1,1)"/> may also
hold for each MR. A bi-directional tunnel would then be established between each
(HoA,CoA) pair.

</t><t>
Regarding MNNs, they are multihomed because several MNPs are available
on the link they are attached to. The MNNs would then configure a
global address with each MNP available on the link.

</t>

<!-- vspace blankLines='5'/ --> <!-- force page break -->

<figure anchor="fig:(n,1,n)"
	title="(n,1,n): Multiple MRs, 1 HA, multiple MNPs">
<artwork><![CDATA[
                     MR2
                  p2<-_  |
                _  |-|_|-|  _____
               |_|-|     |-|     |
                _  |       |     |-|        _
               |_|-|  _  |-|_____| |  _  |-|_|
                   |-|_|-|         |-|_|-|
                  p1<-   |               |
               MNNs  MR1   Internet   AR    HA
]]></artwork>
</figure>

</section> <!-- (N,1,N) -->

<!------------------------------------------------>
<!--  SECTION 2.7: (N,N,1)			-->
<!------------------------------------------------>

<section anchor="sec:class.(n,n,1)"
	title="(n,n,1): Multiple MRs, Multiple HAs, Single MNP">

<t>
The (n,n,1) configuration has more than one MR advertising multiple
global routes.  The mobile network is simultaneously associated with
multiple HAs and a single MNP is available in the NEMO.

<?rfc needLines="8" ?>
</t><t>
The NEMO is multihomed since it has multiple MRs and HAs, but in
addition, the conditions detailed in <xref target="sec:class.(1,1,1)"/>
may also hold for each MR. A bi-directional tunnel would then be
established between each (HoA,CoA) pair.

</t><t>
Regarding MNNs, they are (usually) not multihomed since they would
configure a single global address from the single MNP available on the
link they are attached to.
</t>

<figure anchor="fig:(n,n,1)"
	title="(n,n,1): Multiple MRs, Multiple HAs, 1 MNP">
<artwork><![CDATA[
                     MR2             AR    HA2
                     p                _  |
                    <-_  |         |-|_|-|  _
                _  |-|_|-|  _____  |     |-|_|
               |_|-|     |-|     |-|
                _  |       |     |
               |_|-|  _  |-|_____|-|        _
                   |-|_|-|         |  _  |-|_|
                    <-   |         |-|_|-|
                     p                   |
               MNNs  MR1   Internet  AR    HA1
]]></artwork>
</figure>

</section> <!-- (N,N,1) -->

<!------------------------------------------------>
<!--  SECTION 2.8: (N,N,N)			-->
<!------------------------------------------------>

<section anchor="sec:class.(n,n,n)"
	title="(n,n,n): Multiple MRs, Multiple HAs, Multiple MNPs">

<t>
The (n,n,n) configuration has multiple MRs advertising different
global routes. The mobile network is simultaneously associated with more than one HA and multiple MNPs are available in the NEMO.

</t><t>
The NEMO is multihomed since it has multiple MRs and HAs, but in
addition, the conditions detailed in <xref target="sec:class.(1,1,1)"/>
may also hold for each MR. A bi-directional tunnel would then be
established between each (HoA,CoA) pair.

</t><t>
Regarding MNNs, they are multihomed because several MNPs are available
on the link they are attached to. The MNNs would then configure a
global address with each MNP available on the link.
</t>

<figure anchor="fig:(n,n,n)"
	title="(n,n,n): Multiple MRs, HAs, and MNPs">
<artwork><![CDATA[
                     MR2             AR    HA2
                     p2               _  |
                    <-_  |         |-|_|-|  _
                _  |-|_|-|  _____  |     |-|_|
               |_|-|     |-|     |-|
                _  |       |     |
               |_|-|  _  |-|_____|-|        _
                   |-|_|-|         |  _  |-|_|
                    <-   |         |-|_|-|
                     p1                  |
               MNNs  MR1   Internet  AR    HA1
]]></artwork>
</figure>

</section> <!-- (N,N,N) -->

<!-- /section> <!-- Class.Config -->

</section> <!-- Classification -->

<!------------------------------------------------>
<!--  SECTION 3: DEPLOYMENT SCENARIOS       	-->
<!------------------------------------------------>

<section anchor="sec:scenario-requirement" title="Deployment Scenarios and Prerequisites">

<t>
The following generic goals and benefits of multihoming are discussed
in <xref target="I-D.ietf-monami6-multihoming-motivation-scenario"/>:

<list style="numbers">
        <t>Permanent and Ubiquitous Access</t>
	<t>Reliability</t>
	<t>Load Sharing</t>
        <t>Load Balancing/Flow Distribution</t>
	<t>Preference Settings</t>
        <t>Aggregate Bandwidth</t>
</list>

</t><t>
These benefits are now illustrated from a NEMO perspective with a
typical instance scenario for each case in the taxonomy. We then
discuss the prerequisites to fulfill these.

</t>

<!-------------------------------------------------------->
<!--  SUBSECTION: REQUIREMENTS				-->
<!-------------------------------------------------------->
<section anchor="sec:scenario" title="Deployment Scenarios">

<t>
	
<list style="hanging">
	<t hangText="x=1: Multihomed mobile networks with a single MR">
        <list style="hanging">
             <t hangText="o Example 1:"><vspace blankLines="1"/>

		MR with dual/multiple access interfaces (e.g., 802.11
		and GPRS capabilities).  This is a (1,1,*) if
		a single HA is used for both.  If two
		independent HAs are used, this is a
		(1,n,n) configuration.
<vspace blankLines="1"/>

		Benefits: Ubiquitous Access, Reliability, Load
		Sharing, Preference Settings, Aggregate Bandwidth.

             </t>
	</list>

	</t>
	<!-- cwng@20070820: changed "N" to "n" -->
	<t hangText="x=n: Multihomed mobile networks with multiple MRs">
	<list style="hanging">
             <t hangText="o Example 1:"><vspace blankLines="1"/>

		Train with one MR in each car, all served by the same
		HA, thus a (n,1,*) configuration.  Alternatively, the
		train company might use different HAs, in different countries, thus a
		(n,n,n) configuration.
		
             <vspace blankLines="1"/>

		Benefits: Ubiquitous Access, Reliability, Load
		Sharing, Aggregate Bandwidth.

             </t>
	     
	     <t hangText="o Example 2:"><vspace blankLines="1"/>

		Wireless personal area network with a GPRS-enabled phone and a WiFi-enabled
		PDA. This is a (n,n,n) configuration if different HAs are also used.

		<vspace blankLines="1"/>

		Benefits: Ubiquitous Access, Reliability, Preference
		Settings, Aggregate Bandwidth.

		</t>
	</list>
	</t>
	<t hangText="y=1: Multihomed mobile networks with a single HA">
	<list style="hanging">
		<t hangText="o Example:"><vspace blankLines="1"/>

		<!-- cwng@20070820: IESG-LC made the change from ISP to HA in the above, 
		                    so this must be changed as well -->
                Most single HA cases in above examples.

		</t>
	</list>
	</t>
	<t hangText="y=n: Multihomed mobile networks with multiple HAs">
	<list style="hanging">
             <t hangText="o Example 1:"><vspace blankLines="1"/>

                Most multiple HAs cases in above examples.
		
             </t>
	     
	     <t hangText="o Example 2:"><vspace blankLines="1"/>

		Transatlantic flight with a HA in each continent.
		This is a (1,n,1) configuration if there is only one MR.

	     <vspace blankLines="1"/>

		Benefits: Ubiquitous Access, Reliability, Preference
		Settings (reduced delay, shortest path).

	     </t>
	</list>
	</t>
	<t hangText="z=1: Multihomed mobile networks with a single MNP">
	<list style="hanging">
		<t hangText="o Example:"><vspace blankLines="1"/>

		Most single HA cases in above examples.
		</t>
	</list>
	</t>
	<t hangText="z=n: Multihomed mobile networks with multiple MNPs">
	<list style="hanging">
		<t hangText="o Example 1:"><vspace blankLines="1"/>

		Most multiple HAs cases in above examples.
		
                
		</t>
                
                <t hangText="o Example 2:"><vspace blankLines="1"/>

                Car with a prefix taken from home (personal
                traffic is transmitted using this prefix and is paid by the
                owner) and one that belongs to the car manufacturer
                (maintenance traffic is paid by the car manufacturer).
                This will typically be a (1,1,n) or a (1,n,n,) configuration.

		<vspace blankLines="1"/>

		Benefits: Preference Settings

		</t>
	</list>
	</t>
</list>
</t>

</section> <!-- Scenario -->

<!-------------------------------------------------------->
<!--  SUBSECTION 3.2: PREREQUISITES				-->
<!-------------------------------------------------------->

<section anchor="sec:requirement" title="Prerequisites">

<t>In this section, requirements are stated in order to
comply with the expected benefits of multihoming as detailed in <xref
target="I-D.ietf-monami6-multihoming-motivation-scenario"/>.</t>

<t>
At least one bi-directional tunnel must be available at any point in
time between the mobile network and the fixed network to meet all
expectations. But for most goals to be effective, multiple tunnels
must be maintained simultaneously:

<list style="symbols">

   <t>Permanent and Ubiquitous Access:

   <vspace blankLines="1" />

   At least one bi-directional tunnel must be available at any point
   in time.

   </t><t>

   Reliability:

   <vspace blankLines="1" />

   Both the inbound and outbound traffic must be transmitted or
   diverted over another bi-directional tunnel once a
   bi-directional tunnel is broken or disrupted. It should be noted that the
   provision of fault tolerance capabilities does not necessarily require the
   existence of multiple bi-directional tunnels simultaneously.
   
   </t><t>

   Load Sharing and Load Balancing:

   <vspace blankLines="1" />

   Multiple tunnels must be maintained simultaneously.

   </t><t>

   Preference Settings:

   <vspace blankLines="1" />

       Implicitly, multiple tunnels must be maintained simultaneously if
       preferences are set for deciding which of the available
       bi-directional tunnels should be used.  To allow user/application
       to set the preference, a mechanism should be provided to the
       user/application for the notification of the availability of
       multiple bi-directional tunnels, and perhaps also to set
       preferences.  A similar mechanism should also be provided to network
       administrators to manage preferences.

    </t><t>

    Aggregate Bandwidth:

    <vspace blankLines="1" />
	
	Multiple tunnels must be maintained simultaneously in order to
	increase the total aggregated bandwidth available to the
	mobile network.
    </t>
  </list>
  </t>
</section><!-- Prerequisites -->
</section> <!-- Scenarios and Prerequisites -->
<!-------------------------------------------------------->
<!-- SECTION 4: PROBLEM STATEMENT(2004.1.28. Eun Kyoung)-->
<!-------------------------------------------------------->
<section anchor="sec:problem"
	title="Multihoming Issues">

<t>
   As discussed in the previous section, multiple bi-directional
   tunnels need to be maintained either sequentially (e.g., for fault
   tolerance) or simultaneously (e.g., for load sharing).

</t><t>
   In some cases, it may be necessary to divert packets from a (perhaps
   failed) bi-directional tunnel to an alternative (perhaps newly
   established) bi-directional tunnel (i.e., for matters of fault
   recovery, preferences), or to split traffic between multiple tunnels
   (load sharing, load balancing).

</t><t>
   So, depending on the configuration under consideration, the issues
   discussed below may need to be addressed
   sometimes dynamically.  For each issue, potential
   ways to solve the problem are investigated.
</t>

<!-------------------------------------------------------->
<!--  SECTION 4.1: Fault Tolerance                      -->
<!-- was "Path Survival", change proposed by Marcelo    -->
<!-------------------------------------------------------->

<section anchor="sec:problem.path-survival"
	title="Fault Tolerance">

<t>
One of the goals of multihoming is the provision of fault tolerance
capabilities. In order to provide such features, a set of tasks need
to be performed, including: failure detection, alternative available
path exploration, path selection, and re-homing of established
communications.
These are also discussed in <xref target="I-D.ietf-shim6-failure-detection"/> by the Shim6 WG.
In the following sub-sections, we look at these issues in the specific
context of NEMO, rather than the general Shim6 perspective in
<xref target="I-D.ietf-shim6-failure-detection"/>.
In addition, in some scenarios, it may also be
required to provide the mechanisms for coordination between different
HAs (see <xref target="sec:problem.hasync"/>) and
also the coordination between different MRs
(see <xref target="sec:problem.mrsync"/>).
</t>


<!-------------------------------------------------------->
<!--  SECTION 4.1.1: Failure Detection			-->
<!-------------------------------------------------------->
<?rfc needLines="8" ?>
<section anchor="sec:problem.failure-detect"
	title="Failure Detection">

<t>
  It is expected for faults to occur more readily at the edge of the
  network (i.e., the mobile nodes) due to the use of wireless
  connections. Efficient fault detection mechanisms are necessary to
  recover in timely fashion.

</t><t>

  Depending on the NEMO configuration considered, the failure
  protection domain greatly varies. In some configurations, the
  protection domain provided by NEMO multihoming is limited to the
  links between the MR(s) and the HA(s).  In other configurations, the
  protection domain allows to recover from failures in other parts of
  the path, so an end-to-end failure detection mechanism is required.

</t><t>

The failure detection capabilities required for each configuration are
detailed below:

<list style="symbols">
<t>

For the (1,1,*) cases, multiple paths are available between a single MR
and a single HA.  All the traffic to and from the NEMO flows through
the MR and HA.  Failure detection mechanisms need only to be executed
between these two devices.  This is a NEMO-/MIPv6-specific issue.

</t><t>

For the (n,1,*) cases, there is a single HA, so all the traffic to and
from the NEMO will flow through it.  The failure detection mechanisms need
to be able to detect failure in the path between the used MR and the only
HA.  Hence, the failure detection mechanism needs only to involve the HA
and the MRs.  This is a NEMO/MIPv6 specific issue.

</t><t>

For the (n,n,*) cases, there are multiple paths between the different
HAs and the different MRs.  Moreover, the HAs may be located in
different networks, and have different Internet access links.  This
implies that changing the HA used may not only allow recovering from
failures in the link between the HA and the MR, but also from other
failure modes, affecting other parts of the path.  In this case, an
end-to-end failure detection mechanism would provide additional
protection.  However, a higher number of failures is likely to occur
in the link between the HA and the MR, so it may be reasonable to
provide optimized failure detection mechanisms for this failure
mode. The (n,n,n) case is hybrid, since selecting a different prefix
results in a change of path. For this case, the Shim6 protocols (such
as those discussed in <xref
target="I-D.ietf-shim6-failure-detection"/>) may be useful.

<!-- 0702 Text was: 
The (n,n,1) case, however, seems to be pretty NEMO specific, because
of the absence of multiple prefixes.  The (n,n,n) case is hybrid,
since for these cases when selecting a different prefix results in a
change of path, the Shim6 protocols (such as those discussed in <xref
target="I-D.ietf-shim6-failure-detection"/>) may be useful. The other
cases are NEMO specific.
-->

</t>

</list></t>

<t>
Most of the above cases involve the detection of tunnel failures between
HA(s) and MR(s).  This is no different from the case of failure detection
between a mobile host and its HA(s).  As such, a solution 
for MIPv6 should apply to NEMO as well.  For case (n,*,*), an MR
synchronization solution (see <xref target="sec:problem.mrsync"/>)
should be able to complement a MIPv6 failure detection
solution to achieve the desired functionality for NEMO.
</t>

<t>
In order for fault recovery to work, the MRs and HAs must first
possess a means to detect failures:


<list style="symbols">
<t>
On the MR's side, the MR can rely on router advertisements from
access routers, or other layer-2 trigger mechanisms to detect faults,
e.g., <xref target="I-D.ietf-dna-link-information"/> and
<xref target="I-D.ietf-dna-protocol"/>.

<!-- 0701 Replaced dna-host with dna-protocol -->

<!-- 0701 Replaced the following 2
target="I-D.yegin-dna-l2-hints"
target="I-D.manyfolks-l2-mobilereq"
-->

</t><t>
On the HA's side, it is more difficult to detect tunnel failures.
For an ISP deployment model, the HAs and MRs can use
proprietary methods (such as constant transmission of heartbeat signals) to
detect failures and check tunnel liveness.  In the subscriber model
(see <xref target="sec:alt-class.problem"/>: S/P model), a lack of
standardized "tunnel liveness" protocol means that it is harder to detect failures.

  </t>
</list>

</t><t>
A possible method is for the MRs to send binding updates more regularly
with shorter Lifetime values.  Similarly, HAs can return binding
acknowledgment messages with smaller Lifetime values, thus forcing the
MRs to send binding updates more frequently.  These binding updates can
be used to emulate "tunnel heartbeats".  This, however, may lead to more traffic
and processing overhead, since binding updates sent to HAs must be protected
(and possibly encrypted) with security associations.


</t>

</section> <!-- Failure Detection -->
<!-------------------------------------------------------->
<!--  SECTION 4.1.2: Path Exploration			-->
<!-------------------------------------------------------->

<section anchor="sec:problem.path-explore"
	title="Path Exploration">

<t>
Once a failure in the currently used path is detected, alternative
paths have to be explored in order to identify an available one.  This
process is closely related to failure detection in the sense that
paths being explored need to be alternative paths to the one that has
failed.
There are, however, subtle but significant differences between path
exploration and failure detection.  Failure detection occurs on the
currently used path while path exploration occurs on the alternative paths
(not on the one currently being used for exchanging packets).
Although both path exploration and failure detection are likely to
rely on a reachability or keepalive test exchange,
failure detection also relies on other information,
such as upper layer information (e.g., positive or negative feedback from TCP),
lower layer information (e.g., an interface is down), and
network layer information (e.g., as an address being deprecated
or ICMP error message).

</t>
<?rfc needLines="5" ?>
<t>
Basically, the same cases as in the analysis of the failure detection
(<xref target="sec:problem.failure-detect"/>) issue are
identified:

<list style="symbols">
  <t>
For the (1,1,*) cases, multiple paths are available between a single MR
and a single HA.  The existing paths between the HA and the MR have to
be explored to identify an available one.  The mechanism involves only
the HA and the MR.  This is a NEMO-/MIPv6-specific issue.

  </t><t>
For the (n,1,*) cases, there is a single HA, so all the traffic to and
from the NEMO will flow through it.  The available alternative paths are
the different ones between the different MRs and the HA.  The path-exploration mechanism only involves the HA
and the MRs.  This is a NEMO/MIPv6 specific issue.

  </t><t>
For the (n,n,*) cases, there are multiple paths between the different HAs
and the different MRs.  In this case, alternative paths may be routed
completely independent from one another.
An end-to-end
path-exploration mechanism would be able to discover if any of the 
end-to-end paths is available.   The (n,n,1)
case, however, seems to be pretty NEMO specific, because of the absence of
multiple prefixes. 
The (n,n,n) case is hybrid, since selecting a different prefix results
in a change of path. For this case, the Shim6 protocols (such as
those discussed in <xref target="I-D.ietf-shim6-failure-detection"/>)
may be useful.
<!-- 0702 Text was: The (n,n,n) case is hybrid, since for these cases
that selecting a different prefix results in a change of path, the
Shim6 protocols (such as <xref
target="I-D.ietf-shim6-failure-detection"/>) may be useful.  The other
cases are NEMO specific.-->

  </t>
</list>
Most of the above cases involve the path exploration of tunnels between
HA(s) and MR(s).  This is no different from the case of path exploration
between a mobile host and its HA(s).  As such, a solution 
for MIPv6 should apply to NEMO as well.  For case (n,*,*), an MR
synchronization solution (see <xref target="sec:problem.mrsync"/>)
should be able to complement an MIPv6 path-exploration
solution to achieve the desired functionality for NEMO.
</t>

<t>
In order to perform path exploration, it is sometimes also necessary
for the MR to detect the availability of network media.  
This may be achieved using layer 2 triggers
<xref target="I-D.ietf-dna-link-information"/>, or other mechanism
developed/recommended by the Detecting Network Attachment (DNA) Working Group
<xref target="I-D.ietf-dna-protocol"/>.
<!-- target I-D.ietf-dna-hosts & I-D.ietf-dna-routers replaced with
dna-protocol-->
This is related to <xref target="sec:problem.failure-detect"/>, since
the ability to detect media availability would often imply the
ability to detect media unavailability.
</t>


</section> <!-- Path Exploration -->



<!------------------------------------------------------>
<!--  SECTION 4.1.3: Path Selection                     -->
<!------------------------------------------------------>

<section anchor="sec:problem.path-selection"
	title="Path Selection">
<t>
A path-selection mechanism is required to select among the multiple
available paths.  Depending on the NEMO multihoming configuration
involved, the differences between the paths may affect only the part
between the HA and the MR, or they may affect the full end-to-end path.
In addition, depending on the configuration, path selection may
be performed by the HA(s), the MR(s), or the hosts themselves through
address selection, as will be described in detail next.
</t>
<t>
<!-- In the (*,*,1) cases, t-->
The multiple available paths may differ on
the tunnel between the MR and the HA used to carry traffic to/from
the NEMO. In this case, path selection is performed by the MR and
the intra-NEMO routing system for traffic flowing from the NEMO, and
path selection is performed by the HA and intra-Home Network routing
system for traffic flowing to the NEMO.

</t><t>

<!-- In the (*,*,n) cases, -->
Alternatively, the multiple paths available may differ in more
than just the tunnel between the MR and the HA, since the usage of
different prefixes may result in using different providers; hence, in
completely different paths between the involved endpoints. 
In this case, besides the mechanisms presented in the previous case, 
additional mechanisms for the end-to-end path selection may be needed. 
This mechanism may be closely related to source address selection mechanisms
within the hosts, since selecting a given address implies selecting a
given prefix, which is associated with a given ISP serving one of the
home networks.
</t>
<t>


A dynamic path-selection mechanism is thus needed so that this path
could be selected by:
<list style="symbols">
  <t>
  The HA: it should be able to select the path based on some
  information recorded in the binding cache.
  </t><t>
  The MR: it should be able to select the path based on router
  advertisements received on both its egress interfaces or on its
  ingress interfaces for the (n,*,*) case.
  </t><t>
  The MNN: it should be able to select the path
  based on "Default Router
  Selection" (see <xref target="RFC2461">[Section 6.3.6 Default
  Router Selection]</xref>) in the (n,*,*) case or based on "Source
  Address Selection" in the (*,*,n) cases (see <xref
  target="sec:problem.source-address"/> of the present memo).

  </t><t>
  The user or the application: e.g., in case where a user wants to
  select a particular access technology among the available
  technologies for reasons, e.g., of cost or data rate.

  </t><t>
   A combination of any of the above: a hybrid mechanism should be also available,
   e.g., one in which the HA, the MR, and/or the MNNs are coordinated
   to select the path.
   </t>

</list>

</t><t>
When multiple bi-directional tunnels are available and possibly used
simultaneously, the mode of operation may be either primary-secondary
(one tunnel is precedent over the others and used as the default
tunnel, while the other serves as a backup) or peer-to-peer (no
tunnel has precedence over one another, they are used with the same
priority).  This questions which of the bi-directional tunnels would be
selected, and based on which of the parameters (e.g., type of flow that goes
into/out of the mobile network).

</t><t>
The mechanisms for the selection among the different tunnels between the
MR(s) and the HA(s) seem to be quite NEMO/MIPv6 specific. 

</t><t>
For (1,*,*) cases, they are no different from the case of path selection
between a mobile host and its HA(s).  As such, a solution 
for MIPv6 should apply to NEMO as well.  For the (n,*,*) cases, an MR
synchronization solution  (see <xref target="sec:problem.mrsync"/>)
should be able to complement an MIPv6 path-selection
solution to achieve the desired functionality for NEMO.

</t><t>
The mechanisms for
selecting among different end-to-end paths based on address selection are
similar to the ones used in other multihoming scenarios, as those
considered by Shim6 (e.g., <xref target="I-D.ietf-shim6-proto"/>).


</t>
</section> <!-- Path Selection-->
<!-------------------------------------------------------->
<!--  SECTION 4.1.4: Re-Homing				-->
<!-------------------------------------------------------->
<section anchor="sec:problem.rehoming"
	title="Re-Homing">

<t>
After an outage has been detected and an available alternative
path has been identified, a re-homing event takes place, diverting the
existing communications from one path to the other.  Similar to the
previous items involved in this process, the re-homing procedure heavily
varies depending on the NEMO multihoming configuration.

<list style="symbols">
  <t>
  For the (*,*,1) configurations, the re-homing procedure involves
  only the MR(s) and the HA(s). The re-homing procedure may involve the
  exchange of additional BU messages.
  <!-- vspace blankLines='1'/ -->
  These mechanisms are shared between NEMO Basic Support and MIPv6.

  </t><t>
  For the (*,*,n) cases, in addition to the previous mechanisms, end-to-end mechanisms may be required. Such mechanisms may involve some
  form of end-to-end signaling or may simply rely on using different
  addresses for the communication.
  <!-- vspace blankLines='1'/ -->
  The involved mechanisms may be similar to those required for
  re-homing Shim6 communications (e.g.,
  <xref target="I-D.ietf-shim6-proto"/>).

  </t>
</list>
</t>
</section> <!-- Re-Homing -->
</section> <!-- Path Survival -->


<!-------------------------------------------------------->
<!--  SECTION 4.2: Ingress Filtering			-->
<!-------------------------------------------------------->
<section anchor="sec:problem.ingress"
	title="Ingress Filtering">

<t>
Ingress filtering mechanisms <xref target="RFC2827"/><xref target="RFC3704"/>
may drop the outgoing packets when
multiple bi-directional tunnels end up at different HAs.

<!-- [XXXX CWNG: RESPONSE(ISSUE#9) XXXX]-->
This could particularly occur if different MNPs are handled by
different HAs.  If a packet with a source address configured
from a specific
<?rfc needLines="5" ?>
MNP is tunneled to a HA that does not handle
that specific MNP, the packet may be discarded either by the HA
or by a border router in the home network.
<!-- [XXXX CWNG: /RESPONSE(ISSUE#9) XXXX]-->

</t>

<t>
The ingress filtering compatibility issue is heavily dependent on the
particular NEMO multihoming configuration:


<list style="symbols">
  <t>
  For the (*,*,1) cases, there is not such an issue, since there is a
  single MNP.

  </t><t>
  <!-- [XXXX CWNG: RESPONSE(ISSUE#23) XXXX]-->
  For the (1,1,*) and (n,1,1) cases, there is not such a problem, 
  since there is a single HA, accepting all the MNPs.

  </t><t>
  For the (n,1,n) case, though ingress filtering would not occur at the
  HA, it may occur at the MRs, when each MR is handling different MNPs.
  <!-- [XXXX CWNG: RESPONSE(ISSUE#23) XXXX]-->

  </t><t>
  (*,n,n) are the cases where the ingress filtering presents some
  difficulties.  In the (1,n,n) case, the problem is simplified because
  all the traffic to and from the NEMO is routed through a single
  MR.  Such configuration allows the MR to properly route packets
  respecting the constraints imposed by ingress filtering.
  <!-- [XXXX CWNG: RESPONSE(ISSUE#23) XXXX]-->
  In this case, the single MR may face ingress filtering problems that
  a multihomed mobile node may face, as documented in 
  <xref target="I-D.multihoming-mip6"/>.
  <!-- [XXXX CWNG: RESPONSE(ISSUE#23) XXXX]-->  
  The more complex case is the (n,n,n) case.  A simplified case occurs when all
  the prefixes are accepted by all the HAs, so that no problems occur
  with the ingress filtering.  However, this cannot be always assumed,
  resulting in the problem described below.
  </t>
</list>
</t>

<t>
As an example of how this could happen, consider the deployment scenario
illustrated in <xref target="fig:(n,n,n)-problem"/>: 
the mobile network has two mobile
routers MR1 and MR2, with home agents HA1 and HA2, respectively. Two
bi-directional tunnels are established between the two
pairs.  Each MR advertises a different MNP (P1 and
P2 respectively). MNP P1 is registered to HA1, and MNP P2 is
registered to HA2. Thus, MNNs should be free to auto-configure their
addresses on any of P1 or P2. Ingress filtering could thus happen in
two cases:

<list style="symbols">

<t>
If the two tunnels are available, MNN cannot forward packet with
source address equals P1.MNN to MR2.  This would cause ingress
filtering at HA2 to occur (or even at MR2).  This is contrary to
normal Neighbor Discovery <xref target="RFC2461"/> practice that an
IPv6 node is free to choose any router as its default router
regardless of the prefix it chooses to use.</t>
<?rfc needLines="15" ?>
<t>
If the tunnel to HA1 is broken, packets that would normally be sent through the
tunnel to HA1 should be diverted through the tunnel to HA2.  If HA2 (or some
border router in HA2's domain) performs ingress filtering,
packets with source address configured from MNP P1 may be
discarded.

</t>

</list>
</t>

<figure anchor="fig:(n,n,n)-problem"
	title="An (n,n,n) mobile network">
<artwork><![CDATA[
            Prefix: P1 +-----+  +----+  +----------+   +-----+
                    +--| MR1 |--| AR |--|          |---| HA1 |
                    |  +-----+  +----+  |          |   +-----+
    IP:    +-----+  |                   |          | Prefix: P1
 P1.MNN or | MNN |--+                   | Internet |
   P2.MNN  +-----+  |                   |          | Prefix: P2
                    |  +-----+  +----+  |          |   +-----+
                    +--| MR2 |--| AR |--|          |---| HA2 |
            Prefix: P2 +-----+  +----+  +----------+   +-----+
]]></artwork>
</figure>

<t>
Possible solutions to the ingress filtering incompatibility problem may be
based on the following approaches:

<list style="symbols">
  <t>
  Some form of source address-dependent routing, whether host-based
  and/or router-based where the prefix contained in the source address
  of the packet is considered when deciding which exit router to use
  when forwarding the packet.</t>

  <t>The usage of nested tunnels for (*,n,n) cases.
  <xref target="sec:nested-tunnel"/> describes one such approach.
  </t><t>
  Deprecating those prefixes associated to non-available exit routers.</t>
</list>
</t>

<t>The ingress filtering incompatibilities problems that appear in some
NEMO multihoming configurations are similar to those considered in
Shim6 (e.g., see <xref target="I-D.ietf-shim6-ingress-filtering"/>).
</t>

</section> <!-- Ingress Filtering -->


<!------------------------------------------------------>
<!-- SECTION 4.x: HA SYNCHRONIZATION                  -->
<!------------------------------------------------------>
<section anchor="sec:problem.hasync"
	title="HA Synchronization">

<t>
In the (*,n,*) configuration, a single MNP would be
registered at different HAs.  This gives rise to the following
cases:


<list style="symbols">

  <t>
  Only one HA may actively advertise a route to the MNP,

  </t><t>
  Multiple HAs at different domains may advertise a route
  to the same MNP.
  </t>

</list>

</t><t>
<?rfc needLines="5" ?>
This may pose a problem in the routing infrastructure as a whole
if the HAs are located in different administrative domains.  The
implications of this aspect needs further exploration.  A certain level
of HA coordination may be required.  A possible approach is to
adopt an HA synchronization mechanism such as that described in
<xref target="I-D.wakikawa-mip6-nemo-haha"/> and
<xref target="I-D.koh-mip6-nemo-dhap"/>.
Such synchronization might also be necessary
in a (*,n,*) configuration, when an MR sends binding update messages to
only one HA (instead of all HAs).  In such cases, the binding update
information might have to be synchronized between HAs.
The mode of synchronization may be either primary-secondary or peer-to-peer.
In addition, when a MNP is delegated to the MR (see
<xref target="sec:problem.prefix-delegation"/>),
some level of coordination between the HAs may also be necessary.
</t><t>

This issue is a general mobility issue that will also have to be dealt
with by Mobile IPv6 (see Section 6.2.3 in <xref target="I-D.multihoming-mip6"/>) as well as NEMO Basic
Support.

</t>
</section> <!-- HA Sync -->



<!------------------------------------------------------>
<!-- SECTION 4.4: MR SYNC                             -->
<!------------------------------------------------------>
<section anchor="sec:problem.mrsync"
	title="MR Synchronization">


<t>
In the (n,*,*) configurations, there are common decisions
that may require synchronization among different MRs
<xref target="I-D.tsukada-nemo-mr-cooperation-analysis"/>,
such as:

<list style="symbols">

<t>advertising the same MNP in the (n,*,1) configurations (see also
"prefix delegation" in <xref target="sec:problem.prefix-delegation"/>);

</t><t>
one MR relaying the advertisement of the MNP from another failed MR in
the (n,*,n) configuration; and

</t><t>
relaying between MRs everything that needs to be relayed, such as data packets,
creating a tunnel from the ingress interface, etc., in the (n,*,*) configuration.

</t>
</list>
However, there is no known standardized protocol for this kind of
router-to-router synchronization.  Without such synchronization, it may not
be possible for a (n,*,*) configuration to achieve various multihoming goals,
such as fault tolerance.
</t>

<t>
Such a synchronization mechanism can be primary-secondary (i.e., a master
MR, with the other MRs as backup) or peer-to-peer (i.e., there is no
clear administrative hierarchy between the MRs).  The need for such mechanism
is general in the sense that a multi-router site in the fixed network would
require the same level of router synchronization.  

</t><t>
  Thus, this issue is not specific to NEMO Basic Support, though there
  is a more pressing need to develop an MR-to-MR synchronization scheme
  for proving fault tolerances and failure recovery in NEMO
  configurations due to the higher possibility of links failure.

</t><t>

  In conclusion, it is recommended to investigate a generic solution to
  this issue although the solution would first have to be developed
  for NEMO deployments.
</t>

</section> <!-- MR Sync -->



<!------------------------------------------------------>
<!-- SECTION 4.5: PREFIX DELEGATION                   -->
<!------------------------------------------------------>
<section anchor="sec:problem.prefix-delegation"
	title="Prefix Delegation">

<t>
In the (*,*,1) configurations, the same MNP must be advertised to
the MNNs through different paths. There is, however, no synchronization
mechanism available to achieve this.  
Without a synchronization mechanism,  
MR may end up announcing incompatible MNPs.  
Particularly, 

<list style="symbols">
  <t>
  for the (*,n,1) cases, how can multiple HAs
  delegate the same MNP to the mobile network?  For doing so, the
  HAs may be somehow configured to advertise the same MNP
  (see also "HA Synchronization" in <xref target="sec:problem.hasync"/>).
  </t>

  <t>
  for the (n,*,1) cases, how can multiple MRs be
  synchronized to advertise the same MNP down the NEMO-link?
  For doing so, the MRs may be somehow configured to advertise the
  same MNP (see also "MR Synchronization" in <xref
  target="sec:problem.mrsync"/>).
  </t>
</list>
</t>
<t>
Prefix delegation mechanisms <xref target="RFC3769"/><!--
--><xref target="I-D.ietf-nemo-dhcpv6-pd"/><!--
--><xref target="I-D.ietf-nemo-prefix-delegation"/>
could be used to ensure all routers advertise the same MNP.
Their applicability to a multihomed mobile network should be considered.

</t>



</section> <!-- Prefix Delegation -->
<!------------------------------------------------------>
<!-- SECTION 4.6: Multiple Binding/Registrations      -->
<!------------------------------------------------------>
<section anchor="sec:problem.many-CoA"
	title="Multiple Bindings/Registrations">

<t>
When an MR is configured with multiple CoAs, it is often
necessary for it to bind these CoAs to the same MNP.

</t><t>
This is a generic mobility issue, since Mobile IPv6 nodes face a
similar problem.  This issue is discussed in <xref
target="I-D.multihoming-mip6"/>.  It is sufficient to note that
solutions like <xref target="I-D.ietf-monami6-multiplecoa"/> can
solve this for both Mobile IPv6 and NEMO Basic Support.  This issue
is being dealt with in the Monami6 WG.

</t>
</section> <!-- Multiple-CoA -->


<!------------------------------------------------------>
<!--  SECTION 4.7: Source Address Selection           -->
<!------------------------------------------------------>
<section anchor="sec:problem.source-address"
	title="Source Address Selection">

<t>
In the (*,*,n) configurations, MNNs would be configured with
multiple addresses.  Source address selection mechanisms are needed to
decide which address to choose from.  

</t><t>
However, currently available source address selection mechanisms 
do not allow MNNs to acquire sufficient information to select
their source addresses intelligently (such as based on the traffic condition
associated with the home network of each MNP).



  It may be desirable for MNNs to be able to acquire "preference"
  information on each MNP from the MRs.  This would allow default
  address selection mechanisms, such as those specified in <xref
  target="RFC3484"/>, to be used.  Further exploration on setting such
  "preference" information in Router Advertisement based on
  performance of the bi-directional tunnel might prove to be useful.

Note that source address selection may be closely related to path
selection procedures (see <xref target="sec:problem.path-selection"/>) and
re-homing techniques (see <xref target="sec:problem.rehoming"/>).

</t><t>
This is a general issue faced by any node when offered multiple
prefixes.

</t>
</section> <!-- Source Address Selection -->



<!------------------------------------------------------>
<!-- SECTION 4.8: LOOP IN NESTED NEMO                 -->
<!------------------------------------------------------>
<section anchor="sec:problem.nested"
	title="Loop Prevention in Nested Mobile Networks">

<t>
When a multihomed mobile network is nested within another mobile
network, it can result in very complex topologies. For instance, a
nested mobile network may be attached to two different root-MRs, thus the
aggregated network no longer forms a simple tree structure.  
In such a situation, infinite loop within the mobile network may occur.
</t><t>

  This problem is specific to NEMO Basic Support.  However, at the
  time of writing, more research is recommended to assess the
  probability of loops occurring in a multihomed mobile network.
  For related work, see <xref target="I-D.thubert-tree-discovery"/> for 
  a mechanism to avoid loops in nested NEMO.

  </t>
</section> <!-- Nested -->


<!------------------------------------------------------>
<!-- SECTION 4.x: PREFIX OWNERSHIP (SPLIT)            -->
<!------------------------------------------------------>
<section anchor="sec:problem.split"
	title="Prefix Ownership">

<t>
When a (n,*,1) network splits, (i.e., the two MRs split themselves up),
MRs on distinct links may try to register the only available MNP.
This cannot be allowed, as the HA has no way to know which node with
an address configured from that MNP is attached to which MR.  Some
mechanism must be present for the MNP to either be forcibly removed
from one (or all) MRs, or the implementors must not allow a (n,*,1)
network to split.

</t><t>
A possible approach to solving this problem is described in <xref
target="I-D.kumazawa-nemo-tbdnd"/>.

</t><t>
This problem is specific to NEMO Basic Support.  
However, it is unclear whether there is a sufficient deployment scenario
for this problem to occur.  

</t><t>
It is recommended that the NEMO
WG standardize a solution to solve this problem if there is sufficient
vendor/operator interest, or specify that the
split of a (n,*,1) network cannot be allowed without router renumbering.

</t>
</section> <!-- Split -->



<!------------------------------------------------------>
<!-- SECTION 4.x: PREFERENCES SETTING                 -->
<!------------------------------------------------------>
<section title="Preference Settings"
         anchor='sec:problem.pref-set'>
  <t>
  When a mobile network is multihomed, the MNNs may be able to
  benefit from this configuration, such as to choose among the
  available paths based on cost, transmission delays, bandwidth, etc.
  However, in some cases, such a choice is not made available to the
  MNNs.  Particularly:

  <list style='symbols'>
    <t>
      In the (*,*,n) configuration, the MNNs can influence the path
      by source address selection 
      (see <xref target='sec:problem.path-selection'/> and 
      <xref target='sec:problem.source-address'/>).
    </t>
    <t>
      In the (n,*,*) configuration, the MNNs can influence the path
      by default router selection 
      (see <xref target='sec:problem.path-selection'/>).
    </t>
    <t>
      In the (1,n,1) configuration, the MNNs cannot influence the path
      selection.  
    </t>
  </list>
  </t><t>
One aspect of preference setting is that the preference of the MNN
(e.g., application or transport layer configuration) may not be the
same as the preference used by MR.  Thus, forwarding choices made by
the MR may not be the best for a particular flow, and may even be
detrimental to some transport control loops (i.e., the flow control
algorithm for TCP may be messed up when MR unexpectedly performs load
balancing on a TCP flow).  A mechanism that allows the MNN to indicate
its preference for a given traffic might be helpful here. </t>
  
<t>Another aspect of preference setting is that the MNN may not even be
aware of the existence of multiple forwarding paths, e.g., the (1,n,1)
configuration. A mechanism for the MR to advertise the availability of
multiple tunneling paths would allow the MNN to take advantage of
this, coupled with the previously mentioned mechanism that allows the
MNN to indicate its preference for a given traffic.</t>

<t>This problem is general in the sense that IPv6 nodes may wish to
influence the routing decision done by the upstream routers.  Such a
mechanism is currently being explored by various WGs, such as the NSIS
and IPFIX WGs.  It is also possible that the Shim6 layer in the MNNs
may possess such a capability.  It is recommended for vendors or
operators to investigate into the solutions developed by these WGs
when providing multihoming capabilities to mobile networks.</t>

<t>In addition, the Monami6 WG is currently developing a flow filtering
solution for mobile nodes to indicate how flows should be forwarded by
a filtering agent <xref target="I-D.soliman-monami6-flow-binding"/> (such as HA and mobile anchor points).  It
is recommended that the Monami6 WG consider the issues described here
so that flow filtering can be performed by the MNN to indicate how flows
should be forwarded by the MR.

  </t>

</section><!-- Preference Setting -->
</section><!-- Problem-Statement -->

<!-------------------------------------------------------->
<!--  SECTION: MATRIX 				-->
<!-------------------------------------------------------->
<section anchor="sec:matrix" title="Recommendations to the Working Group">
         <!-- was title="Matrix [Issues,(x,y,z) Configuration]" -->

<t>
Several issues that might impact the deployment of NEMO with
multihoming capabilities were identified in <xref target="sec:problem"/>.
These are shown in the matrix below,
for each of the eight multihoming configurations, together with indications from which WG(s)
a solution to each issue is most likely to be found.

<figure anchor='fig:matrix' title="Matrix of NEMO Multihoming Issues">
<artwork><![CDATA[
 +=================================================================+
 |                       # of MRs: | 1 | 1 | 1 | 1 | n | n | n | n |
 |                       # of HAs: | 1 | 1 | n | n | 1 | 1 | n | n |
 |                  # of Prefixes: | 1 | n | 1 | n | 1 | n | 1 | n |
 +=================================================================+
 | Fault Tolerance                 | * | * | * | * | * | * | * | * |
 +---------------------------------+---+---+---+---+---+---+---+---+
 | Failure Detection               |N/M|N/M|N/M|N/M|N/M|N/M| N | S |
 +---------------------------------+---+---+---+---+---+---+---+---+
 | Path Exploration                |N/M|N/M|N/M|N/M|N/M|N/M| N | S |
 +---------------------------------+---+---+---+---+---+---+---+---+
 | Path Selection                  | N |S/M| M |S/M| N |S/N| N |S/N|
 +---------------------------------+---+---+---+---+---+---+---+---+
 | Re-Homing                       |N/M| S |N/M| S |N/M| S |N/M| S |
 +---------------------------------+---+---+---+---+---+---+---+---+
 | Ingress Filtering               | . | . | . | t | . | . | . | N |
 +---------------------------------+---+---+---+---+---+---+---+---+
 | HA Synchronization              | . | . |N/M|N/M| . | . |N/M|N/M|
 +---------------------------------+---+---+---+---+---+---+---+---+
 | MR Synchronization              | . | . | . | . | G | G | G | G |
 +---------------------------------+---+---+---+---+---+---+---+---+
 | Prefix Delegation               | . | . | N | N | N | N | N | N |
 +---------------------------------+---+---+---+---+---+---+---+---+
 | Multiple Binding/Registrations  | M | M | M | M | M | M | M | M |
 +---------------------------------+---+---+---+---+---+---+---+---+
 | Source Address Selection        | . | G | . | G | . | G | . | G |
 +---------------------------------+---+---+---+---+---+---+---+---+
 | Loop Prevention in Nested NEMO  | N | N | N | N | N | N | N | N |
 +---------------------------------+---+---+---+---+---+---+---+---+
 | Prefix Ownership                | . | . | . | . | N | . | N | . |
 +---------------------------------+---+---+---+---+---+---+---+---+
 | Preference Settings             | G | G | G | G | G | G | G | G |
 +=================================================================+
 N - NEMO Specific       M - MIPv6 Specific      G - Generic IPv6
 S - SHIM6 WG            D - DNA WG
 . - Not an Issue        t - trivial
 * - Fault Tolerance is a combination of Failure Detection, Path
     Exploration, Path Selection, and Re-Homing
]]></artwork>
</figure>
</t>


<t>
The above matrix serves to identify which issues are NEMO-specific,
and which are not.  The readers are reminded
that this matrix is a simplification of <xref target="sec:problem"/>
as subtle details are not represented in <xref target="fig:matrix"/>.
</t>
<t>
  As can be seen from <xref target="fig:matrix"/>, the following are
  some concerns that are specific to NEMO: Failure Detection,
  Path Exploration, Path Selection, Re-Homing, Ingress Filtering,
  HA Synchronization, Prefix Delegation, Loop Prevention in Nested NEMO,
  and Prefix Ownership.  Based on the authors' best knowledge of the
  possible deployments of NEMO, it is recommended that:

  <list style="symbols">
    <t>
      A solution for Failure Detection, Path Exploration, Path Selection, 
      and Re-Homing be solicited from other WGs.
   
      <vspace blankLines='1'/>
      Although Path Selection is reflected in <xref target="fig:matrix"/>
      as NEMO-Specific, the technical consideration of the problem is
      believed to be quite similar to the selection of multiple paths in
      mobile nodes.  
  
      As such, we would recommend vendors to solicit a solution for
      these issues from other WGs in the IETF; for instance, the Monami6 or
      Shim6 WG.
      
    </t>
    
    <t>
      Ingress Filtering on the (n,n,n) configuration can be solved by the
      NEMO WG.
<!-- [rfced] Please clarify the sentence above.  Should this read "can
be solved", "is being solved", "is being reviewed"??  -->
<!-- cwng@20070820: "can be solved", changed -->

      <vspace blankLines='1'/>

      This problem is clearly defined, and can be solved by the WG.
      Deployment of the (n,n,n) configuration can be envisioned on vehicles for
      mass transportation (such as buses, trains) where different
      service providers may install their own MRs on the
      vehicle/vessel.
      <vspace blankLines='1'/>
      It should be noted that the Shim6 WG may be developing a mechanism
      for overcoming ingress filtering in a more general sense.  We thus
      recommend that the NEMO WG concentrate only on the (n,n,n)
      configuration should the WG decide to work on this issue.

    </t>
    
    <t>

      A solution for HA Synchronization can be looked at in a

      <!-- [rfced] Please clarify this sentence.  Should this read "is being
looked at", "can be looked at", etc ??  -->
<!-- cwng@20070820: "can be looked", changed -->

      mobility-specific WG, taking into consideration both mobile
      hosts operating Mobile IPv6 and MRs operating NEMO
      Basic Support.

    </t>
    
    <t>

      A solution for Multiple Bindings/Registrations is presently
      being developed by the Monami6 WG.
<!-- [rfced] Please clarify the sentence above.  Should this read "is
presently being looked at", "is being reviewed by", etc.?? -->
<!-- cwng@20070820: "is presently being developed", changed -->


    </t>
    
    <t>

      Prefix Delegation should be reviewed and checked by the NEMO WG.

    <vspace blankLines='1'/> 

      The proposed solutions <xref
      target="I-D.ietf-nemo-prefix-delegation"/> and <xref
      target="I-D.ietf-nemo-dhcpv6-pd"/> providing prefix delegation
      functionality to NEMO Basic Support should be reviewed in order
      to make sure concerns, as discussed in <xref
      target="sec:problem.prefix-delegation"/>, are properly handled.

    </t>
    
    <t>
      Loop Prevention in Nested NEMO should be investigated.

      <vspace blankLines='1'/>

      Further research is recommended to assess the
      risk of having a loop in the nesting of multihomed mobile networks.

    </t>
    
    <t>

      Prefix Ownership should be considered by the vendors and operators.
      <vspace blankLines='1'/>

      The problem of Prefix Ownership only occurs when a mobile network with 
      multiple MRs and a single MNP can arbitrarily join and split.  Vendors
      and operators of mobile networks are encouraged to input their views on
      the applicability of deploying such kind of mobile networks.

    </t>
  </list>
</t>

</section><!-- Table -->

<!-------------------------------------------------------->
<!--  SECTION: CONCLUSION  				-->
<!-------------------------------------------------------->
<section anchor="sec:conclusion" title="Conclusion">

	
<t>

This memo presented an analysis of multihoming in the context of
network mobility under the operation of NEMO Basic Support (RFC 3963).
The purpose was to investigate issues related to such a bi-directional
tunneling mechanism where mobile networks are multihomed and multiple
bi-directional tunnels are established between Home Agent and Mobile
Router pairs. For doing so, mobile networks were classified into a
taxonomy comprising eight possible multihomed configurations. Issues
were explained one by one and then summarized into a table showing the
multihomed configurations where they apply, suggesting the most
relevant IETF working group where they could be solved.  This analysis
will be helpful to extend the existing standards to support
multihoming and to implementors of NEMO Basic Support and
multihoming-related mechanisms.

</t>

</section><!-- Conclusion -->


<!--------------------------------------------------------------------------->
<!-- SECTION:  SECURITY CONSIDERATION  ------------------------------------------>
<!--------------------------------------------------------------------------->
<section anchor='sec:security'
         title="Security Considerations">
  <t>

    This is an informational document where the multihoming
    configurations under the operation of NEMO Basic Support are
    analyzed. Security considerations of these multihoming
    configurations, should they be different from those that concern NEMO Basic
    Support, must be considered by forthcoming solutions.  For
    instance, an attacker could try to use the multihomed device as a
    means to access another network that would not be normally
    reachable through the Internet.  Even when forwarding to another
    network is turned off by configuration, an attacker could
    compromise a system to enable it.

  </t>
</section>



<!-------------------------------------------------------->
<!--	SECTION: ACKNOWLEDGMENTS			-->
<!-------------------------------------------------------->

<section title="Acknowledgments">

<t>
The authors would like to thank people who have given valuable comments
on various multihoming issues on the mailing list, and also those
who have suggested directions in the 56th - 61st IETF Meetings.
The initial evaluation of NEMO Basic Support on multihoming configurations
is a contribution from Julien Charbon.
</t>

</section> <!-- Acknowledgments -->

<?rfc compact="no" ?>

</middle>


<!-------------------------------------------------------->
<!--  Back Section					-->
<!-------------------------------------------------------->

<back>

<!-------------------------------------------------------->
<!--	REFERENCES					-->
<!-------------------------------------------------------->
<?rfc needLines="15" ?>
<references title="Normative References">
  <!-- To Do: Make sure all references listed are indeed referenced --
              Make sure they are are in the order of appearance --
              (These should be a feature provided by xml2rfc!)
                          OKay, this is provided by xml2rfc.  Just use <?rfc sortrefs="yes"?>
  -->
  <!-- Done -->
<reference anchor="RFC4886">
<front>
<title>Network Mobility Support Goals and Requirements</title>
<author initials="T." surname="Ernst" fullname="T. Ernst">
<organization/>
</author>
<date year="2007" month="July"/>
</front>
<seriesInfo name="RFC" value="4886"/>
<format type="TXT" octets="29083" target="ftp://ftp.isi.edu/in-notes/rfc4886.txt"/>
</reference>

<reference anchor='RFC3753'>

<front>
<title>Mobility Related Terminology</title>
<author initials='J.' surname='Manner' fullname='J. Manner'>
<organization /></author>
<author initials='M.' surname='Kojo' fullname='M. Kojo'>
<organization /></author>
<date year='2004' month='June' /></front>

<seriesInfo name='RFC' value='3753' />
<format type='TXT' octets='74143' target='ftp://ftp.isi.edu/in-notes/rfc3753.txt' />
</reference>

<reference anchor="RFC4885">
<front>
<title>Network Mobility Support Terminology</title>
<author initials="T." surname="Ernst" fullname="T. Ernst">
<organization/>
</author>
<author initials="H-Y." surname="Lach" fullname="H-Y. Lach">
<organization/>
</author>
<date year="2007" month="July"/>
</front>
<seriesInfo name="RFC" value="4885"/>
<format type="TXT" octets="37967" target="ftp://ftp.isi.edu/in-notes/rfc4885.txt"/>
</reference>

<reference anchor='RFC3963'>

<front>
<title>Network Mobility (NEMO) Basic Support Protocol</title>
<author initials='V.' surname='Devarapalli' fullname='V. Devarapalli'>
<organization /></author>
<author initials='R.' surname='Wakikawa' fullname='R. Wakikawa'>
<organization /></author>
<author initials='A.' surname='Petrescu' fullname='A. Petrescu'>
<organization /></author>
<author initials='P.' surname='Thubert' fullname='P. Thubert'>
<organization /></author>
<date year='2005' month='January' /></front>

<seriesInfo name='RFC' value='3963' />
<format type='TXT' octets='75955' target='ftp://ftp.isi.edu/in-notes/rfc3963.txt' />
</reference>

<reference anchor='RFC3775'>

<front>
<title>Mobility Support in IPv6</title>
<author initials='D.' surname='Johnson' fullname='D. Johnson'>
<organization /></author>
<author initials='C.' surname='Perkins' fullname='C. Perkins'>
<organization /></author>
<author initials='J.' surname='Arkko' fullname='J. Arkko'>
<organization /></author>
<date year='2004' month='June' /></front>

<seriesInfo name='RFC' value='3775' />
<format type='TXT' octets='393514' target='ftp://ftp.isi.edu/in-notes/rfc3775.txt' />
</reference>

  <!-- CWNG: RESPONSE(ISSUE#3) REMOVE THE FOLLOWING REFERENCE -->
  <!-- ?rfc include="../references/reference.Thesis.Savola03.xml" ? -->
  <!-- CWNG: /RESPONSE(ISSUE#3) -->
</references>

<references title="Informative References">

<?rfc include="reference.RFC.3315" ?>

<reference anchor='I-D.ietf-monami6-multihoming-motivation-scenario'>
<front>
<title>Motivations and Scenarios for Using Multiple Interfaces and Global Addresses</title>

<author initials='T' surname='Ernst' fullname='Thierry Ernst'>
    <organization />
</author>
<author initials='N' surname='Montavont' fullname='Nicolas Montavont'>
    <organization />
</author>
<author initials='R' surname='Wakikawa' fullname='Ryuji Wakikawa'>
    <organization />
</author>
<author initials='C.-W' surname='Ng' fullname='Chan-Wah Ng'>
    <organization />
</author>
<author initials='K' surname='Kuladinithi' fullname='Koojana Kuladinithi'>
    <organization />
</author>

<date month='October' day='23' year='2006' />
</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-monami6-multihoming-motivation-scenario-01.txt' />
</reference>

<reference anchor='I-D.multihoming-mip6'>
<front>
<title>Analysis of Multihoming in Mobile IPv6</title>

<author initials='N.M.' surname='Montavont' fullname='Nicolas Montavont'></author>
<author initials='R.W.' surname='Wakikawa' fullname='Ryuji Wakikawa'></author>
<author initials='T.E.' surname='Ernst' fullname='Thierry Ernst'></author>
<author initials="C.-W.N" surname="Ng" fullname="Chan-Wah Ng"></author>
<author initials="K.K." surname="Kuladinithi" fullname="Koojana Kuladinithi"></author>

<date month='February' day='25' year='2006' />
</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-monami6-mipv6-analysis-00.txt' />
</reference>

<reference anchor='I-D.wakikawa-mip6-nemo-haha'>
<front>
<title>Inter Home Agents Protocol (HAHA)</title>

<author initials='R' surname='Wakikawa' fullname='Ryuji Wakikawa'>
    <organization />
</author>

<author initials='V' surname='Devarapalli' fullname='Vijay Devarapalli'>
    <organization />
</author>

<author initials='P' surname='Thubert' fullname='Pascal Thubert'>
    <organization />
</author>

<date month='February' day='16' year='2004' />

</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-wakikawa-mip6-nemo-haha-01.txt' />
</reference>

<reference anchor='I-D.koh-mip6-nemo-dhap'>
<front>
<title>Dynamic Inter Home Agent Protocol</title>

<author initials='B' surname='Koh' fullname='Benjamin Koh'>
    <organization/>
</author>
<author initials='C' surname='Ng' fullname='Chan-Wah Ng'>
    <organization/>
</author>
<author initials='J' surname='Hirano' fullname='Jun Hirano'>
    <organization/>
</author>

<date month='July' year='2004' />
</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-koh-mip6-nemo-dhap-00.txt' />
</reference>

<reference anchor='I-D.ietf-monami6-multiplecoa'>
<front>
<title>Multiple Care-of Addresses Registration</title>

<author initials='R' surname='Wakikawa' fullname='Ryuji Wakikawa'>
    <organization />
</author>

<date month='June' day='13' year='2006' />

<abstract><t>According to the current Mobile IPv6 specification, a mobile node may have several CoAs, but only one, termed the primary CoA, can be registered with its Home Agent and the Correspondent Nodes. However, for matters of cost, bandwidth, delay, etc, it is useful for the mobile node to get Internet access through multiple access media simultaneously, in which case multiple active IPv6 CoAs would be assigned to the mobile node. We thus propose Mobile IPv6 extensions designed to register multiple CoAs bound to a single Home Address instead of the sole primary CoA. For doing so, a new identification number must be carried in each binding for the receiver to distinguish between the bindings corresponding to the same Home Address. Those extensions are targeted to NEMO (Network Mobility) Basic Support as well as to Mobile IPv6.</t></abstract>

</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-monami6-multiplecoa-00.txt' />
</reference>

<reference anchor='I-D.kumazawa-nemo-tbdnd'>
<front>
<title>Token based Duplicate Network Detection for split mobile network (Token based DND)</title>

<author initials='M' surname='Kumazawa' fullname='Masayuki Kumazawa'>
    <organization />
</author>

<date month='July' day='12' year='2005' />

<abstract><t>When multiple Mobile Routers share the same prefix, a Home Agent must be able to verify whether the Mobile Routers share the same Mobile Network or not. Otherwise, the Home Agent may not be able to forward a data packet to a correct recipient since the recipient may not be connected to the mobile router the Home Agent chooses to forward the packet. This document describes a Token based Duplicate Network Detection mechanism that enables a Home Agent to detect whether multiple Mobile Rotuers claiming the same prefix are in the same Mobile Network.</t></abstract>

</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-kumazawa-nemo-tbdnd-02.txt' />
</reference>

<reference anchor='RFC2461'>

<front>
<title abbrev='Neighbor Discovery for IPv6'>Neighbor Discovery for IP Version 6 (IPv6)</title>
<author initials='T.' surname='Narten' fullname='Thomas Narten'>
<organization>IBM Corporation</organization>
<address>
<postal>
<street>P.O. Box 12195</street>
<street>Research Triangle Park</street>
<region>NC</region>
<code>27709-2195</code>
<country>USA</country></postal>
<phone>+1 919 254 7798</phone>
<email>narten@raleigh.ibm.com</email></address></author>
<author initials='E.' surname='Nordmark' fullname='Erik Nordmark'>
<organization>Sun Microsystems, Inc.</organization>
<address>
<postal>
<street>901 San Antonio Road</street>
<street>Palo Alto</street>
<region>CA</region>
<code>94303</code>
<country>USA</country></postal>
<phone>+1 650 786 5166</phone>
<facsimile>+1 650 786 5896</facsimile>
<email>nordmark@sun.com</email></address></author>
<author initials='W.A.' surname='Simpson' fullname='William Allen Simpson'>
<organization>Daydreamer, Computer Systems Consulting Services</organization>
<address>
<postal>
<street>1384 Fontaine</street>
<street>Madison Heights</street>
<region>Michigan</region>
<code>48071</code>
<country>USA</country></postal>
<email>bsimpson@MorningStar.com</email></address></author>
<date year='1998' month='December' />
<area>Routing</area>
<keyword>discovery</keyword>
<keyword>internet protocol version 6</keyword>
<keyword>IPv6</keyword>
<abstract>
<t>
   This document specifies the Neighbor Discovery protocol for IP
   Version 6.  IPv6 nodes on the same link use Neighbor Discovery to
   discover each other&apos;s presence, to determine each other&apos;s link-layer
   addresses, to find routers and to maintain reachability information
   about the paths to active neighbors.
</t></abstract></front>

<seriesInfo name='RFC' value='2461' />
<format type='TXT' octets='222516' target='ftp://ftp.isi.edu/in-notes/rfc2461.txt' />
<format type='HTML' octets='252162' target='http://xml.resource.org/public/rfc/html/rfc2461.html' />
<format type='XML' octets='239316' target='http://xml.resource.org/public/rfc/xml/rfc2461.xml' />
</reference>

<reference anchor='RFC3484'>

<front>
<title>Default Address Selection for Internet Protocol version 6 (IPv6)</title>
<author initials='R.' surname='Draves' fullname='R. Draves'>
<organization /></author>
<date year='2003' month='February' /></front>

<seriesInfo name='RFC' value='3484' />
<format type='TXT' octets='55076' target='ftp://ftp.isi.edu/in-notes/rfc3484.txt' />
</reference>

<reference anchor='RFC3769'>

<front>
<title>Requirements for IPv6 Prefix Delegation</title>
<author initials='S.' surname='Miyakawa' fullname='S. Miyakawa'>
<organization /></author>
<author initials='R.' surname='Droms' fullname='R. Droms'>
<organization /></author>
<date year='2004' month='June' /></front>

<seriesInfo name='RFC' value='3769' />
<format type='TXT' octets='10287' target='ftp://ftp.isi.edu/in-notes/rfc3769.txt' />
</reference>

<reference anchor='RFC3704'>

<front>
<title>Ingress Filtering for Multihomed Networks</title>
<author initials='F.' surname='Baker' fullname='F. Baker'>
<organization /></author>
<author initials='P.' surname='Savola' fullname='P. Savola'>
<organization /></author>
<date year='2004' month='March' /></front>

<seriesInfo name='BCP' value='84' />
<seriesInfo name='RFC' value='3704' />
<format type='TXT' octets='35942' target='ftp://ftp.isi.edu/in-notes/rfc3704.txt' />
</reference>

<reference anchor='RFC2827'>

<front>
<title>Network Ingress Filtering: Defeating Denial of Service Attacks which employ IP Source Address Spoofing</title>
<author initials='P.' surname='Ferguson' fullname='P. Ferguson'>
<organization /></author>
<author initials='D.' surname='Senie' fullname='D. Senie'>
<organization /></author>
<date year='2000' month='May' /></front>

<seriesInfo name='BCP' value='38' />
<seriesInfo name='RFC' value='2827' />
<format type='TXT' octets='21258' target='ftp://ftp.isi.edu/in-notes/rfc2827.txt' />
</reference>

<reference anchor='I-D.ietf-shim6-failure-detection'>
<front>
<title>Failure Detection and Locator Pair Exploration Protocol for IPv6  Multihoming</title>

<author initials='J' surname='Arkko' fullname='Jari Arkko'>
    <organization />
</author>

<author initials='I' surname='Beijnum' fullname='Iljitsch van Beijnum'>
    <organization />
</author>

<date month='December' day='13' year='2006' />

<abstract><t>This document defines a mechanism for the detection of communication failures between two communicating hosts at IP layer, and an exploration protocol for switching to another pair of interfaces and/or addresses between the same hosts if a working pair can be found. The draft also discusses the roles of a multihoming protocol versus network attachment functions at IP and link layers.</t></abstract>

</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-shim6-failure-detection-07.txt' />
<format type='PDF'
        target='http://www.ietf.org/internet-drafts/draft-ietf-shim6-failure-detection-07.pdf' />
</reference>

<reference anchor='I-D.ietf-shim6-proto'>
<front>
<title>Level 3 multihoming shim protocol</title>

<author initials='E' surname='Nordmark' fullname='Erik Nordmark'>
    <organization />
</author>
<author initials='M' surname='Bagnulo' fullname='Marcelo Bagnulo'>
    <organization />
</author>

<date month='November' day='24' year='2006' />


</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-shim6-proto-07.txt' />
</reference>

<reference anchor='I-D.ietf-dna-protocol'>
<front>
<title>Detecting Network Attachment in IPv6 Networks (DNAv6)</title>

<author initials='S' surname='Narayanan' fullname='Sathya Narayanan'>
    <organization />
</author>

<date month='October' day='23' year='2006' />


</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-dna-protocol-03.txt' />
</reference>

<reference anchor='I-D.ietf-dna-link-information'>
<front>
<title>Link-layer Event Notifications for Detecting Network Attachments</title>

<author initials='S' surname='Krishnan' fullname='Suresh Krishnan'>
    <organization />
</author>
<author initials='N' surname='Montavont' fullname='Nicolas Montavont'>
    <organization />
</author>
<author initials='A' surname='Yegin' fullname='Eric Njedjou'>
    <organization />
</author>
<author initials='S' surname='Veerepalli' fullname='Siva Veerepalli'>
    <organization />
</author>
<author initials='A' surname='Yegin' fullname='Alper Yegin'>
    <organization />
</author>

<date month='November' day='5' year='2006' />

<abstract><t>Certain network access technologies are capable of providing various link-layer status information to IP. Link-layer event notifications can help IP expeditiously detect configuration changes. This document provides a non-exhaustive catalogue of information available from well-known access technologies.</t></abstract>

</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-dna-link-information-05.txt' />
</reference>

<reference anchor='I-D.thubert-tree-discovery'>
<front>
<title>Nested Nemo Tree Discovery</title>

<author initials='P' surname='Thubert' fullname='Pascal Thubert'>
    <organization />
</author>
<author initials='C' surname='Bontous' fullname='Caroline Bontoux'>
    <organization />
</author>
<author initials='N' surname='Nicolas' fullname='Nicolas Montavont'>
    <organization />
</author>

<date month='November' day='17' year='2006' />

<abstract><t>The purpose of this paper is to describe a minimum set of features that extends the Nemo basic support [4] in order to avoid loops in the nested Nemo case. As a result, Mobile Routers assemble into a tree that can be optimized based on various metrics.</t></abstract>

</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-thubert-tree-discovery-04.txt' />
</reference>

<reference anchor='I-D.ietf-nemo-prefix-delegation'>
<front>
<title>Mobile Network Prefix Delegation</title>

<author initials='P' surname='Thubert' fullname='Pascal Thubert'>
    <organization />
</author>

<author initials='TJ' surname='Kniveton' fullname='TJ Kniveton'>
    <organization />
</author>


<date month='November' day='17' year='2006' />

<abstract><t>This paper extends the Nemo Basic Support [10] for a Mobile Router to synchronize its Mobile Network Prefixes with its Home Agents and obtain new ones dynamically. The proposed prefix delegation mechanism is agnostic to the way the prefixes are managed and provisioned at the Home Agent; it might be used for bootstrapping, resynchronization at binding creation or after a loss of states (eg MR reboot), MNP Renumbering, and configuration checking for loop avoidance.</t></abstract>

</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-nemo-prefix-delegation-01.txt' />
</reference>

<reference anchor='I-D.ietf-nemo-dhcpv6-pd'>
<front>
<title>DHCPv6 Prefix Delegation for NEMO</title>

<author initials='R' surname='Droms' fullname='Ralph Droms'>
    <organization />
</author>

<author initials='P' surname='Thubert' fullname='Pascal Thubert'>
    <organization />
</author>

<date month='September' day='28' year='2006' />

<abstract><t>One aspect of network mobility support is the assignment of a prefix or prefixes to a mobile router (MR) for use on the links in the mobile network. DHCPv6 prefix delegation can be used for this configuration task.</t></abstract>

</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-ietf-nemo-dhcpv6-pd-02.txt' />
</reference>

<reference anchor='I-D.ietf-shim6-ingress-filtering'>
<front>
<title>Ingress filtering compatibility for IPv6 multihomed sites</title>

<author initials='C' surname='Huitema' fullname='Christian Huitema'>
    <organization />
</author>
<author initials='M' surname='Marcelo' fullname='Marcelo Bagnulo'>
    <organization />
</author>

<date month='October' day='8' year='2006' />

<abstract><t>The note presents a set of mechanisms to provide ingress filtering compatibility for legacy hosts in IPv6 multihomed sites.</t></abstract>

</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-huitema-shim6-ingress-filtering-00.txt' />
</reference>

<reference anchor='I-D.tsukada-nemo-mr-cooperation-analysis'>
<front>
<title>Analysis of Multiple Mobile Routers Cooperation</title>

<author initials='M' surname='Tsukada' fullname='Manabu Tsukada'>
    <organization />
</author>

<date month='October' day='20' year='2005' />

<abstract><t>This document is an analysis of multiple Mobile Routers Cooperation in the context of network mobility support (NEMO) in IPv6. Our objective is to identify when cooperation between MRs is needed and what information must be exchanged.</t></abstract>

</front>

<seriesInfo name='Work in' value='Progress' />
<format type='TXT'
        target='http://www.ietf.org/internet-drafts/draft-tsukada-nemo-mr-cooperation-analysis-00.txt' />
</reference>

<reference anchor="I-D.soliman-monami6-flow-binding">
	<front>
	<title>
Flow Bindings in Mobile IPv6 and NEMO Basic Support
</title>

	<author initials="H" surname="Soliman" fullname="Hesham Soliman">
<organization/>
</author>
<date month="March" year="2007"/>

</front>
<seriesInfo name="Work in" value="Progress"/>
<format type="TXT" target="http://www.ietf.org/internet-drafts/draft-soliman-monami6-flow-binding-04.txt"/>
</reference>

</references>
<vspace blankLines="100" />

<!-------------------------------------------------------->
<!--	APPENDIX A					-->
<!-------------------------------------------------------->

<section anchor="sec:alt-class"
	title="Alternative Classifications Approach">

<!------------------------------------------------>
<!--  Original SECTION 2.2: OWN-BASED		-->
<!------------------------------------------------>

<section anchor="sec:alt-class.ownership"
	title="Ownership-Oriented Approach">

<t>
An alternative approach to classifying a multihomed mobile network was proposed
by Erik Nordmark (Sun Microsystems) by breaking the classification of multihomed
network based on ownership.  This is more of a tree-like, top-down classification.
Starting from the control and ownership of the HA(s) and MR(s), there are two
different possibilities: either (i) the HA(s) and MR(s) are controlled by a single
entity, or (ii) the HA(s) and MR(s) are controlled by separate entities.  We called
the first possibility the 'ISP Model', and the second the 'Subscriber/Provider Model'.
</t>

<!------------------------------------------------>
<!--  SECTION 2.2.1: ISP Model			-->
<!------------------------------------------------>

<section anchor="sec:alt-class.isp"
	title="ISP Model">

<t>
The case of the HA(s) and MR(s) are controlled by the same entity can be best
illustrated as an Internet Service Provider (ISP) installing MRs
on trains, ships, or planes.  It is up to the ISP to deploy a certain configuration
of mobile network; all 8 configurations, as described in the Configuration-Oriented
Approach, are possible.  In the remaining portion of this document, when specifically
referring to a mobile network configuration that is controlled by a single entity,
we will add an 'ISP' prefix; for example, ISP-(1,1,1) or ISP-(1,n,n).
</t>

<t>
When the HA(s) and MR(s) are controlled by a single entity (such as an ISP), the
ISP can decide whether it wants to assign one or multiple MNPs to
the mobile network just like it can make the same decision for any other link
in its network (wired or otherwise).  In any case, the ISP will make the routing
between the mobile networks and its core routers (such as the HAs) work.
This includes not introducing any aggregation between the HAs, which will
filter out routing announcements for the MNP(s).
</t>

<t>
To such ends, the ISP has various means and mechanisms.  For one, the ISP can
run its Interior Gateway Protocol (IGP) over bi-directional tunnels between the
MR(s) and HA(s).  Alternatively, static routes may be used with the tunnels.
When static routes are used, a mechanism  to test "tunnel liveness" might be
necessary to avoid maintaining stale routes.  Such "tunnel liveness" may be
tested by sending heartbeats signals from MR(s) to the HA(s).  A possibility is
to simulate heartbeats using Binding Updates messages by controlling the
"Lifetime" field of the Binding Acknowledgment message to force the MR to send
Binding Update messages at regular intervals.  However, a more appropriate tool
might be the Binding Refresh Request 
<?rfc needLines="8" ?>
message, though conformance to the
Binding Refresh Request message may be less strictly enforced in implementations
since it serves a somewhat secondary role when compared to Binding Update messages.
</t>

</section> <!-- Class.Ownership.ISP-Model -->

<!------------------------------------------------>
<!--  SECTION 2.2.2: Subscriber/Provider Model	-->
<!------------------------------------------------>

<section anchor="sec:alt-class.s/p"
	title="Subscriber/Provider Model">

<t>
The case of the HA(s) and MR(s) controlled by the separate entities can be best
illustrated with a subscriber/provider model, where the MRs belongs
to a single subscriber and subscribes to one or more ISPs for HA services.
There is two sub-categories in this case: when the subscriber subscribes to a single ISP,
and when the subscriber subscribes to multiple ISPs.  In the remaining portion
of this document, when specifically referring to a mobile network configuration
that is in the subscriber/provider model where the subscriber subscribes to only
one ISP, we will add an 'S/P' prefix; for example, S/P-(1,1,1) or S/P-(1,n,n).
When specifically referring to a mobile network configuration
that is in the subscriber/provider model where the subscriber subscribes to multiple
ISPs, we will add an 'S/mP' prefix; for example, S/mP-(1,1,1) or S/mP-(1,n,n).
</t>

<t>
Not all 8 configurations are likely to be deployed for the S/P and S/mP models.
For instance, it is unlikely to foresee a S/mP-(*,1,1) mobile network where there
is only a single HA.  For the S/P model, the following configurations are likely
to be deployed:

<list style="symbols">
<t>S/P-(1,1,1): Single Provider, Single MR, Single HA, Single MNP</t>
<t>S/P-(1,1,n): Single Provider, Single MR, Single HA, Multiple MNPs</t>
<t>S/P-(1,n,1): Single Provider, Single MR, Multiple HAs, Single MNP</t>
<t>S/P-(1,n,n): Single Provider, Single MR, Multiple HAs, Multiple MNPs</t>
<t>S/P-(n,n,1): Single Provider, Multiple MRs, Single HA, Single MNP</t>
<t>S/P-(n,1,n): Single Provider, Multiple MRs, Single HA, Multiple MNPs</t>
<t>S/P-(n,n,1): Single Provider, Multiple MRs, Multiple HAs, Single MNP</t>
<t>S/P-(n,n,n): Single Provider, Multiple MRs, Multiple HAs, Multiple MNPs</t>
</list>
<vspace blankLines="1" />
</t>
<?rfc needLines="5" ?>
<t>
For the S/mP model, the following configurations are likely to be deployed:

<list style="symbols">
<t>S/mP-(1,n,1): Multiple Providers, Single MR, Multiple HAs, Single MNP</t>
<t>S/mP-(1,n,n): Multiple Providers, Single MR, Multiple HAs, Multiple MNPs</t>
<t>S/mP-(n,n,n): Multiple Providers, Multiple MRs, Multiple HAs, Multiple MNPs</t>
</list>
</t>

<t>
When the HA(s) and MR(s) are controlled by different entities, it is more likely
that the MR is controlled by one entity (i.e., the subscriber), and
the MR is establishing multiple bi-directional tunnels to one or more HA(s)
provided by one or more ISP(s).  In such cases, it is unlikely that the ISP will run
IGP over the bi-directional tunnel, since the ISP will most certainly wish to retain
full control of its routing domain.
</t>

</section> <!-- Class.Ownership.S/P-Model -->

</section> <!-- Class.Ownership -->

<!------------------------------------------------>
<!--  Original SECTION 2.3: PROBLEM-BASED	-->
<!------------------------------------------------>



<section anchor="sec:alt-class.problem"
	title="Problem-Oriented Approach">

<t>
A third approach was proposed
by Pascal Thubert (Cisco Systems).  This focused on the problems of multihomed
mobile networks rather than the configuration or ownership.  With this approach,
there is a set of 4 categories based on two orthogonal parameters:
the number of HAs, and the number of MNPs advertised.
Since the two parameters are orthogonal, the categories are not mutually
exclusive.  The four categories are:

<list style="symbols">

<!-- Tarzan -->
<t>
Tarzan: Single HA for Different CoAs of Same MNP

<vspace blankLines="1" />

This is the case where one MR registers different
CoAs to the same HA for the same subnet
prefix.  This is equivalent to the case of y=1, i.e., the
(1,1,*) mobile network.
</t>

<!-- JetSet -->
<t>
JetSet: Multiple HAs for Different CoAs of Same MNP

<vspace blankLines="1" />

This is the case where the MR registers different
CoAs to different HAs for the same subnet
prefix.  This is equivalent to the case of y=n, i.e., the (1,n,*)
mobile network.
</t>

<!-- Shinkansen -->
<t>
Shinkansen: Single MNP Advertised by MR(s)

<vspace blankLines="1" />

This is the case where one MNP is announced by different
MRs.  This is equivalent to the case of x=n and z=1,
i.e., the (n,*,1) mobile network.
</t>

<!-- DoubleBed -->
<t>
DoubleBed: Multiple MNPs Advertised by MR(s)

<vspace blankLines="1" />

This is the case where more than one MNPs are
announced by the different MRs.  This is equivalent to the
case of x=n and z=n, i.e., the (n,*,n) mobile network.
</t>
</list>
</t>

</section> <!-- Class.Problem-Oriented -->

</section> <!-- Alternative.Classification -->

<!-------------------------------------------------------->
<!--	APPENDIX B					-->
<!-------------------------------------------------------->

<section anchor="sec:nested-tunnel"
	title="Nested Tunneling for Fault Tolerance">

<t>
In order to utilize the additional robustness provided by multihoming,
MRs that employ bi-directional tunneling with
their HAs should dynamically change their tunnel exit points
depending on the link status.  For instance, if an MR
detects that one of its egress interface is down, it should detect if alternate routes to the global Internet exists.  This
alternate route may be provided by any other MRs connected
to one of its ingress interfaces that has an independent route to the
global Internet, or by another active egress interface the MR
itself possesses.  If such an alternate route exists, the
MR should re-establish the bi-directional tunnel using
this alternate route.
<t>

</t>
In the remaining part of this Appendix, we will attempt to investigate
methods of performing such re-establishment of bi-directional
tunnels.  This method of tunnel re-establishment is particularly useful for
the (*,n,n) NEMO configuration.  The method described is by no means complete
and merely serves as a suggestion on how to approach the problem.
It is also not the objective to specify a new
protocol specifically tailored to provide this form of re-establishments.  Instead, we will limit ourselves to currently
available mechanisms specified in Mobile IPv6 <xref target="RFC3775"/>
and Neighbor Discovery in IPv6 <xref target="RFC2461" />.
</t>

<!-------------------------------------------------------->
<!--	SECTION B.1: Detect Alternate Routes		-->
<!-------------------------------------------------------->

<section anchor="sec:nested-tunnel.detect-alt"
	title="Detecting Presence of Alternate Routes">

<t>
To actively utilize the robustness provided by multihoming, an MR
must first be capable of detecting alternate routes.  This can
be manually configured into the MR by the administrators
if the configuration of the mobile network is relatively static.  It
is however highly desirable for MRs to be able to discover
alternate routes automatically for greater flexibility.
</t>
<t>
The case where an MR possesses multiple egress interface
(bound to the same HA or otherwise) should be trivial, since
the MR should be able to "realize" it has multiple routes
to the global Internet.
</t>
<t>
In the case where multiple MRs are on the mobile network,
each MR has to detect the presence of other MR.
An MR can do so by listening for Router Advertisement
message on its *ingress* interfaces. When an MR receives a
Router Advertisement message with a non-zero Router Lifetime field
from one of its ingress interfaces, it knows that another MR
that can provide an alternate route to the global Internet is
present in the mobile network.
</t>

<!--
[1:MARCELO] --------------------------------
In can see that this covers the case where both MR are on the same
link. However, what if the MRs are in different links, would this be
enough or   using routing protocols is needed?

[2:CWNG] --------------------------------
When two MRs are on different links, this implies there must be a third
router within the NEMO, right?

Anycase, this is a bit complicated, as you now thread into nested
NEMO.   More serious thought need to into it, but I suspect we might end
up re-inventing MANET if one goes deeper into such cases.  Suffice to
say that the mechanism in Appendix B would not work if only one MR is
advertising a global route on any link of the NEMO.

[3:MARCELO] --------------------------------
Well, my observation was more general. I mean, RA are link scoped, so
when you have more than one link, some info may be lost. In this case,
the info lost is the info about what router is announcing which prefix,
i guess. Suppose a case where you have three MR and three different
prefixes and each MR is in a different link and regular routers in
between. Suppose now that only a single MR is working, how do the other
MR identfy which prefix they have to use to configure the new CoA?
In this case, there are three prefixes being announced and an MR whose
link has failed, knows that his prefix is not to be used, but it has
not enough info to decide which one of the other two prefixes to use to
configure the new CoA.
Agree?
You probably need a mechanism to allow an MR to withdraw its own prefix
when it discovers that its link is no longer working. But for this you
cannot use RA, you need to move to router renumbering or dhcp, i guess

Another issue that it is not covered in this solution is the ingress
filtering compatibility. I eman, in the regular situation, when the two
prefixes are available, you may have problems with ingress filtering,
unless you use source address based routing or something similar,
right? i guess you need additional mechanisms to deal with this, like
tunnels between the MR in order to forward the packet through the MR
that is linked to the provider that has delegated the Nemo prefix that
is included in the source address of the packet.

-->

<!--vspace blankLines="100"-->
<!-- ensure a page break -->

</section>
<!-- Appendix B -- Detect Alternate -->

<!-------------------------------------------------------->
<!--	SECTION B.2: Re-Establish Tunnel		-->
<!-------------------------------------------------------->

<section anchor="sec:nested-tunnel.re-est"
	title="Re-Establishment of Bi-Directional Tunnels">

<t>
When an MR detects that the link by which its current bi-directional
tunnel with its HA is using is down,
<!--
[1:MARCELO] --------------------------------
i think this needs some rephrasing

[2:CWNG] --------------------------------
Yep, like "be"->"by"
[NOTE: CHANGED]
-->
it needs to
re-establish the bi-directional tunnel using an alternate route
detected.  We consider two separate cases here: firstly, the
alternate route is provided by another egress interface that belongs
to the MR; secondly, the alternate route is provided by
another MR connected to the mobile network.   We refer to
the former case as an alternate route provided by an alternate egress
interface, and the latter case as an alternate route provided by an
alternate MR.
</t>

<section anchor="sec:nested-tunnel.re-est.alt-iface"
	title="Using Alternate Egress Interface">
<t>
When an egress interface of an MR loses the connection to
the global Internet, the MR can make use of its alternate
egress interface should it possess multiple egress interfaces. The
most direct way to do so is for the MR to send a binding
update to the HA of the failed interface using the CoA
assigned to the alternate interface in order to re-establish
the bi-directional tunneling using the CoA on the
alternate egress interface.  After a successful binding update, the
MR encapsulates outgoing packets through the bi-directional
tunnel using the alternate egress interface.
</t>
<t>
The idea is to use the global address (most likely a CoA)
assigned to an alternate egress interface as the new (back-up) CoA
of the MR to re-establish the bi-directional
tunneling with its HA.
</t>
</section> <!-- Alternate egress Interface -->

<section anchor="sec:nested-tunnel.re-est.alt-MR"
	title="Using Alternate Mobile Router">
<t>
When the MR loses a connection to the global Internet, the
MR can utilize a route provided by an alternate MR
(if one exists) to re-establish the bi-directional tunnel with
its HA.  First, the MR has to obtain a CoA
from the alternate MR (i.e., attach itself to the
alternate MR).  Next, it sends binding update to its HA
using the CoA obtained from the alternate MR.
From then on, the MR can encapsulate outgoing
packets through the bi-directional tunnel via the alternate MR.
</t>
<t>
The idea is to obtain a CoA from the alternate MR
and use this as the new (back-up) CoA of the
MR to re-establish the bi-directional tunneling with its HA.
</t>
<?rfc needLines="8" ?>
<t>
Note that every packet sent between MNNs and
their correspondent nodes will experience two levels of encapsulation.
The first level of tunneling occurs between an MR that the
MNN uses as its default router and the MR's HA.
The second level of tunneling occurs between
the alternate MR and its HA.
</t>

<!--
[1:MARCELO] --------------------------------
AFAIU, in this section is being assumed that each MR has a different
nemo-prefix assigned, is this correct?

[2:CWNG] --------------------------------
Not really.  No assumption is made on the number of prefixes.

[1:MARCELO] --------------------------------
I mean, what happens if there is s single nemo prefix?
What happens if there are multiple nemo prefixes but all the MR
announce all of them?
How does the MR creates a CoA of the "other" MR in this case?

[2:CWNG] --------------------------------
In the case where the other MR advertises all the prefixes it owns,
there is no need to do recovery, since an alternate route exits for all
the prefixes anyway (through the other MR).  The MR can simply set
Lifetime=0 and forces all MNNs to use the other router as their default
router.  No harm done.

In the case where at least one prefix was not advertised by the other
MR, it will autoconfigures an address based on the prefix advertised by
the alternate MR, and use it as the CoA.  The BU it sent will only
register the prefix that was not advertised by the other MR.

Any problem here?

[3:MARCELO] --------------------------------
Well, the point is that when there is a single prefix in the nemo, you
don't need this solution :-), at least not all of it. You still need
the mechanisms to detect failures in the tunnel.
Depending on the number of home agents, you may need a routing protocol
to discover which HA to use.
Something similar happens when there are multiple prefixes but all of
them are supported by all the HAs. In this case, you don't need this
double tunneling stuff, and the mechanism that is used for the single
prefix case will work fine here also.

In addition, you can probably optimize the double tunneling issue when
there is a single HA, since this HA knows both MR. imho this is a very
common case, especially when you are using multihoming to provide
ubiquity rather than fault tolerance.

My point is that there are several scenarios that have different
approaches and require different variations/optimizations, so it would
be good to describe all of them and define which tools are required in
each scenario.

makes sense to you?

[2:THIERRY] --------------------------------
I guess we will need a careful look on the appendix.

[3:MARCELO] --------------------------------
I think that the approach presented in this appendix is very
interesting. However i wonder if this should be placed in an appendix
of a analysis document. I would say that this should be moved to a
separate document covering the nemo multihoming support approach and
that this document should study in detail the proposed approach in all
the relevant scenarios in order to verity that it provides the desired
capabilities.

[4:CWNG] --------------------------------
This solution has always been with the draft since its initial
incarnation (i.e. draft-ng-nemo-multihoming-issues-00.txt).  I agree
that having it in a separate document is the more desirable approach.

[5:MARCELO] --------------------------------
Well as i mentioned, i guess that this approach deserves to be fully
developed, and all the relevant senarios need to be considered, and
imho an appendix is not the place to include all this detailed
information.
-->

</section><!-- Appendix B -- Alternate Router -->

</section><!-- Appendix B -- Re-establish Tunnel -->

<!-------------------------------------------------------->
<!--	SECTION B.3: Avoid Loop				-->
<!-------------------------------------------------------->

<section anchor="sec:nested-tunnel.avoid-loop"
	title="To Avoid Tunneling Loop">

<t>
The method of re-establishing the bi-directional tunnel as described
in <xref target="sec:nested-tunnel.re-est"/>
may lead to infinite loops of tunneling.  This happens
when two MRs on a mobile network lose connection to the
global Internet at the same time and each MR tries to
re-establish bi-directional tunnel using the other MR.  We
refer to this phenomenon as tunneling loop.
</t>
<t>
One approach to avoid tunneling loop is for an MR that has
lost connection to the global Internet to insert an option into the
Router Advertisement message it broadcasts periodically.  This option
serves to notify other MRs on the link that the sender no
longer provides global connection.  Note that setting a zero Router
Lifetime field will not work well since it will cause MNNs
that are attached to the MR to stop using the MR
as their default router too  (in which case, things are back to
square one).
</t>

</section><!-- Appendix B -- Avoid loop -->

<section anchor='sec:nested-tunnel.considerations'
		 title="Points of Considerations">

<t>
  This method of using tunnel re-establishments is by no means a complete
  solution.  There are still points to consider in order to develop it into
  a fully functional solution.  For instance, 
  in <xref target="sec:nested-tunnel.detect-alt"/>, it was suggested
  that MR detects the presence of other MRs using Router Advertisements.
  However, Router Advertisements are link scoped, so when there is more 
  than one link, some information may be lost.   For instance, suppose 
  a case where there are three MRs and three different prefixes and 
  each MR is in a different link with regular routers in between. 
  Suppose now that only a single MR is working; how do the other
  MRs identify which prefix they have to use to configure the new CoA?
  In this case, there are three prefixes being announced, and an MR whose
  link has failed knows that its prefix is not to be used, but it does
  not have enough information to decide which one of the other two prefixes 
  to use to configure the new CoA.
  In such cases, a mechanism is needed to allow an MR to withdraw its 
  own prefix when it discovers that its link is no longer working. 
</t>

</section> <!-- Appendix B -- Other Considerations -->

</section> <!-- Appendix B -->

</back>

</rfc>

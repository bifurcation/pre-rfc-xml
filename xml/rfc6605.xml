<?xml version="1.0" encoding="US-ASCII"?><!DOCTYPE rfc SYSTEM "rfc2629.dtd" [<!ENTITY rfc2119 SYSTEM 	"http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml"><!ENTITY rfc4033 SYSTEM 	"http://xml.resource.org/public/rfc/bibxml/reference.RFC.4033.xml"><!ENTITY rfc4034 SYSTEM 	"http://xml.resource.org/public/rfc/bibxml/reference.RFC.4034.xml"><!ENTITY rfc4035 SYSTEM 	"http://xml.resource.org/public/rfc/bibxml/reference.RFC.4035.xml"><!ENTITY rfc4509 SYSTEM 	"http://xml.resource.org/public/rfc/bibxml/reference.RFC.4509.xml"><!ENTITY rfc5114 SYSTEM 	"http://xml.resource.org/public/rfc/bibxml/reference.RFC.5114.xml"><!ENTITY rfc5155 SYSTEM 	"http://xml.resource.org/public/rfc/bibxml/reference.RFC.5155.xml"><!ENTITY rfc5430 SYSTEM 	"http://xml.resource.org/public/rfc/bibxml/reference.RFC.5430.xml"><!ENTITY rfc6090 SYSTEM 	"http://xml.resource.org/public/rfc/bibxml/reference.RFC.6090.xml"><!ENTITY rfc6234 SYSTEM 	"http://xml.resource.org/public/rfc/bibxml/reference.RFC.6234.xml">]><!DOCTYPE rfc SYSTEM "rfc2629.dtd"><?rfc rfcedstyle="yes"?><?rfc strict='yes'?><?rfc toc="no" ?><?rfc symrefs="yes" ?><?rfc sortrefs="yes"?><?rfc strict="no" ?><?rfc compact="yes" ?><?rfc subcompact="no" ?><rfc number="6605" category="std" ipr="trust200902"><front><title abbrev="ECDSA for DNSSEC">Elliptic Curve Digital Signature Algorithm (DSA) for DNSSEC</title><author initials='P.' surname="Hoffman" fullname='Paul Hoffman'><organization>VPN Consortium</organization><address><email>paul.hoffman@vpnc.org</email></address></author><author initials='W.' surname="Wijngaards" fullname='Wouter Wijngaards'><organization>NLnet Labs</organization><address><email>wouter@nlnetlabs.nl</email></address></author><date month="April" year="2012"/><!-- [rfced] Please insert any keywords (beyond those that appear inthe title) for use on http://www.rfc-editor.org/rfcsearch.html. --><keyword>example</keyword><abstract><t>This document describes how to specify Elliptic Curve Digital Signature Algorithm (DSA) keys andsignatures in DNS Security (DNSSEC). It lists curves of different sizes anduses the SHA-2 family of hashes for signatures.</t></abstract></front><middle><section title="Introduction"><t>DNSSEC, which is broadly defined in RFCs 4033, 4034, and 4035(<xref target='RFC4033'/>, <xref target='RFC4034'/>, and <xreftarget='RFC4035'/>), uses cryptographickeys and digital signatures to provide authentication of DNS data.Currently, the most popular signature algorithm is RSA with SHA-1,using keys that are 1024 or 2048 bits long.</t><t>This document defines the DNSKEY andRRSIG resource records (RRs) of two new signing algorithms:ECDSA (Elliptic Curve DSA) with curve P-256 and SHA-256,andECDSA with curve P-384 and SHA-384. (A description of ECDSAcan be found in <xref target='FIPS-186-3'/>.)This document also defines the DS RR for the SHA-384one-way hash algorithm; the associated DS RR for SHA-256 is alreadydefined in RFC 4509 <xref target='RFC4509'/>.<xref target="RFC6090"/> provides a good introduction to implementing ECDSA.</t><t>Current estimates are that ECDSA with curve P-256 has anapproximate equivalent strength to RSA with 3072-bit keys. UsingECDSA with curve P-256 in DNSSEC has some advantages anddisadvantages relative to using RSA with SHA-256 and with 3072-bitkeys. ECDSA keys are much shorter than RSA keys; at this size,the difference is 256 versus 3072 bits. Similarly, ECDSA signaturesare much shorter than RSA signatures. This is relevant because DNSSECstores and transmits both keys and signatures.</t><t>In the two signing algorithms defined in this document, the sizeof the key for the elliptic curve is matched with the size of theoutput of the hash algorithm. This design is based on the widespreadbelief that the equivalent strength of P-256 and P-384 is half thelength of the key, and also that the equivalent strength of SHA-256and SHA-384 is half the length of the key. Using matched strengthsprevents an attacker from choosing the weaker half of a signaturealgorithm. For example, in a signature that uses RSA with 2048-bitkeys and SHA-256, the signing portion is significantly weaker thanthe hash portion, whereas the two algorithms here are balanced.</t><t>Signing with ECDSA is significantly faster than with RSA (over 20times in some implementations). However, validating RSA signatures issignificantly faster than validating ECDSA signatures (about 5 timesfaster in some implementations).</t><t>Some of the material in this document is copied liberallyfrom RFC 5430 <xref target='RFC5430'/>.<!-- [rfced] RFC 5430 has been obsoleted by RFC 6460.  May we update the text to refer RFC 6460?  Otherwise, we recommend adding text to note the existence of RFC 6460.  Forexample, the text could be updated to read:   Some of the material in this document is copied liberally from RFC   5430 [RFC5430], which has been obsoleted by RFC 6460.Please let us know how you would like to proceed.--></t><t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALLNOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" inthis document are to be interpreted as described in RFC 2119 <xreftarget='RFC2119'/>.</t></section><section title='SHA-384 DS Records'><t>SHA-384 is defined in FIPS 180-3 <xref target='FIPS-180-3'/> andRFC 6234 <xref target='RFC6234'/>, and is similar to SHA-256 in manyways. The implementation of SHA-384 in DNSSEC follows theimplementation of SHA-256 as specified in RFC 4509 except that theunderlying algorithm is SHA-384, the digest value is 48 bytes long,and the digest type code is 4.</t></section><section title='ECDSA Parameters'><t>Verifying ECDSA signatures requires agreement between the signerand the verifier of the parameters used. FIPS 186-3 <xreftarget='FIPS-186-3'/> lists some NIST-recommended elliptic curves.(Other documents give more detail on ECDSA than is givenin FIPS 186-3.)These are the same curves listed in RFC 5114 <xref target='RFC5114'/>.The curves used in this document are:</t><figure><artwork><![CDATA[FIPS 186-3                  RFC 5114------------------------------------------------------------------P-256 (Section D.1.2.3)     256-bit Random ECP Group (Section 2.6)P-384 (Section D.1.2.4)     384-bit Random ECP Group (Section 2.7)]]></artwork></figure></section><section title='DNSKEY and RRSIG Resource Records for ECDSA'><t>ECDSA public keys consist of a single value, called "Q" in FIPS186-3. In DNSSEC keys, Q is a simple bit string that representsthe uncompressed form of a curve point, "x | y".</t><t>The ECDSA signature is the combination of two non-negative integers,called "r" and "s" in FIPS 186-3. The two integers, each of which isformatted as a simple octet string, are combined into a single longeroctet string for DNSSEC as the concatenation "r | s".(Conversion of the integers to bit strings is described in Section C.2 of FIPS 186-3.)For P-256, each integer MUST be encoded as 32 octets; for P-384,each integer MUST be encoded as 48 octets.</t><t>The algorithm numbers associated with the DNSKEY and RRSIG resourcerecords are fully defined in the IANA Considerations section. They are:</t><t><list style='symbols'><t>DNSKEY and RRSIG RRs signifying ECDSA with theP-256 curve and SHA-256 use the algorithm number 13.</t><t>DNSKEY and RRSIG RRs signifying ECDSA with theP-384 curve and SHA-384 use the algorithm number 14.</t></list></t><t>Conformant implementations that create records to be put into the DNS MUSTimplement signing and verification for both of the above algorithms.Conformant DNSSEC verifiers MUST implement verification for both of the abovealgorithms.</t></section><section title='Support for NSEC3 Denial of Existence'><t>RFC 5155 <xref target='RFC5155'/> defines new algorithmidentifiers for existing signing algorithms to indicate that zonessigned with these algorithm identifiers can use NSEC3 as well as NSECrecords to provide denial of existence.  That mechanism was chosen toprotect implementations predating RFC 5155 from encountering resourcerecords they could not know about.  This document does not definesuch algorithm aliases.</t><t>A DNSSEC validator that implements the signing algorithms definedin this document MUST be able to validate negative answers in theform of both NSEC and NSEC3 with hash algorithm 1, as defined in RFC5155.  An authoritative server that does not implement NSEC3 MAYstill serve zones that use the signing algorithms defined in thisdocument with NSEC denial of existence.</t></section><section title="Examples"><t> The following are some examples of ECDSA keys and signatures inDNS format. </t><section title="P-256 Example"><figure><artwork><![CDATA[Private-key-format: v1.2Algorithm: 13 (ECDSAP256SHA256)PrivateKey: GU6SnQ/Ou+xC5RumuIUIuJZteXT2z0O/ok1s38Et6mQ=example.net. 3600 IN DNSKEY 257 3 13 (        GojIhhXUN/u4v54ZQqGSnyhWJwaubCvTmeexv7bR6edb        krSqQpF64cYbcB7wNcP+e+MAnLr+Wi9xMWyQLc8NAA== )example.net. 3600 IN DS 55648 13 2 (        b4c8c1fe2e7477127b27115656ad6256f424625bf5c1        e2770ce6d6e37df61d17 )www.example.net. 3600 IN A 192.0.2.1www.example.net. 3600 IN RRSIG A 13 3 3600 (        20100909100439 20100812100439 55648 example.net.        qx6wLYqmh+l9oCKTN6qIc+bw6ya+KJ8oMz0YP107epXA        yGmt+3SNruPFKG7tZoLBLlUzGGus7ZwmwWep666VCw== )]]></artwork></figure></section><section title="P-384 Example"><figure><artwork><![CDATA[Private-key-format: v1.2Algorithm: 14 (ECDSAP384SHA384)PrivateKey: WURgWHCcYIYUPWgeLmiPY2DJJk02vgrmTfitxgqcL4vwW7BOrbawVmVe0d9V94SRexample.net. 3600 IN DNSKEY 257 3 14 (        xKYaNhWdGOfJ+nPrL8/arkwf2EY3MDJ+SErKivBVSum1        w/egsXvSADtNJhyem5RCOpgQ6K8X1DRSEkrbYQ+OB+v8        /uX45NBwY8rp65F6Glur8I/mlVNgF6W/qTI37m40 )example.net. 3600 IN DS 10771 14 4 (        72d7b62976ce06438e9c0bf319013cf801f09ecc84b8        d7e9495f27e305c6a9b0563a9b5f4d288405c3008a94        6df983d6 )www.example.net. 3600 IN A 192.0.2.1www.example.net. 3600 IN RRSIG A 14 3 3600 (        20100909102025 20100812102025 10771 example.net.        /L5hDKIvGDyI1fcARX3z65qrmPsVz73QD1Mr5CEqOiLP        95hxQouuroGCeZOvzFaxsT8Glr74hbavRKayJNuydCuz        WTSSPdz7wnqXL5bdcJzusdnI0RSMROxxwGipWcJm )]]></artwork></figure></section></section><section title="IANA Considerations"><t>This document updates the IANA registry for digest types in DS records,currently called "Delegation Signer (DS) Resource Record (RR) Type Digest Algorithms". The following entry has been added:</t><figure><artwork><![CDATA[Value          4Digest Type    SHA-384Status         OPTIONAL]]></artwork></figure><t>This document updates the IANA registry "Domain Name SystemSecurity (DNSSEC) Algorithm Numbers". The following two entries have beenadded to the registry:</t><figure><artwork><![CDATA[Number         13Description    ECDSA Curve P-256 with SHA-256Mnemonic       ECDSAP256SHA256Zone Signing   YTrans. Sec.    *Reference      This documentNumber         14Description    ECDSA Curve P-384 with SHA-384Mnemonic       ECDSAP384SHA384Zone Signing   YTrans. Sec.    *Reference      This document* There has been no determination of standardization of the   use of this algorithm with Transaction Security.]]></artwork></figure></section><section title="Security Considerations"><t>The cryptographic work factor of ECDSA with curve P-256 or P-384 isgenerally considered to be equivalent to half the size of the key, or128 bits and 192 bits, respectively. Such an assessment could, ofcourse, change in the future if new attacks that work better than theones known today are found.</t><t>The security considerations listed in RFC 4509 apply hereas well.</t></section></middle><back><references title="Normative References"><reference anchor="FIPS-180-3"><front><title>Secure Hash Standard (SHS)</title><author><organization abbrev="NIST">National Institute of Standards andTechnology, U.S. Department of Commerce</organization></author><date month="October" year="2008"/></front><seriesInfo name="FIPS" value="180-3"/></reference><reference anchor="FIPS-186-3"><front><title>Digital Signature Standard</title><author><organization abbrev="NIST">National Institute of Standards andTechnology, U.S. Department of Commerce</organization></author><date month="June" year="2009"/></front><seriesInfo name="FIPS" value="186-3"/></reference>&rfc2119;&rfc4033;&rfc4034;&rfc4035;&rfc4509;&rfc5114;&rfc5155;</references><references title="Informative References">&rfc5430;&rfc6090;&rfc6234;</references></back></rfc>
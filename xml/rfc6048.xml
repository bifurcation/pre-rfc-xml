<?xml version="1.0" encoding="US-ASCII"?>

<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc toc="yes"?>
<?rfc rfcedstyle="yes"?>

<?xml-stylesheet type='text/xsl' href='rfc2629.xslt'?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
  <!-- Key words for use in RFCs to Indicate Requirement Levels -->
  <!ENTITY rfc2119 PUBLIC ''
    'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml'>
  <!-- Common NNTP Extensions -->
  <!ENTITY rfc2980 PUBLIC ''
    'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2980.xml'>
  <!-- UTF-8, a transformation format of ISO 10646 -->
  <!ENTITY rfc3629 PUBLIC ''
    'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3629.xml'>
  <!-- Network News Transfer Protocol (NNTP) -->
  <!ENTITY rfc3977 PUBLIC ''
    'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3977.xml'>
  <!-- Augmented BNF for Syntax Specifications:  ABNF -->
  <!ENTITY rfc5234 PUBLIC ''
    'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5234.xml'>
  <!-- Internet Message Format -->
  <!ENTITY rfc5322 PUBLIC ''
    'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5322.xml'>
  <!-- USEFOR -->
  <!ENTITY rfc5536 PUBLIC ''
    'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5536.xml'>
  <!-- USEPRO -->
  <!ENTITY rfc5537 PUBLIC ''
    'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5537.xml'>
]>

<rfc ipr="trust200902" number="6048"
     updates="2980, 3977" category="std">

  <front>

    <title abbrev="NNTP Additions to LIST Command">Network News Transfer
    Protocol (NNTP) Additions to LIST Command</title>

    <author initials="J." surname="Elie" fullname="Julien Elie">
      <organization />
      <address>
        <postal>
          <street>13 rue Marx Dormoy</street>
          <code>93160</code>
          <city>Noisy-le-Grand</city>
          <country>France</country>
        </postal>
        <email>julien@trigofacile.com</email>
        <uri>http://www.trigofacile.com/</uri>
      </address>
    </author>

    <date month="November" year="2010" />

    <area>Applications</area>

    <keyword>Usenet</keyword>
    <keyword>NetNews</keyword>
    <keyword>capabilities</keyword>

    <abstract>

      <t>This document defines a set of enhancements to the Network News
      Transfer Protocol (NNTP) that allow a client to request extended
      information from NNTP servers regarding server status, policy, and
      other aspects of local configuration.  These enhancements are made as
      new keywords to the existing LIST capability described in RFC 3977.</t>

      <t>This memo updates and formalizes the LIST DISTRIBUTIONS and
      LIST SUBSCRIPTIONS commands defined in RFC 2980.  It also adds the
      LIST COUNTS, LIST MODERATORS, and LIST MOTD
      commands, and specifies
      additional values returned by the existing LIST ACTIVE command for
      the status of a newsgroup.</t>

    </abstract>

  </front>

  <middle>

    <section title="Introduction">

      <t>The NNTP specification <xref target="RFC3977" /> defines the
      LIST capability and a few keywords that can be used with that
      command: ACTIVE, ACTIVE.TIMES, DISTRIB.PATS, HEADERS, NEWSGROUPS,
      and OVERVIEW.FMT.  Other variants of the LIST command are in use, but
      with limited or absent documentation.  These variants are formalized
      in this document.</t>

      <t>The DISTRIBUTIONS and SUBSCRIPTIONS variants were originally
      documented in <xref target="RFC2980" />.  The LIST DISTRIBUTIONS
      command is sent by a news client to obtain a list of relevant
      distributions known by a news server along with their descriptions.
      The LIST SUBSCRIPTIONS command is sent by a news client when first
      connecting to a news server so as to obtain a list of recommended
      newsgroups available on it.  Both of these commands are intended
      to be used in place of hard-coding news clients to use specific
      distributions or look for specific default newsgroups.</t>

      <t>The MOTD variant was originally documented in <xref
      target="NNTP_LIST" /> (which also describes the
      SUBSCRIPTIONS variant).  The LIST MOTD command is sent by a news
      client to obtain a "message of the day" from the server administrator
      regarding the current state of a news server.</t>

      <t>The COUNTS and MODERATORS variants have not been documented before.
      The LIST COUNTS command is similar to LIST ACTIVE, except that it
      also returns an estimated number of articles in each newsgroup.
      The LIST MODERATORS command is sent by a news client to obtain a
      list of associations between a moderated newsgroup and its submission
      address template.</t>

      <t>The ACTIVE variant was formalized in <xref target="RFC3977" />,
      but the meanings of only three status field values in LIST ACTIVE responses
      have been specified: "y", "n", and "m".  These statuses
      are particularly useful for readers, since they describe local posting
      rights.  However, several other statuses are in use that are primarily
      useful for peers as they mainly describe how remote articles coming
      from peers are locally handled by a given news server.  This memo
      defines three other values for the status field in LIST ACTIVE
      responses: "x", "j", and "=" followed by the name of a newsgroup.</t>

      <t>This specification should be read in conjunction with the
      NNTP base specification <xref target="RFC3977" />.  In the case
      of a conflict between
      these two documents, <xref target="RFC3977" /> takes precedence.</t>

      <section title="Conventions Used in This Document">

        <t>The notational conventions used in this document are the same
        as those in <xref target="RFC3977" />, and any term not defined
        in this document has the same meaning as it does in that one.</t>

        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
        "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
        "OPTIONAL" in this document are to be interpreted as described in
        <xref target="RFC2119" />.</t>

        <t>When a hexadecimal correspondence is given to an octet in
        this document, the value is in US-ASCII <xref target="ASCII" />
        (for instance, ".", noted %x2E).</t>

        <t>In the examples, commands from the client are indicated with [C],
        and responses from the server are indicated with [S].  The client
        is the initiator of the NNTP connection; the server is the other
        endpoint.</t>

      </section>

      <section title="Author's Note">

        <t>Please write the first letter of &quot;Elie&quot; with an
        acute accent wherever possible -- it is U+00C9, that is to say
        &quot;&amp;#201;&quot; in XML.</t>

      </section>

    </section>

    <section title="New LIST Variants">

      <t>The LIST capability is defined in Section 7.6 of <xref
      target="RFC3977" />.  It allows the server to provide useful
      information to the client in multi-line blocks.</t>

      <t>This document provides five new keywords to the LIST capability:
      COUNTS, DISTRIBUTIONS, MODERATORS, MOTD, and SUBSCRIPTIONS.</t>

      <t>Each keyword is OPTIONAL and corresponds to the same-named variant
      of the LIST command.</t>

      <section title="Advertising the New LIST Variants">

        <t>When a news server implements a variant of the LIST command as
        described in this specification, it advertises the corresponding
        feature in the LIST capability.  Where one of these new LIST
        keywords is advertised, it MUST have the meaning given in this
        specification.</t>

        <t>For instance, if a news server implements the SUBSCRIPTIONS
        variant, it will add the SUBSCRIPTIONS keyword to the LIST capability
        in response to the CAPABILITIES command (see Section 5.2 of <xref
        target="RFC3977" />):</t>

<figure><artwork><![CDATA[
   [C] CAPABILITIES
   [S] 101 Capability list:
   [S] VERSION 2
   [S] READER
   [S] LIST ACTIVE NEWSGROUPS SUBSCRIPTIONS
   [S] .
   [C] LIST SUBSCRIPTIONS
   [S] 215 List of recommended newsgroups follows
   [S] local.welcome
   [S] local.test
   [S] news.newusers.questions
   [S] news.announce.newusers
   [S] .
]]></artwork></figure>

        <t>For each of the new LIST variants described in this specification,
        an empty response can be sent to the client:</t>

<figure><artwork><![CDATA[
   [C] LIST SUBSCRIPTIONS
   [S] 215 List of recommended newsgroups follows
   [S] .
]]></artwork></figure>

        <t>This means that the information is maintained by the news server
        but that it is voluntarily empty.  Frequently, the news server
        maintains the information in a configuration file.  This file can
        be empty or contain only commented or blank lines, indicating a
        voluntary absence of information.</t>

        <t>When the news server software implements one of these LIST
        variants but a particular server does not maintain the information
        (for instance, when the configuration file does not exist), the
        503 response code MUST be returned:</t>

<figure><artwork><![CDATA[
   [C] LIST SUBSCRIPTIONS
   [S] 503 No list of recommended newsgroups available
]]></artwork></figure>

      </section>

      <section title="LIST COUNTS" anchor="sec_counts">

        <section title="Usage">

          <list style="hanging" hangIndent="1">
            <t hangText="Syntax"><vspace />LIST COUNTS [wildmat]</t>
            <t hangText="Responses"><vspace />
              215&nbsp;&nbsp;&nbsp;&nbsp;List of newsgroups follows
              (multi-line)</t>
            <t hangText="Parameters"><vspace />
              wildmat&nbsp;&nbsp;&nbsp;&nbsp;Groups of interest</t>
          </list>

        </section>

        <section title="Description">

          <t>See Section 7.6.1 of <xref target="RFC3977" /> for general
          requirements of the LIST command.</t>

          <t>The LIST COUNTS command returns a list of valid newsgroups
          carried by the news server along with associated information,
          the "counts list", and is similar to LIST ACTIVE.</t>

          <t>The information is returned as a multi-line data block following
          the 215 response code and contains one line per newsgroup.
          Each line of this list MUST consist of five fields separated
          from each other by one or more spaces (the usual practice is a
          single space) in the following order:</t>

          <t><list style="symbols">

            <t>The name of the newsgroup.</t>
            <t>The reported high water mark for the group.</t>
            <t>The reported low water mark for the group.</t>
            <t>The estimated number of articles in the group.</t>
            <t>The current status of the group on this server.</t>

          </list></t>

          <t>The reported high and low water marks, and the estimated
          number of articles, are as described in the GROUP command (see
          Section 6.1.1 of <xref target="RFC3977" />), but note that they
          are in the opposite order to the 211 response (that is, number low
high group) to the GROUP command.

          The current status of the group is as described in the LIST ACTIVE
          command (see Section 7.6.3 of <xref target="RFC3977" />, as well
          as <xref target="sec_additions" /> of this document).  Also note
          that, similarly to the LIST ACTIVE command, TAB characters are
          not valid separators for the LIST COUNTS command.</t>

          <t>The order of newsgroups in the counts list is not significant.
          The server need not consistently return the same order or the same
          results if this command is used more than once in a session.</t>

          <t>The same newsgroup SHOULD NOT appear twice in the output of
          this command.</t>

          <t>The counts list is newsgroup-based, and a wildmat MAY be
          specified, in which case the response is limited to only the
          groups, if any, whose names match the wildmat.  If no wildmat
          is specified, the server MUST include every newsgroup that the
          client is permitted to select with the GROUP command (see Section
          6.1.1 of <xref target="RFC3977" />).</t>

          <t>The counts list MAY be empty.  If the server does not
          maintain the information, a 503 response code MUST be returned.
          (However, note that a news server that supports this command
          usually maintains the information.)</t>

          <t>The client MAY use LIST COUNTS in order to obtain an estimate
          of the number of articles in every newsgroup the server carries,
          which enables it to provide the end user with this information.
          This provides a simpler mechanism for a client to obtain the
          estimated number of articles in newsgroups, compared with a
          sequence of individual GROUP commands.</t>

        </section>

        <section title="Examples">

          <t>Example of output with no argument:</t>

<figure><artwork><![CDATA[
   [C] CAPABILITIES
   [S] 101 Capability list:
   [S] VERSION 2
   [S] READER
   [S] LIST ACTIVE COUNTS NEWSGROUPS
   [S] .
   [C] LIST COUNTS
   [S] 215 List of newsgroups follows
   [S] misc.test 3002322 3000234 1234 y
   [S] comp.risks 442001 441099 742 m
   [S] rec.food.drink.tea 100 51 3 y
   [S] local.empty 7 8 0 y
   [S] local.tea 2004 1504 301 y
   [S] .
]]></artwork></figure>

          <t>Example of output with a wildmat:</t>

<figure><artwork><![CDATA[
   [C] LIST COUNTS *.tea,misc.*,!local.*
   [S] 215 List of newsgroups follows
   [S] misc.test 3002322 3000234 1234 y
   [S] rec.food.drink.tea 100 51 3 y
   [S] .
]]></artwork></figure>

          <t>Example of output on an implementation that includes leading
          zeroes:</t>

<figure><artwork><![CDATA[
   [C] LIST COUNTS
   [S] 215 List of newsgroups follows
   [S] misc.test 0003002322 0003000234 1234 y
   [S] comp.risks 0000442001 0000441099 742 m
   [S] rec.food.drink.tea 0000000100 0000000051 3 y
   [S] local.empty 0000000007 0000000008 0 y
   [S] local.tea 0000002004 0000001504 301 y
   [S] .
]]></artwork></figure>

          <t>The estimated number of articles usually does not start with
          leading zeroes, but MAY start with such zeroes.</t>

        </section>

      </section>

      <section title="LIST DISTRIBUTIONS" anchor="sec_distributions">

        <section title="Usage">

          <list style="hanging" hangIndent="1">
            <t hangText="Syntax"><vspace />LIST DISTRIBUTIONS</t>
            <t hangText="Responses"><vspace />
              215&nbsp;&nbsp;&nbsp;&nbsp;Distributions list follows
              (multi-line)</t>
          </list>

        </section>

        <section title="Description">

          <t>See Section 7.6.1 of <xref target="RFC3977" /> for general
          requirements of the LIST command.</t>

          <t>A "distributions list" is maintained by some NNTP servers
          to contain the name of each distribution that is known by the
          news server and a short description about the meaning of the
          distribution.  Distributions are used by clients as potential
          values for the Distribution header field body of a news article
          being posted (see Section 3.2.4 of <xref target="RFC5536" />
          for the definition of this header field).</t>

          <t>The information is returned as a multi-line data block following
          the 215 response code and contains one line per distribution.
          Each line of this list MUST consist of two fields separated from
          each other by one or more space or TAB characters (the usual
          practice is a single TAB).  The first field is the name of the
          distribution, and the second field is a short description of
          the distribution.  There are no leading or trailing whitespaces
          in a line.  The description MAY contain whitespaces.</t>

          <t>The order of distributions in the distributions list is not significant;
          the server need not consistently return the same order or the same
          results if this command is used more than once in a session.</t>

          <t>The same distribution SHOULD NOT appear twice in the output
          of this command.</t>

          <t>The description MUST be in UTF-8 <xref target="RFC3629" />.</t>

          <t>The distributions list is not newsgroup-based, and an argument
          MUST NOT be specified.  Otherwise, a 501 response code MUST
          be returned.</t>

          <t>The distributions list MAY be empty.  If the server does not
          maintain the information, a 503 response code MUST be returned.</t>

          <t>The client MAY use this information to generate or supplement
          a list of known distributions provided to the user.  If the news
          server implements the LIST DISTRIBUTIONS command, it SHOULD also
          implement the LIST DISTRIB.PATS command (defined in Section 7.6.5
          of <xref target="RFC3977" />) and describe in the distributions
          list all the distributions present in the distrib.pats list so that
          the client can use both of these commands jointly (naturally,
          the distributions list can also describe distributions that
          are not present in the distrib.pats list).  Note that the two
          commands need not return distributions in the same order.</t>

        </section>

        <section title="Example">

          <t>Example of a joint use of LIST DISTRIB.PATS and LIST
          DISTRIBUTIONS:</t>

<figure><artwork><![CDATA[
   [C] CAPABILITIES
   [S] 101 Capability list:
   [S] VERSION 2
   [S] READER
   [S] LIST ACTIVE DISTRIB.PATS DISTRIBUTIONS NEWSGROUPS
   [S] .
   [C] LIST DISTRIB.PATS
   [S] 215 Information follows
   [S] 10:local.*:local
   [S] 5:france.*:fr
   [S] 20:local.here.*:thissite
   [S] .
   [C] LIST DISTRIBUTIONS
   [S] 215 List of distributions follows
   [S] fr Local to France.
   [S] local Local to this news server.
   [S] thissite Local to this site.
   [S] usa Local to the United States of America.
   [S] .
]]></artwork></figure>

        </section>

      </section>

      <section title="LIST MODERATORS" anchor="sec_moderators">

        <section title="Usage">

          <list style="hanging" hangIndent="1">
            <t hangText="Syntax"><vspace />LIST MODERATORS</t>
            <t hangText="Responses"><vspace />
              215&nbsp;&nbsp;&nbsp;&nbsp;Moderators list follows
              (multi-line)</t>
          </list>

        </section>

        <section title="Description">

          <t>See Section 7.6.1 of <xref target="RFC3977" /> for general
          requirements of the LIST command.</t>

          <t>The "moderators list" is maintained by some NNTP servers
          to make clients aware of how the news server will generate a
          submission e-mail address when an article is locally posted to
          a moderated newsgroup.</t>

          <t>The information is returned as a multi-line data block following
          the 215 response code.  Each line of this list MUST consist of
          two fields separated from each other by a colon (":" or %x3A).
          The first field is a wildmat (which may be a simple newsgroup
          name), and the second field is the submission address template
          for newsgroups matching that wildmat.  There are no leading or
          trailing whitespaces in a line.  The submission template MAY
          contain colons (":").</t>

          <t>The submission template is essentially an e-mail address
          (see the definition of "addr-spec" in Section 3.4.1 of <xref
          target="RFC5322" />), except with certain modifications.
          The case-sensitive string "%s" (%x25.73) MUST occur either zero or
          one time in the template.  If there is to be a literal "%" in the
          submission address, it MUST be written as "%%" in the template,
          even if not followed by an "s".  The character "%" MUST NOT occur
          in the submission template, except as part of "%s" or "%%".</t>

          <t>The order of lines in the moderators list is significant: the
          first matching line is used.  Consequently, specific patterns
          should be listed before general patterns.  Every moderated
          newsgroup name SHOULD be matched by at least one line in the list;
          often this is achieved by having a default pattern at the bottom,
          but other approaches are acceptable, and news server software MAY
          leave this up to the server administrator rather than enforcing
          it programmatically.</t>

          <t>When an article without an Approved header field is locally posted to a moderated
          newsgroup, the
          server generates a submission address from the corresponding
          submission template (that is, the second field of the first
          matching line in the moderators list) by replacing the "%s",
          if present, with the name of the matching newsgroup after
          each period ("." or %x2E) in the name has been changed to a dash
          ("-" or %x2D).  In addition, any "%%" is changed back to "%".
          The server then forwards the submitted article to the
          moderator at the resulting submission address (see Section 3.5.1 of <xref target="RFC5537" />).</t>

          <t><list style="empty">

            <t>NOTE: The creation and maintenance of submission addresses
            is outside the scope of this specification.</t>

          </list></t>

          <t>The moderators list is not newsgroup-based, and an argument
          MUST NOT be specified.  Otherwise, a 501 response code MUST
          be returned.</t>

          <t>The moderators list MAY be empty.  If the server does not
          maintain the information, a 503 response code MUST be returned,
          although these situations should not occur if the news server
          is an injecting agent that carries moderated newsgroups.</t>

        </section>

        <section title="Example">

          <t>Example of output:</t>

<figure><artwork><![CDATA[
   [C] CAPABILITIES
   [S] 101 Capability list:
   [S] VERSION 2
   [S] READER
   [S] POST
   [S] LIST ACTIVE MODERATORS NEWSGROUPS
   [S] .
   [C] LIST MODERATORS
   [S] 215 List of submission address templates follows
   [S] foo.bar:announce@example.com
   [S] local.*:%s@localhost
   [S] *:%s@moderators.example.com
   [S] .
]]></artwork></figure>

          <t>The following table describes a few examples associating a
          moderated newsgroup and its submission address on a news server
          whose moderators list is the one in the previous example:</t>

          <texttable>
            <ttcol>Name of the moderated newsgroup</ttcol>
            <ttcol>Submission address</ttcol>
            <c>foo.bar</c>
            <c>announce@example.com</c>
            <c>local.test</c>
            <c>local-test@localhost</c>
            <c>alt.dev.null</c>
            <c>alt-dev-null@moderators.example.com</c>
            <c>alt.test-me</c>
            <c>alt-test-me@moderators.example.com</c>
          </texttable>

          <t><list style="empty">

            <t>NOTE: When "%s" is used, periods are changed to dashes,
            and dashes are left alone.  This implies that two moderated
            newsgroups whose names differ only by changing a period to a dash
            would have the same submission address.  Therefore, if a server
            carries such moderated newsgroup pairs but posts should go to
            different submission addresses, a "%s" pattern template cannot
            be used for the moderation submission addresses for those groups,
            and explicit entries without a pattern will be required.</t>

            <t>Similarly, it is not recommended to use a "%s" pattern
            rule for the moderation submission template for two moderated
            newsgroups whose names differ only by the case of their
            characters, because e-mail systems frequently treat the
            left-hand side of e-mail addresses as case-sensitive.  See also
            Section 3.1.4 of <xref target="RFC5536" /> and Section 7.2 of
            <xref target="USEAGE" /> for the syntax of a
            newsgroup name.</t>

          </list></t>

        </section>

      </section>

      <section title="LIST MOTD" anchor="sec_motd">

        <section title="Usage">

          <list style="hanging" hangIndent="1">
            <t hangText="Syntax"><vspace />LIST MOTD</t>
            <t hangText="Responses"><vspace />
              215&nbsp;&nbsp;&nbsp;&nbsp;Information follows
              (multi-line)</t>
          </list>

        </section>

        <section title="Description">

          <t>See Section 7.6.1 of <xref target="RFC3977" /> for general
          requirements of the LIST command.</t>

          <t>The "motd" contains a "message of the day" relevant to
          the news server.  It is intended to provide notification and
          communication between the news administrator and the news user.
          For instance, notification of upcoming downtime or information
          about new facilities available on the news server can be
          communicated via the LIST MOTD command.</t>

          <t>The information is returned as a multi-line data block
          following the 215 response code.  This text is not guaranteed
          to be in any particular format although, like all multi-line
          data blocks, it is "dot-stuffed".</t>

          <t>The server need not return the same information if this
          command is used more than once in a session.  It MAY indeed
          send a different message of the day depending on the state of
          the session.  For instance, on a mode-switching news server,
          the information can be different between its transit mode and
          its reader mode, or between an authenticated session and an
          unauthenticated session.</t>

          <t>The information MUST be in UTF-8 <xref target="RFC3629" />.</t>

          <t>The motd is not newsgroup-based, and an argument MUST NOT
          be specified.  Otherwise, a 501 response code MUST be returned.</t>

          <t>The motd MAY be empty.  If the server does not maintain the
          information, a 503 response code MUST be returned.</t>

          <t>It is up to the client to decide when and how to display this
          message to the user.  No timestamp or date of last modification
          is provided programmatically, although the news administrator
          may include one in the text of the motd.  The client MAY cache a
          local copy or fingerprint of the motd so that it can display the
          message to the user only upon modification.  If the client caches
          the information, it MAY take into account only the motd obtained
          after reaching the intended state of the session.  Nonetheless,
          in case a privacy extension is used, the client MUST NOT cache
          any motd obtained before that extension took effect.</t>

          <t><list style="empty">

            <t>NOTE: Though the client MAY cache the results of this
            command, it MUST NOT rely on the correctness of any cached
            results, whether from earlier in the session or from a previous
            session.  If the motd is cached, the client SHOULD provide a
            way to force the cached information to be refreshed.</t>

          </list></t>

        </section>

        <section title="Example">

          <t>Example of output:</t>

<figure><artwork><![CDATA[
   [C] CAPABILITIES
   [S] 101 Capability list:
   [S] VERSION 2
   [S] READER
   [S] LIST ACTIVE MOTD NEWSGROUPS
   [S] .
   [C] LIST MOTD
   [S] 215 Message of the day follows
   [S] Attention all users,
   [S] 
   [S] This server will be down for scheduled upgrades on February 1st.
   [S] It should be back up by 8:00 a.m. February 2nd.
   [S] Any questions should be e-mailed to <newsmaster@example.com>.
   [S]
   [S] Apologies for the disturbance.
   [S] .
]]></artwork></figure>

        </section>

      </section>

      <section title="LIST SUBSCRIPTIONS" anchor="sec_subscriptions">

        <section title="Usage">

          <list style="hanging" hangIndent="1">
            <t hangText="Syntax"><vspace />LIST SUBSCRIPTIONS [wildmat]</t>
            <t hangText="Responses"><vspace />
              215&nbsp;&nbsp;&nbsp;&nbsp;Subscriptions list follows
              (multi-line)</t>
            <t hangText="Parameters"><vspace />
              wildmat&nbsp;&nbsp;&nbsp;&nbsp;Groups of interest</t>
          </list>

        </section>

        <section title="Description">

          <t>See Section 7.6.1 of <xref target="RFC3977" /> for general
          requirements of the LIST command.</t>

          <t>The "subscriptions list" is maintained by some NNTP servers
          to provide the client with a list of recommended newsgroups.</t>

          <t>The information is returned as a multi-line data block
          following the 215 response code.  Each line of this list MUST
          consist of a newsgroup name.  There are no leading or trailing
          whitespaces in a line.</t>

          <t>The order of newsgroups in the subscriptions list is significant: they
          are listed by order of importance, the first newsgroup being
          the most important to subscribe to.</t>

          <t>The same newsgroup name SHOULD NOT appear twice in the output
          of this command.  The subscriptions list SHOULD contain only newsgroups the
          news server carries.</t>

          <t>The subscriptions list is newsgroup-based, and a wildmat
          MAY be specified, in which case the response is limited to only
          the groups, if any, whose names match the wildmat.  Note that
          the wildmat argument is a new feature in this specification, and
          servers that do not support CAPABILITIES or do not advertise the
          SUBSCRIPTIONS keyword in the LIST capability (and therefore do
          not conform to this specification) are unlikely to support it.</t>

          <t>The subscriptions list MAY be empty.  If the server does not
          maintain the information, a 503 response code MUST be returned.</t>

          <t>The client MAY use this information the first time it
          connects to the news server so as to initialize the list of
          default subscribed newsgroups.  This list should therefore
          contain groups intended for new users on the news server or
          Usenet in general (for instance, newsgroups dedicated to testing,
          support, announcement, or FAQs).  The client MAY present the groups
          in the order of appearance in the list to the user.  When the
          subscriptions list is maintained and non&nbhy;empty, the news client
          SHOULD use it, instead of a hard-coded default list, if any.</t>

        </section>

        <section title="Examples">

          <t>Example of output with no argument:</t>

<figure><artwork><![CDATA[
   [C] CAPABILITIES
   [S] 101 Capability list:
   [S] VERSION 2
   [S] READER
   [S] LIST ACTIVE NEWSGROUPS SUBSCRIPTIONS
   [S] .
   [C] LIST SUBSCRIPTIONS
   [S] 215 List of recommended newsgroups follows
   [S] local.welcome
   [S] local.test
   [S] news.newusers.questions
   [S] news.announce.newusers
   [S] .
]]></artwork></figure>

          <t>Example of output with a wildmat:</t>

<figure><artwork><![CDATA[
   [C] LIST SUBSCRIPTIONS local.*
   [S] 215 List of recommended newsgroups follows
   [S] local.welcome
   [S] local.test
   [S] .
]]></artwork></figure>

        </section>

      </section>

    </section>

    <section title="Additions to LIST ACTIVE" anchor="sec_additions">

      <t>This document specifies three new status field values that can be used
      in the answers to LIST ACTIVE: "x", "j", and "=" followed by the
      name of a newsgroup.</t>

      <section title="New Status Field Values">

        <t>The LIST ACTIVE command is defined in Section 7.6.3 of <xref
        target="RFC3977" />.  The fourth field of each line of this
        list indicates the current status of the newsgroup whose name is
        specified in the first field.  Three status field values are defined
        in <xref target="RFC3977" />:</t>

        <t><list style="hanging" hangIndent="1">

          <t hangText='"y"'>Posting is permitted.</t>

          <t hangText='"n"'>Posting is not permitted.</t>

          <t hangText='"m"'>Postings will be forwarded to the newsgroup
          moderator.</t>

        </list></t>

        <t>This document defines three other case-sensitive status field values
        that can also be used:</t>

        <t><list style="hanging" hangIndent="1">

          <t hangText='"x"'>Postings and articles from peers are not
          permitted.</t>

          <t hangText='"j"'>Only articles from peers are permitted; no
          articles are locally filed.</t>

          <t hangText='"=other.group"'>Only articles from peers
          are permitted, and are filed under the newsgroup named
          "other.group".</t>

        </list></t>

        <t>The server SHOULD use these values when these meanings are
        required and MUST NOT use them with any other meaning.</t>

        <t>A newsgroup with status "x" is a newsgroup with status "n",
        except that articles from peers are not accepted.  A newsgroup
        with status "x" is considered as closed: no new articles will
        arrive in such a group.  On the contrary, articles from peers
        will arrive in a newsgroup with status "n".  Local postings are
        not allowed in a newsgroup with either of these two status
        field values.</t>

        <t>A newsgroup with status "j" is a newsgroup with status "y", except
        that (1) local postings are not accepted, (2) articles received
        from a peer that are crossposted to one or more valid groups are
        filed only into those valid groups, and (3) articles received from a
        peer that are not crossposted to any valid groups are not filed
        into any newsgroup, but are still propagated to other peers,
        if appropriate.</t>

        <t><list style="empty">

          <t>NOTE: Instead of not filing at all an article posted to a
          newsgroup with status "j", a news server MAY file it under a
          catch-all group if no valid group is applicable.  When a news
          server uses a catch-all group to file the articles posted to
          newsgroups with status "j", this catch-all group SHOULD be named
          "junk".  (The first letter of the "junk" newsgroup explains why
          this status has been called "j".)</t>

          <t>Consequently, when a news server carries the "junk"
          newsgroup and uses it for the purpose of the "j" status, the
          "junk" newsgroup contains all postings not filed under another
          newsgroup, regardless of the status of the "junk" newsgroup.
          (However, an article posted explicitly to "junk" is treated
          according to the status of the "junk" newsgroup.)</t>

          <t>The "junk" newsgroup may be available to news readers and is
          often used by a news server as a way to locally store an article
          that will be transmitted to peers (which may carry some of the
          newsgroups the article was posted to even if the local server
          does not).  In addition, instead of rejecting an article that
          contains an invalid Newsgroups header field or that is posted
          to newsgroups it does not carry, a news server may accept such
          an article and file it under the catch-all newsgroup.</t>

          <t>Depending on the configuration of the news server, mentioning
          a newsgroup with status "j" is different than simply not listing
          the group, since articles arriving for unknown newsgroups may
          be rejected.</t>

        </list></t>

        <t>When the status field value begins with an equal sign ("=" or %x3D),
        a newsgroup name on the news server MUST immediately
        follow the sign.  If the status of "foo.bar" is "=other.group",
        it means that "foo.bar" is an alias for "other.group".  These two
        newsgroups are distinct; they do not share their articles or their
        article numbers.  Local postings to "foo.bar" are not allowed,
        but articles from peers are accepted for "foo.bar" and filed into
        "other.group", regardless of the status of "other.group".  The
        contents of their Newsgroups header fields MUST NOT be altered.</t>

        <t>Alias groups are typically used during a transition between two
        newsgroups, including but not limited to a renaming of a group,
        or a correction of a misspelled group name.</t>

        <t>The status of the newsgroup an alias points to MUST NOT be
        taken into account when an article arrives in an alias newsgroup.
        In particular, it means that unapproved articles arriving from peers
        in an alias pointing to a moderated newsgroup are accepted and
        filed into this moderated newsgroup.  Therefore, an alias SHOULD
        NOT point to a moderated newsgroup, since it allows bypassing of
        the moderation.</t>

        <t>An alias SHOULD NOT point to itself or another alias group.
        The newsgroup an alias points to SHOULD exist on the news server,
        and be visible to any client that can see the original group.
        However, when a client issues a LIST ACTIVE command with a wildmat
        including the original group, the newsgroup it points to is not
        listed in the response (unless of course the second newsgroup also
        matches the wildmat).</t>

        <t><list style="empty">

          <t>NOTE: If a server files newsgroups with status "j" into
          "junk", a newsgroup with status "j" and a newsgroup with status
          "=junk" are different.  An article fed by a peer, and crossposted
          to a group with status "j", will result in the article being filed
          only in "junk" if there are no other groups with which to file it,
          or otherwise only in other valid newsgroups it is crossposted to.
          On the other hand, an article fed by a peer, and crossposted to a
          group
          with status "=junk", will result in the article being filed in
          "junk" and in other valid newsgroups it is crossposted to.</t>

        </list></t>

        <t>The following table summarizes what usually happens to an
        article posted to only the newsgroup "foo.bar", depending on its
        status field value on the news server:</t>

        <texttable>
          <ttcol>Status field value of "foo.bar"</ttcol>
          <ttcol>Accepted if local posting?</ttcol>
          <ttcol>Accepted from peers?</ttcol>
          <ttcol>Moderation needed?</ttcol>
          <ttcol>Destination if accepted</ttcol>
          <c>y</c>
            <c>Yes</c>
            <c>Yes</c>
            <c>No</c>
            <c>foo.bar</c>
          <c>n</c>
            <c>No</c>
            <c>Yes</c>
            <c>No</c>
            <c>foo.bar</c>
          <c>m</c>
            <c>Yes</c>
            <c>Yes</c>
            <c>Yes</c>
            <c>foo.bar</c>
          <c>x</c>
            <c>No</c>
            <c>No</c>
            <c>No</c>
            <c></c>
          <c>j</c>
            <c>No</c>
            <c>Yes</c>
            <c>No</c>
            <c>junk (if filed)</c>
          <c>=other.group</c>
            <c>No</c>
            <c>Yes</c>
            <c>No</c>
            <c>other.group</c>
        </texttable>

        <t>The following table summarizes what usually happens to an
        article crossposted to the newsgroup "foo.bar" and a valid newsgroup
        "misc.test" (whose status field is "y") known by the news server,
        depending on the status field value of "foo.bar" on the news server:</t>

        <texttable>
          <ttcol>Status field value of "foo.bar"</ttcol>
          <ttcol>Accepted if local posting?</ttcol>
          <ttcol>Accepted from peers?</ttcol>
          <ttcol>Moderation needed?</ttcol>
          <ttcol>Destination if accepted</ttcol>
          <c>y</c>
            <c>Yes</c>
            <c>Yes</c>
            <c>No</c>
            <c>foo.bar, misc.test</c>
          <c>n</c>
            <c>No</c>
            <c>Yes</c>
            <c>No</c>
            <c>foo.bar, misc.test</c>
          <c>m</c>
            <c>Yes</c>
            <c>Yes</c>
            <c>Yes</c>
            <c>foo.bar, misc.test</c>
          <c>x</c>
            <c>No</c>
            <c>Yes</c>
            <c>No</c>
            <c>misc.test</c>
          <c>j</c>
            <c>No</c>
            <c>Yes</c>
            <c>No</c>
            <c>misc.test</c>
          <c>=other.group</c>
            <c>No</c>
            <c>Yes</c>
            <c>No</c>
            <c>other.group, misc.test</c>
        </texttable>

        <t><list style="empty">

          <t>NOTE: The status of a newsgroup only indicates how articles
          arriving for that newsgroup are normally processed; news servers
          MAY provide clients with special privileges to allow or disallow
          some rights in these newsgroups.  This specification defines
          neither these rights nor whether or not articles posted to these
          groups should be propagated to other peers.</t>

        </list></t>

      </section>

      <section title="Examples">

        <t>Example of an article posted to an alias group by a peer:</t>

<figure><artwork><![CDATA[
   [C] LIST ACTIVE
   [S] 215 List of newsgroups follows
   [S] foo.bar 21 12 y
   [S] misc.test 3002322 3000234 =foo.bar
   [S] .
   [C] IHAVE <for.misc.test@example.com>
   [S] 335 Send it; end with <CR-LF>.<CR-LF>
   [C] Path: demo!.POSTED.somewhere!not-for-mail
   [C] From: "Demo User" <nobody@example.com>
   [C] Newsgroups: misc.test
   [C] Subject: I am just a test article
   [C] Date: 18 Oct 2008 16:02:45 +0200
   [C] Organization: An example, Paris, FR.
   [C] Message-ID: <for.misc.test@example.com>
   [C] MIME-Version: 1.0
   [C]
   [C] This is just a test article.
   [C] .
   [S] 235 Article transferred OK
   [C] LIST ACTIVE
   [S] 215 List of newsgroups follows
   [S] foo.bar 22 12 y
   [S] misc.test 3002322 3000234 =foo.bar
   [S] .
   [C] HDR Xref <for.misc.test@example.com>
   [S] 225 Header information follows
   [S] 0 news.example.com foo.bar:22
   [S] .
   [C] HDR Newsgroups <for.misc.test@example.com>
   [S] 225 Header information follows
   [S] 0 misc.test
   [S] .
]]></artwork></figure>

        <t>The Newsgroups header field of this article is kept untouched.
        This article is filed under "foo.bar" even though it has originally
        been posted to the newsgroup
        "misc.test". Yet, it still propagates to peers that have been
configured to receive articles posted to "misc.text".</t>

        <t>Example of an article locally posted to an alias group:</t>

<figure><artwork><![CDATA[
   [C] LIST ACTIVE
   [S] 215 List of newsgroups follows
   [S] foo.bar 22 12 y
   [S] misc.test 3002322 3000234 =foo.bar
   [S] .
   [C] POST
   [S] 340 Input article; end with <CR-LF>.<CR-LF>
   [C] From: "Demo User" <nobody@example.com>
   [C] Newsgroups: misc.test
   [C] Subject: I am just a test article
   [C] MIME-Version: 1.0
   [C]
   [C] This is just a test article.
   [C] .
   [S] 441 Newsgroup "misc.test" has been renamed to "foo.bar"
]]></artwork></figure>

        <t>The article is rejected, with a detailed error.</t>

      </section>

    </section>

    <section title="Augmented BNF Syntax for These Additions to the LIST
    Command">

      <t>This section describes the formal syntax of the new LIST
      variants defined in this document using <xref target="RFC5234" />.
      It extends the syntax in Section 9 of <xref target="RFC3977" />,
      and non-terminals not defined in this document are defined there.
      The <xref target="RFC3977" /> ABNF should be imported first, before
      attempting to validate these rules.</t>

      <section title="Commands">

        <t>This syntax extends the non-terminal &lt;list-arguments>, which
        represents the variants of the LIST command.</t>

<figure><artwork type="abnf"><![CDATA[
  ; counts
  list-arguments =/ "COUNTS" [WS wildmat]

  ; distributions, moderators, motd
  list-arguments =/ "DISTRIBUTIONS" / "MODERATORS" / "MOTD"

  ; subscriptions
  list-arguments =/ "SUBSCRIPTIONS" [WS wildmat]
]]></artwork></figure>

      </section>

      <section title="Responses">

        <t>This syntax extends the non-terminals &lt;newsgroup-status>
        and &lt;list&nbhy;content>, which represent the status field value
        returned by the LIST ACTIVE command and the response contents for
        the LIST command, respectively.</t>

<figure><artwork type="abnf"><![CDATA[
  ; active
  newsgroup-status =/ newsgroup-alias /
        %x78 / %x6a  ; case-sensitive "x" and "j"
  newsgroup-alias =  "=" newsgroup-name

  ; counts
  list-content =/ list-counts-content
  list-counts-content =
        *(newsgroup-name 3(SPA article-number)
        SPA newsgroup-status CRLF)

  ; distributions
  list-content =/ list-distributions-content
  list-distributions-content =
        *(distribution WS distribution-description CRLF)
  distribution-description = U-TEXT

  ; moderators
  list-content =/ list-moderators-content
  list-moderators-content =
        *(wildmat ":" moderators-address CRLF)
  moderators-address = S-TEXT

  ; motd
  list-content =/ list-motd-content
  list-motd-content = *(*U-CHAR CRLF)

  ; subscriptions
  list-content =/ list-subscriptions-content
  list-subscriptions-content = *(newsgroup-name CRLF)
]]></artwork></figure>

      </section>

    </section>

    <section title="Internationalization Considerations">

      <t>No new internationalization considerations are introduced by this
      extension, beyond those already described in the core specification
      <xref target="RFC3977" />.</t>

      <t>In particular, newsgroup names SHOULD be restricted to US-ASCII
      <xref target="ASCII" /> until a successor to <xref target="RFC5536"
      /> standardizes another approach.</t>

      <t>Distribution descriptions and the message of the day MUST be in
      UTF-8 <xref target="RFC3629" />.</t>

    </section>

    <section title="Security Considerations" anchor="sec_security">

      <t>No new security considerations are introduced by this extension,
      beyond those already described in the core specification <xref
      target="RFC3977" /> and the <xref target="RFC5537">Netnews Architecture
      and Protocols specification</xref>
      (especially distribution leakage and e-mail
      Denial of Service during the moderation process).</t>

    </section>

    <section title="IANA Considerations">

      <t>This section gives a formal definition of this extension as required
      by Section 3.3.3 of <xref target="RFC3977" /> for the IANA registry.
      It extends the LIST capability label defined in Section 7.6 of <xref
      target="RFC3977" />.</t>

      <t><list style="symbols">

        <t>This extension provides additional keywords to the pre-existing
        LIST capability defined in Section 7.6 of <xref target="RFC3977"
        />.  New status field values are also added to the ACTIVE variant of the LIST
        command.</t>

        <t>The capability label that this extension extends is "LIST".</t>

        <t>This extension adds five optional arguments to the "LIST"
        capability label: "COUNTS", "DISTRIBUTIONS", "MODERATORS", "MOTD",
        and "SUBSCRIPTIONS", indicating which new variants of the LIST
        command are supported.  Consequently, this extension associates
        these new arguments with the pre-existing "LIST" NNTP command.</t>

        <t>This extension defines five new commands, LIST COUNTS,
        LIST DISTRIBUTIONS, LIST MODERATORS, LIST MOTD, and LIST
        SUBSCRIPTIONS, whose behavior, arguments, and responses are
        defined in Sections&nbsp;<xref target="sec_counts" format="counter"
        />, <xref target="sec_distributions" format="counter" />, <xref
        target="sec_moderators" format="counter" />, <xref target="sec_motd"
        format="counter" />, and <xref target="sec_subscriptions"
        format="counter" />, respectively.</t>

        <t>This extension does not associate any new responses with
        pre-existing NNTP commands.</t>

        <t>This extension does not affect the maximum length of commands
        or initial response lines.</t>

        <t>This extension does not alter pipelining.  The LIST COUNTS, LIST
        DISTRIBUTIONS, LIST MODERATORS, LIST MOTD, and LIST SUBSCRIPTIONS
        commands can be pipelined.</t>

        <t>Use of this extension does not alter the capabilities list.</t>

        <t>This extension does not cause any pre-existing command to
        produce a 401, 480, or 483 response.</t>

        <t>This extension is unaffected by any use of the MODE READER
        command.</t>

        <t>This extension does not affect the overall behavior of a server
        or client other than via the new commands.</t>

        <t>Published Specification: This document.</t>

        <t>Contact for Further Information: Author of this document.</t>

        <t>Change Controller: IESG &lt;iesg@ietf.org>.</t>

      </list></t>

    </section>

    <section title="Acknowledgements">

      <t>The author gratefully acknowledges the comments and additional
      information provided by Russ Allbery, Urs Janssen, Antti-Juhani
      Kaijanaho, Alexey Melnikov, Peter Saint-Andre, Dieter Stussy, and
      Sean Turner on this document.</t>

      <t>The author would particularly like to thank Jeffrey M. Vinocur
      for having reread, improved, and patiently fixed the English wording
      and the quality of this document.</t>

      <t>Special thanks are due to:</t>

      <list>

        <t>Stan Barber, whose text in <xref target="RFC2980" /> served as the
        initial basis for the DISTRIBUTIONS and SUBSCRIPTIONS variants of
        the LIST command.</t>

        <t>Brian Hernacki, whose text in <xref target="NNTP_LIST"
        /> served as the initial basis for the MOTD and also
        the SUBSCRIPTIONS variants of the LIST command.</t>

        <t>The authors of the documentation of a few sample files of the
        InterNetNews news server ("active", "distributions", "moderators",
        "motd.news", and "subscriptions"): Russ Allbery, Bettina Fink,
        Rich Salz, and a few other people to whom I am also grateful.</t>
      </list>
    </section>
  </middle>

  <back>

    <references title="Normative References">

      &rfc2119;
      &rfc3629;
      &rfc3977;
      &rfc5234;
      &rfc5322;
    </references>

    <references title="Informative References">
      <reference anchor="ASCII">
        <front>
          <title>Coded Character Sets - 7-Bit American Standard Code for
          Information Interchange (7-Bit ASCII), ANSI X3.4</title>
          <author>
            <organization>American National Standards Institute</organization>
          </author>
          <date year="1986" />
        </front>
      </reference>

      <reference anchor="NNTP_LIST">
        <front>
            <title>NNTP LIST Additions</title>
            <author initials="B." surname="Hernacki" fullname="Brian Hernacki">
                <organization>Netscape Communications, Inc.</organization>
            </author>
            <date month="July" day="15" year="1997"/>
        </front>
        <seriesInfo name="Work in" value="Progress"/>

    </reference>

      &rfc2980;
      &rfc5536;
      &rfc5537;

    <reference anchor='USEAGE'>
    <front>
    <title>Usenet Best Practice</title>

    <author initials='C' surname='Lindsey' fullname='Charles Lindsey'>
        <organization />
    </author>

    <date month='March' day='16' year='2005' />
    </front>

    <seriesInfo name='Work in' value='Progress' />
/>
    </reference>

    </references>

  </back>
</rfc>

<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [

<!ENTITY rfc2047 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2047.xml'>
<!ENTITY rfc2231 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2231.xml'>
<!ENTITY rfc1652 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.1652.xml'>
<!ENTITY rfc2821 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2821.xml'>
<!ENTITY rfc2822 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2822.xml'>
<!ENTITY rfc2119 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml'>
<!ENTITY rfc3629 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.3629.xml'>
<!ENTITY rfc5234 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5234.xml'>
<!ENTITY rfc5248 PUBLIC ''
   'http://xml.resource.org/public/rfc/bibxml/reference.RFC.5248.xml'>
]>

<?rfc rfcedstyle="yes"?>
<?rfc subcompact="no"?>
<?rfc toc="yes"?>
<?rfc symrefs="yes" ?>
<?rfc sortrefs="yes"?>

<rfc 
    number="5336" category="exp" updates="2821, 2822, 4952">

<front>
<title abbrev="EAI SMTP Extension">
   SMTP Extension for Internationalized Email Addresses
</title>


<author role="editor" initials="J.K." surname="Yao" fullname="Jiankang YAO">
      <organization> CNNIC</organization>
      <address>
         <postal>
            <street>No.4 South 4th Street, Zhongguancun</street>
            <city>Beijing</city>
           </postal>
         <phone>+86 10 58813007 </phone>
         <email>yaojk@cnnic.cn</email>
      </address>
  </author>

<author role="editor" initials="W." surname="Mao" fullname="Wei MAO">
      <organization> CNNIC</organization>
      <address>
         <postal>
            <street>No.4 South 4th Street, Zhongguancun</street>
            <city>Beijing</city>
           </postal>
         <phone>+86 10 58812230 </phone>
         <email>maowei_ietf@cnnic.cn</email>
      </address>
  </author>


<date month="August" year="2008" />


<keyword>EAI, UTF8SMTP, MAIL, TRANSFER</keyword>

<abstract>
<t>
This document specifies an SMTP extension
for transport and delivery of email messages with internationalized
email addresses or header information.
Communication with systems that do not implement this specification is
specified in another document. This document updates some syntaxes and rules defined 
in RFC 2821 and RFC 2822, and has some material updating RFC 4952.
</t>
</abstract>

</front>

<middle>

<section title="Introduction" anchor="intro">
<t>
An internationalized email address
includes two parts, the local part and the domain part.
The ways email addresses are used by protocols are different from the ways domain
names are used. The most critical difference is that emails are
delivered through a chain of clients and servers, while domain
names are resolved by name servers looking up those names in their
own tables. In
addition to this, the Simple Mail Transfer Protocol
<xref target="RFC2821"/> provides a
negotiation mechanism about service extension with which clients can discover server
capabilities and make decisions for
further processing.  An extended overview of the extension model for
internationalized addresses and headers appears in
<xref target='RFC4952'/>, referred to as "the framework
document" or just as "Framework" elsewhere in this specification.
This document specifies an SMTP extension to permit
internationalized email addresses in envelopes, and UNICODE
characters (encoded in UTF-8) <xref target="RFC3629" /> in headers.
</t>


<section title="Role of This Specification">
<t>The framework document specifies the
requirements for, and describes components of, full internationalization of
electronic mail. A thorough understanding of the information in that
document and in the base Internet email specifications
<xref target="RFC2821"/> <xref target="RFC2822"/> is necessary to
understand and implement this specification. 
</t><t>
This document specifies an element of the email internationalization
work, specifically the definition
of an SMTP extension <xref target="RFC2821"/>
for internationalized email address transport delivery.
</t>
</section>



<section title="Terminology">

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
"OPTIONAL" in this document are to be interpreted as described in
RFC 2119 <xref target="RFC2119"/>.</t>

<t>
The terms "conventional message" and "internationalized message" are defined
in an appendix to this specification.  The terms "UTF-8 string" or
"UTF-8 character" are used informally to refer to Unicode characters
encoded in UTF-8 <xref target="RFC3629"/>.
All other specialized terms used in this specification are defined in
the framework document or in the base Internet email specifications
<xref target="RFC2821"/> <xref target="RFC2822"/>.  In particular,
the terms "ASCII address",
"internationalized email address", "non-ASCII address", "i18mail address",
"UTF8SMTP",
"message", and "mailing list" are used in this document according to
the definitions in the framework document.
</t>

<?rfc needLines="3" ?>
<t>
This specification defines only those Augmented BNF (ABNF) <xref target="RFC5234" />
syntax rules that are different
from those of the base email specifications
<xref target="RFC2821"/><xref target="RFC2822"/> and,
where the earlier rules are upgraded or extended, gives them new
names.  When the new rule is a small modification to the older one,
it is typically given a name starting with "u". Rules that are
undefined here may be found in the base email specifications under
the same names.
</t>

</section>
</section>

<section title="Overview of Operation" anchor="overview">

<t>
This specification describes an optional extension to the email transport
mechanism that permits non-ASCII <xref target="ASCII"/> characters in
both the envelope and 
header fields of messages, which are encoded with UTF-8 <xref target="RFC3629" /> characters.
The extension is identified with the 
token "UTF8SMTP". In order to provide 
information that may be needed in downgrading, an optional alternate
ASCII address may be needed if an SMTP client
attempts to transfer an internationalized message and
encounters a server that does not support this extension.
</t>
<t>
The EAI UTF-8 header specification
<xref target="RFC5335"/> provides the details of how and
where non-ASCII characters are permitted
in the header fields of messages. The
context for this specification is described in the framework document.</t>
</section>

<section title="Mail Transport-Level Protocol">
<section title="Framework for the Internationalization Extension" anchor="framework" >
<t>
The following service extension is defined:
<list style="numbers">
<t>The name of the SMTP service extension is
"Email Address Internationalization". </t>
<t>The EHLO keyword value associated with this extension is
"UTF8SMTP".</t>
<t>No parameter values are defined for this EHLO keyword value. In
order to permit future (although unanticipated) extensions, the
EHLO response MUST NOT contain any parameters for that keyword.
Clients MUST ignore any parameters; that is, clients MUST behave as
if the parameters do not appear.
If a server includes UTF8SMTP in its EHLO response, it MUST be fully
compliant with this version of this specification.
</t>

<t>One optional parameter, ALT-ADDRESS, is added to the MAIL
and RCPT
commands of SMTP. ALT-ADDRESS specifies an all-ASCII address which can
be used as a substitute for the corresponding primary (i18mail)
address when downgrading.  More discussion of the use of this parameter appears in
<xref target="RFC4952"/> and <xref target="Downgrade" />.
</t>
<t>One optional parameter "UTF8REPLY" is added to
the VRFY and EXPN commands. The parameter UTF8REPLY has no
value. The parameter indicates that the SMTP client can accept Unicode
characters in UTF-8 encoding in replies from the VRFY and EXPN commands.
</t>

<t>No additional SMTP verbs are defined by this extension.</t>
<t>Servers offering this extension MUST provide support for, and
announce, the 8BITMIME extension <xref target="RFC1652" />. </t>
<t>
The reverse-path and forward-path of the SMTP MAIL and RCPT
commands are extended to allow Unicode characters encoded in
UTF-8 in mailbox names (addresses).
</t>
<t>
The mail message body is extended as specified in
<xref target="RFC5335" />.
</t>
<t>
The maximum length of MAIL and RCPT command lines is
increased by 460 characters by the possible addition of the
ALT-ADDRESS keyword and value.
</t>
<t>The UTF8SMTP extension is valid on the submission
   port <xref target="RFC4409" />.</t>

</list>
</t>
</section>

<section title="The UTF8SMTP Extension"
      anchor="extension">
<t>An SMTP server that announces this extension MUST be prepared to
accept a UTF-8 string <xref target="RFC3629" />
in any position in which RFC 2821 specifies that a mailbox can
appear. That string MUST be parsed only as specified in RFC 2821,
i.e., by separating the mailbox into source route, local part, and
domain part, using only the characters colon (U+003A), comma (U+002C),
and at-sign (U+0040) as specified there. Once isolated by this
parsing process, the local part MUST be treated as opaque unless the
SMTP server is the final delivery Mail Transfer Agent (MTA). Any domain names that are to
be looked up in the DNS MUST first be processed into the
form
specified in "Internationalizing Domain Names in Applications (IDNA)" <xref target="RFC3490" /> by
means of the ToASCII() operation unless they are already
in that form. Any domain names that are to be compared
to local strings SHOULD be checked for validity and then MUST be
compared as specified in Section 3.4 of IDNA.
</t>


<t>
An SMTP client that receives the UTF8SMTP extension keyword in
response to the EHLO command MAY transmit mailbox names within
SMTP commands as internationalized strings in UTF-8 form. It
MAY send a UTF-8 header <xref target="RFC5335" /> (which may also include
mailbox names in UTF-8).
It MAY transmit the domain parts of mailbox names within SMTP
commands or the message header as either ACE (ASCII
Compatible Encoding) labels
(as specified in IDNA <xref target="RFC3490" />) or UTF-8 strings.
All labels in domain parts of mailbox names which are IDNs
(either UTF-8 or ACE strings) MUST be valid. If the original
client submits a message to a Message Submission Server ("MSA")
<xref target="RFC4409" />, it is the responsibility of the MSA that all domain
labels are valid; otherwise, it is the original client's
responsibility.
The presence of the UTF8SMTP extension does not change the
requirement of RFC 2821 that servers relaying mail MUST NOT
attempt to parse, evaluate, or transform the local part in any
way.
</t>

<t>
If the UTF8SMTP SMTP extension is not offered by the Server, the
SMTP client MUST NOT transmit an internationalized address
and MUST NOT transmit a mail message containing
internationalized mail headers as described in <xref target="RFC5335" />
at any level within its MIME structure.
(For this paragraph, the internationalized domain name in the form of ACE labels
as specified in IDNA <xref target="RFC3490" /> is not considered as "internationalized".)
Instead, if an SMTP client (SMTP sender) attempts to transfer an
internationalized message and encounters a server that
does not support the
extension, it MUST make one of the following four choices:
</t>
<t>
<list style="numbers">
   <t>If and only if the SMTP client (sender) is a Message
Submission Server ("MSA") <xref target="RFC4409" />, it MAY, consistent
with the general provisions for changes by such servers,
rewrite the envelope, headers, or message material to
make them entirely ASCII and consistent with the
provisions of RFC 2821 <xref target="RFC2821" /> and RFC 2822
<xref target="RFC2822" />. </t>

     <t>It may either reject the message during the SMTP transaction or accept the message and
     then generate and transmit a notification of non-deliverability.
      Such notification MUST be done as specified in RFC 2821  <xref target="RFC2821" />,
RFC 3464 <xref target="RFC3464" />, and
the EAI delivery status notification (DSN) specification <xref target="RFC5337" />.</t>

         <t >It may find an alternate route to the destination that permits
       UTF8SMTP. That route may be discovered by trying alternate
       Mail eXchanger (MX) hosts (using preference rules as specified in RFC 2821)
       or using other means available to the SMTP-sender.</t>
         <t >If and only if ASCII addresses are available for all
       addresses that appear in the return path
       and the specific forward paths being attempted,
       it may downgrade the message to an all-ASCII form as specified in
       <xref target="Downgrade" />. An ASCII address is
       considered to be
   "available" for a particular address if the original
   address in the envelope is in ASCII or if an
   ALT-ADDRESS parameter is specified for a UTF8SMTP
   address.</t>
         </list>

</t>
<t>The difference 
between choice 1 and choice 4 is that choice 1 is constrained by Message Submission 
<xref target="RFC4409" />, while choice 4 is constrained by <xref target="Downgrade" />.
</t>

</section>
<section title="Extended Mailbox Address Syntax" anchor="syntax" >
<t>RFC 2821, Section 4.1.2, defines the syntax of a mailbox
entirely in terms of ASCII characters, using the
production for a mailbox and those productions on which it depends.
</t>

<t>
The key changes made by this specification are, informally, to
<list  style="symbols">
<t>Change the definition of "sub-domain" to permit either the
definition above or a UTF-8 string representing a DNS label that is
conformant with IDNA
<xref target="RFC3490" />.</t>
<t>Change the definition of "Atom" to permit either the definition above
or a UTF-8 string. That
string MUST NOT contain any of the ASCII characters (either graphics
or controls) that are not permitted in "atext"; it is otherwise
unrestricted.
</t> </list> </t>

<t>According to the description above, the syntax of an
   internationalized email
mailbox name (address) is defined in ABNF <xref target="RFC5234" />
   as follows.</t>
<figure>
  <artwork type="abnf"><![CDATA[
         uMailbox = uLocal-part "@" uDomain
           ; Replace Mailbox in RFC 2821, Section 4.1.2

         uLocal-part = uDot-string / uQuoted-string
           ; MAY be case-sensitive
           ; Replace Local-part in RFC 2821, Section 4.1.2

         uDot-string = uAtom *("." uAtom)
           ; Replace Dot-string in RFC 2821, Section 4.1.2

         uAtom = 1*ucharacter
               ; Replace Atom in RFC 2821, Section 4.1.2

         ucharacter = atext / UTF8-non-ascii

         atext = <See Section 3.2.4 of RFC 2822>

         uQuoted-string = DQUOTE *uqcontent DQUOTE
           ; Replace Quoted-string in RFC 2821, Section 4.1.2

         DQUOTE = <See appendix B.1 of RFC 5234>

         uqcontent = qcontent / UTF8-non-ascii

         qcontent = <See Section 3.2.5 of RFC 2822>

         uDomain = (sub-udomain 1*("." sub-udomain)) / address-literal
           ; Replace Domain in RFC 2821, Section 4.1.2

         address-literal = <See Section 4.1.2 of RFC 2822>

         sub-udomain = uLet-dig [uLdh-str]
           ; Replace sub-domain in RFC 2821, Section 4.1.2

         uLet-dig = Let-dig / UTF8-non-ascii

         Let-dig = <See Section 4.1.3 of RFC 2821>

         uLdh-str = *( ALPHA / DIGIT / "-" / UTF8-non-ascii) uLet-dig
           ; Replace Ldh-str in RFC 2821, Section 4.1.3

         UTF8-non-ascii = UTF8-2 / UTF8-3 / UTF8-4

         UTF8-2 =  <See Section 4 of RFC 3629>

         UTF8-3 =  <See Section 4 of RFC 3629>

         UTF8-4 =  <See Section 4 of RFC 3629>
 ]]> </artwork>
</figure>

<t> The value of "uDomain" SHOULD be verified by applying the tests
 specified as part of IDNA <xref target="RFC3490" />. If that
 verification fails,
 the email address with that uDomain MUST NOT be regarded as a
 valid email address.</t>
</section>


<section title="The ALT-ADDRESS Parameter"  >
<t>If the UTF8SMTP extension is offered, the syntax of the SMTP MAIL and
RCPT commands is extended to support the optional esmtp-keyword "ALT-
ADDRESS".  That keyword specifies an alternate all-ASCII address
that may be used when downgrading.
If the ALT-ADDRESS
esmtp-keyword is used, it MUST have an associated esmtp-value
(ALT-ADDRESS-esmtp-value, which is defined below).
</t>

<t>
While it may be tempting to consider ALT-ADDRESS as a
general-purpose second-chance address, such behavior is not
defined here. Instead, in this specification ALT-ADDRESS only
     has meaning when the associated primary address is non-ASCII and
     the message is downgraded. This restriction allows for future
     extension of the specification even though no such extensions
     are currently anticipated.
	 </t>

<t>Based on the definition of mail-parameters in <xref target="RFC2821" />,
the ALT-ADDRESS parameter usage in the commands of MAIL and RCPT is defined
 as follows. The following definitions are given in the same format as used in RFC 2821.
 <figure>
  <artwork type="abnf"><![CDATA[
     "MAIL FROM:" ("<>" / uReverse-path) [ SP Mail-parameters ] CRLF
        ; Update the MAIL command in RFC 2821, Section 4.1.1.2.
        ; A new parameter defined by the ABNF non-terminal
        ; <ALT-ADDRESS-parameter> is added.  It complies
        ; with the syntax specified for <esmtp-param> in RFC 2821.

     "RCPT TO:" ("<Postmaster@" uDomain ">" / "<Postmaster>" /
           uForward-path) [ SP Rcpt-parameters ] CRLF
            ; Update RCPT command in RFC 2821, Section 4.1.1.3.
            ; A new parameter defined by the ABNF non-terminal
            ; <ALT-ADDRESS-parameter> is added.  It complies
            ; with the syntax specified for <esmtp-param>.
            ; uDomain is defined in Section 3.3 of this document.

     uReverse-path = uPath
        ; Replace Reverse-path in RFC 2821, Section 4.1.2.

     uForward-path = uPath
        ; Replace Forward-path in RFC 2821, Section 4.1.2.

     uPath = "<" [ A-d-l ":" ] uMailbox ">"
        ; Replace Path in RFC 2821, Section 4.1.2.
        ; uMailbox is defined in Section 3.3 of this document.

     A-d-l = <See Section 4.1.2 of RFC 2821>

     ALT-ADDRESS-parameter = "ALT-ADDRESS=" ALT-ADDRESS-value

     ALT-ADDRESS-value = xtext
            ; The value is a mailbox name encoded as xtext.

     xtext = <See Section 4.2 of RFC 3461>
 ]]> </artwork>
</figure>
</t>
<t>
The ALT-ADDRESS-parameter MUST NOT appear more than once in any
MAIL or RCPT command. ALT-ADDRESS-esmtp-value MUST be an
all-ASCII email address before xtext encoding.
</t>
</section>

<section title="ALT-ADDRESS Parameter Usage and Response Codes"
         anchor="UsageAndCodes">
<t>
An "internationalized message" as defined in the appendix of this specification
MUST NOT be sent to an SMTP server
that does not support UTF8SMTP.
Such a message MAY be rejected by a server if it lacks
ALT-ADDRESSes as discussed in <xref target="extension"/> of this
specification. </t>
<t>The three-digit reply codes used in this section are consistent
   with their meanings as defined in RFC 2821.</t>
<t>
When messages are rejected because the RCPT command requires an
ALT-ADDRESS,
the response code 553 is used with the meaning
"mailbox name not allowed". When messages are rejected for other
reasons, such as the MAIL command requiring an ALT-ADDRESS, the response code
550 is used with the meaning "mailbox unavailable".
When the server supports enhanced mail system status
codes <xref target="RFC3463" />, response code "X.6.7" <xref target="RFC5248"/> is used,
meaning that "The ALT-ADDRESS is
required but not specified".
</t>
<t>
If the response code is issued after the final "." of the DATA command,
the response code "554" is used with the meaning "Transaction
failed". 
When the server supports enhanced mail system status
codes <xref target="RFC3463" />, response code "X.6.9" <xref target="RFC5248"/> is used,
meaning that
"UTF8SMTP downgrade failed".
</t>

</section>


<section title="Body Parts and SMTP Extensions"
  anchor="BodyParts">
   <t>There is no ESMTP parameter to assert that 
     a message is an internationalized message. An SMTP
     server that requires accurate knowledge of whether a message is
     internationalized is required to parse all message header fields
     and MIME header fields in the message body.</t>
	 <t>While this specification requires that servers support the
      8BITMIME extension <xref target="RFC1652"/> to ensure that
      servers have adequate handling capability for 8-bit data and to
      avoid a number of complex encoding problems, the use of
      internationalized addresses obviously does not require non-ASCII
      body parts in the MIME message.
	  The UTF8SMTP
      extension MAY be used with the BODY=8BITMIME parameter if that is
     appropriate given the body content or, with the BODY=BINARYMIME
     parameter, if the server advertises BINARYMIME <xref target="RFC3030"/>
	 and that is appropriate. 
	  </t>
   <t> Assuming that the server advertises UTF8SMTP and 8BITMIME, and
      receives
      at least one non-ASCII address, with or without ALT-ADDRESS,
      the
      precise interpretation of 'No BODY parameter',
      "BODY=8BITMIME", and "BODY=BINARYMIME" in the MAIL command
      is:
      <list style="numbers">
         <t >
            If there is no BODY parameter, the header contains UTF-8
            characters, but all the body parts are in ASCII (possibly as the
            result of a content-transfer-encoding).</t>
         <t >
            If a BODY=8BITMIME parameter is present, the header
            contains UTF-8 characters, and some or
            all of the body parts contain 8-bit line-oriented data.</t>
         <t >
            If a BODY=BINARYMIME parameter is present, the header
            contains UTF-8 characters, and some or all body parts contain
            binary data without restriction as to line lengths or
            delimiters.</t>
         </list></t>
      </section>



<section title="Additional ESMTP Changes and Clarifications" >
<t>The information carried in the mail transport process involves addresses ("mailboxes") and
domain names in various contexts in addition to the MAIL and RCPT commands and
extended alternatives to them. In general, the rule is that, when RFC
2821 specifies a mailbox, this specification expects UTF-8 to be used for
the entire string; when RFC 2821
specifies a domain name, the name SHOULD be in the form of ACE labels
if its
raw form is non-ASCII.</t>

<t>The following subsections list and discuss all of the relevant cases.
</t>

<section title="The Initial SMTP Exchange" >
<t> When an SMTP connection is opened, the server
normally sends a
"greeting" response consisting of the 220 response code and some
information. The client then sends the EHLO command. Since the
client cannot know whether the server supports UTF8SMTP until after
it receives the response from EHLO, any domain
names that appear in this dialogue, or in responses to EHLO, MUST be
in the hostname form, i.e., internationalized ones MUST be in the
form of ACE labels.</t>
</section>

<section title="Mail eXchangers" >
<t>
    Organizations often authorize multiple servers to accept mail
    addressed to them. For example, the
    organization may itself operate more than one server, and may
    also or instead have an agreement with other organizations to
    accept mail as a backup. Authorized servers are generally listed
    in MX records as described in RFC 2821.
    When more than one server accepts mail for the domain-part of a
	mailbox, it is
    strongly advised that either all or none of them support the
    UTF8SMTP extension. Otherwise, surprising downgrades can happen
    during temporary failures, which users might perceive as a serious 
	reliability issue.
</t>
</section>


<section title="Trace Information" anchor="TraceFields" >
<t>
When an SMTP server receives a message for delivery or further
processing, it MUST insert trace ("time stamp" or "Received")
information at the beginning of the message content.
"Time stamp" or "Received" appears in the form of "Received:" lines.
The most important use of Received: lines is for debugging mail faults.
When the delivery SMTP server makes the "final delivery" of a
message, it inserts a Return-path line at the beginning of the mail
data. The primary purpose of the Return-path is to designate the address to
which messages indicating non-delivery or other mail system failures
are to be sent.
For the trace information, this memo updates the time stamp line and the return
path line <xref target="RFC2821" /> formally defined as
follows:</t>
 <figure>
  <artwork type="abnf"><![CDATA[
   uReturn-path-line = "Return-Path:" FWS uReverse-path <CRLF>
       ; Replaces Return-path-line in Section 4.4 of RFC 2821
       ; uReverse-path is defined in Section 3.3 of this document

   uTime-stamp-line = "Received:" FWS uStamp <CRLF>
       ; Replaces Time-stamp-line in Section 4.4 of RFC 2821

   uStamp = From-domain By-domain uOpt-info ";"  FWS date-time
       ; Replaces Stamp in Section 4.4 of RFC 2821

    uOpt-info = [Via] [With] [ID] [uFor]
       ; Replaces Opt-info in Section 4.4 of RFC 2821
       ; The protocol value for With will allow a UTF8SMTP value

      uFor = "FOR" ( FWS (uPath / uMailbox) ) CFWS
       ; Replaces For in Section 4.4 of RFC 2821
       ; uPath and uMailbox are defined in Sections 2.4 and
       ; 2.3, respectively, of this document
]]></artwork>
</figure>
<t>Note:  The FOR parameter has been changed to match the
   definition in <xref target="RFC2821bis" />,
permitting only one address in the For
   clause. The group working on that document reached mailing
   list consensus that the syntax in <xref target="RFC2821" /> that permitted
   more than one address was simply a mistake.</t><t>
Except in the 'uFor' clause and 'uReverse-path' value where non-ASCII domain
names may be used, 
internationalized domain names in Received fields MUST be
transmitted in the form of ACE labels.
The protocol value of the WITH clause when this extension is
used is one of the UTF8SMTP values specified in the "IANA
Considerations" section of this document.
</t>

</section>

<section title="UTF-8 Strings in Replies" anchor="UTF8Reply" >
   <section title="MAIL and RCPT Commands">
<t>
    If the client issues a RCPT command containing non-ASCII
    characters, the SMTP server is permitted to use UTF-8 characters
	in the email address associated with 251 and 551 response codes.
</t>
<t>
    If an SMTP client follows this specification and sends any
      RCPT commands containing non-ASCII addresses, it MUST be
      able to accept and process 251 or 551 responses containing
      UTF-8 email addresses. If a given RCPT command does not
      include a non-ASCII envelope address, the server MUST NOT
      return a 251 or 551 response containing a non-ASCII
      mailbox. Instead, it MUST transform such responses into
      250 or 550 responses that do not contain addresses.
</t>
</section>

<section title="VRFY and EXPN Commands and the UTF8REPLY Parameter" anchor="usage2">
   <t>If the VRFY and EXPN commands are transmitted with an optional
	  parameter "UTF8REPLY", it indicates the client can accept UTF-8
	  strings in replies from those commands.
	  This allows the server to use UTF-8 strings in mailbox names
	  and full names that occur in replies without concern that the
	  client might be confused by them.
      An SMTP client that conforms to this specification MUST accept
	  and correctly process replies from the VRFY and EXPN commands
	  that contain UTF-8 strings.
      However, the SMTP server MUST NOT use UTF-8 strings in replies if the
	  SMTP client does not specifically allow such replies by
	  transmitting this parameter.
      Most replies do not require that a mailbox name be included in
	  the returned text, and therefore UTF-8 is not needed in them.
	  Some replies, notably those resulting from successful execution
	  of the VRFY and EXPN commands, do include the mailbox, making
	  the provisions of this section important.</t>

 <t>VERIFY (VRFY) and EXPAND (EXPN) command syntaxes are changed to:</t>

 <figure>
  <artwork type="abnf"><![CDATA[
    "VRFY" SP (uLocal-part / uMailbox) [SP "UTF8REPLY"] CRLF
           ; uLocal-part and uMailbox are defined in
	   ; Section 3.3 of this document.

    "EXPN" SP ( uLocal-part / uMailbox ) [ SP "UTF8REPLY" ] CRLF
	   ; uLocal-part and uMailbox are defined in
	   ; Section 3.3 of this document.
]]></artwork>
</figure>

<t> 
The "UTF8REPLY" parameter does not use a value.
If the reply to a VERIFY (VRFY) or EXPAND (EXPN) command
 requires UTF-8, but the SMTP client does not use the "UTF8REPLY"
   parameter, then the server MUST use either the response code 252 or 550.
   Response code 252, defined in <xref target="RFC2821" />, means "Cannot VRFY
   user, but will accept the message and attempt the delivery".
   Response code 550, also defined in <xref target="RFC2821" />, means "Requested
   action not taken: mailbox unavailable". When the server
   supports enhanced mail system status codes <xref target="RFC3463" />, the
   enhanced response code as specified below is used.
   Using the "UTF8REPLY" parameter with a VERIFY (VRFY) or EXPAND
   (EXPN) command enables UTF-8 replies for that command only.
 </t>
   <t>If a normal success response  (i.e., 250) is returned,
   the response MAY include the full name of the user and MUST include
   the mailbox of the user. It MUST be in either of the following
   forms:</t>

 <figure>
  <artwork><![CDATA[
      User Name <uMailbox>
         ; uMailbox is defined in Section 3.3 of this document.
         ; User Name can contain non-ASCII characters.

      uMailbox
         ; uMailbox is defined in Section 3.3 of this document.
]]></artwork>
</figure>

   <t>
If the SMTP reply requires UTF-8 strings, but UTF-8 is not
 allowed in the reply, and the server supports enhanced mail
 system status codes <xref target='RFC3463'/>, the enhanced response code is
either "X.6.8" or "X.6.10" <xref target="RFC5248" />, meaning "A reply
containing a UTF-8 string is required to show the mailbox name,
but that form of response is not permitted by the client".
  </t>
   <t>
 If the SMTP client does not support the UTF8SMTP extension,
 but receives a UTF-8 string in a reply, it may not be able to
  properly report the reply to the user, and some clients might crash.
   Internationalized messages in replies are only
   allowed in the commands 
   under the situations described above. Under any other circumstances,
   UTF-8 text MUST NOT appear in the reply.
</t>
<t>
Although UTF-8 is needed to represent email addresses in responses
under the rules specified in this section, this extension
does not permit the use of UTF-8 for any other purposes.
SMTP servers MUST NOT include non-ASCII characters in replies except in the
limited cases specifically permitted in this section.
</t>
</section>
</section>
</section>
</section>

<section title="IANA Considerations">
<t>IANA has added a new value "UTF8SMTP" to the SMTP 
Service Extension subregistry of the Mail Parameters registry, according 
to the following data:
</t>
<texttable>
   <ttcol align="left">Keywords</ttcol>
   <ttcol align="left">Description</ttcol>
   <ttcol align="left">Reference</ttcol>
<c>UTF8SMTP</c>    <c>Internationalized email address</c>
	  <c>[RFC&rfc.number;]</c>
</texttable> 


<t>This document adds new values to the SMTP Enhanced Status Code 
subregistry of the Mail Parameters registry,
following the guidance in Sections <xref target="UsageAndCodes" format="counter"/> and
  <xref target="usage2" format="counter"/> of this document, 
and being based on <xref target="RFC5248" />.
The registration data is as 
follows:

<figure>
  <artwork ><![CDATA[
    Code:               X.6.7
    Sample Text:        The ALT-ADDRESS is required but not specified
    Associated basic status code:  553, 550
    Description:        This indicates the reception of a MAIL or RCPT
                        command that required an ALT-ADDRESS parameter
                        but such parameter was not present.
    Defined:            RFC 5336  (Experimental track)
    Submitter:          Jiankang YAO
    Change controller:  IESG.
 ]]> </artwork>
</figure>

<figure>
  <artwork ><![CDATA[
    Code:               X.6.8
    Sample Text:        UTF-8 string reply is required,
                        but not permitted by the client
    Associated basic status code:  553, 550
    Description:        This indicates that a reply containing a UTF-8 
                        string is required to show the mailbox name, 
			but that form of response is not 
			permitted by the client.
    Defined:            RFC  5336.  (Experimental track)
    Submitter:          Jiankang YAO
    Change controller:  IESG.
 ]]> </artwork>
</figure>

<figure>
  <artwork ><![CDATA[
    Code:               X.6.9
    Sample Text:        UTF8SMTP downgrade failed
    Associated basic status code:  550
    Description:        This indicates that transaction failed
	                after the final "." of the DATA command.
    Defined:            RFC  5336.  (Experimental track)
    Submitter:          Jiankang YAO
    Change controller:  IESG.
 ]]> </artwork>
</figure>

<figure>
  <artwork ><![CDATA[
    Code:               X.6.10
    Sample Text:        UTF-8 string reply is required,
                        but not permitted by the client
    Associated basic status code:  252
    Description:        This indicates that a reply containing a UTF-8 
                        string is required to show the mailbox name, 
			but that form of response is not 
			permitted by the client.
    Defined:            RFC 5336.  (Experimental track)
    Submitter:          Jiankang YAO
    Change controller:  IESG.
 ]]> </artwork>
</figure>
</t>

<t>
The "Mail Transmission Types" registry under the Mail Parameters registry is requested to be updated
to include the following new
entries:</t>

<texttable>
   <ttcol align="left">WITH protocol types</ttcol>
   <ttcol align="left">Description</ttcol>
   <ttcol align="left">Reference</ttcol>

<c>UTF8SMTP</c>    <c>UTF8SMTP with Service Extensions</c>
	  <c>[RFC&rfc.number;]</c>
<c>UTF8SMTPA</c>   <c>UTF8SMTP with SMTP AUTH</c>
    <c><xref target="RFC4954"/> [RFC&rfc.number;]</c>
<c>UTF8SMTPS </c> <c>UTF8SMTP with STARTTLS</c>
   <c><xref target="RFC3207"/> [RFC&rfc.number;]</c>
<c>UTF8SMTPSA</c> <c>UTF8SMTP with both STARTTLS and SMTP AUTH</c>
      <c><xref target="RFC3207"/> <xref target="RFC4954"/> [RFC&rfc.number;]</c>
</texttable>                                                

</section>

<section title="Security Considerations" anchor="security">
<t> See the extended security considerations discussion in the
   framework document <xref target="RFC4952"/>.
</t>
</section>


<section title="Acknowledgements">
<t>
Much of the text in the initial version of this specification was derived or
copied from <xref target="Emailaddr"/> with the permission of
the author.
Significant comments and suggestions were received from Xiaodong LEE, Nai-Wen Hsu,
Yangwoo KO, Yoshiro YONEYA, and other members of the JET team and were
incorporated into the specification.  Additional important comments
and suggestions, and often specific text, were contributed by many
members of the WG and design team. Those contributions include
material from
John C Klensin, Charles Lindsey, Dave Crocker, Harald Tveit Alvestrand, Marcos Sanz, Chris Newman,
Martin Duerst, Edmon Chung, Tony Finch, Kari Hurtta, Randall Gellens,
Frank Ellermann, Alexey Melnikov, Pete Resnick, S. Moonesamy, Soobok Lee, Shawn Steele, Alfred Hoenes,
Miguel Garcia, Magnus Westerlund, and Lars Eggert.
Of course, none of the individuals are
necessarily responsible for the combination of ideas represented
here.
</t>
</section>

</middle>

<back>

<references title="Normative References">

 <reference anchor="RFC4952">
 <front>
  <title>Overview and Framework for Internationalized Email</title>
 <author initials="J." surname="Klensin" fullname="J. Klensin">
  <organization />
  </author>
 <author initials="Y." surname="Ko" fullname="Y. Ko">
  <organization />
  </author>
  <date year="2007" month="July" />
 <abstract>
  <t>Full use of electronic mail throughout the world requires that
	 people be able to use their own names, written correctly in
	 their own languages and scripts, as mailbox names in email
	 addresses. This document introduces a series of specifications
	 that define mechanisms and protocol extensions needed to fully
	 support internationalized email addresses. These changes include
	 an SMTP extension and extension of email header syntax to
	 accommodate UTF-8 data. The document set also includes
	 discussion of key assumptions and issues in deploying fully
	 internationalized email. This memo provides information for the
	 Internet community.</t>          
  </abstract>
  </front>
  <seriesInfo name="RFC" value="4952" />
  <format type="TXT" octets="48409" target="ftp://ftp.isi.edu/in-notes/rfc4952.txt" />
  </reference>


<!-- ietf-eai-utf8headers became RFC 5335 -->

<reference anchor="RFC5335">
   <front>
   <title>
Internationalized Email Headers
  </title>
<author initials="Y." surname="Abel" fullname="Abel Yang" role="editor">
  <organization/>
  </author>
  <date month="August"  year="2008" />
  </front>
  <seriesInfo name="RFC" value="5335" />
</reference>


<reference anchor="RFC3463">
 <front>
  <title>Enhanced Mail System Status Codes</title>
 <author initials="G." surname="Vaudreuil" fullname="G. Vaudreuil">
  <organization />
  </author>
  <date year="2003" month="January" />
 <abstract>
  <t>This document defines a set of extended status codes for use within the mail system for delivery status reports, tracking, and improved diagnostics. In combination with other information provided in the Delivery Status Notification (DSN) delivery report, these codes facilitate media and language independent rendering of message delivery status. [STANDARDS TRACK]</t>
  </abstract>
  </front>
  <seriesInfo name="RFC" value="3463" />
  <format type="TXT" octets="31832" target="ftp://ftp.isi.edu/in-notes/rfc3463.txt" />
  </reference>



 <reference anchor="RFC3464">
 <front>
  <title>An Extensible Message Format for Delivery Status Notifications</title>
 <author initials="K." surname="Moore" fullname="K. Moore">
  <organization />
  </author>
 <author initials="G." surname="Vaudreuil" fullname="G. Vaudreuil">
  <organization />
  </author>
  <date year="2003" month="January" />
 <abstract>
  <t>This memo defines a Multipurpose Internet Mail Extensions (MIME) content-type that may be used by a message transfer agent (MTA) or electronic mail gateway to report the result of an attempt to deliver a message to one or more recipients. This content-type is intended as a machine-processable replacement for the various types of delivery status notifications currently used in Internet electronic mail. Because many messages are sent between the Internet and other messaging systems (such as X.400 or the so-called "Local Area Network (LAN)-based" systems), the Delivery Status Notification (DSN) protocol is designed to be useful in a multi-protocol messaging environment. To this end, the protocol described in this memo provides for the carriage of "foreign" addresses and error codes, in addition to those normally used in Internet mail. Additional attributes may also be defined to support "tunneling" of foreign notifications through Internet mail. [STANDARDS TRACK]</t>
  </abstract>
  </front>
  <seriesInfo name="RFC" value="3464" />
  <format type="TXT" octets="83060" target="ftp://ftp.isi.edu/in-notes/rfc3464.txt" />
  </reference>




<!-- 8BITMIME -->
&rfc1652;

&rfc3629;
&rfc2821;
&rfc2822;

<reference anchor="RFC3490">
<front>
<title>Internationalizing Domain Names in Applications (IDNA)</title>
<author initials='P.' surname='Faltstrom' fullname='P. Faltstrom'>
<organization /></author>
<author initials='P.' surname='Hoffman' fullname='P. Hoffman'>
<organization /></author>
<author initials='A.' surname='Costello' fullname='A. Costello'>
<organization /></author>
<date month='March' year='2003' /></front>
<seriesInfo name='RFC' value='3490' />
<format type='TXT' octets='51943'
    target='ftp://ftp.isi.edu/in-notes/rfc3490.txt' />
</reference>

<reference anchor="RFC4409">
 <front>
  <title>Message Submission for Mail</title>
 <author initials="R." surname="Gellens" fullname="R. Gellens">
  <organization />
  </author>
 <author initials="J." surname="Klensin" fullname="J. Klensin">
  <organization />
  </author>
  <date year="2006" month="April" />
 <abstract>
  <t>This memo splits message submission from message relay, allowing each service to operate according to its own rules (for security, policy, etc.), and specifies what actions are to be taken by a submission server.</t><t> Message relay and final delivery are unaffected, and continue to use SMTP over port 25.</t><t> When conforming to this document, message submission uses the protocol specified here, normally over port 587.</t><t> This separation of function offers a number of benefits, including the ability to apply specific security or policy requirements. [STANDARDS TRACK]</t>
  </abstract>
  </front>
  <seriesInfo name="RFC" value="4409" />
  <format type="TXT" octets="34911" target="ftp://ftp.isi.edu/in-notes/rfc4409.txt" />
  </reference>

  <reference anchor="RFC3461">
  <front>
  <title>Simple Mail Transfer Protocol (SMTP) Service Extension for Delivery Status Notifications (DSNs)</title>
 <author initials="K." surname="Moore" fullname="K. Moore">
  <organization />
  </author>
  <date year="2003" month="January" />
  </front>
  <seriesInfo name="RFC" value="3461" />
  <format type="TXT" octets="76076" target="ftp://ftp.isi.edu/in-notes/rfc3461.txt" />
 </reference>

<!-- draft-hansen-4468upd-mailesc-registry became RFC 5248 -->
&rfc5248;

<!-- ietf-eai-dsn became RFC 5337 -->

 <reference anchor="RFC5337">
    <front>
    <title>
          Internationalized Delivery Status and Disposition Notifications</title>
    <author initials="C." surname="Newman" fullname="Chris Newman">
      <organization>Sun Microsystems</organization>
      <address />
      </author>

      <author initials="A." surname="Melnikov" fullname="Alexey
      Melnikov" role="editor">
      <organization>Isode Ltd</organization>
      <address />
      </author>
      <date month="August" year="2008" />
      </front>
  <seriesInfo name="RFC" value="5337" />
</reference>

      <reference anchor='ASCII'>
        <front>
          <title>USA Code for Information Interchange</title>
          <author>
            <organization abbrev="ANSI">
              American National Standards Institute
                (formerly United States of America Standards Institute)
        </organization>
          </author>
          <date year="1968"/>
        </front>
      <seriesInfo name="ANSI" value="X3.4-1968" />
   <!-- <annotation>ANSI X3.4-1968 has been replaced by newer
      versions with slight modifications, but the 1968 version
      remains definitive for the Internet. </annotation>  -->
      </reference>

&rfc2119;
&rfc5234;

</references>

<references title="Informative References">


<reference anchor="Downgrade">
<front>
<title>Downgrading mechanism for Email Address Internationalization</title>

<author initials='K' surname='Fujiwara' fullname='Kazunori  Fujiwara'>
    <organization />
</author>

<author initials='Y' surname='Yoneya' fullname='Yoshiro Yoneya'>
    <organization />
</author>

<date month='July' day='14' year='2008' />

</front>

     <seriesInfo name="Work in" value="Progress" />

</reference>


<reference anchor="RFC2821bis">
    <front><title>Simple Mail Transfer Protocol</title>
       <author initials="J." surname="Klensin" fullname="John C. Klensin">
         <organization> </organization> </author>
      
      <date month="July" year="2008" day="11"/>
    </front>
     <seriesInfo name="Work in" value="Progress" />
</reference>

<reference anchor="RFC0974">
 <front>
  <title>Mail routing and the domain system</title> 
 <author initials="C." surname="Partridge" fullname="Craig Partridge">
  <organization>Bolt Baranek and Newman (BBN) Laboratories Inc., CSNET CIC</organization> 
  </author>
  <date year="1986" day="1" month="January" /> 
  </front>
  <seriesInfo name="RFC" value="974" /> 
  <format type="TXT" octets="18581" target="ftp://ftp.isi.edu/in-notes/rfc974.txt" /> 
  </reference>

<reference anchor="RFC3030">
 <front>
  <title>SMTP Service Extensions for Transmission of Large and Binary MIME Messages</title>
 <author initials="G." surname="Vaudreuil" fullname="G. Vaudreuil">
  <organization />
  </author>
  <date year="2000" month="December" />
 <abstract>
  <t>This memo defines two extensions to the SMTP (Simple Mail Transfer Protocol) service. [STANDARDS TRACK] </t>
  </abstract>
 </front>
  <seriesInfo name="RFC" value="3030" />
  <format type="TXT" octets="23405" target="ftp://ftp.isi.edu/in-notes/rfc3030.txt" />
 </reference>

 <reference anchor="RFC3207">
 <front>
  <title>SMTP Service Extension for Secure SMTP over Transport Layer Security</title>
 <author initials="P." surname="Hoffman" fullname="P. Hoffman">
  <organization />
  </author>
  <date year="2002" month="February" />
 <abstract>
  <t>This document describes an extension to the SMTP (Simple Mail Transfer Protocol) service that allows an SMTP server and client to use TLS (Transport Layer Security) to provide private, authenticated communication over the Internet. This gives SMTP agents the ability to protect some or all of their communications from eavesdroppers and attackers. [STANDARDS TRACK]</t>
  </abstract>
  </front>
  <seriesInfo name="RFC" value="3207" />
  <format type="TXT" octets="18679" target="ftp://ftp.isi.edu/in-notes/rfc3207.txt" />
  </reference>


<reference anchor="RFC4954">
<front>
  <title>SMTP Service Extension for Authentication</title>
 <author initials="R." surname="Siemborski" fullname="R. Siemborski" role="editor">
  <organization />
  </author>
 <author initials="A." surname="Melnikov" fullname="A. Melnikov" role="editor">
  <organization />
  </author>
  <date year="2007" month="July" />
 <abstract>
  <t>This document defines a Simple Mail Transport Protocol (SMTP) extension whereby an SMTP client may indicate an authentication mechanism to the server, perform an authentication protocol exchange, and optionally negotiate a security layer for subsequent protocol interactions during this session. This extension includes a profile of the Simple Authentication and Security Layer (SASL) for SMTP.</t><t> This document obsoletes RFC 2554. [STANDARDS TRACK]</t>
  </abstract>
  </front>
  <seriesInfo name="RFC" value="4954" />
  <format type="TXT" octets="43493" target="ftp://ftp.isi.edu/in-notes/rfc4954.txt" />
  </reference>


<reference anchor="RFC2033">
 <front>
  <title abbrev="Local Mail">Local Mail Transfer Protocol</title>
 <author initials="J.G." surname="Myers" fullname="John G. Myers">
  <organization>Carnegie-Mellon University</organization>
 <address>
 <postal>
  <street>5000 Forbes Ave.</street>
  <street>Pittsburgh</street>
  <street>15213-3890</street>
  <country>PA</country>
  </postal>
  <email>jgm+@cmu.edu</email>
  </address>
  </author>
  <date year="1996" month="October" />
  <area>Applications</area>
  <keyword>mail</keyword>
  </front>
  <seriesInfo name="RFC" value="2033" />
  <format type="TXT" octets="14711" target="ftp://ftp.isi.edu/in-notes/rfc2033.txt" />
  <format type="HTML" octets="27748" target="http://xml.resource.org/public/rfc/html/rfc2033.html" />
  <format type="XML" octets="17426" target="http://xml.resource.org/public/rfc/xml/rfc2033.xml" />
  </reference>





<reference anchor="Emailaddr">
<front>
<title>
Internationalization of Email Addresses
</title>
<author initials="J.C." surname="Klensin" fullname="John C Klensin">
  <organization/>
  <address>
    <postal>
      <street>1770 Massachusetts Ave, #322</street>
      <city>Cambridge</city> <region>MA</region> <code>02140</code>
      <country>USA</country> </postal>
    <phone>+1 617 491 5735 </phone>
    <email>john-ietf@jck.com</email>
  </address>
  </author>
  <date month="July" day="18" year="2005" />
</front>

     <seriesInfo name="Work in" value="Progress" />
</reference>

</references>

   
   <section title="Material Updating RFC 4952">
   <t>RFC 4952, the overview and framework document covering this set
      of extensions for internationalized email, was completed before this
      specification, which specifies a particular part of the protocol set.  This
      appendix, which is normative, contains material that would have
      been incorporated into RFC 4952 had it been delayed until the
      work described in the rest of this specification was
      completed. This material should be included in any update to RFC 4952.</t>

<section title="Conventional Message and Internationalized Message"  >


      <t><list style="symbols">
         <t>A conventional message is one that does not use any extension
         defined in this document
or in the UTF-8 header specification <xref target="RFC5335" />,
and which is strictly conformant to RFC 2822 <xref target="RFC2822" />.</t>
         <t>An internationalized message is a message utilizing one or more of
the extensions defined in this specification or in the UTF-8 header
specification <xref target="RFC5335" />,
so that it is no longer
conformant to the RFC 2822 specification of a message.</t>

      </list></t>

</section>

<section title="LMTP"  >

<t>LMTP <xref target="RFC2033" /> may be used as the final delivery agent.
In such cases, LMTP may be arranged to deliver the mail to the mail store.
The mail store may not have UTF8SMTP capability. LMTP needs to be updated to
deal with these situations.
</t>

</section>



<section title="SMTP Service Extension for DSNs"  >
<t>
    The existing Draft Standard regarding delivery status notifications
    (DSNs) <xref target="RFC3461" /> is limited to ASCII text
    in the machine readable portions of the protocol.
    "International Delivery Status and Disposition
    Notifications" <xref target="RFC5337" /> adds a new address type
    for international email addresses so an original recipient address
    with non-ASCII characters can be correctly preserved even after
    downgrading.
    If an SMTP server advertises both the UTF8SMTP and the DSN extension,
    that server MUST implement EAI DSN <xref target="RFC5337" />
    including support for the ORCPT parameter.</t>
</section>



<section title="Implementation Advice">
    <t>In the absence of this extension, SMTP clients and servers are
    constrained to using only those addresses permitted by RFC 2821. The
    local parts of those addresses MAY be made up of any ASCII characters,
    although some of them MUST be quoted as specified there. It is
    notable in an internationalization context that there is a long
    history on some systems of using overstruck ASCII characters (a
    character, a backspace, and another character) within a quoted string
    to approximate non-ASCII characters. This form of
    internationalization SHOULD be phased out as this extension
    becomes widely deployed, but backward-compatibility considerations
    require that it continue to be supported.
    </t>
</section>


<section title="Applicability of SMTP Extension to Additional Uses">
    <t>
     Among other protocol changes, the SMTP extension allows an
     optional alternate address to be supplied with the MAIL and RCPT
     commands. For the purposes of this set of specifications, this
     alternate address only has meaning when the primary address
     contains UTF-8 characters and the message is downgraded.
     While it may be tempting to consider the alternate address as a
     general-purpose second-chance address to be used whenever the
     primary address is rejected, such behavior is not defined here.
     This restriction allows for future extensions to be developed
     which create such a general-purpose second-chance address,
     although no specific work on such an extension is currently
     anticipated.  Note that any such extension needs to consider the
     question of what the <xref target="RFC0974" /> sequencing rules mean when
     different possible servers support different sets of ESMTP
     options (or, in this case, addresses). The answer to this
     question may also imply updates to <xref target="RFC2821" />.
    </t>
</section>


</section>

</back>
</rfc>

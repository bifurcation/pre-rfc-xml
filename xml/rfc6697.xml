<?xml version="1.0" encoding="US-ASCII"?>

<?xml-stylesheet type='text/xsl'
href='http://xml.resource.org/authoring/rfc2629.xslt' ?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY rfc2828 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2828.xml">
<!ENTITY rfc2865 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2865.xml">
<!ENTITY rfc3588 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3588.xml">
<!ENTITY rfc3748 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3748.xml">
<!ENTITY rfc4306 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4306.xml">
<!ENTITY rfc4962 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4962.xml">
<!ENTITY rfc5169 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5169.xml">
<!ENTITY rfc5247 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5247.xml">
<!ENTITY rfc5295 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5295.xml">
<!ENTITY rfc5749 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5749.xml">
<!ENTITY rfc5836 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5836.xml">
<!ENTITY rfc5873 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5873.xml">
<!ENTITY rfc4072 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4072.xml">
<!ENTITY rfc6440 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6440.xml">
]>

<?rfc toc="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<?rfc rfcedstyle="yes"?>

<rfc category="info" number="6697" ipr="trust200902" submissionType="IETF" consensus="yes">
  <front>
    <title abbrev="HOKEY Architecture Design">Handover Keying (HOKEY) Architecture Design</title>

    <author fullname="Glen Zorn" initials="G." role="editor" surname="Zorn">
      <organization abbrev="Network Zen">Network Zen</organization>

      <address>
        <postal>
          <street>227/358 Thanon Sanphawut</street>

          <city>Bang Na</city>

          <region>Bangkok</region>

          <code>10260</code>

          <country>Thailand</country>
        </postal>

        <phone>+66 (0) 909 201060</phone>

        <email>glenzorn@gmail.com</email>
      </address>
    </author>

    <author fullname="Qin Wu" initials="Q." surname="Wu">
      <organization abbrev="Huawei">Huawei Technologies Co., Ltd.</organization>

      <address>
        <postal>
          <street>101 Software Avenue, Yuhua District</street>

          <city>Nanjing</city>

          <region>JiangSu</region>

          <code>210012</code>

          <country>China</country>
        </postal>

        <phone>+86-25-84565892</phone>

        <email>bill.wu@huawei.com</email>
      </address>
    </author>

    <author fullname="Tom Taylor" initials="T." surname="Taylor">
      <organization abbrev="Huawei">Huawei Technologies Co.,
      Ltd.</organization>

      <address>
        <postal>
          <street></street>

          <city>Ottawa</city>
          <region>Ontario</region>

          <country>Canada</country>
        </postal>

        <email>tom.taylor.stds@gmail.com</email>
      </address>
    </author>
    
    <author fullname="Yoav Nir" initials="Y." surname="Nir">
      <organization>Check Point</organization>

      <address>
        <postal>
          <street>5 Hasolelim St.</street>

          <region>Tel Aviv</region>

          <code>67897</code>

          <country>Israel</country>
        </postal>

        <email>ynir@checkpoint.com</email>
      </address>
    </author>

    <author fullname="Katrin Hoeper" initials="K." surname="Hoeper">
      <organization abbrev="Motorola Solutions, Inc.">Motorola Solutions, Inc.</organization>

      <address>
        <postal>
          <street>1301 E. Algonquin Road</street>

          <city>Schaumburg</city>

          <region>IL</region>

          <code>60196</code>

          <country>USA</country>
        </postal>

        <email>khoeper@motorolasolutions.com></email>
      </address>
    </author>
    
    <author fullname="Sebastien Decugis" initials="S." surname="Decugis">
                <organization>INSIDE Secure</organization>

                <address>
                <postal>
                        <street>41 Parc Club du Golf</street>
                        <city>Aix-en-Provence</city>
                        <code>13856</code>
                        <country>France</country>
                </postal>
                <phone>+33 (0)4 42 39 63 00</phone>
        <email>sdecugis@freediameter.net</email>
      </address>
    </author>

    <date month="July" year="2012" />

    <abstract>
      <t>The Handover Keying (HOKEY) Working Group seeks to minimize handover
      delay due to authentication when a peer moves from one point of
      attachment to another. Work has progressed on two different approaches
      to reduce handover delay: early authentication (so that authentication
      does not need to be performed during handover), and reuse of
      cryptographic material generated during an initial authentication to
      save time during re-authentication. A basic assumption is that the
      mobile host or "peer" is initially authenticated using the Extensible
      Authentication Protocol (EAP), executed between the peer and an EAP
      server as defined in RFC 3748.</t>

      <t>This document defines the HOKEY architecture. Specifically, it
      describes design objectives, the functional environment within which
      handover keying operates, the functions to be performed by the HOKEY
      architecture itself, and the assignment of those functions to
      architectural components. It goes on to illustrate the operation of the
      architecture within various deployment scenarios that are described more
      fully in other documents produced by the HOKEY Working Group.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>The Extensible Authentication Protocol (EAP) <xref
      target="RFC3748"></xref> is an authentication framework that supports
      different types of authentication methods. Originally designed for
      dial-up connections, EAP is now commonly used for authentication
      in a variety of access networks.</t>

      <t>When a host (or "peer", the term used from this point onward) changes
      its point of attachment to the network, it must be re-authenticated. If
      a full EAP authentication must be repeated, several message round trips
      between the peer and the home EAP server may be involved. The resulting
      delay will result in degradation -- or, in the worst case, loss of any
      service session in progress -- if communication is suspended while
      re-authentication is carried out. The delay is worse if the new point of
      attachment is in a visited network rather than the peer's home network
      because of the extra procedural steps involved as well as the
      probable increase in round-trip time.</t>

      <t>Clancy, et al.&nbsp;<xref target="RFC5169"></xref>
      describe this problem more fully and
      establish design goals for solutions to reduce re-authentication delay
      for transfers within a single administrative domain. 
      They also suggest a number of ways to achieve a
      solution: <list style="symbols">
          <t>specification of a method-independent, efficient
          re-authentication protocol based upon EAP;</t>

          <t>reuse of keying material from the initial EAP authentication;</t>

          <t>deployment of re-authentication servers local to the peer to
          reduce round-trip delay; and</t>

          <t>specification of the additional protocol needed to allow the EAP
          server to pass authentication information to the local
          re-authentication servers.</t>
        </list></t>

      <t>Salowey, et al.&nbsp;<xref target="RFC5295"></xref>
      tackle the problem of the reuse of keying material by specifying how to
      derive a hierarchy of cryptographically independent purpose-specific
      keys from the results of the original EAP authentication, while
      Cao, et&nbsp;al.&nbsp;<xref target="RFC6696"></xref> specify a
      method-independent re-authentication protocol (the EAP Re-authentication
      Protocol (ERP)) applicable to two specific deployment
      scenarios: <list style="symbols">
          <t>where the peer's home EAP server also performs re-authentication;
          and</t>

          <t>where a local re-authentication server exists but is co-located
          with an Authentication, Authorization, and Accounting (AAA)
          proxy within the domain.</t>
        </list></t>

      <t>Other work provides further pieces of the solution or insight into
      the problem. For the purpose of this memo, Hoeper, et al.&nbsp;<xref
      target="RFC5749"></xref> provide an abstract mechanism for distribution
      of keying material from the EAP server to re-authentication servers.
      Ohba, et&nbsp;al.&nbsp;<xref target="RFC5836"></xref> contrast the EAP
      Re-authentication (ER) strategy provided by ERP with an alternative
      strategy called "early authentication". RFC 5836
      defines EAP early authentication as the use of EAP by a mobile peer to
      establish authenticated keying material on a target attachment point
      prior to its arrival. 
      Hence, the goal of EAP early
      authentication is to complete all EAP-related communications, including
      AAA signaling, in preparation for the handover, before the mobile device
      actually moves. 
      Early authentication includes direct and indirect
      pre-authentication as well as Authenticated Anticipatory Keying (AAK).
      All three early authentication mechanisms provide means to securely
      establish authenticated keying material on
      a Candidate Attachment Point (CAP) while still being connected to the
      Serving Attachment Point (SAP) but vary in their respective system
      assumptions and communication paths. In particular, direct
      pre-authentication assumes that clients are capable of discovering
      CAPs and all communications are routed through the SAP.
      On the other hand, indirect pre-authentication assumes an existing
      relationship between the SAP and CAP, whereas the discovery and selection
      of CAPs is outside the scope of AAK.
      Furthermore, both direct and indirect pre-authentication require a full
      EAP execution to occur before the handover of the peer takes place,
      while AAK techniques (like ERP <xref target="RFC6696"/>) use keys
      derived from the initial EAP authentication. </t>

      <t>Both EAP re-authentication and early authentication enable faster
      inter-authenticator handovers.
      However, it is currently unclear how
      the necessary handover infrastructure can be deployed and
      integrated into existing EAP infrastructures. In particular, previous work has not
      described how ER servers that act as endpoints in the re-authentication
      process should be integrated into local and home domain networks.
      Furthermore, how EAP infrastructure can
      support the timely triggering of early authentications and aid with the
      selection of CAPs is currently unspecified.</t>

      <t>This document proposes a general HOKEY architecture and demonstrates
      how it can be adapted to different deployment scenarios. To begin with,
      <xref target="goals"></xref> recalls the design objectives for the HOKEY
      architecture. <xref target="fncns"></xref> reviews the functions that
      must be supported within the architecture. <xref target="compon"></xref>
      describes the components of the HOKEY architecture. 
      <xref target="scen"></xref> describes the different deployment scenarios that
      the HOKEY Working Group has addressed and the information flows that
      must occur within those scenarios, by reference to the documents
      summarized above where possible and otherwise within this document
      itself.
      Finally, <xref target="aaa"/> provides an analysis of how AAA protocols
      can be applied in the HOKEY architecture.
      </t>
    </section>

    <!-- Introduction -->

    <section anchor="terms" title="Terminology">

      <t>This document reuses terms defined in Section 2 of
      Ohba, et&nbsp;al.&nbsp;<xref target="RFC5836"></xref> and Section 2 of
      Cao, et&nbsp;al.&nbsp;<xref target="RFC6696"></xref>. 
      In addition, it defines the following:
      <list style="hanging">
                  <t hangText="DS&nbhy;rRK">
                          <vspace blankLines="0"/>
                          Domain-Specific re-authentication Root Key.
                  </t>

                  <t hangText="pMSK">
                          <vspace blankLines="0"/>
                          pre-established Master Session Key
                  </t>
                  
          <t hangText="EAP Early Authentication"><vspace blankLines="0" /> The
          use of EAP by a mobile peer to establish authenticated keying
          material on a target attachment point prior to its arrival; see
          Ohba, et&nbsp;al.&nbsp;<xref target="RFC5836"></xref>.</t>
          
          <t hangText="ER Key Management"><vspace blankLines="0" /> An
          instantiation of the mechanism described in
          Hoeper, et&nbsp;al.&nbsp;<xref target="RFC5749"></xref>
          for creating and delivering root keys from
          an EAP server to an ER server.</t>


          <t hangText="EAP Re-authentication (ER)"><vspace blankLines="0" />
          The use of keying material derived from an initial EAP
          authentication to enable single-round-trip re-authentication of a
          mobile peer. For a detailed description of the keying material, see
          Section 4 of Cao, et&nbsp;al.&nbsp;<xref target="RFC6696"></xref>.</t>

          <t hangText="ER Server"><vspace blankLines="0" /> A component of the
          HOKEY architecture that terminates the EAP re-authentication
          exchange with the peer.</t>

        </list></t>
    </section>

    <section anchor="goals" title="Design Goals">
      <t>This section investigates the design goals for the HOKEY
      architecture. These include reducing the signaling overhead for re-
      authentication and early authentication, integrating local domain name
      discovery, enabling fault-tolerant re-authentication,
      and improving deployment scalability. These goals supplement
      those discussed in Section 4 of RFC 5169.
      Note that the identification and selection of CAPs is
      not a goal of the architecture, since those operations are generally
      specific to the lower layer in use. 
      </t>

      <section anchor="sigOvhd" title="Reducing Signaling Overhead">
        <section title="Minimized Communications with Home Servers">
          <t>ERP <xref target="RFC6696"/>
          requires only one round trip; however, this round trip may
          require communication between a peer and its home ER and/or home
          AAA server in explicit bootstrapping and communication between local
          servers and the home server in implicit bootstrapping even if the peer
          is currently attached to a visited (local) network. As a result,
          even this one round trip may introduce long delays because the home ER
          and home AAA servers may be distant from the peer and the network 
          to which it is attached. To lower signaling
          overhead, communication with the home ER server and home AAA server
          should be minimized. Ideally, a peer should only need to communicate
          with local servers and other local entities.</t>
        </section>

        <section title="Minimized User Interaction for Authentication">
          <t> When the peer is initially attached to the network or moves
          between heterogeneous networks, full EAP authentication
          between the peer and EAP server occurs and user interaction 
          may be needed, e.g., a dialog to prompt the user
          for credentials. 
          To reduce latency, user
          interaction for authentication at each handover should be
          minimized.
          Ideally, user involvement should take place only 
          during initial authentication and subsequent re-authentication should occur 
          transparently.</t>
        </section>
       </section>
       
        <section title="Integrated Local Domain Name (LDN) Discovery">
          <t> ERP bootstrapping must occur before (implicit) or during
          (explicit) a handover to transport the necessary
          keys to the local ER server involved. Implicit bootstrapping is
          preferable because it does not require communication with the home
          ER server during handover, but it requires that the
          peer know the domain name of the ER server before the subsequent
          local ERP exchange happens in order to derive the necessary
          re-authentication keying material. ERP <xref target="RFC6696"></xref>
          does not specify such a domain name discovery mechanism and suggests
          that the peer may learn the domain name through the
          EAP-Initiate/Re-auth-Start message or via lower-layer announcements.
          However,
          domain name discovery happens after the implicit bootstrapping
          completes, which may introduce extra latency. To allow
          more efficient handovers, a HOKEY architecture should support an
          efficient domain name discovery mechanism 
          (for example, see <xref target="RFC6440">Zorn, Wu &amp; Wang</xref>)    
          and allow its integration
          with ERP implicit bootstrapping. Even in the case of explicit
          bootstrapping, LDN discovery should be optimized such
          that it does not require contacting the home AAA server, as is
          currently the case. </t>
        </section>

                <section title="Fault-Tolerant Re-Authentication">
                        <t>
                                If all authentication services depend upon a remote server, a network partition can result
                                in the denial of service to valid users.  However, if for example an ER server exists in the 
                                local network, previously authenticated users can re-authenticate even though a link to the home or main
                                authentication server doesn't exist.
                        </t>
                </section>
                
      <section title="Improved Deployment Scalability">
        <t>To provide better deployment scalability, there should be no
   requirement for the co-location of entities providing handover keying
   services (e.g., ER servers) and AAA servers or proxies.  Separation
   of these entities may cause problems with routing but allows greater
   flexibility in deployment and implementation.</t>
      </section>
    </section>

    <section anchor="fncns" title="Required Functionality">   
      <section anchor="SysOver" title="Authentication Subsystem Functional Overview">
        <t>The operation of the authentication subsystem 
          provided by HOKEY also depends on the
        availability of a number of discovery functions: <list style="symbols">
            <t>discovery of CAPs by the peer, by the SAP,
            or by some other entity;</t>

            <t>discovery of the authentication services supported at a given
            CAP;</t>

            <t>discovery of the required server in the home domain when a
            CAP is not in the same domain as the SAP, or no local server
            is available;</t>

            <t>peer discovery of the LDN when EAP
            re-authentication is used with a local server.</t>
          </list> It is assumed that these functions are provided by the
        environment within which the authentication subsystem operates and
        are outside the scope of the authentication subsystem itself. LDN
        discovery is a possible exception.</t>

        <t>The major functions
        comprising the authentication subsystem and their interdependencies are discussed in greater detail below.

        <list style="symbols">
            <t>When AAA is invoked to authorize network
            access, it uses one of two services offered by the authentication
            subsystem: full EAP authentication or EAP re-authentication.  
            Note that although AAA may perform authentication directly in some cases,
            when EAP is utilized AAA functions only as a transport for EAP messages 
            and the encryption keys (if any) resulting from successful EAP authentication.
            </t>

            <t>Pre-authentication triggers AAA network access authorization at each CAP, which in turn
            causes full EAP authentication to be invoked.</t>

            <t>EAP re-authentication invokes ER key management at the time of
            authentication to create and distribute keying material to ER
            servers.</t>

            <t>AAK relies on ER key
            management to establish keying material on ER/AAK servers but
            uses an extension to ER key management to derive and establish
            keying material on candidate authenticators. 
            AAK uses an
            extension to EAP re-authentication to communicate with ER/AAK
            servers.</t>
          </list></t>

        <t>EAP authentication, EAP re-authentication, and handover key
        distribution depend on the routing and secure transport service
        provided by AAA. Discovery functions and the function of
        authentication and authorization of network entities (access points,
        ER servers) are not shown. As stated above, these are external to the
        authentication subsystem.</t>
      </section>

      <!-- System Overview -->

      <section anchor="preauth"
               title="Pre-Authentication Function (Direct or Indirect)">
        <t>The pre-authentication function is responsible for discovery of
        CAPs and completion of network access
        authentication and authorization at each CAP in
        advance of handover. The operation of this function is described in
        general terms in Ohba, et&nbsp;al.&nbsp;<xref target="RFC5836"></xref>.
        No document is yet
        available to describe the implementation of pre-authentication in
        terms of specific protocols; <xref target="RFC5873">pre-authentication
        support for the Protocol for Carrying Authentication for Network
        Access (PANA)</xref> could be part of the solution.</t>
      </section>

      <!-- preauth -->

      <section anchor="reauth" title="EAP Re-Authentication Function">
        <t>The EAP re-authentication function is responsible for
        authenticating the peer at a specific access point using keying
        material derived from a prior full EAP authentication. <xref
        target="RFC5169">RFC 5169</xref> provides the design objectives for an
        implementation of this function. <xref target="RFC6696">ERP</xref>
        describes a protocol to implement EAP re-authentication.
        </t>
      </section>

      <!-- reauth -->

      <section anchor="EAPauthen" title="EAP Authentication Function">
        <t>The EAP authentication function is responsible for authenticating
        the peer at a specific access point using a full EAP exchange. Aboba,
        et&nbsp;al.&nbsp;<xref target="RFC3748"></xref> define the associated
        protocol, while Ohba, et&nbsp;al.&nbsp;<xref target="RFC5836"></xref> 
        describe the use of EAP as part of
        pre-authentication. Note that the HOKEY Working Group has not
        specified the non-AAA protocol required to transport EAP frames over
        IP that is shown in Figures 3 and 5 of
        Ohba, et&nbsp;al.&nbsp;<xref target="RFC5836"></xref>,
        although <xref target="RFC5873">PANA</xref> is a candidate.</t>
      </section>

      <!-- EAPauthen -->

      <section anchor="AAKfcn" title="Authenticated Anticipatory Keying (AAK) Function">
        <t>The AAK function is responsible for
        pre-placing keying material derived from an initial full EAP
        authentication on CAPs. The operation is carried
        out in two steps: ER key management (with trigger not currently
        specified) places root keys derived from initial EAP authentication
        onto an ER/AAK server associated with the peer. When requested by the
        peer, the ER/AAK server derives and pushes predefined master session
        keys to one or more CAPs. The operation of the AAK
        function is described in very
        general terms in Ohba, et&nbsp;al.&nbsp;<xref target="RFC5836"></xref>.
        A protocol specification exists (see Cao, et&nbsp;al.&nbsp;<xref target="RFC6630"></xref>).
        </t>
      </section>

      <!-- AAKfcn -->

      <section anchor="keyMgmt" title="Management of EAP-Based Handover Keys">
        <t>Handover key management consists of EAP
        method-independent key derivation and distribution and comprises the
        following specific functions: <list style="symbols">
            <t>handover key derivation</t>

            <t>handover key distribution</t>
          </list> The derivation of handover keys is specified in Salowey,
        et&nbsp;al.&nbsp;<xref target="RFC5295"></xref>, and AAA-based key
        distribution is specified in <xref target="RFC5749">Hoeper,
        Nakhjiri &amp; Ohba</xref>.</t>
      </section>

      <!-- keyMgmt -->
    </section>
  
    <!-- fncns -->

    <section anchor="compon" title="Components of the HOKEY Architecture">
      <t>This section describes the components of the HOKEY architecture in
      terms of the functions they perform. The components cooperate as
      described in this section to carry out the functions described in the
      previous section. <xref target="scen"></xref> describes the different
      deployment scenarios that are possible using these functions.</t>

      <t>The components of the HOKEY architecture are as follows: <list
          style="symbols">
          <t>the peer;</t>

          <t>the authenticator, which is a part of the SAP and CAPs;</t>

          <t>the EAP server;</t>

          <t>the ER server; and</t>

          <t>the ER/AAK server <xref target="RFC6630"></xref>,
          either in the home domain or local to the authenticator.</t>
        </list></t>

      <section anchor="peerFnc" title="Functions of the Peer">
        <t>The peer participates in the functions described in <xref
        target="fncns"></xref>, as shown in <xref
        target="tab_peerFnc"></xref>.</t>

        <texttable anchor="tab_peerFnc" title="Functions of the Peer">
          <ttcol>Function</ttcol>

          <ttcol>Peer Role</ttcol>

          <c>EAP authentication</c>

          <c>Determines that full EAP authentication is needed based on
          context (e.g., initial authentication), prompting from the
          authenticator, or discovery that only EAP authentication is
          supported. &nbsp;Participates in the EAP exchange with the EAP server.</c>

          <c>-</c>

          <c>-</c>

          <c>Direct pre-authentication</c>

          <c>Discovers CAPs. &nbsp;Initiates pre-authentication
          with each, followed by EAP authentication as above, but using IP
          rather than L2 transport for the EAP frames.</c>

          <c>-</c>

          <c>-</c>

          <c>Indirect pre-authentication</c>

          <c>Enters into a full EAP exchange when triggered, using either L2
          or L3 transport for the frames.</c>

          <c>-</c>

          <c>-</c>

          <c>EAP re-authentication</c>

          <c>Determines that EAP re-authentication is possible based on
          discovery or authenticator prompting. &nbsp;Participates in ERP
          exchange with the ER server.</c>

          <c>-</c>

          <c>-</c>

          <c>AAK</c>

          <c>Determines that AAK is possible based on discovery or serving
          authenticator prompting. &nbsp;Discovers CAPs. &nbsp;Participates in ERP/AAK exchange, requesting distribution of keying material to
          the CAPs.</c>

          <c>-</c>

          <c>-</c>

          <c>ER key management</c>

          <c>No role.</c>
        </texttable>
      </section>

      <!-- peerFnc -->

      <section anchor="saFnc" title="Functions of the Serving Authenticator">
        <t>The serving authenticator participates in the functions described
        in <xref target="fncns"></xref>, as shown in <xref
        target="tab_saFnc"></xref>.</t>

        <texttable anchor="tab_saFnc"
                   title="Functions of the Serving Authenticator">
          <ttcol>Function</ttcol>

          <ttcol>Serving Authenticator Role</ttcol>

          <c>EAP authentication</c>

          <c>No role.</c>

          <c>-</c>

          <c>-</c>

          <c>Direct pre-authentication</c>

          <c>No role.</c>

          <c>-</c>

          <c>-</c>

          <c>Indirect pre-authentication</c>

          <c>Discovers CAPs. &nbsp;Initiates an EAP exchange
          between the peer and the EAP server through each candidate
          authenticator. &nbsp;Mediates between L2 transport of EAP frames on the
          peer side and a non-AAA protocol over IP toward the CAP.</c>

          <c>-</c>

          <c>-</c>

          <c>EAP re-authentication</c>

          <c>No role.</c>

          <c>-</c>

          <c>-</c>

          <c>AAK</c>

          <c>Mediates between L2 transport of AAK frames on the peer side and
          AAA transport toward the ER/AAK server.</c>

          <c>-</c>

          <c>-</c>

          <c>ER key management</c>

          <c>No role.</c>
        </texttable>
      </section>

      <!-- saFnc -->

      <section anchor="caFnc" title="Functions of the Candidate Authenticator">
        <t>The candidate authenticator participates in the functions described
        in <xref target="fncns"></xref>, as shown in <xref
        target="tab_caFnc"></xref>.</t>

        <texttable anchor="tab_caFnc"
                   title="Functions of the Candidate Authenticator">
          <ttcol>Function</ttcol>

          <ttcol>Candidate Authenticator Role</ttcol>

          <c>EAP authentication</c>

          <c>Invokes AAA network access authentication and authorization upon
          handover/initial attachment. &nbsp;Mediates between L2 transport of EAP
          frames on the peer link and AAA transport toward the EAP server.</c>

          <c>-</c>

          <c>-</c>

          <c>Direct pre-authentication</c>

          <c>Invokes AAA network access authentication and authorization when
          the peer initiates authentication. &nbsp;Mediates between non-AAA L3
          transport of EAP frames on the peer side and AAA transport toward
          the EAP server.</c>

          <c>-</c>

          <c>-</c>

          <c>Indirect pre-authentication</c>

          <c>Same as direct pre-authentication, except that it communicates
          with the serving authenticator rather than the peer.</c>

          <c>-</c>

          <c>-</c>

          <c>EAP re-authentication</c>

          <c>Invokes AAA network access authentication and authorization upon
          handover. &nbsp;Discovers or is configured with the address of the ER
          server. &nbsp;Mediates between L2 transport of ERP frames on the peer
          side and AAA transport toward the ER server.</c>

          <c>-</c>

          <c>-</c>

          <c>AAK</c>

          <c>Receives and saves the pMSK.</c>

          <c>-</c>

          <c>-</c>

          <c>ER key management</c>

          <c>No role.</c>
        </texttable>

      </section>

      <!-- caFnc -->

      <section anchor="EAPsrvFnc" title="Functions of the EAP Server">
        <t>The EAP server participates in the functions described in <xref
        target="fncns"></xref>, as shown in <xref
        target="tab_EAPsrvFnc"></xref>.</t>

        <texttable anchor="tab_EAPsrvFnc" title="Functions of the EAP Server">
          <ttcol>Function</ttcol>

          <ttcol>EAP Server Role</ttcol>

          <c>EAP authentication</c>

          <c>Terminates EAP signaling between it and the peer via
          the candidate authenticator. Determines whether network access
          authentication succeeds or fails. &nbsp;Provides the MSK to the
          authenticator (via AAA).</c>

          <c>-</c>

          <c>-</c>

          <c>Direct pre-authentication</c>

          <c>Same as for EAP authentication.</c>

          <c>-</c>

          <c>-</c>

          <c>Indirect pre-authentication</c>

          <c>Same as for EAP authentication.</c>

          <c>-</c>

          <c>-</c>

          <c>EAP re-authentication</c>

          <c>Provides an rRK or DS&nbhy;rRK to the ER
          server (via AAA).</c>

          <c>-</c>

          <c>-</c>

          <c>AAK</c>

          <c>Same as for EAP re-authentication.</c>

          <c>-</c>

          <c>-</c>

          <c>ER key management</c>

          <c>Creates an rRK or DS&nbhy;rRK and distributes it to the ER server requesting
          the information.</c>
        </texttable>
      </section>

      <!-- EAPsrvFnc -->

      <section anchor="ERsrvFnc" title="Functions of the ER Server">
        <t>The ER server participates in the functions described in <xref
        target="fncns"></xref>, as shown in <xref
        target="tab_ERsrvFnc"></xref>.</t>

        <texttable anchor="tab_ERsrvFnc" title="Functions of the ER Server">
          <ttcol>Function</ttcol>

          <ttcol>ER Server Role</ttcol>

          <c>EAP authentication</c>

          <c>No role.</c>

          <c>-</c>

          <c>-</c>

          <c>Direct pre-authentication</c>

          <c>No role.</c>

          <c>-</c>

          <c>-</c>

          <c>Indirect pre-authentication</c>

          <c>No role.</c>

          <c>-</c>

          <c>-</c>

          <c>EAP re-authentication</c>

          <c>Acquires an rRK or DS&nbhy;rRK as applicable when
          necessary. &nbsp;Terminates ERP signaling between it and the
          peer via the candidate authenticator. &nbsp;Determines whether
          network access authentication succeeds or fails. Provides
          an MSK to the authenticator.</c>

          <c>-</c>

          <c>-</c>

          <c>AAK</c>

          <c>Acquires an rRK or DS&nbhy;rRK
          as applicable when necessary. &nbsp;Derives pMSKs and
          passes them to the CAPs.</c>

          <c>-</c>

          <c>-</c>

          <c>ER key management</c>

          <c>Receives and saves an rRK or DS&nbhy;rRK as applicable.</c>
        </texttable>

      </section>

      <!-- ERsrvFnc -->
    </section>

    <!-- compon -->

    <section anchor="scen" title="Usage Scenarios">
      <t>Depending upon whether a change in a domain or access
      technology is involved, we have the following usage scenarios.</t>

       <section title="Simple Re-Authentication">
            <t>The peer remains stationary and re-authenticates to the original access point.  Note that in this case, 
             the SAP takes the role of the CAP in the discussion above.</t>
           </section>    
      <section title="Intra-Domain Handover">
        <t>The peer moves between two authenticators in the same domain. In
        this scenario, the peer communicates with the ER server via the ER
        authenticator within the same network.</t>
      </section>

      <section title="Inter-Domain Handover">
        <t>The peer moves between two different domains. In this scenario, the
        peer communicates with more than one ER server via one or two
        different ER authenticators. One ER server is located in the current
        network as the peer, and one is located in the previous network from which
        the peer moves. Another ER server is located in the home network to which
        the peer belongs.</t>
      </section>

      <section title="Inter-Technology Handover">
        <t>The peer moves between two heterogeneous networks. In this
        scenario, the peer needs to support at least two access technologies.
        The coverage of two access technologies usually is overlapped during
        handover. In this case, only authentication corresponding to
        intra-domain handover is required; i.e., the peer can communicate
        with the same local ER server to complete authentication and obtain
        keying material corresponding to the peer.</t>
      </section>
    </section>

    <!-- scen -->

    <section title="AAA Considerations" anchor="aaa">
      <t>This section provides an analysis of how the AAA protocol can be
      applied in the HOKEY architecture in accordance with
      <xref target="SysOver"/> ("Authentication Subsystem Functional
      Overview").</t>

      <section title="Authorization">
        <t> Authorization is a major issue in deployments. Wherever the peer
        moves around, the home AAA server provides authorization for the peer
        during its handover. However, it is unnecessary to couple authorization
        with authentication at every handover, since authorization is
        only needed when the peer is initially attached to the network or moves
        between two different AAA domains. The EAP key management document
        <xref target="RFC5247"></xref> discusses several vulnerabilities that
        are common to handover mechanisms. One important issue arises from the
        way that the authorization decisions might be handled at the AAA
        server during network access authentication. For example, if AAA
        proxies are involved, they may also influence authorization
        decisions. Furthermore, the reasons for choosing a particular decision
        are not communicated to the AAA clients. In fact, the AAA client only
        knows the final authorization result. Another issue relates to session
        management. In some circumstances, when the peer moves from one
        authenticator to another, the peer may be authenticated by the
        different authenticator during a period of time, and the authenticator
        to which the peer is currently attached needs to create a new AAA user
        session; however, the AAA server should not view these handoffs as
        different sessions. Otherwise, this may affect user experience and also cause
        accounting or logging issues. For example, session ID creation, in
        most cases, is done by each authenticator to which the peer attaches.
        In this sense, the new authenticator acting as AAA client needs to
        create a new AAA user session from scratch, which forces its
        corresponding AAA server to terminate the existing user session with
        the previous authenticator and set up a new user session with the new
        authenticator. This may complicate the setup and maintenance of the
        AAA user session. </t>
      </section>

      <section title="Transport Aspect">
        <t>The existing AAA protocols can be used to carry EAP and
        ERP messages between the AAA server and AAA clients. AAA transport of
        ERP messages is specified in <xref target="RFC5749">Hoeper, Nakhjiri
        &amp; Ohba</xref> and Bournelle, et&nbsp;al.&nbsp;<xref target="DIAMETER-ERP"></xref>. 
        AAA transport of EAP messages is
        specified in <xref target="RFC4072"></xref>.
        Key transport also can
        be performed through a AAA protocol. <xref
        target="DIAMETER-AVP">Zorn, Wu &amp; Cakulev</xref> specify a set of
        Attribute-Value Pairs (AVPs) providing native Diameter support of
        cryptographic key delivery.</t>
      </section>
    </section>

    <section title="Security Considerations">
     <t>This document does not introduce any new security vulnerabilities.</t>

        </section>

    <section title="Acknowledgments">
      <t>The authors would like to thank Mark Jones, Zhen Cao, Semyon Mizikovsky, 
      Stephen Farrell, Ondrej Sury, Richard Barnes, Jari Arkko,
      and Lionel Morand
      for their reviews and comments.</t>
    </section>
  </middle>

  <back>

    <?rfc rfcedstyle="no"?>
        <references title="Normative References">
                &rfc5169;

<reference anchor='RFC5836'>
<front>
<title>Extensible Authentication Protocol (EAP) Early Authentication Problem Statement</title>
<author initials='Y.' surname='Ohba' fullname='Y. Ohba' role="editor">
<organization /></author>
<author initials='Q.' surname='Wu' fullname='Q. Wu' role="editor">
<organization /></author>
<author initials='G.' surname='Zorn' fullname='G. Zorn' role="editor">
<organization /></author>
<date year='2010' month='April' />
</front>
<seriesInfo name='RFC' value='5836' />
</reference>

<!-- draft-ietf-hokey-rfc5296bis (RFC 6696); companion doc. -->
<reference anchor='RFC6696'>
<front>
<title>EAP Extensions for the EAP
Re-authentication Protocol (ERP)</title>
<author initials='Z' surname='Cao' fullname='Zhen Cao'>
    <organization />
</author>
<author initials='B' surname='He' fullname='Baohong He'>
    <organization />
</author>
<author initials='Y' surname='Shi' fullname='Yang Shi'>
    <organization />
</author>
<author initials='Q' surname='Wu' fullname='Qin Wenson Wu' role="editor">
    <organization />
</author>
<author initials='G' surname='Zorn' fullname='Glen Zorn' role="editor">
    <organization />
</author>
<date month='July' year='2012' />
</front>
<seriesInfo name='RFC' value='6696' />
</reference>

<reference anchor='RFC3748'>
<front>
<title>Extensible Authentication Protocol (EAP)</title>
<author initials='B.' surname='Aboba' fullname='B. Aboba'>
<organization /></author>
<author initials='L.' surname='Blunk' fullname='L. Blunk'>
<organization /></author>
<author initials='J.' surname='Vollbrecht' fullname='J. Vollbrecht'>
<organization /></author>
<author initials='J.' surname='Carlson' fullname='J. Carlson'>
<organization /></author>
<author initials='H.' surname='Levkowetz' fullname='H. Levkowetz' role="editor">
<organization /></author>
<date year='2004' month='June' />
</front>
<seriesInfo name='RFC' value='3748' />
</reference>

    </references>

    <references title="Informative References">

      &rfc5295;

<reference anchor='RFC5749'>
<front>
<title>Distribution of EAP-Based Keys for Handover and Re-Authentication</title>
<author initials='K.' surname='Hoeper' fullname='K. Hoeper' role="editor">
<organization /></author>
<author initials='M.' surname='Nakhjiri' fullname='M. Nakhjiri'>
<organization /></author>
<author initials='Y.' surname='Ohba' fullname='Y. Ohba' role="editor">
<organization /></author>
<date year='2010' month='March' />
</front>
<seriesInfo name='RFC' value='5749' />
</reference>

      &rfc5873;
      &rfc6440;

<!-- draft-ietf-hokey-erp-aak (PUB as RFC 6630) -->
<reference anchor='RFC6630'>
<front>
<title>EAP Re-authentication Protocol Extensions for Authenticated Anticipatory Keying (ERP/AAK)</title>
<author initials='Z.' surname='Cao' fullname='Z. Cao'>
<organization /></author>
<author initials='H.' surname='Deng' fullname='H. Deng'>
<organization /></author>
<author initials='Q.' surname='Wu' fullname='Q. Wu'>
<organization /></author>
<author initials='G.' surname='Zorn' fullname='G. Zorn' role="editor">
<organization /></author>
<date year='2012' month='June' />
</front>
<seriesInfo name='RFC' value='6630' />
</reference>

<!-- draft-ietf-dime-erp ("I-D Exists") -->
<reference anchor='DIAMETER-ERP'>
<front>
<title>Diameter Support for the EAP Re-authentication Protocol (ERP)</title>
<author initials='J' surname='Bournelle' fullname='Julien Bournelle'>
    <organization />
</author>
<author initials='L' surname='Morand' fullname='Lionel Morand'>
    <organization />
</author>
<author initials='S' surname='Decugis' fullname='Sebastien Decugis'>
    <organization />
</author>
<author initials='Q' surname='Wu' fullname='Qin Wenson Wu'>
    <organization />
</author>
<author initials='G' surname='Zorn' fullname='Glen Zorn'>
    <organization />
</author>
<date month='June' year='2012' />
</front>
<seriesInfo name='Work in' value='Progress' />
</reference>

<!-- draft-ietf-dime-local-keytran (REF) -->
<reference anchor='DIAMETER-AVP'>
<front>
<title>Diameter Attribute-Value Pairs for Cryptographic Key Transport</title>
<author initials='G' surname='Zorn' fullname='Glen Zorn'>
    <organization />
</author>
<author initials='Q' surname='Wu' fullname='Qin Wenson Wu'>
    <organization />
</author>
<author initials='V' surname='Cakulev' fullname='Violeta Cakulev'>
    <organization />
</author>
<date month='August' year='2011' />
</front>
<seriesInfo name='Work in' value='Progress' />
</reference>

      &rfc5247;
      
<reference anchor='RFC4072'>
<front>
<title>Diameter Extensible Authentication Protocol (EAP) Application</title>
<author initials='P.' surname='Eronen' fullname='P. Eronen' role="editor">
<organization /></author>
<author initials='T.' surname='Hiller' fullname='T. Hiller'>
<organization /></author>
<author initials='G.' surname='Zorn' fullname='G. Zorn'>
<organization /></author>
<date year='2005' month='August' />
</front>
<seriesInfo name='RFC' value='4072' />
</reference>

    </references>
  <?rfc rfcedstyle="yes"?>
  </back>
</rfc>

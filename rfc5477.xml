<?xml version="1.0" encoding="US-ASCII"?>
<!--
  Download these references from:
  http://xml.resource.org/public/rfc/bibxml  - for RFCs.
  http://xml.resource.org/public/rfc/bibxml3 - for IETF IPFIX and PSAMP drafts.
  http://xml.resource.org/public/rfc/bibxml2 - for ISO docs.
-->
<!--<?rfc strict="yes"?>-->
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc rfcedstyle="yes"?>
<?rfc subcompact="no"?>
<?rfc symrefs="yes"?>

<rfc number="5477" category="std" ipr="trust200811">
<front>
<title abbrev="PSAMP Information Model">Information Model for
    Packet Sampling Exports</title>
<author fullname="Thomas Dietz" initials="T.D." surname="Dietz">
<organization>NEC Europe Ltd.</organization>
<address>
<postal>
<street>NEC Laboratories Europe</street>
<street>Network Research Division</street>
<street>Kurfuersten-Anlage 36</street>
<city>Heidelberg</city>
<code>69115</code>
<country>Germany</country>
</postal>
<phone>+49 6221 4342-128</phone>
<email>Thomas.Dietz@nw.neclab.eu</email>
<uri>http://www.nw.neclab.eu</uri>
</address>
</author>
<author fullname="Benoit Claise" initials="B.C." surname="Claise">
<organization>Cisco Systems, Inc.</organization>
<address>
<postal>
<street>De Kleetlaan 6a b1</street>
<city>Degem</city>
<code>1813</code>
<country>Belgium</country>
</postal>
<phone>+32 2 704 5622</phone>
<email>bclaise@cisco.com</email>
</address>
</author>
<author fullname="Paul Aitken" initials="P.A." surname="Aitken">
<organization>Cisco Systems, Inc.</organization>
<address>
<postal>
<street>96 Commercial Quay</street>
<city>Edinburgh</city>
<code>EH6 6LX</code>
<country>Scotland</country>
</postal>
<phone>+44 131 561 3616</phone>
<email>paitken@cisco.com</email>
<uri>http://www.cisco.com/</uri>
</address>
</author>
<author fullname="Falko Dressler" initials="F.D." surname="Dressler">
<organization>University of Erlangen-Nuremberg</organization>
<address>
<postal>
<street>Dept. of Computer Sciences</street>
<street>Martensstr. 3</street>
<city>Erlangen</city>
<code>91058</code>
<country>Germany</country>
</postal>
<phone>+49 9131 85-27914</phone>
<email>dressler@informatik.uni-erlangen.de</email>
<uri>http://www7.informatik.uni-erlangen.de/~dressler</uri>
</address>
</author>
<author fullname="Georg Carle" initials="G.C." surname="Carle">
<organization>Technical University of Munich</organization>
<address>
<postal>
<street>Institute for Informatics</street>
<street>Boltzmannstr. 3</street>
<city>Garching bei Muenchen</city>
<code>85737</code>
<country>Germany</country>
</postal>
<phone>+49 89 289-18030</phone>
<email>carle@in.tum.de</email>
<uri> http://www.net.in.tum.de/~carle/</uri>
</address>
</author>

<!--[rfced] Please note that the above address does not match that in the Appendix; please review and update if necessary. -->
<date month="March" year="2009"/>

<!--[rfced] Please insert any keywords (beyond those that appear in the title) for use on http://www.rfc-editor.org/rfcsearch.html. -->

<note title=""><t>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November 10,
2008. The person(s) controlling the copyright in some of this material
may not have granted the IETF Trust the right to allow modifications
of such material outside the IETF Standards Process.  Without
obtaining an adequate license from the person(s) controlling the
copyright in such materials, this document may not be modified outside
the IETF Standards Process, and derivative works of it may not be
created outside the IETF Standards Process, except to format it for
publication as an RFC or to translate it into languages other than
English.
</t>
</note>

<abstract>
<t>This memo defines an information model for the Packet
      SAMPling (PSAMP) protocol. It is used by the PSAMP protocol
      for encoding sampled packet data and information related to
      the Sampling process. As the PSAMP protocol is based on the
      IP Flow Information eXport (IPFIX) protocol, this information model is an extension to the
      IPFIX information model.</t>
</abstract>
</front>
<middle>
<section anchor="introduction" title="Introduction" toc="default">
<t>Packet Sampling techniques are required for various
      measurement scenarios. The Packet Sampling (PSAMP) protocol
      provides mechanisms for packet selection using different
      Filtering and Sampling techniques. A standardized way for the
      export and storage of the Information Elements defined in
      Section <xref format="counter" target="infoelements" pageno="false"/> is
      required. The definition of the PSAMP information and data
      model is based on the <xref target="RFC5102" pageno="false" format="default"> IPFIX
      information model </xref>. The <xref target="RFC5476" pageno="false" format="default"> PSAMP protocol document
      </xref> specifies how to use the IPFIX protocol in the PSAMP
      context.</t>
<t>This document examines the <xref target="RFC5102" pageno="false" format="default"> IPFIX
      information model </xref> and extends it to meet the PSAMP requirements. Therefore, the
      structure of this document is strongly based on the IPFIX
      document. It complements the PSAMP protocol specification by
      providing an appropriate PSAMP information model. The main
      part of this document, Section <xref format="counter" target="infoelements" pageno="false"/>, defines the list of Information
      Elements to be transmitted by the PSAMP protocol. Sections
      <xref format="counter" target="properties" pageno="false"/> and <xref format="counter" target="dataTypes" pageno="false"/> describe the data types
      and Information Element properties used within this document
      and their relationship to the IPFIX information model.</t>

<t>Although the PSAMP charter specified no requirements for measuring packet
errors (such as drops, malformed, etc.), and this document does not cover
such data, if there is need for collecting and exporting packet error
information, the appropriate Information Elements can be requested from
IANA, and exported with the PSAMP protocol.  </t>

<t>The main body of Section <xref format="counter" target="infoelements" pageno="false"/> was generated from an XML document.
      The XML-based specification of the PSAMP Information Elements
      can be used for automatically checking syntactical
      correctness of the specification. Furthermore it can be used
      -- in combination with the IPFIX information model -- for
      automated code generation. The resulting code can be used in
      PSAMP protocol implementations to deal with processing PSAMP
      information elements.</t>
<t>For that reason, the XML document that served as the
      source for Section <xref format="counter" target="infoelements" pageno="false"/> is attached to this document in
      Appendix <xref format="counter" target="infoelementsXml" pageno="false"/>.</t>
<t>Note that although partially generated from the attached
      XML documents, the main body of this document is normative
      while the appendix is informational.</t>
</section>

<section anchor="overview" title="PSAMP Documents Overview" toc="default">
<t> This document is one out of a series of documents from the PSAMP group. </t>

<t>
<xref target="RFC5474" pageno="false" format="default"/>: "A Framework
      for Packet Selection and Reporting" describes the PSAMP
      framework for network elements to select subsets of packets
      by statistical and other methods, and to export a stream of
      reports on the selected packets to a Collector.</t>
<t>
<xref target="RFC5475" pageno="false" format="default"/>: "Sampling and
      Filtering Techniques for IP Packet Selection" describes the
      set of packet selection techniques supported by PSAMP.</t>
<t>
<xref target="RFC5476" pageno="false" format="default"/>: "Packet Sampling
      (PSAMP) Protocol Specifications" specifies the export of
      packet information from a PSAMP Exporting Process to a PSAMP
      Collecting Process.</t>
<t>RFC 5477 (this document): "Information Model for Packet Sampling
      Exports" defines an information and data model for
      PSAMP.</t>
</section>
<section anchor="terminology" title="Terminology" toc="default">
<t>IPFIX-specific terminology used in this document is
      defined in Section 2 of <xref target="RFC5101" pageno="false" format="default"/>.
      PSAMP-specific terminology used in this document is defined
      in Section 3.2 of <xref target="RFC5476" pageno="false" format="default"/>.
      In this document, as in <xref target="RFC5101" pageno="false" format="default"/>
and <xref target="RFC5476" pageno="false" format="default"/>, the
first letter of each IPFIX- and PSAMP-specific term is capitalized.</t>

<section title="Conventions Used in This Document">
<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
      "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
      and "OPTIONAL" in this document are to be interpreted as
      described in <xref target="RFC2119" pageno="false" format="default">RFC 2119</xref>.</t>
</section>
</section>
<section anchor="relationship" title="Relationship between PSAMP and IPFIX" toc="default">
<t>As described in the PSAMP protocol <xref target="RFC5476" pageno="false" format="default"/>, a PSAMP Report can be seen
      as a very special IPFIX Data Record. It represents an IPFIX
      Flow containing only a single packet. Therefore, the IPFIX
      information model can be used as a basis for PSAMP
      Reports.</t>
<t>Nevertheless, there are properties required in PSAMP
      Reports that cannot be modeled using the current IPFIX
      information model. This document describes extensions to the
      IPFIX information model that allow the modeling of
      information and data required by PSAMP.</t>
<t>Some of these extensions allow the export of what may be
      considered sensitive information. Refer to the Security
      Considerations section for a fuller discussion.</t>
<t>Note that the export of sampled or filtered PSAMP Reports
      may not need all the Information Elements defined by the
      <xref target="RFC5102" pageno="false" format="default"> IPFIX information model </xref>, as
      discussed in Sections 6.2 and 6.3 of the <xref target="RFC5474" pageno="false" format="default">PSAMP Framework</xref>.</t>
</section>
<section anchor="properties" title="Properties of a PSAMP Information Element" toc="default">
<t>The PSAMP Information Elements are defined in accordance
      with Sections 2.1 to 2.3 of the <xref target="RFC5102" pageno="false" format="default"> IPFIX
      information model </xref> to which reference should be made
      for more information. Nevertheless, we strongly recommend
      defining the optional "units" property for every Information
      Element (if applicable).</t>
<t>The Data Types defined in Section 3.1 of the <xref target="RFC5102" pageno="false" format="default">IPFIX information model</xref> are also used
      for the PSAMP Information Elements.</t>
</section>
<section anchor="dataTypes" title="Type Space" toc="default">
<t>The PSAMP Information Elements MUST be constructed from
      the basic abstract data types and data type semantics
      described in Section 3 of the <xref target="RFC5102" pageno="false" format="default"> IPFIX
      information model </xref>. To ensure consistency between
      IPFIX and PSAMP, the data types are not repeated in this
      document. The encoding of these data types is described in
      the <xref target="RFC5101" pageno="false" format="default"> IPFIX protocol </xref>.</t>
</section>
<section anchor="design" title="Overloading Information Elements" toc="default">
<t>Information Elements SHOULD NOT be overloaded with
      multiple meanings or re-used for multiple purposes. Different
      Information Elements SHOULD be allocated for each
      requirement.</t>
<t>Although the presence of certain other Information
      Elements allows the selection method to be inferred, a
      separate Information Element is provided for the
      selectorAlgorithm to include as scope for the Selector Report
      Interpretation <xref target="RFC5476" pageno="false" format="default"/>.</t>
<t>Even if the Information Elements are specified with a
      specific selection method (i.e., a specific value of
      selectorAlgorithm) in mind, these Information Elements are
      not restricted to the selection method and MAY be used for
      different selection methods in the future.</t>
</section>
<section anchor="infoelements" title="The PSAMP Information Elements " toc="default">
<t>This section describes the Information Elements used by
      the PSAMP protocol.</t>
<t>For each Information Element specified in Sections <xref format="counter" target="infoelements-identifiers" pageno="false"/> - <xref format="counter" target="infoelements-statistics" pageno="false"/> below, a
      unique identifier is allocated in accordance with Section 4
      of the <xref target="RFC5102" pageno="false" format="default"> IPFIX information model
      </xref>. The assignments are controlled by IANA as an
      extension of the IPFIX information model.</t>
<t>The Information Elements specified by the <xref target="RFC5102" pageno="false" format="default"> IPFIX information model </xref> are used by
      the PSAMP protocol where applicable. To avoid inconsistencies
      between the IPFIX and the PSAMP information and data models,
      only those Information Elements that are not already
      described by the IPFIX information model are defined
      here.</t>
<t>Below is the list of additional PSAMP Information
      Elements:<figure>
<artwork>
+-----+----------------------------+-----+----------------------------+
|  ID | Name                       |  ID | Name                       |
+-----+----------------------------+-----+----------------------------+
| 301 | selectionSequenceId        | 321 | relativeError              |
| 302 | selectorId                 | 322 | observationTimeSeconds     |
| 303 | informationElementId       | 323 | observationTimeMilliseconds|
| 304 | selectorAlgorithm          | 324 | observationTimeMicroseconds|
| 305 | samplingPacketInterval     | 325 | observationTimeNanoseconds |
| 306 | samplingPacketSpace        | 326 | digestHashValue            |
| 307 | samplingTimeInterval       | 327 | hashIPPayloadOffset        |
| 308 | samplingTimeSpace          | 328 | hashIPPayloadSize          |
| 309 | samplingSize               | 329 | hashOutputRangeMin         |
| 310 | samplingPopulation         | 330 | hashOutputRangeMax         |
| 311 | samplingProbability        | 331 | hashSelectedRangeMin       |
| 313 | ipHeaderPacketSection      | 332 | hashSelectedRangeMax       |
| 314 | ipPayloadPacketSection     | 333 | hashDigestOutput           |
| 316 | mplsLabelStackSection      | 334 | hashInitialiserValue       |
| 317 | mplsPayloadPacketSection   | 336 | upperCILimit               |
| 318 | selectorIdTotalPktsObserved| 337 | lowerCILimit               |
| 319 | selectorIdTotalPktsSelected| 338 | confidenceLevel            |
| 320 | absoluteError              |     |                            |
+-----+----------------------------+-----+----------------------------+
  </artwork>
</figure>
</t>
<section anchor="infoelements-identifiers" title="Identifiers (301-303)" toc="default">
<t>Information Elements in this section serve as
        identifiers. All of them have an integral abstract data
        type and data type semantics "identifier".</t>
<figure>
<artwork>
+-----+----------------------------+-----+----------------------------+
|  ID | Name                       |  ID | Name                       |
+-----+----------------------------+-----+----------------------------+
| 301 | selectionSequenceId        | 303 | informationElementId       |
| 302 | selectorId                 |     |                            |
+-----+----------------------------+-----+----------------------------+
  </artwork>
</figure>
<section title="selectionSequenceId">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
From all the packets observed at an Observation Point, a subset
of the packets is selected by a sequence of one or more
Selectors. The selectionSequenceId is a unique value per
Observation Domain, specifying the Observation Point and the
sequence of Selectors through which the packets are selected.
</t>
<t hangText="Abstract Data Type:">unsigned64</t>
<t hangText="Data Type Semantics:">identifier</t>
<t hangText="ElementId:">301</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="selectorId">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
The Selector ID is the unique ID identifying a Primitive
Selector. Each Primitive Selector must have a unique ID in the
Observation Domain.
</t>
<t hangText="Abstract Data Type:">unsigned16</t>
<t hangText="Data Type Semantics:">identifier</t>
<t hangText="ElementId:">302</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="informationElementId">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element contains the ID of another Information
Element.
</t>
<t hangText="Abstract Data Type:">unsigned16</t>
<t hangText="Data Type Semantics:">identifier</t>
<t hangText="ElementId:">303</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>
</section>
<section anchor="infoelements-sampling" title="Sampling Configuration (304-311)" toc="default">
<t>Information Elements in this section can be used for
        describing the Sampling configuration of a Selection
        Process.</t>
<figure>
<artwork>
+-----+----------------------------+-----+----------------------------+
|  ID | Name                       |  ID | Name                       |
+-----+----------------------------+-----+----------------------------+
| 304 | selectorAlgorithm          | 308 | samplingTimeSpace          |
| 305 | samplingPacketInterval     | 309 | samplingSize               |
| 306 | samplingPacketSpace        | 310 | samplingPopulation         |
| 307 | samplingTimeInterval       | 311 | samplingProbability        |
+-----+----------------------------+-----+----------------------------+
  </artwork>
</figure>
<section title="selectorAlgorithm">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element identifies the packet selection
methods (e.g., Filtering, Sampling) that are applied by
the Selection Process.</t>
<t>
Most of these methods have parameters. Further
Information Elements are needed to fully specify packet
selection with these methods and all their parameters.</t>
<t>
The methods listed below are defined in
<xref target="RFC5475" />. For their parameters,
Information Elements are defined in the information model
document. The names of these Information Elements are
listed for each method identifier.</t>
<t>
Further method identifiers may be added to the list
below. It might be necessary to define new Information
Elements to specify their parameters.</t>
<t>
The selectorAlgorithm registry is maintained by IANA. New
assignments for the registry will be administered by IANA
and are subject to Expert Review <xref target="RFC5226" />.</t>
<t>
The registry can be updated when specifications of the new
method(s) and any new Information Elements are provided.</t>
<t>
The group of experts must double check the selectorAlgorithm
definitions and Information Elements with already defined
selectorAlgorithms and Information Elements for completeness,
accuracy, and redundancy. Those experts will initially be drawn
from the Working Group Chairs and document editors of the IPFIX
and PSAMP Working Groups.</t>
<t>
The following packet selection methods identifiers are
defined here:</t>
<t>
<figure>
<artwork>        +----+------------------------+------------------------+
        | ID |        Method          |      Parameters        |
        +----+------------------------+------------------------+
        | 1  | Systematic count-based | samplingPacketInterval |
        |    | Sampling               | samplingPacketSpace    |
        +----+------------------------+------------------------+
        | 2  | Systematic time-based  | samplingTimeInterval   |
        |    | Sampling               | samplingTimeSpace      |
        +----+------------------------+------------------------+
        | 3  | Random n-out-of-N      | samplingSize           |
        |    | Sampling               | samplingPopulation     |
        +----+------------------------+------------------------+
        | 4  | Uniform probabilistic  | samplingProbability    |
        |    | Sampling               |                        |
        +----+------------------------+------------------------+
        | 5  | Property Match         | no agreed parameters   |
        |    | Filtering              |                        |
        +----+------------------------+------------------------+
        |   Hash-based Filtering      | hashInitialiserValue   |
        +----+------------------------+ hashIPPayloadOffset    |
        | 6  | using BOB              | hashIPPayloadSize      |
        +----+------------------------+ hashSelectedRangeMin   |
        | 7  | using IPSX             | hashSelectedRangeMax   |
        +----+------------------------+ hashOutputRangeMin     |
        | 8  | using CRC              | hashOutputRangeMax     |
        +----+------------------------+------------------------+</artwork>
</figure>
</t>
<t>
There is a broad variety of possible parameters that could be
used for Property match Filtering (5), but currently there are no
agreed parameters specified.
</t>
<t hangText="Abstract Data Type:">unsigned16</t>
<t hangText="Data Type Semantics:">identifier</t>
<t hangText="ElementId:">304</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="samplingPacketInterval">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the number of packets that
are consecutively sampled. A value of 100 means that
100 consecutive packets are sampled.</t>
<t>
For example, this Information Element may be used to describe
the configuration of a systematic count-based Sampling Selector.
</t>
<t hangText="Abstract Data Type:">unsigned32</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">305</t>
<t hangText="Status:">current</t>
<t hangText="Units:">packets</t>
</list>
</t>
</section>

<section title="samplingPacketSpace">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the number of packets between
two "samplingPacketInterval"s. A value of 100 means that the
next interval starts 100 packets (which are not sampled)
after the current "samplingPacketInterval" is over.</t>
<t>
For example, this Information Element may be used to describe
the configuration of a systematic count-based Sampling Selector.
</t>
<t hangText="Abstract Data Type:">unsigned32</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">306</t>
<t hangText="Status:">current</t>
<t hangText="Units:">packets</t>
</list>
</t>
</section>

<section title="samplingTimeInterval">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the time interval in
microseconds during which all arriving packets are sampled.</t>
<t>
For example, this Information Element may be used to describe
the configuration of a systematic time-based Sampling Selector.
</t>
<t hangText="Abstract Data Type:">unsigned32</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">307</t>
<t hangText="Status:">current</t>
<t hangText="Units:">microseconds</t>
</list>
</t>
</section>

<section title="samplingTimeSpace">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the time interval in
microseconds between two "samplingTimeInterval"s. A value of 100
means that the next interval starts 100 microseconds
(during which no packets are sampled) after the current
"samplingTimeInterval" is over.</t>
<t>
For example, this Information Element may used to describe the
configuration of a systematic time-based Sampling Selector.
</t>
<t hangText="Abstract Data Type:">unsigned32</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">308</t>
<t hangText="Status:">current</t>
<t hangText="Units:">microseconds</t>
</list>
</t>
</section>

<section title="samplingSize">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the number of elements taken
from the parent Population for random Sampling methods.</t>
<t>
For example, this Information Element may be used to describe
the configuration of a random n-out-of-N Sampling Selector.
</t>
<t hangText="Abstract Data Type:">unsigned32</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">309</t>
<t hangText="Status:">current</t>
<t hangText="Units:">packets</t>
</list>
</t>
</section>

<section title="samplingPopulation">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the number of elements in the
parent Population for random Sampling methods.</t>
<t>
For example, this Information Element may be used to describe
the configuration of a random n-out-of-N Sampling Selector.
</t>
<t hangText="Abstract Data Type:">unsigned32</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">310</t>
<t hangText="Status:">current</t>
<t hangText="Units:">packets</t>
</list>
</t>
</section>

<section title="samplingProbability">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the probability that a packet
is sampled, expressed as a value between 0 and 1. The
probability is equal for every packet. A value of 0 means no
packet was sampled since the probability is 0.</t>
<t>
For example, this Information Element may be used to describe
the configuration of a uniform probabilistic Sampling Selector.
</t>
<t hangText="Abstract Data Type:">float64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">311</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>
</section>
<section anchor="infoelements-hash" title="Hash Configuration (326-334)" toc="default">
<t>The following Information Elements can be used for
        describing the Sampling configuration of a Selection
        Process. The individual parameters are explained in more
        detail in Sections 6.2, 3.8, and 7.1 of <xref target="RFC5475" pageno="false" format="default"/>.</t>
<figure>
<artwork>
+-----+----------------------------+-----+----------------------------+
|  ID | Name                       |  ID | Name                       |
+-----+----------------------------+-----+----------------------------+
| 326 | digestHashValue            | 331 | hashSelectedRangeMin       |
| 327 | hashIPPayloadOffset        | 332 | hashSelectedRangeMax       |
| 328 | hashIPPayloadSize          | 333 | hashDigestOutput           |
| 329 | hashOutputRangeMin         | 334 | hashInitialiserValue       |
| 330 | hashOutputRangeMax         |     |                            |
+-----+----------------------------+-----+----------------------------+
  </artwork>
</figure>
<section title="digestHashValue">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the value from the digest
hash function.</t>
<t>
See also Sections 6.2, 3.8, and 7.1 of
<xref target="RFC5475" />.
</t>
<t hangText="Abstract Data Type:">unsigned64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">326</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="hashIPPayloadOffset">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the IP payload offset used by
a Hash-based Selection Selector.</t>
<t>
See also Sections 6.2, 3.8, and 7.1 of
<xref target="RFC5475" />.
</t>
<t hangText="Abstract Data Type:">unsigned64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">327</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="hashIPPayloadSize">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the IP payload size used by a
Hash-based Selection Selector.</t>
<t>
See also Sections 6.2, 3.8, and 7.1 of
<xref target="RFC5475" />.
</t>
<t hangText="Abstract Data Type:">unsigned64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">328</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="hashOutputRangeMin">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the value for the beginning
of a hash function's potential output range.</t>
<t>
See also Sections 6.2, 3.8, and 7.1 of
<xref target="RFC5475" />.
</t>
<t hangText="Abstract Data Type:">unsigned64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">329</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="hashOutputRangeMax">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the value for the end of a
hash function's potential output range.</t>
<t>
See also Sections 6.2, 3.8, and 7.1 of
<xref target="RFC5475" />.
</t>
<t hangText="Abstract Data Type:">unsigned64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">330</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="hashSelectedRangeMin">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the value for the beginning
of a hash function's selected range.</t>
<t>
See also Sections 6.2, 3.8, and 7.1 of
<xref target="RFC5475" />.
</t>
<t hangText="Abstract Data Type:">unsigned64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">331</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="hashSelectedRangeMax">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the value for the end of a
hash function's selected range.</t>
<t>
See also Sections 6.2, 3.8, and 7.1 of
<xref target="RFC5475" />.
</t>
<t hangText="Abstract Data Type:">unsigned64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">332</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="hashDigestOutput">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element contains a boolean value that is TRUE
if the output from this hash Selector has been configured to be
included in the packet report as a packet digest, else FALSE.</t>
<t>
See also Sections 6.2, 3.8, and 7.1 of
<xref target="RFC5475" />.
</t>
<t hangText="Abstract Data Type:">boolean</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">333</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="hashInitialiserValue">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the initialiser value to the
hash function.</t>
<t>
See also Sections 6.2, 3.8, and 7.1 of
<xref target="RFC5475" />.
</t>
<t hangText="Abstract Data Type:">unsigned64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">334</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>
</section>
<section anchor="infoelements-timestamps" title="Timestamps (322-325)" toc="default">
<t>The Information Elements listed below contain timestamps. They can be used for reporting the observation time
        of a single packet.</t>
<figure>
<artwork>
+-----+----------------------------+-----+----------------------------+
|  ID | Name                       |  ID | Name                       |
+-----+----------------------------+-----+----------------------------+
| 322 | observationTimeSeconds     | 324 | observationTimeMicroseconds|
| 323 | observationTimeMilliseconds| 325 | observationTimeNanoseconds |
+-----+----------------------------+-----+----------------------------+
  </artwork>
</figure>
<section title="observationTimeSeconds">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the absolute time in seconds
of an observation.
</t>
<t hangText="Abstract Data Type:">dateTimeSeconds</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">322</t>
<t hangText="Status:">current</t>
<t hangText="Units:">seconds</t>
</list>
</t>
</section>

<section title="observationTimeMilliseconds">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the absolute time in
milliseconds of an observation.
</t>
<t hangText="Abstract Data Type:">dateTimeMilliseconds</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">323</t>
<t hangText="Status:">current</t>
<t hangText="Units:">milliseconds</t>
</list>
</t>
</section>

<section title="observationTimeMicroseconds">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the absolute time in
microseconds of an observation.
</t>
<t hangText="Abstract Data Type:">dateTimeMicroseconds</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">324</t>
<t hangText="Status:">current</t>
<t hangText="Units:">microseconds</t>
</list>
</t>
</section>

<section title="observationTimeNanoseconds">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the absolute time in
nanoseconds of an observation.
</t>
<t hangText="Abstract Data Type:">dateTimeNanoseconds</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">325</t>
<t hangText="Status:">current</t>
<t hangText="Units:">nanoseconds</t>
</list>
</t>
</section>
</section>
<section anchor="infoelements-packet" title="Packet Data (313-314) (316-317)" toc="default">
<t>The following Information Elements are all used for
        reporting raw content of a packet. All Information Elements containing 
        sections of the observed packet can also be used in <xref target="RFC5101" pageno="false" format="default">IPFIX</xref>. If the values for those
        sections vary for different packets in a Flow, then the Flow
        Report will contain the value observed in the first packet
        of the Flow.</t>
<figure>
<artwork>
+-----+----------------------------+-----+----------------------------+
|  ID | Name                       |  ID | Name                       |
+-----+----------------------------+-----+----------------------------+
| 313 | ipHeaderPacketSection      | 316 | mplsLabelStackSection      |
| 314 | ipPayloadPacketSection     | 317 | mplsPayloadPacketSection   |
+-----+----------------------------+-----+----------------------------+
  </artwork>
</figure>
<section title="ipHeaderPacketSection">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element, which may have a variable length,
carries a series of octets from the start of the IP header of a
sampled packet.</t>
<t>
With sufficient length, this element also reports octets from
the IP payload, subject to <xref target="RFC2804" />. See the Security
Considerations section.</t>
<t>
The size of the exported section may be constrained due to
limitations in the IPFIX protocol.</t>
<t>
The data for this field MUST NOT be padded.
</t>
<t hangText="Abstract Data Type:">octetArray</t>
<t hangText="ElementId:">313</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="ipPayloadPacketSection">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element, which may have a variable length,
carries a series of octets from the start of the IP payload of a
sampled packet.</t>
<t>
The IPv4 payload is that part of the packet that follows the
IPv4 header and any options, which <xref target="RFC0791"/> refers to as "data"
or "data octets". For example, see the examples in <xref target="RFC0791"/>, Appendix
A.</t>
<t>
The IPv6 payload is the rest of the packet following the 40-octet IPv6 header. Note that any extension headers present are
considered part of the payload. See <xref target="RFC2460"/> for the IPv6
specification.</t>
<t>
The size of the exported section may be constrained due to
limitations in the IPFIX protocol.</t>
<t>
The data for this field MUST NOT be padded.
</t>
<t hangText="Abstract Data Type:">octetArray</t>
<t hangText="ElementId:">314</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="mplsLabelStackSection">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element, which may have a variable length,
carries the first n octets from the MPLS label stack of a
sampled packet.</t>
<t>
With sufficient length, this element also reports octets from
the MPLS payload, subject to <xref target="RFC2804"/>. See the Security
Considerations section.</t>
<t>
See <xref target="RFC3031"/> for the specification of MPLS packets.</t>
<t>
See <xref target="RFC3032"/> for the specification of the MPLS label stack.</t>
<t>
The size of the exported section may be constrained due to
limitations in the IPFIX protocol.</t>
<t>
The data for this field MUST NOT be padded.
</t>
<t hangText="Abstract Data Type:">octetArray</t>
<t hangText="ElementId:">316</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="mplsPayloadPacketSection">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element, which may have a variable length,
carries the first n octets from the MPLS payload of a sampled
packet, being data that follows immediately after the MPLS label
stack.</t>
<t>
See <xref target="RFC3031"/> for the specification of MPLS packets.</t>
<t>
See <xref target="RFC3032"/> for the specification of the MPLS label stack.</t>
<t>
The size of the exported section may be constrained due to
limitations in the IPFIX protocol.</t>
<t>
The data for this field MUST NOT be padded.
</t>
<t hangText="Abstract Data Type:">octetArray</t>
<t hangText="ElementId:">317</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>
</section>
<section anchor="infoelements-statistics" title="Statistics (318-321, 336-338)" toc="default">
<t>Information Elements in this section can be used for
        reporting statistics from the Metering Process.</t>
<figure>
<artwork>
+-----+----------------------------+-----+----------------------------+
|  ID | Name                       |  ID | Name                       |
+-----+----------------------------+-----+----------------------------+
| 318 | selectorIdTotalPktsObserved| 336 | upperCILimit               |
| 319 | selectorIdTotalPktsSelected| 337 | lowerCILimit               |
| 320 | absoluteError              | 338 | confidenceLevel            |
| 321 | relativeError              |     |                            |
+-----+----------------------------+-----+----------------------------+
  </artwork>
</figure>
<section title="selectorIdTotalPktsObserved">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the total number of packets
observed by a Selector, for a specific value of SelectorId.</t>
<t>
This Information Element should be used in an Options Template
scoped to the observation to which it refers.
See Section 3.4.2.1 of the IPFIX protocol document <xref target="RFC5101"/>.

<!--[rfced] Please confirm the above change (and in all iterations of this sentence) from RFC 5102 to RFC 5101. -->
</t>
<t hangText="Abstract Data Type:">unsigned64</t>
<t hangText="Data Type Semantics:">totalCounter</t>
<t hangText="ElementId:">318</t>
<t hangText="Status:">current</t>
<t hangText="Units:">packets</t>
</list>
</t>
</section>

<section title="selectorIdTotalPktsSelected">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the total number of packets
selected by a Selector, for a specific value of SelectorId.</t>
<t>
This Information Element should be used in an Options Template
scoped to the observation to which it refers.
See Section 3.4.2.1 of the IPFIX protocol document <xref target="RFC5101"/>.
</t>
<t hangText="Abstract Data Type:">unsigned64</t>
<t hangText="Data Type Semantics:">totalCounter</t>
<t hangText="ElementId:">319</t>
<t hangText="Status:">current</t>
<t hangText="Units:">packets</t>
</list>
</t>
</section>

<section title="absoluteError">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the maximum possible
measurement error of the reported value for a given Information
Element. The absoluteError has the same unit as the Information
Element with which it is associated. The real value of the metric can
differ by absoluteError (positive or negative) from the
measured value.</t>
<t>
This Information Element provides only the
error for measured values. If an Information Element contains
an estimated value (from Sampling), the confidence boundaries
and confidence level have to be provided instead, using the
upperCILimit, lowerCILimit, and confidenceLevel Information
Elements.</t>
<t>
This Information Element should be used in an Options Template
scoped to the observation to which it refers.
See section 3.4.2.1 of the IPFIX protocol document <xref target="RFC5101"/>.
</t>
<t hangText="Abstract Data Type:">float64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">320</t>
<t hangText="Status:">current</t>
<t hangText="Units:">
      The units of the Information Element for which the error is
      specified.
    </t>
</list>
</t>
</section>

<section title="relativeError">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the maximum possible positive
or negative error ratio for the reported value for a given
Information Element as a percentage of the measured value.
The real value of the metric can differ by relativeError percent
(positive or negative) from the measured value.</t>
<t>
This Information Element
provides only the error for measured values. If an Information
Element contains an estimated value (from Sampling), the
confidence boundaries and confidence level have to be provided
instead, using the upperCILimit, lowerCILimit, and
confidenceLevel Information Elements.</t>
<t>
This Information Element should be used in an Options Template
scoped to the observation to which it refers.
See Section 3.4.2.1 of the IPFIX protocol document <xref target="RFC5101"/>.
</t>
<t hangText="Abstract Data Type:">float64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">321</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="upperCILimit">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the upper limit of a
confidence interval. It is used to provide an accuracy
statement for an estimated value. The confidence limits
define the range in which the real value is assumed to be
with a certain probability p. Confidence limits always need
to be associated with a confidence level that defines this
probability p. Please note that a confidence interval only
provides a probability that the real value lies within the
limits. That means the real value can lie outside the
confidence limits.</t>
<t>
The upperCILimit, lowerCILimit, and confidenceLevel
Information Elements should all be used in an Options Template
scoped to the observation to which they refer.
See Section 3.4.2.1 of the IPFIX protocol document <xref target="RFC5101"/>.</t>
<t>
Note that the upperCILimit, lowerCILimit, and confidenceLevel
are all required to specify confidence, and should be
disregarded unless all three are specified together.
</t>
<t hangText="Abstract Data Type:">float64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">336</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="lowerCILimit">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the lower limit of a
confidence interval. For further information, see the
description of upperCILimit.</t>
<t>
The upperCILimit, lowerCILimit, and confidenceLevel
Information Elements should all be used in an Options Template
scoped to the observation to which they refer.
See Section 3.4.2.1 of the IPFIX protocol document <xref target="RFC5101"/>.</t>
<t>
Note that the upperCILimit, lowerCILimit, and confidenceLevel
are all required to specify confidence, and should be
disregarded unless all three are specified together.
</t>
<t hangText="Abstract Data Type:">float64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">337</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>

<section title="confidenceLevel">
<t>
<list style="hanging">
<t hangText="Description:"/>
<t>
This Information Element specifies the confidence level. It is
used to provide an accuracy statement for estimated values.
The confidence level provides the probability p with which the
real value lies within a given range. A confidence level
always needs to be associated with confidence limits that
define the range in which the real value is assumed to be.</t>
<t>
The upperCILimit, lowerCILimit, and confidenceLevel
Information Elements should all be used in an Options Template
scoped to the observation to which they refer.
See Section 3.4.2.1 of the IPFIX protocol document <xref target="RFC5101"/>.</t>
<t>
Note that the upperCILimit, lowerCILimit, and confidenceLevel
are all required to specify confidence, and should be
disregarded unless all three are specified together.
</t>
<t hangText="Abstract Data Type:">float64</t>
<t hangText="Data Type Semantics:">quantity</t>
<t hangText="ElementId:">338</t>
<t hangText="Status:">current</t>
</list>
</t>
</section>
</section>
</section>
<section anchor="security" title="Security Considerations" toc="default">
<t>The PSAMP information model itself does not directly
      introduce security issues. Rather, it defines a set of
      attributes that may for privacy or business issues be
      considered sensitive information.</t>
<t>For example, exporting values of header fields may make
      attacks possible for the receiver of this information, which
      would otherwise only be possible for direct observers of the
      reported Flows along the data path. Specifically, the
      Information Elements pertaining to packet sections MUST
      target no more than the packet header, some subsequent bytes
      of the packet, and encapsulating headers if present. Full
      packet capture of arbitrary packet streams is explicitly out
      of scope, per <xref target="RFC2804" pageno="false" format="default"/>.</t>
<t>The underlying protocol used to exchange the information
      described here MUST therefore apply appropriate procedures to
      guarantee the integrity and confidentiality of the exported
      information. Such procedures are defined in separate
      documents, specifically the IPFIX protocol document <xref target="RFC5101" pageno="false" format="default"/>.</t>
</section>
<section anchor="IANA" title="IANA Considerations" toc="default">
<t>The PSAMP information model, as set out in this document,
      has two sets of assigned numbers. Considerations for
      assigning them are discussed in this section, using the
      example policies as set out in the "Guidelines for IANA
      Considerations" document <xref target="RFC5226" pageno="false" format="default"/>.
</t>
<section title="Related Considerations" toc="default">
<t>As the PSAMP protocol uses the IPFIX protocol, refer to
        the IANA Considerations section in <xref target="RFC5102" pageno="false" format="default"/>
        for the assignments of numbers used in the protocol and for
        the numbers used in the information model.</t>
</section>
<section title="PSAMP-Related Considerations" toc="default">
<t>This document specifies an initial set of PSAMP
        Information Elements fulfilling the needs specified in
        <xref target="RFC5475" pageno="false" format="default"/>, as an
        extension to the IPFIX Information Elements <xref target="RFC5102" pageno="false" format="default"/>.</t>
<t>Note that the PSAMP Information Element IDs were
        initially started at value 301, in order to leave a gap
        for any ongoing IPFIX work requiring new Information
        Elements. It is expected that this gap in the Information
        Element numbering will be filled in by IANA with new IPFIX
        Information Elements.</t>
<t>Each new selection method MUST be assigned a unique
        value in the selectorAlgorithm registry. Its configuration
        parameter(s), along with the way to report them with an
        Options Template, MUST be clearly specified. The initial
        content of the selectorAlgorithm registry is found in
        Section 8.2.1.</t>
<t>New assignments for the PSAMP selection method will be
        administered by IANA and are subject to Expert Review <xref target="RFC5226" pageno="false" format="default"/>. The group of experts must double check
        the Information Elements definitions with already defined
        Information Elements for completeness, accuracy, and
        redundancy. Those experts will initially be drawn from the
        Working Group Chairs and document editors of the IPFIX and
        PSAMP Working Groups. The selectorAlgorithm registry is
        maintained by IANA and can be updated as long as
        specifications of the new method(s) and any new Information
        Elements are provided.</t>
</section>
</section>
</middle>
<back>
<references title="Normative References">
<reference anchor="RFC2119">
<front>
<title abbrev="RFC Key Words">Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials="S." surname="Bradner" fullname="Scott Bradner">
<organization>Harvard University</organization>
<address>
<postal>
<street>1350 Mass. Ave.</street>
<street>Cambridge</street>
<street>MA 02138</street>
</postal>
<phone>- +1 617 495 3864</phone>
<email>sob@harvard.edu</email>
</address>
</author>
<date year="1997" month="March"/>
<area>General</area>
<keyword>keyword</keyword>
<abstract>
<t>
   In many standards track documents several words are used to signify
   the requirements in the specification.  These words are often
   capitalized.  This document defines these words as they should be
   interpreted in IETF documents.  Authors who follow these guidelines
   should incorporate this phrase near the beginning of their document:

<list>
<t>
      The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
      NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in
      RFC 2119.
</t>
</list>
</t>
<t>
   Note that the force of these words is modified by the requirement
   level of the document in which they are used.
</t>
</abstract>
</front>
<seriesInfo name="BCP" value="14"/>
<seriesInfo name="RFC" value="2119"/>
<format type="TXT" octets="4723" target="ftp://ftp.isi.edu/in-notes/rfc2119.txt"/>
<format type="HTML" octets="17491" target="http://xml.resource.org/public/rfc/html/rfc2119.html"/>
<format type="XML" octets="5777" target="http://xml.resource.org/public/rfc/xml/rfc2119.xml"/>
</reference>
<reference anchor="RFC5226">
<front>
<title>Guidelines for Writing an IANA Considerations Section in RFCs</title>
<author initials="T." surname="Narten" fullname="T. Narten">
<organization/>
</author>
<author initials="H." surname="Alvestrand" fullname="H. Alvestrand">
<organization/>
</author>
<date year="2008" month="May"/>
<abstract>
<t>Many protocols make use of identifiers consisting of constants and other well-known values. Even after a protocol has been defined and deployment has begun, new values may need to be assigned (e.g., for a new option type in DHCP, or a new encryption or authentication transform for IPsec). To ensure that such quantities have consistent values and interpretations across all implementations, their assignment must be administered by a central authority. For IETF protocols, that role is provided by the Internet Assigned Numbers Authority (IANA).&lt;/t&gt;&lt;t&gt; In order for IANA to manage a given namespace prudently, it needs guidelines describing the conditions under which new values can be assigned or when modifications to existing values can be made. If IANA is expected to play a role in the management of a namespace, IANA must be given clear and concise instructions describing that role. This document discusses issues that should be considered in formulating a policy for assigning values to a namespace and provides guidelines for authors on the specific text that must be included in documents that place demands on IANA.&lt;/t&gt;&lt;t&gt; This document obsoletes RFC 2434. This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t>
</abstract>
</front>
<seriesInfo name="BCP" value="26"/>
<seriesInfo name="RFC" value="5226"/>
<format type="TXT" octets="66160" target="ftp://ftp.isi.edu/in-notes/rfc5226.txt"/>
</reference>
<reference anchor="RFC5101">
<front>
<title>Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information</title>
<author initials="B." surname="Claise" fullname="B. Claise">
<organization/>
</author>
<date year="2008" month="January"/>
<abstract>
<t>This document specifies the IP Flow Information Export (IPFIX) protocol that serves for transmitting IP Traffic Flow information over the network.  In order to transmit IP Traffic Flow information from an Exporting Process to an information Collecting Process, a common representation of flow data and a standard means of communicating them is required.  This document describes how the IPFIX Data and Template Records are carried over a number of transport protocols from an IPFIX Exporting Process to an IPFIX Collecting Process. [STANDARDS TRACK]</t>
</abstract>
</front>
<seriesInfo name="RFC" value="5101"/>
<format type="TXT" octets="147196" target="ftp://ftp.isi.edu/in-notes/rfc5101.txt"/>
</reference>
<reference anchor="RFC5102">
<front>
<title>Information Model for IP Flow Information Export</title>
<author initials="J." surname="Quittek" fullname="J. Quittek">
<organization/>
</author>
<author initials="S." surname="Bryant" fullname="S. Bryant">
<organization/>
</author>
<author initials="B." surname="Claise" fullname="B. Claise">
<organization/>
</author>
<author initials="P." surname="Aitken" fullname="P. Aitken">
<organization/>
</author>
<author initials="J." surname="Meyer" fullname="J. Meyer">
<organization/>
</author>
<date year="2008" month="January"/>
<abstract>
<t>
This memo defines an information model for the IP Flow Information
eXport (IPFIX) protocol.  It is used by the IPFIX protocol for
encoding measured traffic information and information related to the
traffic Observation Point, the traffic Metering Process, and the
Exporting Process.  Although developed for the IPFIX protocol, the
model is defined in an open way that easily allows using it in other
protocols, interfaces, and applications. [STANDARDS TRACK]
</t> 
</abstract>
</front>
<seriesInfo name="RFC" value="5102"/>
<format type="TXT" octets="335617" target="ftp://ftp.isi.edu/in-notes/rfc5102.txt"/>
</reference>

<reference anchor="RFC5475">
<front>
<title>Sampling and Filtering Techniques for IP Packet Selection</title>
<author initials="T" surname="Zseby" fullname="Tanja Zseby">
<organization/>
</author>
<author initials="M" surname="Molina" fullname="Maurizio Molina">
<organization/>
</author>
<author initials="D" surname="Duffield" fullname="Nick Duffield">
<organization/>
</author>
<author initials="S" surname="Niccolini" fullname="Saverio Niccolini">
<organization/>
</author>
<author initials="F" surname="Rapall" fullname="Frederic Raspall">
<organization/>
</author>
<date month="March" year="2009"/>
<abstract>
<t>This document describes Sampling and Filtering techniques for IP packet selection. It provides a categorization of schemes and defines what parameters are needed to describe the most common selection schemes. Furthermore, it shows how techniques can be combined to build more elaborate packet Selectors. The document provides the basis for the definition of information models for configuring selection techniques in Metering Processes and for reporting the technique in use to a Collector.</t>
</abstract>
</front>
<seriesInfo name="RFC" value="5475"/>
</reference>

<reference anchor="RFC5476">
<front>
<title>Packet Sampling (PSAMP) Protocol Specifications</title>
<author initials="B" surname="Claise" fullname="Benoit Claise" role="editor">
<organization/>
</author>
<date month="March" year="2009"/>
<abstract>
<t>This document specifies the export of packet information from a PSAMP Exporting Process to a PSAMP Collecting Process.  For export of packet information the IP Flow Information Export (IPFIX) protocol is used, as both the IPFIX and PSAMP architecture match very well and the means provided by the IPFIX protocol are sufficient.  The document specifies in detail how the IPFIX protocol is used for PSAMP export of packet information.</t>
</abstract>
</front>
<seriesInfo name="RFC" value="5476"/>
</reference>
</references>

<references title="Informative References">
<reference anchor="RFC0791">
<front>
<title abbrev="Internet Protocol">Internet Protocol</title>
<author initials="J." surname="Postel" fullname="Jon Postel">
<organization>University of Southern California (USC)/Information Sciences Institute</organization>
<address>
<postal>
<street>4676 Admiralty Way</street>
<city>Marina del Rey</city>
<region>CA</region>
<code>90291</code>
<country>US</country>
</postal>
</address>
</author>
<date year="1981" day="1" month="September"/>
</front>
<seriesInfo name="STD" value="5"/>
<seriesInfo name="RFC" value="791"/>
<format type="TXT" octets="97779" target="ftp://ftp.isi.edu/in-notes/rfc791.txt"/>
</reference>
<reference anchor="RFC2460">
<front>
<title abbrev="IPv6 Specification">Internet Protocol, Version 6 (IPv6) Specification</title>
<author initials="S.E." surname="Deering" fullname="Stephen E. Deering">
<organization>Cisco Systems, Inc.</organization>
<address>
<postal>
<street>170 West Tasman Drive</street>
<street>San Jose</street>
<region>CA</region>
<code>95134-1706</code>
<country>USA</country>
</postal>
<phone>+1 408 527 8213</phone>
<facsimile>+1 408 527 8254</facsimile>
<email>deering@cisco.com</email>
</address>
</author>
<author initials="R.M." surname="Hinden" fullname="Robert M. Hinden">
<organization>Nokia</organization>
<address>
<postal>
<street>232 Java Drive</street>
<street>Sunnyvale</street>
<region>CA</region>
<code>94089</code>
<country>USA</country>
</postal>
<phone>+1 408 990 2004</phone>
<facsimile>+1 408 743 5677</facsimile>
<email>hinden@iprg.nokia.com</email>
</address>
</author>
<date year="1998" month="December"/>
<area>Internet</area>
<keyword>internet protocol version 6</keyword>
<keyword>IPv6</keyword>
<abstract>
<t>
   This document specifies version 6 of the Internet Protocol (IPv6),
   also sometimes referred to as IP Next Generation or IPng.
</t>
</abstract>
</front>
<seriesInfo name="RFC" value="2460"/>
<format type="TXT" octets="85490" target="ftp://ftp.isi.edu/in-notes/rfc2460.txt"/>
<format type="HTML" octets="99496" target="http://xml.resource.org/public/rfc/html/rfc2460.html"/>
<format type="XML" octets="93343" target="http://xml.resource.org/public/rfc/xml/rfc2460.xml"/>
</reference>
<reference anchor="RFC2629">
<front>
<title>Writing I-Ds and RFCs using XML</title>
<author initials="M.T." surname="Rose" fullname="Marshall T. Rose">
<organization>Invisible Worlds, Inc.</organization>
<address>
<postal>
<street>660 York Street</street>
<city>San Francisco</city>
<region>CA</region>
<code>94110</code>
<country>US</country>
</postal>
<phone>+1 415 695 3975</phone>
<email>mrose@not.invisible.net</email>
<uri>http://invisible.net/</uri>
</address>
</author>
<date year="1999" month="June"/>
<area>General</area>
<keyword>RFC</keyword>
<keyword>Request for Comments</keyword>
<keyword>I-D</keyword>
<keyword>Internet-Draft</keyword>
<keyword>XML</keyword>
<keyword>Extensible Markup Language</keyword>
<abstract>
<t>This memo presents a technique for using XML
(Extensible Markup Language)
as a source format for documents in the Internet-Drafts (I-Ds) and
Request for Comments (RFC) series.</t>
</abstract>
</front>
<seriesInfo name="RFC" value="2629"/>
<format type="TXT" octets="48677" target="ftp://ftp.isi.edu/in-notes/rfc2629.txt"/>
<format type="HTML" octets="71741" target="http://xml.resource.org/public/rfc/html/rfc2629.html"/>
<format type="XML" octets="53481" target="http://xml.resource.org/public/rfc/xml/rfc2629.xml"/>
</reference>
<reference anchor="RFC2804">
<front>
<title>IETF Policy on Wiretapping</title>
<author>
<organization>IAB</organization>
</author>
<author>
<organization>IESG</organization>
</author>
<date year="2000" month="May"/>
<abstract>
<t>This document describes the position that the Internet Engineering Task Force (IETF) has taken regarding the inclusion into IETF standards-track documents of functionality designed to facilitate wiretapping.  This memo explains what the IETF thinks the question means, why its answer is "no", and what that answer means.  This memo provides information for the Internet community.</t>
</abstract>
</front>
<seriesInfo name="RFC" value="2804"/>
<format type="TXT" octets="18934" target="ftp://ftp.isi.edu/in-notes/rfc2804.txt"/>
</reference>
<reference anchor="RFC3031">
<front>
<title>Multiprotocol Label Switching Architecture</title>
<author initials="E." surname="Rosen" fullname="E. Rosen">
<organization/>
</author>
<author initials="A." surname="Viswanathan" fullname="A. Viswanathan">
<organization/>
</author>
<author initials="R." surname="Callon" fullname="R. Callon">
<organization/>
</author>
<date year="2001" month="January"/>
<abstract>
<t>This document specifies the architecture for Multiprotocol Label Switching (MPLS). [STANDARDS TRACK]</t>
</abstract>
</front>
<seriesInfo name="RFC" value="3031"/>
<format type="TXT" octets="147175" target="ftp://ftp.isi.edu/in-notes/rfc3031.txt"/>
</reference>
<reference anchor="RFC3032">
<front>
<title>MPLS Label Stack Encoding</title>
<author initials="E." surname="Rosen" fullname="E. Rosen">
<organization/>
</author>
<author initials="D." surname="Tappan" fullname="D. Tappan">
<organization/>
</author>
<author initials="G." surname="Fedorkow" fullname="G. Fedorkow">
<organization/>
</author>
<author initials="Y." surname="Rekhter" fullname="Y. Rekhter">
<organization/>
</author>
<author initials="D." surname="Farinacci" fullname="D. Farinacci">
<organization/>
</author>
<author initials="T." surname="Li" fullname="T. Li">
<organization/>
</author>
<author initials="A." surname="Conta" fullname="A. Conta">
<organization/>
</author>
<date year="2001" month="January"/>
<abstract>
<t>This document specifies the encoding to be used by an LSR in order to transmit labeled packets on Point-to-Point Protocol (PPP) data links, on LAN data links, and possibly on other data links as well.  This document also specifies rules and procedures for processing the various fields of the label stack encoding. [STANDARDS TRACK]</t>
</abstract>
</front>
<seriesInfo name="RFC" value="3032"/>
<format type="TXT" octets="48314" target="ftp://ftp.isi.edu/in-notes/rfc3032.txt"/>
</reference>
<reference anchor="RFC5474">
<front>
<title>A Framework for Packet Selection and Reporting</title>

<author initials="N" surname="Duffield" fullname="Nick Duffield" role="editor">
<organization/>
</author>

<date month="March" year="2009"/>
<abstract>
<t>This document specifies a framework for the PSAMP (Packet Sampling) protocol.  The functions of this protocol are to select packets from a stream according to a set of standardized selectors, to form a stream of reports on the selected packets, and to export the reports to a collector.  This framework details the components of this architecture, then describes some generic requirements, motivated by the dual aims of ubiquitous deployment and utility of the reports for applications.  Detailed requirements for selection, reporting and exporting are described, along with configuration requirements of the PSAMP functions.</t>
</abstract>
</front>
<seriesInfo name="RFC" value="5474"/>
</reference>
</references>
<section anchor="infoelementsXml" title="Formal Specification of PSAMP Information Elements" toc="default">
<t>This appendix contains a formal description of the PSAMP
      information model XML document. Note that this appendix is of
      informational nature, while the text in <xref target="infoelements" pageno="false" format="default"/> generated from this appendix is
      normative.</t>
<t>Using a formal and machine-readable syntax for the
      information model enables the creation of PSAMP-aware tools
      that can automatically adapt to extensions to the
      information model, by simply reading updated information
      model specifications.</t>
<t>The wide availability of XML-aware tools and libraries for
      client devices is a primary consideration for this choice. In
      particular, libraries for parsing XML documents are readily
      available. Also, mechanisms such as the Extensible Stylesheet
      Language (XSL) allow for transforming a source XML document
      into other documents. This draft was authored in XML and
      transformed according to <xref target="RFC2629" pageno="false" format="default"/>.</t>
<t>It should be noted that the use of XML in Exporters,
      Collectors, or other tools is not mandatory for the deployment
      of PSAMP. In particular, exporting processes do not produce
      or consume XML as part of their operation. It is expected
      that PSAMP Collectors MAY take advantage of the machine
      readability of the information model vs. hardcoding their
      behavior or inventing proprietary means for accommodating
      extensions.</t>

<figure><artwork><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<!--
  This XML document is a product of the IETF IPFIX Working Group.
  Contact information:
    WG charter:
      http://www.ietf.org/html.charters/ipfix-charter.html

    Mailing Lists:
      General Discussion: ipfix@ietf.org
      To Subscribe: http://www1.ietf.org/mailman/listinfo/ipfix
      Archive:
        http://www1.ietf.org/mail-archive/web/ipfix/current/index.html

    Editor:
      Thomas Dietz
      NEC Europe Ltd.
      NEC Laboratories Europe
      Network Research Division
      Kurfuersten-Anlage 36
      Heidelberg 69115
      Germany
      Phone: +49 6221 4342-128
      Email: Thomas.Dietz@nw.neclab.eu


      Benoit Claise
      Cisco Systems, Inc.
      De Kleetlaan 6a b1
      Degem  1813
      Belgium
      Phone: +32 2 704 5622
      Email: bclaise@cisco.com


      Paul Aitken
      Cisco Systems, Inc.
      96 Commercial Quay
      Edinburgh  EH6 6LX
      Scotland
      Phone: +44 131 561 3616
      Email: paitken@cisco.com
      URI:   http://www.cisco.com


      Falko Dressler
      University of Erlangen-Nuremberg
      Dept. of Computer Sciences
      Martensstr. 3
      Erlangen  91058
      Germany
      Phone: +49 9131 85-27914
      Email: dressler@informatik.uni-erlangen.de
      URI:   http://www7.informatik.uni-erlangen.de/~dressler

      Georg Carle
      Technical University of Munich
      Institute for Informatics
      Boltzmannstr. 3
      Garching bei Muenchen  85737
      Germany

      Phone: +49 89 289-18030
      EMail: carle@in.tum.de
      URI:   http://www.net.in.tum.de/~carle/

  Abstract:
   This memo defines an information model for the Packet SAMPling
   (PSAMP) protocol.  It is used by the PSAMP protocol for encoding
   sampled packet data and information related to the Sampling process.
   As the PSAMP protocol is based on the IPFIX protocol, this
   information model is an extension to the IPFIX information model.

   Copyright (c) 20009 IETF Trust and the persons identified as
   authors of the code.  All rights reserved.

   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:  

   - Redistributions of source code must retain the above copyright
     notice, this list of conditions and the following disclaimer. 

   - Redistributions in binary form must reproduce the above copyright
     notice, this list of conditions and the following disclaimer in
     the documentation and/or other materials provided with the
     distribution. 

   - Neither the name of Internet Society, IETF or IETF Trust, nor the
     names of specific contributors, may be used to endorse or promote
     products derived from this software without specific prior
     written permission.  

   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
   'AS IS' AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
   A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
   OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
   SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
   LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
   THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. 

   This version of the XML document is part of RFC 5477; 
   see the RFC itself for full legal notices.
-->
<fieldDefinitions xmlns="urn:ietf:params:xml:ns:ipfix-info"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="urn:ietf:params:xml:ns:ipfix-info
             ipfix-info.xsd">
  <field name="selectionSequenceId" dataType="unsigned64"
    dataTypeSemantics="identifier" elementId="301" status="current"
    group="identifiers">
    <description>
      <paragraph>
        From all the packets observed at an Observation Point, a subset
        of the packets is selected by a sequence of one or more
        Selectors.  The selectionSequenceId is a unique value per
        Observation Domain, specifying the Observation Point and the
        sequence of Selectors through which the packets are selected.
      </paragraph>
    </description>
  </field>

  <field name="selectorId" dataType="unsigned16"
    dataTypeSemantics="identifier" elementId="302" status="current"
    group="identifiers">
    <description>
      <paragraph>
        The Selector ID is the unique ID identifying a Primitive
        Selector.  Each Primitive Selector must have a unique ID in the
        Observation Domain.
      </paragraph>
    </description>
  </field>

  <field name="informationElementId" dataType="unsigned16"
    dataTypeSemantics="identifier" elementId="303" status="current"
    group="identifiers">
    <description>
      <paragraph>
        This Information Element contains the ID of another Information
        Element.
      </paragraph>
    </description>
  </field>

  <field name="selectorAlgorithm" dataType="unsigned16"
    dataTypeSemantics="identifier" elementId="304" status="current"
    group="sampling configuration">
    <description>
      <paragraph>
        This Information Element identifies the packet selection
        methods (e.g., Filtering, Sampling) that are applied by
        the Selection Process.

        Most of these methods have parameters.  Further
        Information Elements are needed to fully specify packet
        selection with these methods and all their parameters.

        The methods listed below are defined in
        [RFC5475].  For their parameters,
        Information Elements are defined in the information model
        document.  The names of these Information Elements are
        listed for each method identifier.

        Further method identifiers may be added to the list
        below.  It might be necessary to define new Information
        Elements to specify their parameters.

        The selectorAlgorithm registry is maintained by IANA.  New
        assignments for the registry will be administered by IANA
        and are subject to Expert Review [RFC5226].

        The registry can be updated when specifications of the new
        method(s) and any new Information Elements are provided.

        The group of experts must double check the selectorAlgorithm
        definitions and Information Elements with already defined
        selectorAlgorithms and Information Elements for completeness,
        accuracy, and redundancy.  Those experts will initially be drawn
        from the Working Group Chairs and document editors of the IPFIX
        and PSAMP Working Groups.

        The following packet selection methods identifiers are
        defined here:

        +----+------------------------+------------------------+
        | ID |        Method          |      Parameters        |
        +----+------------------------+------------------------+
        | 1  | Systematic count-based | samplingPacketInterval |
        |    | Sampling               | samplingPacketSpace    |
        +----+------------------------+------------------------+
        | 2  | Systematic time-based  | samplingTimeInterval   |
        |    | Sampling               | samplingTimeSpace      |
        +----+------------------------+------------------------+
        | 3  | Random n-out-of-N      | samplingSize           |
        |    | Sampling               | samplingPopulation     |
        +----+------------------------+------------------------+
        | 4  | Uniform probabilistic  | samplingProbability    |
        |    | Sampling               |                        |
        +----+------------------------+------------------------+
        | 5  | Property Match         | no agreed parameters   |
        |    | Filtering              |                        |
        +----+------------------------+------------------------+
        |   Hash-based Filtering      | hashInitialiserValue   |
        +----+------------------------+ hashIPPayloadOffset    |
        | 6  | using BOB              | hashIPPayloadSize      |
        +----+------------------------+ hashSelectedRangeMin   |
        | 7  | using IPSX             | hashSelectedRangeMax   |
        +----+------------------------+ hashOutputRangeMin     |
        | 8  | using CRC              | hashOutputRangeMax     |
        +----+------------------------+------------------------+

        There is a broad variety of possible parameters that could be
        used for Property Match Filtering (5), but currently there are
        no agreed parameters specified.
      </paragraph>
    </description>
  </field>

  <field name="samplingPacketInterval" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="305" status="current"
    group="sampling configuration">
    <description>
      <paragraph>
        This Information Element specifies the number of packets that
        are consecutively sampled.  A value of 100 means that
        100 consecutive packets are sampled.

        For example, this Information Element may be used to describe
        the configuration of a systematic count-based Sampling Selector.
      </paragraph>
    </description>
    <units>packets</units>
  </field>

  <field name="samplingPacketSpace" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="306" status="current"
    group="sampling configuration">
    <description>
      <paragraph>
        This Information Element specifies the number of packets between
        two "samplingPacketInterval"s.  A value of 100 means that the
        next interval starts 100 packets (which are not sampled)
        after the current "samplingPacketInterval" is over.

        For example, this Information Element may be used to describe
        the configuration of a systematic count-based Sampling Selector.
      </paragraph>
    </description>
    <units>packets</units>
  </field>

  <field name="samplingTimeInterval" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="307" status="current"
    group="sampling configuration">
    <description>
      <paragraph>
        This Information Element specifies the time interval in
        microseconds during which all arriving packets are sampled.

        For example, this Information Element may be used to describe
        the configuration of a systematic time-based Sampling Selector.
      </paragraph>
    </description>
    <units>microseconds</units>
  </field>

  <field name="samplingTimeSpace" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="308" status="current"
    group="sampling configuration">
    <description>
      <paragraph>
        This Information Element specifies the time interval in
        microseconds between two "samplingTimeInterval"s.  A value of 100
        means that the next interval starts 100 microseconds
        (during which no packets are sampled) after the current
        "samplingTimeInterval" is over.

        For example, this Information Element may used to describe the
        configuration of a systematic time-based Sampling Selector.
      </paragraph>
    </description>
    <units>microseconds</units>
  </field>

  <field name="samplingSize" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="309" status="current"
    group="sampling configuration">
    <description>
      <paragraph>
        This Information Element specifies the number of elements taken
        from the parent Population for random Sampling methods.

        For example, this Information Element may be used to describe
        the configuration of a random n-out-of-N Sampling Selector.
      </paragraph>
    </description>
    <units>packets</units>
  </field>

  <field name="samplingPopulation" dataType="unsigned32"
    dataTypeSemantics="quantity" elementId="310" status="current"
    group="sampling configuration">
    <description>
      <paragraph>
        This Information Element specifies the number of elements in the
        parent Population for random Sampling methods.

        For example, this Information Element may be used to describe
        the configuration of a random n-out-of-N Sampling Selector.
      </paragraph>
    </description>
    <units>packets</units>
  </field>

  <field name="samplingProbability" dataType="float64"
    dataTypeSemantics="quantity" elementId="311" status="current"
    group="sampling configuration">
    <description>
      <paragraph>
        This Information Element specifies the probability that a packet
        is sampled, expressed as a value between 0 and 1.  The
        probability is equal for every packet.  A value of 0 means no
        packet was sampled since the probability is 0.

        For example, this Information Element may be used to describe
        the configuration of a uniform probabilistic Sampling Selector.
      </paragraph>
    </description>
  </field>

  <field name="ipHeaderPacketSection" dataType="octetArray"
    elementId="313" status="current" group="packet data">
    <description>
      <paragraph>
        This Information Element, which may have a variable length,
        carries a series of octets from the start of the IP header of a
        sampled packet.

        With sufficient length, this element also reports octets from
        the IP payload, subject to [RFC2804].  See the Security
        Considerations section.

        The size of the exported section may be constrained due to
        limitations in the IPFIX protocol.

        The data for this field MUST NOT be padded.
      </paragraph>
    </description>
  </field>

  <field name="ipPayloadPacketSection" dataType="octetArray"
    elementId="314" status="current" group="packet data">
    <description>
      <paragraph>
        This Information Element, which may have a variable length,
        carries a series of octets from the start of the IP payload of a
        sampled packet.

        The IPv4 payload is that part of the packet that follows the
        IPv4 header and any options, which [RFC0791] refers to as "data"
        or "data octets".  For example, see the examples in [RFC0791], 
        Appendix A.

        The IPv6 payload is the rest of the packet following the 
        40-octet IPv6 header.  Note that any extension headers present 
        are considered part of the payload.  See [RFC2460] for the IPv6
        specification.

        The size of the exported section may be constrained due to
        limitations in the IPFIX protocol.

        The data for this field MUST NOT be padded.
      </paragraph>
    </description>
  </field>

  <field name="mplsLabelStackSection" dataType="octetArray"
    elementId="316" status="current" group="packet data">
    <description>
      <paragraph>
        This Information Element, which may have a variable length,
        carries the first n octets from the MPLS label stack of a
        sampled packet.

        With sufficient length, this element also reports octets from
        the MPLS payload, subject to [RFC2804].  See the Security
        Considerations section.

        See [RFC3031] for the specification of MPLS packets.

        See [RFC3032] for the specification of the MPLS label stack.

        The size of the exported section may be constrained due to
        limitations in the IPFIX protocol.

        The data for this field MUST NOT be padded.
      </paragraph>
    </description>
  </field>

  <field name="mplsPayloadPacketSection" dataType="octetArray"
    elementId="317" status="current" group="packet data">
    <description>
      <paragraph>
        This Information Element, which may have a variable length,
        carries the first n octets from the MPLS payload of a sampled
        packet, being data that follows immediately after the MPLS label
        stack.

        See [RFC3031] for the specification of MPLS packets.

        See [RFC3032] for the specification of the MPLS label stack.

        The size of the exported section may be constrained due to
        limitations in the IPFIX protocol.

        The data for this field MUST NOT be padded.
      </paragraph>
    </description>
  </field>

  <field name="selectorIdTotalPktsObserved" dataType="unsigned64"
    dataTypeSemantics="totalCounter" elementId="318" status="current"
    group="statistics">
    <description>
      <paragraph>
        This Information Element specifies the total number of packets
        observed by a Selector, for a specific value of SelectorId.

        This Information Element should be used in an Options Template
        scoped to the observation to which it refers.
        See Section 3.4.2.1 of the IPFIX protocol document [RFC5101].
      </paragraph>
    </description>
    <units>packets</units>
  </field>

  <field name="selectorIdTotalPktsSelected" dataType="unsigned64"
    dataTypeSemantics="totalCounter" elementId="319" status="current"
    group="statistics">
    <description>
      <paragraph>
        This Information Element specifies the total number of packets
        selected by a Selector, for a specific value of SelectorId.

        This Information Element should be used in an Options Template
        scoped to the observation to which it refers.
        See Section 3.4.2.1 of the IPFIX protocol document [RFC5101].
        </paragraph>
    </description>
    <units>packets</units>
  </field>

  <field name="absoluteError" dataType="float64"
    dataTypeSemantics="quantity" elementId="320" status="current"
    group="statistics">
    <description>
      <paragraph>
        This Information Element specifies the maximum possible
        measurement error of the reported value for a given Information
        Element.  The absoluteError has the same unit as the Information
        Element with which it is associated.  The real value of the 
        metric can differ by absoluteError (positive or negative) from
        the measured value.

        This Information Element provides only the
        error for measured values.  If an Information Element contains
        an estimated value (from Sampling), the confidence boundaries
        and confidence level have to be provided instead, using the
        upperCILimit, lowerCILimit, and confidenceLevel Information
        Elements.

        This Information Element should be used in an Options Template
        scoped to the observation to which it refers.
        See Section 3.4.2.1 of the IPFIX protocol document [RFC5101].
      </paragraph>
    </description>
    <units>
      The units of the Information Element for which the error is
      specified.
    </units>
  </field>

  <field name="relativeError" dataType="float64"
    dataTypeSemantics="quantity" elementId="321" status="current"
    group="statistics">
    <description>
      <paragraph>
        This Information Element specifies the maximum possible positive
        or negative error ratio for the reported value for a given
        Information Element as a percentage of the measured value.
        The real value of the metric can differ by relativeError percent
        (positive or negative) from the measured value.

        This Information Element provides only the error for measured
        values.  If an Information Element contains an estimated value
        (from Sampling), the confidence boundaries and confidence
        level have to be provided instead, using the upperCILimit,
        lowerCILimit, and confidenceLevel Information Elements.

        This Information Element should be used in an Options Template
        scoped to the observation to which it refers.
        See Section 3.4.2.1 of the IPFIX protocol document [RFC5101].
      </paragraph>
    </description>
  </field>

  <field name="observationTimeSeconds" dataType="dateTimeSeconds"
    dataTypeSemantics="quantity" elementId="322" status="current"
    group="timestamps">
    <description>
      <paragraph>
        This Information Element specifies the absolute time in seconds
        of an observation.
      </paragraph>
    </description>
    <units>seconds</units>
  </field>

  <field name="observationTimeMilliseconds"
    dataType="dateTimeMilliseconds" dataTypeSemantics="quantity"
    elementId="323" status="current" group="timestamps">
    <description>
      <paragraph>
        This Information Element specifies the absolute time in
        milliseconds of an observation.
      </paragraph>
    </description>
    <units>milliseconds</units>
  </field>

  <field name="observationTimeMicroseconds"
    dataType="dateTimeMicroseconds" dataTypeSemantics="quantity"
    elementId="324" status="current" group="timestamps">
    <description>
      <paragraph>
        This Information Element specifies the absolute time in
        microseconds of an observation.
      </paragraph>
    </description>
    <units>microseconds</units>
  </field>

  <field name="observationTimeNanoseconds"
    dataType="dateTimeNanoseconds" dataTypeSemantics="quantity"
    elementId="325" status="current" group="timestamps">
    <description>
      <paragraph>
        This Information Element specifies the absolute time in
        nanoseconds of an observation.
      </paragraph>
    </description>
    <units>nanoseconds</units>
  </field>

  <field name="digestHashValue" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="326" status="current"
    group="hash configuration">
    <description>
      <paragraph>
        This Information Element specifies the value from the digest
        hash function.

        See also Sections 6.2, 3.8, and 7.1 of
        [RFC5475].
      </paragraph>
    </description>
  </field>

  <field name="hashIPPayloadOffset" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="327" status="current"
    group="hash configuration">
    <description>
      <paragraph>
        This Information Element specifies the IP payload offset used by
        a Hash-based Selection Selector.

        See also Sections 6.2, 3.8, and 7.1 of
        [RFC5475].
      </paragraph>
    </description>
  </field>

  <field name="hashIPPayloadSize" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="328" status="current"
    group="hash configuration">
    <description>
      <paragraph>
        This Information Element specifies the IP payload size used by a
        Hash-based Selection Selector.
        See also Sections 6.2, 3.8, and 7.1 of
        [RFC5475]
      </paragraph>
    </description>
  </field>

  <field name="hashOutputRangeMin" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="329" status="current"
    group="hash configuration">
    <description>
      <paragraph>
        This Information Element specifies the value for the beginning
        of a hash function's potential output range.

        See also Sections 6.2, 3.8, and 7.1 of
        [RFC5475].
      </paragraph>
    </description>
  </field>

  <field name="hashOutputRangeMax" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="330" status="current"
    group="hash configuration">
    <description>
      <paragraph>
        This Information Element specifies the value for the end of a
        hash function's potential output range.

        See also Sections 6.2, 3.8, and 7.1 of
        [RFC5475].
      </paragraph>
    </description>
  </field>

  <field name="hashSelectedRangeMin" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="331" status="current"
    group="hash configuration">
    <description>
      <paragraph>
        This Information Element specifies the value for the beginning
        of a hash function's selected range.

        See also Sections 6.2, 3.8, and 7.1 of
        [RFC5475].
      </paragraph>
    </description>
  </field>

  <field name="hashSelectedRangeMax" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="332" status="current"
    group="hash configuration">
    <description>
      <paragraph>
        This Information Element specifies the value for the end of a
        hash function's selected range.

        See also Sections 6.2, 3.8, and 7.1 of
        [RFC5475].
      </paragraph>
    </description>
  </field>

  <field name="hashDigestOutput" dataType="boolean"
    dataTypeSemantics="quantity" elementId="333" status="current"
    group="hash configuration">
    <description>
      <paragraph>
        This Information Element contains a boolean value that is TRUE
        if the output from this hash Selector has been configured to be
        included in the packet report as a packet digest, else FALSE.

        See also Sections 6.2, 3.8, and 7.1 of
        [RFC5475].
      </paragraph>
    </description>
  </field>

  <field name="hashInitialiserValue" dataType="unsigned64"
    dataTypeSemantics="quantity" elementId="334" status="current"
    group="hash configuration">
    <description>
      <paragraph>
        This Information Element specifies the initialiser value to the
        hash function.

        See also Sections 6.2, 3.8, and 7.1 of
        [RFC5475].
      </paragraph>
    </description>
  </field>

  <field name="upperCILimit" dataType="float64"
    dataTypeSemantics="quantity" elementId="336" status="current"
    group="statistics">
    <description>
      <paragraph>
        This Information Element specifies the upper limit of a
        confidence interval.  It is used to provide an accuracy
        statement for an estimated value.  The confidence limits
        define the range in which the real value is assumed to be
        with a certain probability p.  Confidence limits always need
        to be associated with a confidence level that defines this
        probability p.  Please note that a confidence interval only
        provides a probability that the real value lies within the
        limits.  That means the real value can lie outside the
        confidence limits.

        The upperCILimit, lowerCILimit, and confidenceLevel
        Information Elements should all be used in an Options Template
        scoped to the observation to which they refer.
        See Section 3.4.2.1 of the IPFIX protocol document [RFC5101].

        Note that the upperCILimit, lowerCILimit, and confidenceLevel
        are all required to specify confidence, and should be
        disregarded unless all three are specified together.
      </paragraph>
    </description>
    </field>

  <field name="lowerCILimit" dataType="float64"
    dataTypeSemantics="quantity" elementId="337" status="current"
    group="statistics">
    <description>
      <paragraph>
        This Information Element specifies the lower limit of a
        confidence interval.  For further information, see the
        description of upperCILimit.

        The upperCILimit, lowerCILimit, and confidenceLevel
        Information Elements should all be used in an Options Template
        scoped to the observation to which they refer.
        See Section 3.4.2.1 of the IPFIX protocol document [RFC5101].

        Note that the upperCILimit, lowerCILimit, and confidenceLevel
        are all required to specify confidence, and should be
        disregarded unless all three are specified together.
      </paragraph>
    </description>
  </field>

  <field name="confidenceLevel" dataType="float64"
    dataTypeSemantics="quantity" elementId="338" status="current"
    group="statistics">
    <description>
      <paragraph>
        This Information Element specifies the confidence level.  It is
        used to provide an accuracy statement for estimated values.
        The confidence level provides the probability p with which the
        real value lies within a given range.  A confidence level
        always needs to be associated with confidence limits that
        define the range in which the real value is assumed to be.

        The upperCILimit, lowerCILimit, and confidenceLevel
        Information Elements should all be used in an Options Template
        scoped to the observation to which they refer.
        See Section 3.4.2.1 of the IPFIX protocol document [RFC5101].

        Note that the upperCILimit, lowerCILimit, and confidenceLevel
        are all required to specify confidence, and should be
        disregarded unless all three are specified together.
      </paragraph>
    </description>
  </field>

</fieldDefinitions>
]]></artwork></figure>

</section>
</back>
</rfc>
